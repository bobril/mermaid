(function(e){"use strict";var t=__bbb.bd;var a=__bbb.Lb;var _=__bbb.xc;var i=__bbb.Mb;var n=__bbb.qc;var r=__bbb.rc;var o=__bbb.dc;var l=__bbb.ec;var s=__bbb.gc;var c=__bbb.fc;var d=__bbb.fd;var u=__bbb.gd;var h=__bbb.Gd;var b=__bbb._b;var g=__bbb.ad;var p=__bbb.Fd;var A=__bbb.Hd;var v=__bbb.Id;var m=__bbb.Jd;var S=__bbb.pc;var D=t.pie;var I={sections:new Map,showData:!1,config:D};var f=I.sections;var E=I.showData;var k=structuredClone(D);var F=a(()=>structuredClone(k),"getConfig");var W=a(()=>{f=new Map;E=I.showData;_()},"clear");var V=a(({label:e,value:t})=>{if(t<0){throw new Error(`"${e}" has invalid value: ${t}. Negative values are not allowed in pie charts. All slice values must be >= 0.`)}if(!f.has(e)){f.set(e,t);i.debug(`added new section: ${e}, with value: ${t}`)}},"addSection");var C=a(()=>f,"getSections");var T=a(e=>{E=e},"setShowData");var x=a(()=>E,"getShowData");var w={getConfig:F,clear:W,setDiagramTitle:n,getDiagramTitle:r,setAccTitle:o,getAccTitle:l,setAccDescription:s,getAccDescription:c,addSection:V,getSections:C,setShowData:T,getShowData:x};var G=a((e,t)=>{d(e,t);t.setShowData(e.showData);e.sections.map(t.addSection)},"populateDb");var L={parse:a(async e=>{const t=await u("pie",e);i.debug(t);G(t,w)},"parse")};var N=a(e=>`\n  .pieCircle{\n    stroke: ${e.pieStrokeColor};\n    stroke-width : ${e.pieStrokeWidth};\n    opacity : ${e.pieOpacity};\n  }\n  .pieOuterCircle{\n    stroke: ${e.pieOuterStrokeColor};\n    stroke-width: ${e.pieOuterStrokeWidth};\n    fill: none;\n  }\n  .pieTitleText {\n    text-anchor: middle;\n    font-size: ${e.pieTitleTextSize};\n    fill: ${e.pieTitleTextColor};\n    font-family: ${e.fontFamily};\n  }\n  .slice {\n    font-family: ${e.fontFamily};\n    fill: ${e.pieSectionTextColor};\n    font-size:${e.pieSectionTextSize};\n    // fill: white;\n  }\n  .legend text {\n    fill: ${e.pieLegendTextColor};\n    font-family: ${e.fontFamily};\n    font-size: ${e.pieLegendTextSize};\n  }\n`,"getStyles");var $=a(e=>{const t=[...e.values()].reduce((e,t)=>e+t,0);const a=[...e.entries()].map(([e,t])=>({label:e,value:t})).filter(e=>e.value/t*100>=1).sort((e,t)=>t.value-e.value);const _=h().value(e=>e.value);return _(a)},"createPieArcs");var y=a((e,t,a,_)=>{i.debug("rendering pie chart\n"+e);const n=_.db;const r=b();const o=g(n.getConfig(),r.pie);const l=40;const s=18;const c=4;const d=450;const u=p(t);const h=u.append("g");h.attr("transform","translate("+d/2+","+d/2+")");const{themeVariables:D}=r;let[I]=A(D.pieOuterStrokeWidth);I!==null&&I!==void 0?I:I=2;const f=o.textPosition;const E=Math.min(d,d)/2-l;const k=v().innerRadius(0).outerRadius(E);const F=v().innerRadius(E*f).outerRadius(E*f);h.append("circle").attr("cx",0).attr("cy",0).attr("r",E+I/2).attr("class","pieOuterCircle");const W=n.getSections();const V=$(W);const C=[D.pie1,D.pie2,D.pie3,D.pie4,D.pie5,D.pie6,D.pie7,D.pie8,D.pie9,D.pie10,D.pie11,D.pie12];let T=0;W.forEach(e=>{T+=e});const x=V.filter(e=>(e.data.value/T*100).toFixed(0)!=="0");const w=m(C);h.selectAll("mySlices").data(x).enter().append("path").attr("d",k).attr("fill",e=>w(e.data.label)).attr("class","pieCircle");h.selectAll("mySlices").data(x).enter().append("text").text(e=>(e.data.value/T*100).toFixed(0)+"%").attr("transform",e=>"translate("+F.centroid(e)+")").style("text-anchor","middle").attr("class","slice");h.append("text").text(n.getDiagramTitle()).attr("x",0).attr("y",-(d-50)/2).attr("class","pieTitleText");const G=[...W.entries()].map(([e,t])=>({label:e,value:t}));const L=h.selectAll(".legend").data(G).enter().append("g").attr("class","legend").attr("transform",(e,t)=>{const a=s+c;const _=a*G.length/2;const i=12*s;const n=t*a-_;return"translate("+i+","+n+")"});L.append("rect").attr("width",s).attr("height",s).style("fill",e=>w(e.label)).style("stroke",e=>w(e.label));L.append("text").attr("x",s+c).attr("y",s-c).text(e=>{if(n.getShowData()){return`${e.label} [${e.value}]`}return e.label});const N=Math.max(...L.selectAll("text").nodes().map(e=>{var t;return(t=e===null||e===void 0?void 0:e.getBoundingClientRect().width)!==null&&t!==void 0?t:0}));const y=d+l+s+c+N;u.attr("viewBox",`0 0 ${y} ${d}`);S(u,d,y,o.useMaxWidth)},"draw");var P={draw:y};var R={parser:L,db:w,renderer:P,styles:N};var U={diagram:R};__bbb.z=U}).call(this)