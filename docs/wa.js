(function(e){"use strict";var t=function(e){if(!("default"in e))return e;var t=e.default;if(typeof t==="object"||typeof t==="function"){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&o!=="default"&&(t[o]=e[o])}return t};var o=function(e,t,o){typeof t==="symbol"&&(t=t.description?"[".concat(t.description,"]"):"");return Object.defineProperty(e,"name",{configurable:!0,value:o?"".concat(o," ",t):t})};var i=__bbb.bc;var n=__bbb.Mb;var r=__bbb.hc;var s=__bbb.ic;var a=__bbb.tc;var d=__bbb.uc;var c=__bbb.jc;var l=__bbb.kc;var u=__bbb.Ac;var p=__bbb.dd;var _=__bbb.ed;var h=__bbb.fd;var g=__bbb.id;var f=__bbb.jd;var m=__bbb.Nb;var v=__bbb.ze;var y=__bbb.yc;var x=__bbb.we;var b=__bbb.ac;var C=__bbb.Ae;var E=__bbb.gc;var I=__bbb.Be;var A=__bbb.cc;var N=__bbb.dc;var D=__bbb.Id;var k=__bbb.le;var w=function(){var o={};var n={exports:o};(function e(t,r){if(typeof o==="object"&&typeof n==="object")n.exports=r(i);else if(typeof define==="function"&&define.amd)define(["cose-base"],r);else if(typeof o==="object")o["cytoscapeFcose"]=r(i);else t["cytoscapeFcose"]=r(t["coseBase"])})(this,function(t){return(()=>{var o={658:e=>{e.exports=Object.assign!=null?Object.assign.bind(Object):function(e){for(var t=arguments.length,o=Array(t>1?t-1:0),i=1;i<t;i++){o[i-1]=arguments[i]}o.forEach(function(t){Object.keys(t).forEach(function(o){return e[o]=t[o]})});return e}},548:(t,o,i)=>{var n=function(){function t(t,o){var i=[];var n=!0;var r=!1;var s=e;try{for(var a=t[Symbol.iterator](),d;!(n=(d=a.next()).done);n=!0){i.push(d.value);if(o&&i.length===o)break}}catch(e){r=!0;s=e}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw s}}return i}return function(e,o){if(Array.isArray(e)){return e}else if(Symbol.iterator in Object(e)){return t(e,o)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var r=i(140).layoutBase.LinkedList;var s={};s.getTopMostNodes=function(e){var t={};for(var o=0;o<e.length;o++){t[e[o].id()]=!0}var i=e.filter(function(e,o){typeof e==="number"&&(e=o);var i=e.parent()[0];while(i!=null){if(t[i.id()]){return!1}i=i.parent()[0]}return!0});return i};s.connectComponents=function(e,t,o,i){var n=new r;var s=new Set;var a=[];var d=void 0;var c=void 0;var l=void 0;var u=!1;var p=1;var _=[];var h=[];var g=function i(){var r=e.collection();h.push(r);var g=o[0];var f=e.collection();f.merge(g).merge(g.descendants().intersection(t));a.push(g);f.forEach(function(e){n.push(e);s.add(e);r.merge(e)});var m=function i(){g=n.shift();var c=e.collection();g.neighborhood().nodes().forEach(function(e){t.intersection(g.edgesWith(e)).length>0&&c.merge(e)});for(var l=0;l<c.length;l++){var u=c[l];d=o.intersection(u.union(u.ancestors()));if(d!=null&&!s.has(d[0])){var p=d.union(d.descendants());p.forEach(function(e){n.push(e);s.add(e);r.merge(e);o.has(e)&&a.push(e)})}}};while(n.length!=0){m()}r.forEach(function(e){t.intersection(e.connectedEdges()).forEach(function(e){r.has(e.source())&&r.has(e.target())&&r.merge(e)})});a.length==o.length&&(u=!0);if(!u||u&&p>1){c=a[0];l=c.connectedEdges().length;a.forEach(function(e){if(e.connectedEdges().length<l){l=e.connectedEdges().length;c=e}});_.push(c.id());var v=e.collection();v.merge(a[0]);a.forEach(function(e){v.merge(e)});a=[];o=o.difference(v);p++}};do{g()}while(!u);i&&(_.length>0&&i.set("dummy"+(i.size+1),_));return h};s.relocateComponent=function(t,o,i){if(!i.fixedNodeConstraint){var r=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY,a=Number.POSITIVE_INFINITY,d=Number.NEGATIVE_INFINITY;if(i.quality=="draft"){var c=!0,l=!1,u=e;try{for(var p=o.nodeIndexes[Symbol.iterator](),_;!(c=(_=p.next()).done);c=!0){var h=_.value,g=n(h,2),f=g[0],m=g[1],v=i.cy.getElementById(f);if(v){var y=v.boundingBox(),x=o.xCoords[m]-y.w/2,b=o.xCoords[m]+y.w/2,C=o.yCoords[m]-y.h/2,E=o.yCoords[m]+y.h/2;x<r&&(r=x);b>s&&(s=b);C<a&&(a=C);E>d&&(d=E)}}}catch(e){l=!0;u=e}finally{try{!c&&p.return&&p.return()}finally{if(l){throw u}}}var I=t.x-(s+r)/2,A=t.y-(d+a)/2;o.xCoords=o.xCoords.map(function(e){return e+I});o.yCoords=o.yCoords.map(function(e){return e+A})}else{Object.keys(o).forEach(function(e){var t=o[e];var i=t.getRect().x;var n=t.getRect().x+t.getRect().width;var c=t.getRect().y;var l=t.getRect().y+t.getRect().height;i<r&&(r=i);n>s&&(s=n);c<a&&(a=c);l>d&&(d=l)});var N=t.x-(s+r)/2,D=t.y-(d+a)/2;Object.keys(o).forEach(function(e){var t=o[e];t.setCenter(t.getCenterX()+N,t.getCenterY()+D)})}}};s.calcBoundingBox=function(e,t,o,i){var n=Number.MAX_SAFE_INTEGER;var r=Number.MIN_SAFE_INTEGER;var s=Number.MAX_SAFE_INTEGER;var a=Number.MIN_SAFE_INTEGER;var d=void 0;var c=void 0;var l=void 0;var u=void 0;var p=e.descendants().not(":parent");var _=p.length;for(var h=0;h<_;h++){var g=p[h];d=t[i.get(g.id())]-g.width()/2;c=t[i.get(g.id())]+g.width()/2;l=o[i.get(g.id())]-g.height()/2;u=o[i.get(g.id())]+g.height()/2;n>d&&(n=d);r<c&&(r=c);s>l&&(s=l);a<u&&(a=u)}var f={};f.topLeftX=n;f.topLeftY=s;f.width=r-n;f.height=a-s;return f};s.calcParentsWithoutChildren=function(e,t){var o=e.collection();t.nodes(":parent").forEach(function(e){var t=!1;e.children().forEach(function(e){e.css("display")!="none"&&(t=!0)});t||o.merge(e)});return o};t.exports=s},816:(e,t,o)=>{var i=o(548);var n=o(140).CoSELayout;var r=o(140).CoSENode;var s=o(140).layoutBase.PointD;var a=o(140).layoutBase.DimensionD;var d=o(140).layoutBase.LayoutConstants;var c=o(140).layoutBase.FDLayoutConstants;var l=o(140).CoSEConstants;var u=function e(t,o){var u=t.cy;var p=t.eles;var _=p.nodes();var h=p.edges();var g=void 0;var f=void 0;var m=void 0;var v={};if(t.randomize){g=o["nodeIndexes"];f=o["xCoords"];m=o["yCoords"]}var y=function e(t){return typeof t==="function"};var x=function e(t,o){if(y(t)){return t(o)}else{return t}};var b=i.calcParentsWithoutChildren(u,p);var C=function e(t,o,n,d){var c=o.length;for(var l=0;l<c;l++){var u=o[l],p=null;u.intersection(b).length==0&&(p=u.children());var _=void 0,h=u.layoutDimensions({nodeDimensionsIncludeLabels:d.nodeDimensionsIncludeLabels});if(u.outerWidth()!=null&&u.outerHeight()!=null){if(d.randomize){if(!u.isParent()){_=t.add(new r(n.graphManager,new s(f[g.get(u.id())]-h.w/2,m[g.get(u.id())]-h.h/2),new a(parseFloat(h.w),parseFloat(h.h))))}else{var y=i.calcBoundingBox(u,f,m,g);if(u.intersection(b).length==0){_=t.add(new r(n.graphManager,new s(y.topLeftX,y.topLeftY),new a(y.width,y.height)))}else{_=t.add(new r(n.graphManager,new s(y.topLeftX,y.topLeftY),new a(parseFloat(h.w),parseFloat(h.h))))}}}else{_=t.add(new r(n.graphManager,new s(u.position("x")-h.w/2,u.position("y")-h.h/2),new a(parseFloat(h.w),parseFloat(h.h))))}}else{_=t.add(new r(this.graphManager))}_.id=u.data("id");_.nodeRepulsion=x(d.nodeRepulsion,u);_.paddingLeft=parseInt(u.css("padding"));_.paddingTop=parseInt(u.css("padding"));_.paddingRight=parseInt(u.css("padding"));_.paddingBottom=parseInt(u.css("padding"));if(d.nodeDimensionsIncludeLabels){_.labelWidth=u.boundingBox({includeLabels:!0,includeNodes:!1,includeOverlays:!1}).w;_.labelHeight=u.boundingBox({includeLabels:!0,includeNodes:!1,includeOverlays:!1}).h;_.labelPosVertical=u.css("text-valign");_.labelPosHorizontal=u.css("text-halign")}v[u.data("id")]=_;isNaN(_.rect.x)&&(_.rect.x=0);isNaN(_.rect.y)&&(_.rect.y=0);if(p!=null&&p.length>0){var C=void 0;C=n.getGraphManager().add(n.newGraph(),_);e(C,p,n,d)}}};var E=function e(o,i,n){var r=0;var s=0;for(var a=0;a<n.length;a++){var d=n[a],u=v[d.data("source")],p=v[d.data("target")];if(u&&p&&u!==p&&u.getEdgesBetween(p).length==0){var _=i.add(o.newEdge(),u,p);_.id=d.id();_.idealLength=x(t.idealEdgeLength,d);_.edgeElasticity=x(t.edgeElasticity,d);r+=_.idealLength;s++}}if(t.idealEdgeLength!=null){if(s>0)l.DEFAULT_EDGE_LENGTH=c.DEFAULT_EDGE_LENGTH=r/s;else if(!y(t.idealEdgeLength))l.DEFAULT_EDGE_LENGTH=c.DEFAULT_EDGE_LENGTH=t.idealEdgeLength;else l.DEFAULT_EDGE_LENGTH=c.DEFAULT_EDGE_LENGTH=50;l.MIN_REPULSION_DIST=c.MIN_REPULSION_DIST=c.DEFAULT_EDGE_LENGTH/10;l.DEFAULT_RADIAL_SEPARATION=c.DEFAULT_EDGE_LENGTH}};var I=function e(t,o){o.fixedNodeConstraint&&(t.constraints["fixedNodeConstraint"]=o.fixedNodeConstraint);o.alignmentConstraint&&(t.constraints["alignmentConstraint"]=o.alignmentConstraint);o.relativePlacementConstraint&&(t.constraints["relativePlacementConstraint"]=o.relativePlacementConstraint)};t.nestingFactor!=null&&(l.PER_LEVEL_IDEAL_EDGE_LENGTH_FACTOR=c.PER_LEVEL_IDEAL_EDGE_LENGTH_FACTOR=t.nestingFactor);t.gravity!=null&&(l.DEFAULT_GRAVITY_STRENGTH=c.DEFAULT_GRAVITY_STRENGTH=t.gravity);t.numIter!=null&&(l.MAX_ITERATIONS=c.MAX_ITERATIONS=t.numIter);t.gravityRange!=null&&(l.DEFAULT_GRAVITY_RANGE_FACTOR=c.DEFAULT_GRAVITY_RANGE_FACTOR=t.gravityRange);t.gravityCompound!=null&&(l.DEFAULT_COMPOUND_GRAVITY_STRENGTH=c.DEFAULT_COMPOUND_GRAVITY_STRENGTH=t.gravityCompound);t.gravityRangeCompound!=null&&(l.DEFAULT_COMPOUND_GRAVITY_RANGE_FACTOR=c.DEFAULT_COMPOUND_GRAVITY_RANGE_FACTOR=t.gravityRangeCompound);t.initialEnergyOnIncremental!=null&&(l.DEFAULT_COOLING_FACTOR_INCREMENTAL=c.DEFAULT_COOLING_FACTOR_INCREMENTAL=t.initialEnergyOnIncremental);t.tilingCompareBy!=null&&(l.TILING_COMPARE_BY=t.tilingCompareBy);if(t.quality=="proof")d.QUALITY=2;else d.QUALITY=0;l.NODE_DIMENSIONS_INCLUDE_LABELS=c.NODE_DIMENSIONS_INCLUDE_LABELS=d.NODE_DIMENSIONS_INCLUDE_LABELS=t.nodeDimensionsIncludeLabels;l.DEFAULT_INCREMENTAL=c.DEFAULT_INCREMENTAL=d.DEFAULT_INCREMENTAL=!t.randomize;l.ANIMATE=c.ANIMATE=d.ANIMATE=t.animate;l.TILE=t.tile;l.TILING_PADDING_VERTICAL=typeof t.tilingPaddingVertical==="function"?t.tilingPaddingVertical.call():t.tilingPaddingVertical;l.TILING_PADDING_HORIZONTAL=typeof t.tilingPaddingHorizontal==="function"?t.tilingPaddingHorizontal.call():t.tilingPaddingHorizontal;l.DEFAULT_INCREMENTAL=c.DEFAULT_INCREMENTAL=d.DEFAULT_INCREMENTAL=!0;l.PURE_INCREMENTAL=!t.randomize;d.DEFAULT_UNIFORM_LEAF_NODE_SIZES=t.uniformNodeDimensions;if(t.step=="transformed"){l.TRANSFORM_ON_CONSTRAINT_HANDLING=!0;l.ENFORCE_CONSTRAINTS=!1;l.APPLY_LAYOUT=!1}if(t.step=="enforced"){l.TRANSFORM_ON_CONSTRAINT_HANDLING=!1;l.ENFORCE_CONSTRAINTS=!0;l.APPLY_LAYOUT=!1}if(t.step=="cose"){l.TRANSFORM_ON_CONSTRAINT_HANDLING=!1;l.ENFORCE_CONSTRAINTS=!1;l.APPLY_LAYOUT=!0}if(t.step=="all"){if(t.randomize)l.TRANSFORM_ON_CONSTRAINT_HANDLING=!0;else l.TRANSFORM_ON_CONSTRAINT_HANDLING=!1;l.ENFORCE_CONSTRAINTS=!0;l.APPLY_LAYOUT=!0}if(t.fixedNodeConstraint||t.alignmentConstraint||t.relativePlacementConstraint){l.TREE_REDUCTION_ON_INCREMENTAL=!1}else{l.TREE_REDUCTION_ON_INCREMENTAL=!0}var e=new n;var A=e.newGraphManager();C(A.addRoot(),i.getTopMostNodes(_),e,t);E(e,A,h);I(e,t);e.runLayout();return v};e.exports={coseLayout:u}},212:(t,o,i)=>{var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1;i.configurable=!0;"value"in i&&(i.writable=!0);Object.defineProperty(e,i.key,i)}}return function(t,o,i){o&&e(t.prototype,o);i&&e(t,i);return t}}();function r(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var s=i(658);var a=i(548);var d=i(657),c=d.spectralLayout;var l=i(816),u=l.coseLayout;var p=Object.freeze({quality:"default",randomize:!0,animate:!0,animationDuration:1e3,animationEasing:e,fit:!0,padding:30,nodeDimensionsIncludeLabels:!1,uniformNodeDimensions:!1,packComponents:!0,step:"all",samplingType:!0,sampleSize:25,nodeSeparation:75,piTol:1E-07,nodeRepulsion:function e(t){return 4500},idealEdgeLength:function e(t){return 50},edgeElasticity:function e(t){return.45},nestingFactor:.1,gravity:.25,numIter:2500,tile:!0,tilingCompareBy:e,tilingPaddingVertical:10,tilingPaddingHorizontal:10,gravityRangeCompound:1.5,gravityCompound:1,gravityRange:3.8,initialEnergyOnIncremental:.3,fixedNodeConstraint:e,alignmentConstraint:e,relativePlacementConstraint:e,ready:function e(){},stop:function e(){}});var _=function(){function t(e){r(this,t);this.options=s({},p,e)}n(t,[{key:"run",value:function t(){var o=this;var i=this.options;var n=i.cy;var r=i.eles;var s=[];var d=[];var l=void 0;var p=[];i.fixedNodeConstraint&&(!Array.isArray(i.fixedNodeConstraint)||i.fixedNodeConstraint.length==0)&&(i.fixedNodeConstraint=e);if(i.alignmentConstraint){i.alignmentConstraint.vertical&&(!Array.isArray(i.alignmentConstraint.vertical)||i.alignmentConstraint.vertical.length==0)&&(i.alignmentConstraint.vertical=e);i.alignmentConstraint.horizontal&&(!Array.isArray(i.alignmentConstraint.horizontal)||i.alignmentConstraint.horizontal.length==0)&&(i.alignmentConstraint.horizontal=e)}i.relativePlacementConstraint&&(!Array.isArray(i.relativePlacementConstraint)||i.relativePlacementConstraint.length==0)&&(i.relativePlacementConstraint=e);var _=i.fixedNodeConstraint||i.alignmentConstraint||i.relativePlacementConstraint;if(_){i.tile=!1;i.packComponents=!1}var h=void 0;var g=!1;if(n.layoutUtilities&&i.packComponents){h=n.layoutUtilities("get");h||(h=n.layoutUtilities());g=!0}if(r.nodes().length>0){if(!g){var f=i.eles.boundingBox();p.push({x:f.x1+f.w/2,y:f.y1+f.h/2});if(i.randomize){var m=c(i);s.push(m)}if(i.quality=="default"||i.quality=="proof"){d.push(u(i,s[0]));a.relocateComponent(p[0],d[0],i)}else{a.relocateComponent(p[0],s[0],i)}}else{var v=a.getTopMostNodes(i.eles.nodes());l=a.connectComponents(n,i.eles,v);l.forEach(function(e){var t=e.boundingBox();p.push({x:t.x1+t.w/2,y:t.y1+t.h/2})});i.randomize&&l.forEach(function(e){i.eles=e;s.push(c(i))});if(i.quality=="default"||i.quality=="proof"){var y=n.collection();if(i.tile){var x=new Map,b=[],C=[],E=0,I={nodeIndexes:x,xCoords:b,yCoords:C},A=[];l.forEach(function(e,t){if(e.edges().length==0){e.nodes().forEach(function(t,o){y.merge(e.nodes()[o]);if(!t.isParent()){I.nodeIndexes.set(e.nodes()[o].id(),E++);I.xCoords.push(e.nodes()[0].position().x);I.yCoords.push(e.nodes()[0].position().y)}});A.push(t)}});if(y.length>1){var N=y.boundingBox();p.push({x:N.x1+N.w/2,y:N.y1+N.h/2});l.push(y);s.push(I);for(var D=A.length-1;D>=0;D--){l.splice(A[D],1);s.splice(A[D],1);p.splice(A[D],1)}}}l.forEach(function(e,t){i.eles=e;d.push(u(i,s[t]));a.relocateComponent(p[t],d[t],i)})}else{l.forEach(function(e,t){a.relocateComponent(p[t],s[t],i)})}var k=new Set;if(l.length>1){var w=[],S=r.filter(function(e){return e.css("display")=="none"});l.forEach(function(e,t){var o=void 0;i.quality=="draft"&&(o=s[t].nodeIndexes);if(e.nodes().not(S).length>0){var n={};n.edges=[];n.nodes=[];var r=void 0;e.nodes().not(S).forEach(function(e){if(i.quality=="draft"){if(!e.isParent()){r=o.get(e.id());n.nodes.push({x:s[t].xCoords[r]-e.boundingbox().w/2,y:s[t].yCoords[r]-e.boundingbox().h/2,width:e.boundingbox().w,height:e.boundingbox().h})}else{var c=a.calcBoundingBox(e,s[t].xCoords,s[t].yCoords,o);n.nodes.push({x:c.topLeftX,y:c.topLeftY,width:c.width,height:c.height})}}else{d[t][e.id()]&&n.nodes.push({x:d[t][e.id()].getLeft(),y:d[t][e.id()].getTop(),width:d[t][e.id()].getWidth(),height:d[t][e.id()].getHeight()})}});e.edges().forEach(function(e){var r=e.source();var c=e.target();if(r.css("display")!="none"&&c.css("display")!="none"){if(i.quality=="draft"){var l=o.get(r.id()),u=o.get(c.id()),p=[],_=[];if(r.isParent()){var h=a.calcBoundingBox(r,s[t].xCoords,s[t].yCoords,o);p.push(h.topLeftX+h.width/2);p.push(h.topLeftY+h.height/2)}else{p.push(s[t].xCoords[l]);p.push(s[t].yCoords[l])}if(c.isParent()){var g=a.calcBoundingBox(c,s[t].xCoords,s[t].yCoords,o);_.push(g.topLeftX+g.width/2);_.push(g.topLeftY+g.height/2)}else{_.push(s[t].xCoords[u]);_.push(s[t].yCoords[u])}n.edges.push({startX:p[0],startY:p[1],endX:_[0],endY:_[1]})}else{d[t][r.id()]&&d[t][c.id()]&&n.edges.push({startX:d[t][r.id()].getCenterX(),startY:d[t][r.id()].getCenterY(),endX:d[t][c.id()].getCenterX(),endY:d[t][c.id()].getCenterY()})}}});if(n.nodes.length>0){w.push(n);k.add(t)}}});var R=h.packComponents(w,i.randomize).shifts;if(i.quality=="draft"){s.forEach(function(e,t){var o=e.xCoords.map(function(e){return e+R[t].dx});var i=e.yCoords.map(function(e){return e+R[t].dy});e.xCoords=o;e.yCoords=i})}else{var T=0;k.forEach(function(e){Object.keys(d[e]).forEach(function(t){var o=d[e][t];o.setCenter(o.getCenterX()+R[T].dx,o.getCenterY()+R[T].dy)});T++})}}}}var L=function t(o,n){if(i.quality=="default"||i.quality=="proof"){typeof o==="number"&&(o=n);var r=void 0,a=void 0,c=o.data("id");d.forEach(function(e){if(c in e){r={x:e[c].getRect().getCenterX(),y:e[c].getRect().getCenterY()};a=e[c]}});if(i.nodeDimensionsIncludeLabels){if(a.labelWidth){if(a.labelPosHorizontal=="left"){r.x+=a.labelWidth/2}else a.labelPosHorizontal=="right"&&(r.x-=a.labelWidth/2)}if(a.labelHeight){if(a.labelPosVertical=="top"){r.y+=a.labelHeight/2}else a.labelPosVertical=="bottom"&&(r.y-=a.labelHeight/2)}}r==e&&(r={x:o.position("x"),y:o.position("y")});return{x:r.x,y:r.y}}else{var l=void 0;s.forEach(function(t){var i=t.nodeIndexes.get(o.id());i!=e&&(l={x:t.xCoords[i],y:t.yCoords[i]})});l==e&&(l={x:o.position("x"),y:o.position("y")});return{x:l.x,y:l.y}}};if(i.quality=="default"||i.quality=="proof"||i.randomize){var B=a.calcParentsWithoutChildren(n,r),Y=r.filter(function(e){return e.css("display")=="none"});i.eles=r.not(Y);r.nodes().not(":parent").not(Y).layoutPositions(o,i,L);B.length>0&&B.forEach(function(e){e.position(L(e))})}else{console.log("If randomize option is set to false, then quality option must be 'default' or 'proof'.")}}}]);return t}();t.exports=_},657:(t,o,i)=>{var n=i(548);var r=i(140).layoutBase.Matrix;var s=i(140).layoutBase.SVD;var a=function t(o){var i=o.cy;var a=o.eles;var d=a.nodes();var c=a.nodes(":parent");var l=new Map;var u=new Map;var p=new Map;var _=[];var h=[];var g=[];var f=[];var m=[];var v=[];var y=[];var x=[];var b=void 0;var C=1e8;var E=1E-09;var I=o.piTol;var A=o.samplingType;var N=o.nodeSeparation;var D=void 0;var k=function e(){var t=0;var o=0;var i=!1;while(o<D){t=Math.floor(Math.random()*b);i=!1;for(var n=0;n<o;n++){if(f[n]==t){i=!0;break}}if(!i){f[o]=t;o++}else{continue}}};var w=function e(t,o,i){var n=[];var r=0;var s=0;var a=0;var d=void 0;var c=[];var l=0;var p=1;for(var h=0;h<b;h++){c[h]=C}n[s]=t;c[t]=0;while(s>=r){a=n[r++];var g=_[a];for(var f=0;f<g.length;f++){d=u.get(g[f]);if(c[d]==C){c[d]=c[a]+1;n[++s]=d}}v[a][o]=c[a]*N}if(i){for(var y=0;y<b;y++){v[y][o]<m[y]&&(m[y]=v[y][o])}for(var x=0;x<b;x++){if(m[x]>l){l=m[x];p=x}}}return p};var S=function e(t){var o=void 0;if(!t){k();for(var i=0;i<D;i++){w(f[i],i,t,!1)}}else{o=Math.floor(Math.random()*b);for(var n=0;n<b;n++){m[n]=C}for(var r=0;r<D;r++){f[r]=o;o=w(o,r,t)}}for(var s=0;s<b;s++){for(var a=0;a<D;a++){v[s][a]*=v[s][a]}}for(var d=0;d<D;d++){y[d]=[]}for(var c=0;c<D;c++){for(var l=0;l<D;l++){y[c][l]=v[f[l]][c]}}};var R=function e(){var t=s.svd(y);var o=t.S;var i=t.U;var n=t.V;var a=o[0]*o[0]*o[0];var d=[];for(var c=0;c<D;c++){d[c]=[];for(var l=0;l<D;l++){d[c][l]=0;c==l&&(d[c][l]=o[c]/(o[c]*o[c]+a/(o[c]*o[c])))}}x=r.multMat(r.multMat(n,d),r.transpose(i))};var T=function e(){var t=void 0;var o=void 0;var i=[];var n=[];var s=[];var a=[];for(var d=0;d<b;d++){i[d]=Math.random();n[d]=Math.random()}i=r.normalize(i);n=r.normalize(n);var c=0;var l=E;var u=E;var p=void 0;while(!0){c++;for(var _=0;_<b;_++){s[_]=i[_]}i=r.multGamma(r.multL(r.multGamma(s),v,x));t=r.dotProduct(s,i);i=r.normalize(i);l=r.dotProduct(s,i);p=Math.abs(l/u);if(p<=1+I&&p>=1){break}u=l}for(var f=0;f<b;f++){s[f]=i[f]}c=0;u=E;while(!0){c++;for(var m=0;m<b;m++){a[m]=n[m]}a=r.minusOp(a,r.multCons(s,r.dotProduct(s,a)));n=r.multGamma(r.multL(r.multGamma(a),v,x));o=r.dotProduct(a,n);n=r.normalize(n);l=r.dotProduct(a,n);p=Math.abs(l/u);if(p<=1+I&&p>=1){break}u=l}for(var y=0;y<b;y++){a[y]=n[y]}h=r.multCons(s,Math.sqrt(Math.abs(t)));g=r.multCons(a,Math.sqrt(Math.abs(o)))};n.connectComponents(i,a,n.getTopMostNodes(d),l);c.forEach(function(e){n.connectComponents(i,a,n.getTopMostNodes(e.descendants().intersection(a)),l)});var L=0;for(var B=0;B<d.length;B++){d[B].isParent()||u.set(d[B].id(),L++)}var Y=!0;var G=!1;var F=e;try{for(var M=l.keys()[Symbol.iterator](),z;!(Y=(z=M.next()).done);Y=!0){var X=z.value;u.set(X,L++)}}catch(e){G=!0;F=e}finally{try{!Y&&M.return&&M.return()}finally{if(G){throw F}}}for(var P=0;P<u.size;P++){_[P]=[]}c.forEach(function(e){var t=e.children().intersection(a);while(t.nodes(":childless").length==0){t=t.nodes()[0].children().intersection(a)}var o=0;var i=t.nodes(":childless")[0].connectedEdges().length;t.nodes(":childless").forEach(function(e,t){if(e.connectedEdges().length<i){i=e.connectedEdges().length;o=t}});p.set(e.id(),t.nodes(":childless")[o].id())});d.forEach(function(e){var t=void 0;if(e.isParent())t=u.get(p.get(e.id()));else t=u.get(e.id());e.neighborhood().nodes().forEach(function(o){if(a.intersection(e.edgesWith(o)).length>0){if(o.isParent())_[t].push(p.get(o.id()));else _[t].push(o.id())}})});var O=function e(t){var o=u.get(t);var n=void 0;l.get(t).forEach(function(e){if(i.getElementById(e).isParent())n=p.get(e);else n=e;_[o].push(n);_[u.get(n)].push(t)})};var J=!0;var j=!1;var H=e;try{for(var $=l.keys()[Symbol.iterator](),q;!(J=(q=$.next()).done);J=!0){var V=q.value;O(V)}}catch(e){j=!0;H=e}finally{try{!J&&$.return&&$.return()}finally{if(j){throw H}}}b=u.size;var U=void 0;if(b>2){D=b<o.sampleSize?b:o.sampleSize;for(var Z=0;Z<b;Z++){v[Z]=[]}for(var W=0;W<D;W++){x[W]=[]}if(o.quality=="draft"||o.step=="all"){S(A);R();T();U={nodeIndexes:u,xCoords:h,yCoords:g}}else{u.forEach(function(e,t){h.push(i.getElementById(t).position("x"));g.push(i.getElementById(t).position("y"))});U={nodeIndexes:u,xCoords:h,yCoords:g}}return U}else{var K=u.keys(),Q=i.getElementById(K.next().value),ee=Q.position(),te=Q.outerWidth();h.push(ee.x);g.push(ee.y);if(b==2){var oe=i.getElementById(K.next().value),ie=oe.outerWidth();h.push(ee.x+te/2+ie/2+o.idealEdgeLength);g.push(ee.y)}U={nodeIndexes:u,xCoords:h,yCoords:g};return U}};t.exports={spectralLayout:a}},579:(e,t,o)=>{var i=o(212);var n=function e(t){if(!t){return}t("layout","fcose",i)};typeof cytoscape!=="undefined"&&n(cytoscape);e.exports=n},140:e=>{e.exports=t}};var i={};function n(t){var r=i[t];if(r!==e){return r.exports}var s=i[t]={exports:{}};o[t](s,s.exports,n);return s.exports}var r=n(579);return r})()});return t(n.exports)}.call(window);var S;var R={L:"left",R:"right",T:"top",B:"bottom"};var T={L:n(e=>`${e},${e/2} 0,${e} 0,0`,"L"),R:n(e=>`0,${e/2} ${e},0 ${e},${e}`,"R"),T:n(e=>`0,0 ${e},0 ${e/2},${e}`,"T"),B:n(e=>`${e/2},0 ${e},${e} 0,${e}`,"B")};var L={L:n((e,t)=>e-t+2,"L"),R:n((e,t)=>e-2,"R"),T:n((e,t)=>e-t+2,"T"),B:n((e,t)=>e-2,"B")};var B=n(function(e){if(G(e)){return e==="L"?"R":"L"}else{return e==="T"?"B":"T"}},"getOppositeArchitectureDirection");var Y=n(function(e){return e==="L"||e==="R"||e==="T"||e==="B"},"isArchitectureDirection");var G=n(function(e){return e==="L"||e==="R"},"isArchitectureDirectionX");var F=n(function(e){return e==="T"||e==="B"},"isArchitectureDirectionY");var M=n(function(e,t){const o=G(e)&&F(t);const i=F(e)&&G(t);return o||i},"isArchitectureDirectionXY");var z=n(function(e){const t=e[0];const o=e[1];const i=G(t)&&F(o);const n=F(t)&&G(o);return i||n},"isArchitecturePairXY");var X=n(function(e){return e!=="LL"&&e!=="RR"&&e!=="TT"&&e!=="BB"},"isValidArchitectureDirectionPair");var P=n(function(e,t){const o=`${e}${t}`;return X(o)?o:void 0},"getArchitectureDirectionPair");var O=n(function([e,t],o){const i=o[0];const n=o[1];if(G(i)){if(F(n)){return[e+(i==="L"?-1:1),t+(n==="T"?1:-1)]}else{return[e+(i==="L"?-1:1),t]}}else{if(G(n)){return[e+(n==="L"?1:-1),t+(i==="T"?1:-1)]}else{return[e,t+(i==="T"?1:-1)]}}},"shiftPositionByArchitectureDirectionPair");var J=n(function(e){if(e==="LT"||e==="TL"){return[1,1]}else if(e==="BL"||e==="LB"){return[1,-1]}else if(e==="BR"||e==="RB"){return[-1,-1]}else{return[-1,1]}},"getArchitectureDirectionXYFactors");var j=n(function(e,t){if(M(e,t)){return"bend"}else if(G(e)){return"horizontal"}return"vertical"},"getArchitectureDirectionAlignment");var H=n(function(e){return e.type==="service"},"isArchitectureService");var $=n(function(e){return e.type==="junction"},"isArchitectureJunction");var q=n(e=>e.data(),"edgeData");var V=n(e=>e.data(),"nodeData");var U=_.architecture;var Z=(S=class{constructor(){this.nodes={};this.groups={};this.edges=[];this.registeredIds={};this.elements={};this.setAccTitle=r;this.getAccTitle=s;this.setDiagramTitle=a;this.getDiagramTitle=d;this.getAccDescription=c;this.setAccDescription=l;this.clear()}clear(){this.nodes={};this.groups={};this.edges=[];this.registeredIds={};this.dataStructures=void 0;this.elements={};u()}addService({id:e,icon:t,in:o,title:i,iconText:n}){if(this.registeredIds[e]!==void 0){throw new Error(`The service id [${e}] is already in use by another ${this.registeredIds[e]}`)}if(o!==void 0){if(e===o){throw new Error(`The service [${e}] cannot be placed within itself`)}if(this.registeredIds[o]===void 0){throw new Error(`The service [${e}]'s parent does not exist. Please make sure the parent is created before this service`)}if(this.registeredIds[o]==="node"){throw new Error(`The service [${e}]'s parent is not a group`)}}this.registeredIds[e]="node";this.nodes[e]={id:e,type:"service",icon:t,iconText:n,title:i,edges:[],in:o}}getServices(){return Object.values(this.nodes).filter(H)}addJunction({id:e,in:t}){this.registeredIds[e]="node";this.nodes[e]={id:e,type:"junction",edges:[],in:t}}getJunctions(){return Object.values(this.nodes).filter($)}getNodes(){return Object.values(this.nodes)}getNode(e){var t;return(t=this.nodes[e])!==null&&t!==void 0?t:null}addGroup({id:e,icon:t,in:o,title:i}){var n,r,s;if(((n=this.registeredIds)===null||n===void 0?void 0:n[e])!==void 0){throw new Error(`The group id [${e}] is already in use by another ${this.registeredIds[e]}`)}if(o!==void 0){if(e===o){throw new Error(`The group [${e}] cannot be placed within itself`)}if(((r=this.registeredIds)===null||r===void 0?void 0:r[o])===void 0){throw new Error(`The group [${e}]'s parent does not exist. Please make sure the parent is created before this group`)}if(((s=this.registeredIds)===null||s===void 0?void 0:s[o])==="node"){throw new Error(`The group [${e}]'s parent is not a group`)}}this.registeredIds[e]="group";this.groups[e]={id:e,icon:t,title:i,in:o}}getGroups(){return Object.values(this.groups)}addEdge({lhsId:e,rhsId:t,lhsDir:o,rhsDir:i,lhsInto:n,rhsInto:r,lhsGroup:s,rhsGroup:a,title:d}){if(!Y(o)){throw new Error(`Invalid direction given for left hand side of edge ${e}--${t}. Expected (L,R,T,B) got ${String(o)}`)}if(!Y(i)){throw new Error(`Invalid direction given for right hand side of edge ${e}--${t}. Expected (L,R,T,B) got ${String(i)}`)}if(this.nodes[e]===void 0&&this.groups[e]===void 0){throw new Error(`The left-hand id [${e}] does not yet exist. Please create the service/group before declaring an edge to it.`)}if(this.nodes[t]===void 0&&this.groups[t]===void 0){throw new Error(`The right-hand id [${t}] does not yet exist. Please create the service/group before declaring an edge to it.`)}const c=this.nodes[e].in;const l=this.nodes[t].in;if(s&&c&&l&&c==l){throw new Error(`The left-hand id [${e}] is modified to traverse the group boundary, but the edge does not pass through two groups.`)}if(a&&c&&l&&c==l){throw new Error(`The right-hand id [${t}] is modified to traverse the group boundary, but the edge does not pass through two groups.`)}const u={lhsId:e,lhsDir:o,lhsInto:n,lhsGroup:s,rhsId:t,rhsDir:i,rhsInto:r,rhsGroup:a,title:d};this.edges.push(u);if(this.nodes[e]&&this.nodes[t]){this.nodes[e].edges.push(this.edges[this.edges.length-1]);this.nodes[t].edges.push(this.edges[this.edges.length-1])}}getEdges(){return this.edges}getDataStructures(){if(this.dataStructures===void 0){const e={};const t=Object.entries(this.nodes).reduce((t,[o,i])=>{t[o]=i.edges.reduce((t,i)=>{var n,r,s,a;const d=(n=this.getNode(i.lhsId))===null||n===void 0?void 0:n.in;const c=(r=this.getNode(i.rhsId))===null||r===void 0?void 0:r.in;if(d&&c&&d!==c){const t=j(i.lhsDir,i.rhsDir);if(t!=="bend"){(s=e[d])!==null&&s!==void 0?s:e[d]={};e[d][c]=t;(a=e[c])!==null&&a!==void 0?a:e[c]={};e[c][d]=t}}if(i.lhsId===o){const e=P(i.lhsDir,i.rhsDir);if(e){t[e]=i.rhsId}}else{const e=P(i.rhsDir,i.lhsDir);if(e){t[e]=i.lhsId}}return t},{});return t},{});const o=Object.keys(t)[0];const i={[o]:1};const r=Object.keys(t).reduce((e,t)=>t===o?e:{...e,[t]:1},{});const s=n(e=>{const o={[e]:[0,0]};const n=[e];while(n.length>0){const e=n.shift();if(e){i[e]=1;delete r[e];const s=t[e];const[a,d]=o[e];Object.entries(s).forEach(([e,t])=>{if(!i[t]){o[t]=O([a,d],e);n.push(t)}})}}return o},"BFS");const a=[s(o)];while(Object.keys(r).length>0){a.push(s(Object.keys(r)[0]))}this.dataStructures={adjList:t,spatialMaps:a,groupAlignments:e}}return this.dataStructures}setElementForId(e,t){this.elements[e]=t}getElementById(e){return this.elements[e]}getConfig(){return p({...U,...h().architecture})}getConfigField(e){return this.getConfig()[e]}},o(S,"ArchitectureDB"),(()=>{n(S,"ArchitectureDB")})(),S);var W=n((e,t)=>{g(e,t);e.groups.map(e=>t.addGroup(e));e.services.map(e=>t.addService({...e,type:"service"}));e.junctions.map(e=>t.addJunction({...e,type:"junction"}));e.edges.map(e=>t.addEdge(e))},"populateDb");var K={parser:{yy:void 0},parse:n(async e=>{var t;const o=await f("architecture",e);m.debug(o);const i=(t=K.parser)===null||t===void 0?void 0:t.yy;if(!(i instanceof Z)){throw new Error("parser.parser?.yy was not a ArchitectureDB. This is due to a bug within Mermaid, please report this issue at https://github.com/mermaid-js/mermaid/issues.")}W(o,i)},"parse")};var Q=n(e=>`\n  .edge {\n    stroke-width: ${e.archEdgeWidth};\n    stroke: ${e.archEdgeColor};\n    fill: none;\n  }\n\n  .arrow {\n    fill: ${e.archEdgeArrowColor};\n  }\n\n  .node-bkg {\n    fill: none;\n    stroke: ${e.archGroupBorderColor};\n    stroke-width: ${e.archGroupBorderWidth};\n    stroke-dasharray: 8;\n  }\n  .node-icon-text {\n    display: flex; \n    align-items: center;\n  }\n  \n  .node-icon-text > div {\n    color: #fff;\n    margin: 1px;\n    height: fit-content;\n    text-align: center;\n    overflow: hidden;\n    display: -webkit-box;\n    -webkit-box-orient: vertical;\n  }\n`,"getStyles");var ee=n(e=>`<g><rect width="80" height="80" style="fill: #087ebf; stroke-width: 0px;"/>${e}</g>`,"wrapIcon");var te={prefix:"mermaid-architecture",height:80,width:80,icons:{database:{body:ee('<path id="b" data-name="4" d="m20,57.86c0,3.94,8.95,7.14,20,7.14s20-3.2,20-7.14" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><path id="c" data-name="3" d="m20,45.95c0,3.94,8.95,7.14,20,7.14s20-3.2,20-7.14" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><path id="d" data-name="2" d="m20,34.05c0,3.94,8.95,7.14,20,7.14s20-3.2,20-7.14" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><ellipse id="e" data-name="1" cx="40" cy="22.14" rx="20" ry="7.14" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><line x1="20" y1="57.86" x2="20" y2="22.14" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><line x1="60" y1="57.86" x2="60" y2="22.14" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/>')},server:{body:ee('<rect x="17.5" y="17.5" width="45" height="45" rx="2" ry="2" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><line x1="17.5" y1="32.5" x2="62.5" y2="32.5" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><line x1="17.5" y1="47.5" x2="62.5" y2="47.5" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><g><path d="m56.25,25c0,.27-.45.5-1,.5h-10.5c-.55,0-1-.23-1-.5s.45-.5,1-.5h10.5c.55,0,1,.23,1,.5Z" style="fill: #fff; stroke-width: 0px;"/><path d="m56.25,25c0,.27-.45.5-1,.5h-10.5c-.55,0-1-.23-1-.5s.45-.5,1-.5h10.5c.55,0,1,.23,1,.5Z" style="fill: none; stroke: #fff; stroke-miterlimit: 10;"/></g><g><path d="m56.25,40c0,.27-.45.5-1,.5h-10.5c-.55,0-1-.23-1-.5s.45-.5,1-.5h10.5c.55,0,1,.23,1,.5Z" style="fill: #fff; stroke-width: 0px;"/><path d="m56.25,40c0,.27-.45.5-1,.5h-10.5c-.55,0-1-.23-1-.5s.45-.5,1-.5h10.5c.55,0,1,.23,1,.5Z" style="fill: none; stroke: #fff; stroke-miterlimit: 10;"/></g><g><path d="m56.25,55c0,.27-.45.5-1,.5h-10.5c-.55,0-1-.23-1-.5s.45-.5,1-.5h10.5c.55,0,1,.23,1,.5Z" style="fill: #fff; stroke-width: 0px;"/><path d="m56.25,55c0,.27-.45.5-1,.5h-10.5c-.55,0-1-.23-1-.5s.45-.5,1-.5h10.5c.55,0,1,.23,1,.5Z" style="fill: none; stroke: #fff; stroke-miterlimit: 10;"/></g><g><circle cx="32.5" cy="25" r=".75" style="fill: #fff; stroke: #fff; stroke-miterlimit: 10;"/><circle cx="27.5" cy="25" r=".75" style="fill: #fff; stroke: #fff; stroke-miterlimit: 10;"/><circle cx="22.5" cy="25" r=".75" style="fill: #fff; stroke: #fff; stroke-miterlimit: 10;"/></g><g><circle cx="32.5" cy="40" r=".75" style="fill: #fff; stroke: #fff; stroke-miterlimit: 10;"/><circle cx="27.5" cy="40" r=".75" style="fill: #fff; stroke: #fff; stroke-miterlimit: 10;"/><circle cx="22.5" cy="40" r=".75" style="fill: #fff; stroke: #fff; stroke-miterlimit: 10;"/></g><g><circle cx="32.5" cy="55" r=".75" style="fill: #fff; stroke: #fff; stroke-miterlimit: 10;"/><circle cx="27.5" cy="55" r=".75" style="fill: #fff; stroke: #fff; stroke-miterlimit: 10;"/><circle cx="22.5" cy="55" r=".75" style="fill: #fff; stroke: #fff; stroke-miterlimit: 10;"/></g>')
},disk:{body:ee('<rect x="20" y="15" width="40" height="50" rx="1" ry="1" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><ellipse cx="24" cy="19.17" rx=".8" ry=".83" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><ellipse cx="56" cy="19.17" rx=".8" ry=".83" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><ellipse cx="24" cy="60.83" rx=".8" ry=".83" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><ellipse cx="56" cy="60.83" rx=".8" ry=".83" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><ellipse cx="40" cy="33.75" rx="14" ry="14.58" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><ellipse cx="40" cy="33.75" rx="4" ry="4.17" style="fill: #fff; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><path d="m37.51,42.52l-4.83,13.22c-.26.71-1.1,1.02-1.76.64l-4.18-2.42c-.66-.38-.81-1.26-.33-1.84l9.01-10.8c.88-1.05,2.56-.08,2.09,1.2Z" style="fill: #fff; stroke-width: 0px;"/>')},internet:{body:ee('<circle cx="40" cy="40" r="22.5" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><line x1="40" y1="17.5" x2="40" y2="62.5" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><line x1="17.5" y1="40" x2="62.5" y2="40" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><path d="m39.99,17.51c-15.28,11.1-15.28,33.88,0,44.98" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><path d="m40.01,17.51c15.28,11.1,15.28,33.88,0,44.98" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><line x1="19.75" y1="30.1" x2="60.25" y2="30.1" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><line x1="19.75" y1="49.9" x2="60.25" y2="49.9" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/>')},cloud:{body:ee('<path d="m65,47.5c0,2.76-2.24,5-5,5H20c-2.76,0-5-2.24-5-5,0-1.87,1.03-3.51,2.56-4.36-.04-.21-.06-.42-.06-.64,0-2.6,2.48-4.74,5.65-4.97,1.65-4.51,6.34-7.76,11.85-7.76.86,0,1.69.08,2.5.23,2.09-1.57,4.69-2.5,7.5-2.5,6.1,0,11.19,4.38,12.28,10.17,2.14.56,3.72,2.51,3.72,4.83,0,.03,0,.07-.01.1,2.29.46,4.01,2.48,4.01,4.9Z" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/>')},unknown:v,blank:{body:ee("")}}};var oe=n(async function(e,t,o){const i=o.getConfigField("padding");const n=o.getConfigField("iconSize");const r=n/2;const s=n/6;const a=s/2;await Promise.all(t.edges().map(async t=>{var n,d;const{source:c,sourceDir:l,sourceArrow:u,sourceGroup:p,target:_,targetDir:h,targetArrow:g,targetGroup:f,label:m}=q(t);let{x:v,y:C}=t[0].sourceEndpoint();const{x:E,y:I}=t[0].midpoint();let{x:A,y:N}=t[0].targetEndpoint();const D=i+4;if(p){if(G(l)){v+=l==="L"?-D:D}else{C+=l==="T"?-D:D+18}}if(f){if(G(h)){A+=h==="L"?-D:D}else{N+=h==="T"?-D:D+18}}if(!p&&((n=o.getNode(c))===null||n===void 0?void 0:n.type)==="junction"){if(G(l)){v+=l==="L"?r:-r}else{C+=l==="T"?r:-r}}if(!f&&((d=o.getNode(_))===null||d===void 0?void 0:d.type)==="junction"){if(G(h)){A+=h==="L"?r:-r}else{N+=h==="T"?r:-r}}if(t[0]._private.rscratch){let t=e.insert("g");t.insert("path").attr("d",`M ${v},${C} L ${E},${I} L${A},${N} `).attr("class","edge").attr("id",y(c,_,{prefix:"L"}));if(u){let e=G(l)?L[l](v,s):v-a,o=F(l)?L[l](C,s):C-a;t.insert("polygon").attr("points",T[l](s)).attr("transform",`translate(${e},${o})`).attr("class","arrow")}if(g){let e=G(h)?L[h](A,s):A-a,o=F(h)?L[h](N,s):N-a;t.insert("polygon").attr("points",T[h](s)).attr("transform",`translate(${e},${o})`).attr("class","arrow")}if(m){let e=!M(l,h)?G(l)?"X":"Y":"XY",o=0;if(e==="X"){o=Math.abs(v-A)}else if(e==="Y"){o=Math.abs(C-N)/1.5}else{o=Math.abs(v-A)/2}let i=t.append("g");await x(i,m,{useHtmlLabels:!1,width:o,classes:"architecture-service-label"},b());i.attr("dy","1em").attr("alignment-baseline","middle").attr("dominant-baseline","middle").attr("text-anchor","middle");if(e==="X"){i.attr("transform","translate("+E+", "+I+")")}else if(e==="Y"){i.attr("transform","translate("+E+", "+I+") rotate(-90)")}else if(e==="XY"){let e=P(l,h);if(e&&z(e)){let t=i.node().getBoundingClientRect(),[o,n]=J(e);i.attr("dominant-baseline","auto").attr("transform",`rotate(${-1*o*n*45})`);let r=i.node().getBoundingClientRect();i.attr("transform",`\n                translate(${E}, ${I-t.height/2})\n                translate(${o*r.width/2}, ${n*r.height/2})\n                rotate(${-1*o*n*45}, 0, ${t.height/2})\n              `)}}}}}))},"drawEdges");var ie=n(async function(e,t,o){const i=o.getConfigField("padding");const n=i*.75;const r=o.getConfigField("fontSize");const s=o.getConfigField("iconSize");const a=s/2;await Promise.all(t.nodes().map(async t=>{const i=V(t);if(i.type==="group"){let{h:s,w:d,x1:c,y1:l}=t.boundingBox(),u=e.append("rect");u.attr("id",`group-${i.id}`).attr("x",c+a).attr("y",l+a).attr("width",d).attr("height",s).attr("class","node-bkg");let p=e.append("g"),_=c,h=l;if(i.icon){let e=p.append("g");e.html(`<g>${await C(i.icon,{height:n,width:n,fallbackPrefix:te.prefix})}</g>`);e.attr("transform","translate("+(_+a+1)+", "+(h+a+1)+")");_+=n;h+=r/2-1-2}if(i.label){let e=p.append("g");await x(e,i.label,{useHtmlLabels:!1,width:d,classes:"architecture-service-label"},b());e.attr("dy","1em").attr("alignment-baseline","middle").attr("dominant-baseline","start").attr("text-anchor","start");e.attr("transform","translate("+(_+a+4)+", "+(h+a+2)+")")}o.setElementForId(i.id,u)}}))},"drawGroups");var ne=n(async function(e,t,o){var i;const n=b();for(const r of o){let o=t.append("g"),s=e.getConfigField("iconSize");if(r.title){let e=o.append("g");await x(e,r.title,{useHtmlLabels:!1,width:s*1.5,classes:"architecture-service-label"},n);e.attr("dy","1em").attr("alignment-baseline","middle").attr("dominant-baseline","middle").attr("text-anchor","middle");e.attr("transform","translate("+s/2+", "+s+")")}let a=o.append("g");if(r.icon){a.html(`<g>${await C(r.icon,{height:s,width:s,fallbackPrefix:te.prefix})}</g>`)}else if(r.iconText){a.html(`<g>${await C("blank",{height:s,width:s,fallbackPrefix:te.prefix})}</g>`);let e=a.append("g"),t=e.append("foreignObject").attr("width",s).attr("height",s),o=t.append("div").attr("class","node-icon-text").attr("style",`height: ${s}px;`).append("div").html(E(r.iconText,n)),d=(i=parseInt(window.getComputedStyle(o.node(),null).getPropertyValue("font-size").replace(/\D/g,"")))!==null&&i!==void 0?i:16;o.attr("style",`-webkit-line-clamp: ${Math.floor((s-2)/d)};`)}else{a.append("path").attr("class","node-bkg").attr("id","node-"+r.id).attr("d",`M0 ${s} v${-s} q0,-5 5,-5 h${s} q5,0 5,5 v${s} H0 Z`)}o.attr("id",`service-${r.id}`).attr("class","architecture-service");let{width:d,height:c}=o.node().getBBox();r.width=d;r.height=c;e.setElementForId(r.id,o)}return 0},"drawServices");var re=n(function(e,t,o){o.forEach(o=>{const i=t.append("g");const n=e.getConfigField("iconSize");const r=i.append("g");r.append("rect").attr("id","node-"+o.id).attr("fill-opacity","0").attr("width",n).attr("height",n);i.attr("class","architecture-junction");const{width:s,height:a}=i._groups[0][0].getBBox();i.width=s;i.height=a;e.setElementForId(o.id,i)})},"drawJunctions");I([{name:te.prefix,icons:te}]);A.use(w);function se(e,t,o){e.forEach(e=>{t.add({group:"nodes",data:{type:"service",id:e.id,icon:e.icon,label:e.title,parent:e.in,width:o.getConfigField("iconSize"),height:o.getConfigField("iconSize")},classes:"node-service"})})}n(se,"addServices");function ae(e,t,o){e.forEach(e=>{t.add({group:"nodes",data:{type:"junction",id:e.id,parent:e.in,width:o.getConfigField("iconSize"),height:o.getConfigField("iconSize")},classes:"node-junction"})})}n(ae,"addJunctions");function de(e,t){t.nodes().map(t=>{const o=V(t);if(o.type==="group"){return}o.x=t.position().x;o.y=t.position().y;const i=e.getElementById(o.id);i.attr("transform","translate("+(o.x||0)+","+(o.y||0)+")")})}n(de,"positionNodes");function ce(e,t){e.forEach(e=>{t.add({group:"nodes",data:{type:"group",id:e.id,icon:e.icon,label:e.title,parent:e.in},classes:"node-group"})})}n(ce,"addGroups");function le(e,t){e.forEach(e=>{const{lhsId:o,rhsId:i,lhsInto:n,lhsGroup:r,rhsInto:s,lhsDir:a,rhsDir:d,rhsGroup:c,title:l}=e;const u=M(e.lhsDir,e.rhsDir)?"segments":"straight";const p={id:`${o}-${i}`,label:l,source:o,sourceDir:a,sourceArrow:n,sourceGroup:r,sourceEndpoint:a==="L"?"0 50%":a==="R"?"100% 50%":a==="T"?"50% 0":"50% 100%",target:i,targetDir:d,targetArrow:s,targetGroup:c,targetEndpoint:d==="L"?"0 50%":d==="R"?"100% 50%":d==="T"?"50% 0":"50% 100%"};t.add({group:"edges",data:p,classes:u})})}n(le,"addEdges");function ue(e,t,o){const i=n((e,t)=>Object.entries(e).reduce((e,[i,n])=>{var r,s,a;let d=0;const c=Object.entries(n);if(c.length===1){e[i]=c[0][1];return e}for(let n=0;n<c.length-1;n++){for(let l=n+1;l<c.length;l++){let[u,p]=c[n],[_,h]=c[l],g=(r=o[u])===null||r===void 0?void 0:r[_];if(g===t){(s=e[i])!==null&&s!==void 0?s:e[i]=[];e[i]=[...e[i],...p,...h]}else if(u==="default"||_==="default"){(a=e[i])!==null&&a!==void 0?a:e[i]=[];e[i]=[...e[i],...p,...h]}else{let t=`${i}-${d++}`;e[t]=p;let o=`${i}-${d++}`;e[o]=h}}}return e},{}),"flattenAlignments");const r=t.map(t=>{const o={};const n={};Object.entries(t).forEach(([t,[i,r]])=>{var s,a,d,c,l,u;var p,_;const h=(a=(s=e.getNode(t))===null||s===void 0?void 0:s.in)!==null&&a!==void 0?a:"default";(d=o[r])!==null&&d!==void 0?d:o[r]={};(c=(p=o[r])[h])!==null&&c!==void 0?c:p[h]=[];o[r][h].push(t);(l=n[i])!==null&&l!==void 0?l:n[i]={};(u=(_=n[i])[h])!==null&&u!==void 0?u:_[h]=[];n[i][h].push(t)});return{horiz:Object.values(i(o,"horizontal")).filter(e=>e.length>1),vert:Object.values(i(n,"vertical")).filter(e=>e.length>1)}});const[s,a]=r.reduce(([e,t],{horiz:o,vert:i})=>[[...e,...o],[...t,...i]],[[],[]]);return{horizontal:s,vertical:a}}n(ue,"getAlignments");function pe(e,t){const o=[];const i=n(e=>`${e[0]},${e[1]}`,"posToStr");const r=n(e=>e.split(",").map(e=>parseInt(e)),"strToPos");e.forEach(e=>{const n=Object.fromEntries(Object.entries(e).map(([e,t])=>[i(t),e]));const s=[i([0,0])];const a={};const d={L:[-1,0],R:[1,0],T:[0,1],B:[0,-1]};while(s.length>0){let e=s.shift();if(e){a[e]=1;let c=n[e];if(c){let l=r(e);Object.entries(d).forEach(([e,r])=>{const d=i([l[0]+r[0],l[1]+r[1]]);const u=n[d];if(u&&!a[d]){s.push(d);o.push({[R[e]]:u,[R[B(e)]]:c,gap:1.5*t.getConfigField("iconSize")})}})}}}});return o}n(pe,"getRelativeConstraints");function _e(e,t,o,i,r,{spatialMaps:s,groupAlignments:a}){return new Promise(d=>{const c=N("body").append("div").attr("id","cy").attr("style","display:none");const l=A({container:document.getElementById("cy"),style:[{selector:"edge",style:{"curve-style":"straight",label:"data(label)","source-endpoint":"data(sourceEndpoint)","target-endpoint":"data(targetEndpoint)"}},{selector:"edge.segments",style:{"curve-style":"segments","segment-weights":"0","segment-distances":[.5],"edge-distances":"endpoints","source-endpoint":"data(sourceEndpoint)","target-endpoint":"data(targetEndpoint)"}},{selector:"node",style:{"compound-sizing-wrt-labels":"include"}},{selector:"node[label]",style:{"text-valign":"bottom","text-halign":"center","font-size":`${r.getConfigField("fontSize")}px`}},{selector:".node-service",style:{label:"data(label)",width:"data(width)",height:"data(height)"}},{selector:".node-junction",style:{width:"data(width)",height:"data(height)"}},{selector:".node-group",style:{padding:`${r.getConfigField("padding")}px`}}],layout:{name:"grid",boundingBox:{x1:0,x2:100,y1:0,y2:100}}});c.remove();ce(o,l);se(e,l,r);ae(t,l,r);le(i,l);const u=ue(r,s,a);const p=pe(s,r);const _=l.layout({name:"fcose",quality:"proof",styleEnabled:!1,animate:!1,nodeDimensionsIncludeLabels:!1,idealEdgeLength(e){const[t,o]=e.connectedNodes();const{parent:i}=V(t);const{parent:n}=V(o);const s=i===n?1.5*r.getConfigField("iconSize"):.5*r.getConfigField("iconSize");return s},edgeElasticity(e){const[t,o]=e.connectedNodes();const{parent:i}=V(t);const{parent:n}=V(o);const r=i===n?.45:.001;return r},alignmentConstraint:u,relativePlacementConstraint:p});_.one("layoutstop",()=>{var e;function t(e,t,o,i){let n,r;const{x:s,y:a}=e;const{x:d,y:c}=t;r=(i-a+(s-o)*(a-c)/(s-d))/Math.sqrt(1+Math.pow((a-c)/(s-d),2));n=Math.sqrt(Math.pow(i-a,2)+Math.pow(o-s,2)-Math.pow(r,2));const l=Math.sqrt(Math.pow(d-s,2)+Math.pow(c-a,2));n=n/l;let u=(d-s)*(i-a)-(c-a)*(o-s);switch(!0){case u>=0:u=1;break;case u<0:u=-1;break}let p=(d-s)*(o-s)+(c-a)*(i-a);switch(!0){case p>=0:p=1;break;case p<0:p=-1;break}r=Math.abs(r)*u;n=n*p;return{distances:r,weights:n}}n(t,"getSegmentWeights");l.startBatch();for(const o of Object.values(l.edges())){if((e=o.data)===null||e===void 0?void 0:e.call(o)){let{x:e,y:i}=o.source().position(),{x:n,y:r}=o.target().position();if(e!==n&&i!==r){let e=o.sourceEndpoint(),i=o.targetEndpoint(),{sourceDir:n}=q(o),[r,s]=F(n)?[e.x,i.y]:[i.x,e.y],{weights:a,distances:d}=t(e,i,r,s);o.style("segment-distances",d);o.style("segment-weights",a)}}}l.endBatch();_.run()});_.run();l.ready(e=>{m.info("Ready",e);d(l)})})}n(_e,"layoutArchitecture");var he=n(async(e,t,o,i)=>{const n=i.db;const r=n.getServices();const s=n.getJunctions();const a=n.getGroups();const d=n.getEdges();const c=n.getDataStructures();const l=D(t);const u=l.append("g");u.attr("class","architecture-edges");const p=l.append("g");p.attr("class","architecture-services");const _=l.append("g");_.attr("class","architecture-groups");await ne(n,p,r);re(n,p,s);const h=await _e(r,s,a,d,n,c);await oe(u,h,n);await ie(_,h,n);de(n,h);k(void 0,l,n.getConfigField("padding"),n.getConfigField("useMaxWidth"))},"draw");var ge={draw:he};var fe={parser:K,get db(){return new Z},renderer:ge,styles:Q};var me={diagram:fe};__bbb.V=me}).call(this)