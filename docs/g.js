(function(e){"use strict";function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=Array(t);r<t;r++)a[r]=e[r];return a}function r(e){if(Array.isArray(e))return e}function a(e){if(Array.isArray(e))return t(e)}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,y(a.key),a)}}function o(e,t,r){return t&&i(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=m(e))||t){r&&(e=r);var a=0,n=function(){};return{s:n,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}function l(e,t,r){return(t=y(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function d(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,o,s=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(s.push(a.value),s.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw n}}return s}}function p(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function u(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function f(e,t){return r(e)||d(e,t)||m(e,t)||p()}function h(e){return a(e)||c(e)||m(e)||u()}function g(t,r){if("object"!=typeof t||!t)return t;var a=t[Symbol.toPrimitive];if(e!==a){var n=a.call(t,r);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function y(e){var t=g(e,"string");return"symbol"==typeof t?t:t+""}function v(e){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function m(r,a){if(r){if("string"==typeof r)return t(r,a);var n={}.toString.call(r).slice(8,-1);return"Object"===n&&r.constructor&&(n=r.constructor.name),"Map"===n||"Set"===n?Array.from(r):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?t(r,a):e}}var b=typeof window==="undefined"?null:window;var x=b?b.navigator:null;b?b.document:null;var _=v("");var w=v({});var S=v(function(){});var P=typeof HTMLElement==="undefined"?"undefined":v(HTMLElement);var C=function e(t){return t&&t.instanceString&&T(t.instanceString)?t.instanceString():null};var E=function e(t){return t!=null&&v(t)==_};var T=function e(t){return t!=null&&v(t)===S};var I=function e(t){return!O(t)&&(Array.isArray?Array.isArray(t):t!=null&&t instanceof Array)};var k=function e(t){return t!=null&&v(t)===w&&!I(t)&&t.constructor===Object};var R=function e(t){return t!=null&&v(t)===w};var D=function e(t){return t!=null&&v(t)===v(1)&&!isNaN(t)};var B=function e(t){return D(t)&&Math.floor(t)===t};var A=function t(r){if("undefined"===P){return e}else{return null!=r&&r instanceof HTMLElement}};var O=function e(t){return L(t)||N(t)};var L=function e(t){return C(t)==="collection"&&t._private.single};var N=function e(t){return C(t)==="collection"&&!t._private.single};var M=function e(t){return C(t)==="core"};var j=function e(t){return C(t)==="stylesheet"};var q=function e(t){return C(t)==="event"};var z=function t(r){if(r===e||r===null){return!0}else if(r===""||r.match(/^\s+$/)){return!0}return!1};var $=function e(t){if(typeof HTMLElement==="undefined"){return!1}else{return t instanceof HTMLElement}};var V=function e(t){return k(t)&&D(t.x1)&&D(t.x2)&&D(t.y1)&&D(t.y2)};var F=function e(t){return R(t)&&T(t.then)};var W=function e(){return x&&x.userAgent.match(/msie|trident|edge/i)};var H=function e(t,r){r||(r=function e(){if(arguments.length===1){return arguments[0]}else if(arguments.length===0){return"undefined"}var t=[];for(var r=0;r<arguments.length;r++){t.push(arguments[r])}return t.join("$")});var a=function e(){var n=this;var i;var o=r.apply(n,arguments);var s=a.cache;(i=s[o])||(i=s[o]=t.apply(n,arguments));return i};a.cache={};return a};var X=H(function(e){return e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})});var Y=H(function(e){return e.replace(/(-\w)/g,function(e){return e[1].toUpperCase()})});var G=H(function(e,t){return e+t[0].toUpperCase()+t.substring(1)},function(e,t){return e+"$"+t});var K=function e(t){if(z(t)){return t}return t.charAt(0).toUpperCase()+t.substring(1)};var U=function e(t,r){return t.slice(-1*r.length)===r};var Q="(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))";var Z="rgb[a]?\\(("+Q+"[%]?)\\s*,\\s*("+Q+"[%]?)\\s*,\\s*("+Q+"[%]?)(?:\\s*,\\s*("+Q+"))?\\)";var J="rgb[a]?\\((?:"+Q+"[%]?)\\s*,\\s*(?:"+Q+"[%]?)\\s*,\\s*(?:"+Q+"[%]?)(?:\\s*,\\s*(?:"+Q+"))?\\)";var ee="hsl[a]?\\(("+Q+")\\s*,\\s*("+Q+"[%])\\s*,\\s*("+Q+"[%])(?:\\s*,\\s*("+Q+"))?\\)";var te="hsl[a]?\\((?:"+Q+")\\s*,\\s*(?:"+Q+"[%])\\s*,\\s*(?:"+Q+"[%])(?:\\s*,\\s*(?:"+Q+"))?\\)";var re="\\#[0-9a-fA-F]{3}";var ae="\\#[0-9a-fA-F]{6}";var ne=function e(t,r){if(t<r){return-1}else if(t>r){return 1}else{return 0}};var ie=function e(t,r){return-1*ne(t,r)};var oe=Object.assign!=null?Object.assign.bind(Object):function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];if(r==null){continue}var a=Object.keys(r);for(var n=0;n<a.length;n++){var i=a[n];e[i]=r[i]}}return e};var se=function e(t){if(!(t.length===4||t.length===7)||t[0]!=="#"){return}var r=t.length===4;var a,n,i;var o=16;if(r){a=parseInt(t[1]+t[1],o);n=parseInt(t[2]+t[2],o);i=parseInt(t[3]+t[3],o)}else{a=parseInt(t[1]+t[2],o);n=parseInt(t[3]+t[4],o);i=parseInt(t[5]+t[6],o)}return[a,n,i]};var le=function t(r){var a;var n,i,o,s,l,c,d;function p(e,t,r){r<0&&(r+=1);r>1&&(r-=1);if(r<1/6)return e+(t-e)*6*r;if(r<1/2)return t;if(r<2/3)return e+(t-e)*(2/3-r)*6;return e}var u=new RegExp("^"+ee+"$").exec(r);if(u){n=parseInt(u[1]);if(n<0){n=(360- -1*n%360)%360}else n>360&&(n=n%360);n/=360;i=parseFloat(u[2]);if(i<0||i>100){return}i=i/100;o=parseFloat(u[3]);if(o<0||o>100){return}o=o/100;s=u[4];if(s!==e){s=parseFloat(s);if(s<0||s>1){return}}if(i===0){l=c=d=Math.round(o*255)}else{var f=o<.5?o*(1+i):o+i-o*i,h=2*o-f;l=Math.round(255*p(h,f,n+1/3));c=Math.round(255*p(h,f,n));d=Math.round(255*p(h,f,n-1/3))}a=[l,c,d,s]}return a};var ce=function t(r){var a;var n=new RegExp("^"+Z+"$").exec(r);if(n){a=[];var i=[];for(var o=1;o<=3;o++){var s=n[o];s[s.length-1]==="%"&&(i[o]=!0);s=parseFloat(s);i[o]&&(s=s/100*255);if(s<0||s>255){return}a.push(Math.floor(s))}var l=i[1]||i[2]||i[3],c=i[1]&&i[2]&&i[3];if(l&&!c){return}var d=n[4];if(d!==e){d=parseFloat(d);if(d<0||d>1){return}a.push(d)}}return a};var de=function e(t){return ue[t.toLowerCase()]};var pe=function e(t){return(I(t)?t:null)||de(t)||se(t)||ce(t)||le(t)};var ue={transparent:[0,0,0,0],aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],grey:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};var fe=function e(t){var r=t.map;var a=t.keys;var n=a.length;for(var i=0;i<n;i++){var o=a[i];if(k(o)){throw Error("Tried to set map with object key")}if(i<a.length-1){r[o]==null&&(r[o]={});r=r[o]}else{r[o]=t.value}}};var he=function e(t){var r=t.map;var a=t.keys;var n=a.length;for(var i=0;i<n;i++){var o=a[i];if(k(o)){throw Error("Tried to get map with object key")}r=r[o];if(r==null){return r}}return r};var ge=typeof globalThis!=="undefined"?globalThis:typeof window!=="undefined"?window:typeof window!=="undefined"?window:typeof self!=="undefined"?self:{};function ye(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e["default"]:e}var ve;var me;function be(){if(me)return ve;me=1;function e(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}ve=e;return ve}var xe;var _e;function we(){if(_e)return xe;_e=1;var e=typeof ge=="object"&&ge&&ge.Object===Object&&ge;xe=e;return xe}var Se;var Pe;function Ce(){if(Pe)return Se;Pe=1;var e=we();var t=typeof self=="object"&&self&&self.Object===Object&&self;var r=e||t||Function("return this")();Se=r;return Se}var Ee;var Te;function Ie(){if(Te)return Ee;Te=1;var e=Ce();var t=function(){return e.Date.now()};Ee=t;return Ee}var ke;var Re;function De(){if(Re)return ke;Re=1;var e=/\s/;function t(t){var r=t.length;while(r--&&e.test(t.charAt(r))){}return r}ke=t;return ke}var Be;var Ae;function Oe(){if(Ae)return Be;Ae=1;var e=De();var t=/^\s+/;function r(r){return r?r.slice(0,e(r)+1).replace(t,""):r}Be=r;return Be}var Le;var Ne;function Me(){if(Ne)return Le;Ne=1;var e=Ce();var t=e.Symbol;Le=t;return Le}var je;var qe;function ze(){if(qe)return je;qe=1;var t=Me();var r=Object.prototype;var a=r.hasOwnProperty;var n=r.toString;var i=t?t.toStringTag:e;function o(t){var r=a.call(t,i),o=t[i];try{t[i]=e;var s=!0}catch(e){}var l=n.call(t);if(s){if(r){t[i]=o}else{delete t[i]}}return l}je=o;return je}var $e;var Ve;function Fe(){if(Ve)return $e;Ve=1;var e=Object.prototype;var t=e.toString;function r(e){return t.call(e)}$e=r;return $e}var We;var He;function Xe(){if(He)return We;He=1;var t=Me(),r=ze(),a=Fe();var n="[object Null]",i="[object Undefined]";var o=t?t.toStringTag:e;function s(t){if(t==null){return t===e?i:n}return o&&o in Object(t)?r(t):a(t)}We=s;return We}var Ye;var Ge;function Ke(){if(Ge)return Ye;Ge=1;function e(e){return e!=null&&typeof e=="object"}Ye=e;return Ye}var Ue;var Qe;function Ze(){if(Qe)return Ue;Qe=1;var e=Xe(),t=Ke();var r="[object Symbol]";function a(a){return typeof a=="symbol"||t(a)&&e(a)==r}Ue=a;return Ue}var Je;var et;function tt(){if(et)return Je;et=1;var e=Oe(),t=be(),r=Ze();var a=0/0;var n=/^[-+]0x[0-9a-f]+$/i;var i=/^0b[01]+$/i;var o=/^0o[0-7]+$/i;function s(s){if(typeof s=="number"){return s}if(r(s)){return a}if(t(s)){var l=typeof s.valueOf=="function"?s.valueOf():s;s=t(l)?l+"":l}if(typeof s!="string"){return s===0?s:+s}s=e(s);var c=i.test(s);return c||o.test(s)?parseInt(s.slice(2),c?2:8):n.test(s)?a:+s}Je=s;return Je}var rt;var at;function nt(){if(at)return rt;at=1;var t=be(),r=Ie(),a=tt();var n="Expected a function";var i=Math.max,o=Math.min;function s(s,l,c){var d,p,u,f,h,g,y=0,v=!1,m=!1,b=!0;if(typeof s!="function"){throw new TypeError(n)}l=a(l)||0;if(t(c)){v=!!c.leading;m="maxWait"in c;u=m?i(a(c.maxWait)||0,l):u;b="trailing"in c?!!c.trailing:b}function x(t){var r=d,a=p;d=p=e;y=t;f=s.apply(a,r);return f}function _(e){y=e;h=setTimeout(P,l);return v?x(e):f}function w(e){var t=e-g,r=e-y,a=l-t;return m?o(a,u-r):a}function S(t){var r=t-g,a=t-y;return g===e||r>=l||r<0||m&&a>=u}function P(){var e=r();if(S(e)){return C(e)}h=setTimeout(P,w(e))}function C(t){h=e;if(b&&d){return x(t)}d=p=e;return f}function E(){h!==e&&clearTimeout(h);y=0;d=g=p=h=e}function T(){return h===e?f:C(r())}function I(){var t=r(),a=S(t);d=arguments;p=this;g=t;if(a){if(h===e){return _(g)}if(m){clearTimeout(h);h=setTimeout(P,l);return x(g)}}h===e&&(h=setTimeout(P,l));return f}I.cancel=E;I.flush=T;return I}rt=s;return rt}var it=nt();var ot=ye(it);var st=b?b.performance:null;var lt=st&&st.now?function(){return st.now()}:function(){return Date.now()};var ct=function(){if(b){if(b.requestAnimationFrame){return function(e){b.requestAnimationFrame(e)}}else if(b.mozRequestAnimationFrame){return function(e){b.mozRequestAnimationFrame(e)}}else if(b.webkitRequestAnimationFrame){return function(e){b.webkitRequestAnimationFrame(e)}}else if(b.msRequestAnimationFrame){return function(e){b.msRequestAnimationFrame(e)}}}return function(e){e&&setTimeout(function(){e(lt())},1e3/60)}}();var dt=function e(t){return ct(t)};var pt=9261;var ut=65599;var ft=5381;var ht=function t(r){var a=arguments.length>1&&arguments[1]!==e?arguments[1]:pt;var n=a;var i;for(;;){i=r.next();if(i.done){break}n=n*ut+i.value|0}return n};var gt=function t(r){var a=arguments.length>1&&arguments[1]!==e?arguments[1]:pt;return a*ut+r|0};var yt=function t(r){var a=arguments.length>1&&arguments[1]!==e?arguments[1]:ft;return(a<<5)+a+r|0};var vt=function e(t,r){return t*2097152+r};var mt=function e(t){return t[0]*2097152+t[1]};var bt=function e(t,r){return[gt(t[0],r[0]),yt(t[1],r[1])]};var xt=function e(t,r){var a={value:0,done:!1};var n=0;var i=t.length;var o={next:function e(){if(n<i){a.value=t[n++]}else{a.done=!0}return a}};return ht(o,r)};var _t=function e(t,r){var a={value:0,done:!1};var n=0;var i=t.length;var o={next:function e(){if(n<i){a.value=t.charCodeAt(n++)}else{a.done=!0}return a}};return ht(o,r)};var wt=function e(){return St(arguments)};var St=function e(t){var r;for(var a=0;a<t.length;a++){var n=t[a];if(a===0){r=_t(n)}else{r=_t(n,r)}}return r};function Pt(e,t,r,a,n){var i=n*Math.PI/180;var o=Math.cos(i)*(e-r)-Math.sin(i)*(t-a)+r;var s=Math.sin(i)*(e-r)+Math.cos(i)*(t-a)+a;return{x:o,y:s}}var Ct=function e(t,r,a,n,i,o){return{x:(t-a)*i+a,y:(r-n)*o+n}};function Et(e,t,r){if(r===0)return e;var a=(t.x1+t.x2)/2;var n=(t.y1+t.y2)/2;var i=t.w/t.h;var o=1/i;var s=Pt(e.x,e.y,a,n,r);var l=Ct(s.x,s.y,a,n,i,o);return{x:l.x,y:l.y}}var Tt=!0;var It=console.warn!=null;var kt=console.trace!=null;var Rt=Number.MAX_SAFE_INTEGER||9007199254740991;var Dt=function e(){return!0};var Bt=function e(){return!1};var At=function e(){return 0};var Ot=function e(){};var Lt=function e(t){throw new Error(t)};var Nt=function t(r){if(r!==e){Tt=!!r}else{return Tt}};var Mt=function e(t){if(!Nt()){return}if(It){console.warn(t)}else{console.log(t);kt&&console.trace()}};var jt=function e(t){return oe({},t)};var qt=function e(t){if(t==null){return t}if(I(t)){return t.slice()}else if(k(t)){return jt(t)}else{return t}};var zt=function e(t){return t.slice()};var $t=function e(t,r){for(r=t="";t++<36;r+=t*51&52?(t^15?8^Math.random()*(t^20?16:4):4).toString(16):"-");return r};var Vt={};var Ft=function e(){return Vt};var Wt=function t(r){var a=Object.keys(r);return function(t){var n={};for(var i=0;i<a.length;i++){var o=a[i],s=t==null?e:t[o];n[o]=s===e?r[o]:s}return n}};var Ht=function e(t,r,a){for(var n=t.length-1;n>=0;n--){t[n]===r&&t.splice(n,1)}};var Xt=function e(t){t.splice(0,t.length)};var Yt=function e(t,r){for(var a=0;a<r.length;a++){var n=r[a];t.push(n)}};var Gt=function e(t,r,a){a&&(r=G(a,r));return t[r]};var Kt=function e(t,r,a,n){a&&(r=G(a,r));t[r]=n};var Ut=function(){function t(){n(this,t);this._obj={}}return o(t,[{key:"set",value:function e(t,r){this._obj[t]=r;return this}},{key:"delete",value:function t(r){this._obj[r]=e;return this}},{key:"clear",value:function e(){this._obj={}}},{key:"has",value:function t(r){return this._obj[r]!==e}},{key:"get",value:function e(t){return this._obj[t]}}])}();var Qt=typeof Map!=="undefined"?Map:Ut;var Zt="undefined";var Jt=function(){function e(t){n(this,e);this._obj=Object.create(null);this.size=0;if(t!=null){var r;if(t.instanceString!=null&&t.instanceString()===this.instanceString()){r=t.toArray()}else{r=t}for(var a=0;a<r.length;a++){this.add(r[a])}}}return o(e,[{key:"instanceString",value:function e(){return"set"}},{key:"add",value:function e(t){var r=this._obj;if(r[t]!==1){r[t]=1;this.size++}}},{key:"delete",value:function e(t){var r=this._obj;if(r[t]===1){r[t]=0;this.size--}}},{key:"clear",value:function e(){this._obj=Object.create(null)}},{key:"has",value:function e(t){return this._obj[t]===1}},{key:"toArray",value:function e(){var t=this;return Object.keys(this._obj).filter(function(e){return t.has(e)})}},{key:"forEach",value:function e(t,r){return this.toArray().forEach(t,r)}}])}();var er=(typeof Set==="undefined"?"undefined":v(Set))!==Zt?Set:Jt;var tr=function t(r,a){var n=arguments.length>2&&arguments[2]!==e?arguments[2]:!0;if(r===e||a===e||!M(r)){Lt("An element must have a core reference and parameters set");return}var i=a.group;if(i==null){if(a.data&&a.data.source!=null&&a.data.target!=null){i="edges"}else{i="nodes"}}if(i!=="nodes"&&i!=="edges"){Lt("An element must be of type `nodes` or `edges`; you specified `"+i+"`");return}this.length=1;this[0]=this;var o=this._private={cy:r,single:!0,data:a.data||{},position:a.position||{x:0,y:0},autoWidth:e,autoHeight:e,autoPadding:e,compoundBoundsClean:!1,listeners:[],group:i,style:{},rstyle:{},styleCxts:[],styleKeys:{},removed:!0,selected:a.selected?!0:!1,selectable:a.selectable===e?!0:a.selectable?!0:!1,locked:a.locked?!0:!1,grabbed:!1,grabbable:a.grabbable===e?!0:a.grabbable?!0:!1,pannable:a.pannable===e?i==="edges"?!0:!1:a.pannable?!0:!1,active:!1,classes:new er,animation:{current:[],queue:[]},rscratch:{},scratch:a.scratch||{},edges:[],children:[],parent:a.parent&&a.parent.isNode()?a.parent:null,traversalCache:{},backgrounding:!1,bbCache:null,bbCacheShift:{x:0,y:0},bodyBounds:null,overlayBounds:null,labelBounds:{all:null,source:null,target:null,main:null},arrowBounds:{source:null,target:null,"mid-source":null,"mid-target":null}};o.position.x==null&&(o.position.x=0);o.position.y==null&&(o.position.y=0);if(a.renderedPosition){var s=a.renderedPosition,l=r.pan(),c=r.zoom();o.position={x:(s.x-l.x)/c,y:(s.y-l.y)/c}}var d=[];if(I(a.classes)){d=a.classes}else E(a.classes)&&(d=a.classes.split(/\s+/));for(var p=0,u=d.length;p<u;p++){var f=d[p];if(!f||f===""){continue}o.classes.add(f)}this.createEmitter();(n===e||n)&&this.restore();var h=a.style||a.css;if(h){Mt("Setting a `style` bypass at element creation should be done only when absolutely necessary.  Try to use the stylesheet instead.");this.style(h)}};var rr=function t(r){r={bfs:r.bfs||!r.dfs,dfs:r.dfs||!r.bfs};return function t(a,n,i){var o;if(k(a)&&!O(a)){o=a;a=o.roots||o.root;n=o.visit;i=o.directed}i=arguments.length===2&&!T(n)?n:i;n=T(n)?n:function(){};var s=this._private.cy;var l=a=E(a)?this.filter(a):a;var c=[];var d=[];var p={};var u={};var f={};var h=0;var g;var y=this.byGroup(),v=y.nodes,m=y.edges;for(var b=0;b<l.length;b++){var x=l[b],_=x.id();if(x.isNode()){c.unshift(x);if(r.bfs){f[_]=!0;d.push(x)}u[_]=0}}var w=function t(){var a=r.bfs?c.shift():c.pop();var o=a.id();if(r.dfs){if(f[o]){return 0}f[o]=!0;d.push(a)}var s=u[o];var l=p[o];var y=l!=null?l.source():null;var b=l!=null?l.target():null;var x=l==null?e:a.same(y)?b[0]:y[0];var _;_=n(a,l,x,h++,s);if(_===!0){g=a;return 1}if(_===!1){return 1}var w=a.connectedEdges().filter(function(e){return(!i||e.source().same(a))&&m.has(e)});for(var S=0;S<w.length;S++){var P=w[S],C=P.connectedNodes().filter(function(e){return!e.same(a)&&v.has(e)}),E=C.id();if(C.length!==0&&!f[E]){C=C[0];c.push(C);if(r.bfs){f[E]=!0;d.push(C)}p[E]=P;u[E]=u[o]+1}}},S;while(c.length!==0){S=w();if(S===0)continue;if(S===1)break}var P=s.collection();for(var C=0;C<d.length;C++){var I=d[C],R=p[I.id()];R!=null&&P.push(R);P.push(I)}return{path:s.collection(P),found:s.collection(g)}}};var ar={breadthFirstSearch:rr({bfs:!0}),depthFirstSearch:rr({dfs:!0})};ar.bfs=ar.breadthFirstSearch;ar.dfs=ar.depthFirstSearch;var nr={exports:{}};var ir=nr.exports;var or;function sr(){if(or)return nr.exports;or=1;(function(e,t){(function(){var t,r,a,n,i,o,s,l,c,d,p,u,f,h,g;a=Math.floor,d=Math.min;r=function(e,t){if(e<t){return-1}if(e>t){return 1}return 0};c=function(e,t,n,i,o){var s;n==null&&(n=0);o==null&&(o=r);if(n<0){throw new Error("lo must be non-negative")}i==null&&(i=e.length);while(n<i){s=a((n+i)/2);if(o(t,e[s])<0){i=s}else{n=s+1}}return[].splice.apply(e,[n,n-n].concat(t)),t};o=function(e,t,a){a==null&&(a=r);e.push(t);return h(e,0,e.length-1,a)};i=function(e,t){var a,n;t==null&&(t=r);a=e.pop();if(e.length){n=e[0];e[0]=a;g(e,0,t)}else{n=a}return n};l=function(e,t,a){var n;a==null&&(a=r);n=e[0];e[0]=t;g(e,0,a);return n};s=function(e,t,a){var n;a==null&&(a=r);if(e.length&&a(e[0],t)<0){n=[e[0],t],t=n[0],e[0]=n[1];g(e,0,a)}return t};n=function(e,t){var n,i,o,s,l,c;t==null&&(t=r);s=function(){c=[];for(var t=0,r=a(e.length/2);0<=r?t<r:t>r;0<=r?t++:t--){c.push(t)}return c}.apply(this).reverse();l=[];for(i=0,o=s.length;i<o;i++){n=s[i];l.push(g(e,n,t))}return l};f=function(e,t,a){var n;a==null&&(a=r);n=e.indexOf(t);if(n===-1){return}h(e,0,n,a);return g(e,n,a)};p=function(e,t,a){var i,o,l,c,d;a==null&&(a=r);o=e.slice(0,t);if(!o.length){return o}n(o,a);d=e.slice(t);for(l=0,c=d.length;l<c;l++){i=d[l];s(o,i,a)}return o.sort(a).reverse()};u=function(e,t,a){var o,s,l,p,u,f,h,g,y;a==null&&(a=r);if(t*10<=e.length){l=e.slice(0,t).sort(a);if(!l.length){return l}s=l[l.length-1];h=e.slice(t);for(p=0,f=h.length;p<f;p++){o=h[p];if(a(o,s)<0){c(l,o,0,null,a);l.pop();s=l[l.length-1]}}return l}n(e,a);y=[];for(u=0,g=d(t,e.length);0<=g?u<g:u>g;0<=g?++u:--u){y.push(i(e,a))}return y};h=function(e,t,a,n){var i,o,s;n==null&&(n=r);i=e[a];while(a>t){s=a-1>>1;o=e[s];if(n(i,o)<0){e[a]=o;a=s;continue}break}return e[a]=i};g=function(e,t,a){var n,i,o,s,l;a==null&&(a=r);i=e.length;l=t;o=e[t];n=2*t+1;while(n<i){s=n+1;s<i&&!(a(e[n],e[s])<0)&&(n=s);e[t]=e[n];t=n;n=2*t+1}e[t]=o;return h(e,l,t,a)};t=function(){e.push=o;e.pop=i;e.replace=l;e.pushpop=s;e.heapify=n;e.updateItem=f;e.nlargest=p;e.nsmallest=u;function e(e){this.cmp=e!=null?e:r;this.nodes=[]}e.prototype.push=function(e){return o(this.nodes,e,this.cmp)};e.prototype.pop=function(){return i(this.nodes,this.cmp)};e.prototype.peek=function(){return this.nodes[0]};e.prototype.contains=function(e){return this.nodes.indexOf(e)!==-1};e.prototype.replace=function(e){return l(this.nodes,e,this.cmp)};e.prototype.pushpop=function(e){return s(this.nodes,e,this.cmp)};e.prototype.heapify=function(){return n(this.nodes,this.cmp)};e.prototype.updateItem=function(e){return f(this.nodes,e,this.cmp)};e.prototype.clear=function(){return this.nodes=[]};e.prototype.empty=function(){return this.nodes.length===0};e.prototype.size=function(){return this.nodes.length};e.prototype.clone=function(){var t;t=new e;t.nodes=this.nodes.slice(0);return t};e.prototype.toArray=function(){return this.nodes.slice(0)};e.prototype.insert=e.prototype.push;e.prototype.top=e.prototype.peek;e.prototype.front=e.prototype.peek;e.prototype.has=e.prototype.contains;e.prototype.copy=e.prototype.clone;return e}();(function(t,r){{return e.exports=r()}})(this,function(){return t})}).call(ir)})(nr);return nr.exports}var lr;var cr;function dr(){if(cr)return lr;cr=1;lr=sr();return lr}var pr=dr();var ur=ye(pr);var fr=Wt({root:null,weight:function e(t){return 1},directed:!1});var hr={dijkstra:function e(t){if(!k(t)){var r=arguments;t={root:r[0],weight:r[1],directed:r[2]}}var a=fr(t),n=a.root,i=a.weight,o=a.directed;var s=this;var l=E(n)?this.filter(n)[0]:n[0];var c={};var d={};var p={};var u=this.byGroup(),f=u.nodes,h=u.edges;h.unmergeBy(function(e){return e.isLoop()});var g=function e(t){return c[t.id()]};var y=function e(t,r){c[t.id()]=r;v.updateItem(t)};var v=new ur(function(e,t){return g(e)-g(t)});for(var m=0;m<f.length;m++){var b=f[m];c[b.id()]=b.same(l)?0:Infinity;v.push(b)}var x=function e(t,r){var a=(o?t.edgesTo(r):t.edgesWith(r)).intersect(h);var n=Infinity;var s;for(var l=0;l<a.length;l++){var c=a[l],d=i(c);if(d<n||!s){n=d;s=c}}return{edge:s,dist:n}};while(v.size()>0){var _=v.pop(),w=g(_),S=_.id();p[S]=w;if(w===Infinity){continue}var P=_.neighborhood().intersect(f);for(var C=0;C<P.length;C++){var T=P[C],I=T.id(),R=x(_,T),D=w+R.dist;if(D<g(T)){y(T,D);d[I]={node:_,edge:R.edge}}}}return{distanceTo:function e(t){var r=E(t)?f.filter(t)[0]:t[0];return p[r.id()]},pathTo:function e(t){var r=E(t)?f.filter(t)[0]:t[0];var a=[];var n=r;var i=n.id();if(r.length>0){a.unshift(r);while(d[i]){var o=d[i];a.unshift(o.edge);a.unshift(o.node);n=o.node;i=n.id()}}return s.spawn(a)}}}};var gr={kruskal:function e(t){t=t||function(e){return 1};var r=this.byGroup(),a=r.nodes,n=r.edges;var i=a.length;var o=new Array(i);var s=function e(t){for(var r=0;r<o.length;r++){var a=o[r];if(a.has(t)){return r}}};for(var l=0;l<i;l++){o[l]=this.spawn(a[l])}var c=n.sort(function(e,r){return t(e)-t(r)});for(var d=0;d<c.length;d++){var p=c[d],u=p.source()[0],f=p.target()[0],h=s(u),g=s(f),y=o[h],v=o[g];if(h!==g){a.merge(p);y.merge(v);o.splice(g,1)}}return a}};var yr=Wt({root:null,goal:null,weight:function e(t){return 1},heuristic:function e(t){return 0},directed:!1});var vr={aStar:function t(r){var a=this.cy();var n=yr(r),i=n.root,o=n.goal,s=n.heuristic,l=n.directed,c=n.weight;i=a.collection(i)[0];o=a.collection(o)[0];var d=i.id();var p=o.id();var u={};var f={};var h={};var g=new ur(function(e,t){return f[e.id()]-f[t.id()]});var y=new er;var v={};var m={};var b=function e(t,r){g.push(t);y.add(r)};var x,_;var w=function e(){x=g.pop();_=x.id();y["delete"](_)};var S=function e(t){return y.has(t)};b(i,d);u[d]=0;f[d]=s(i);var P=0;while(g.size()>0){w();P++;if(_===p){var C=[],E=o,T=p,I=m[T];for(;;){C.unshift(E);I!=null&&C.unshift(I);E=v[T];if(E==null){break}T=E.id();I=m[T]}return{found:!0,distance:u[_],path:this.spawn(C),steps:P}}h[_]=!0;var k=x._private.edges;for(var R=0;R<k.length;R++){var D=k[R];if(!this.hasElementWithId(D.id())){continue}if(l&&D.data("source")!==_){continue}var B=D.source(),A=D.target(),O=B.id()!==_?B:A,L=O.id();if(!this.hasElementWithId(L)){continue}if(h[L]){continue}var N=u[_]+c(D);if(!S(L)){u[L]=N;f[L]=N+s(O);b(O,L);v[L]=x;m[L]=D;continue}if(N<u[L]){u[L]=N;f[L]=N+s(O);v[L]=x;m[L]=D}}}return{found:!1,distance:e,path:e,steps:P}}};var mr=Wt({weight:function e(t){return 1},directed:!1});var br={floydWarshall:function e(t){var r=this.cy();var a=mr(t),n=a.weight,i=a.directed;var o=this.byGroup(),s=o.nodes,l=o.edges;var c=s.length;var d=c*c;var p=function e(t){return s.indexOf(t)};var u=function e(t){return s[t]};var f=new Array(d);for(var h=0;h<d;h++){var g=h%c,y=(h-g)/c;if(y===g){f[h]=0}else{f[h]=Infinity}}var v=new Array(d);var m=new Array(d);for(var b=0;b<l.length;b++){var x=l[b],_=x.source()[0],w=x.target()[0];if(_===w){continue}var S=p(_),P=p(w),C=S*c+P,T=n(x);if(f[C]>T){f[C]=T;v[C]=P;m[C]=x}if(!i){var I=P*c+S;if(!i&&f[I]>T){f[I]=T;v[I]=S;m[I]=x}}}for(var k=0;k<c;k++){for(var R=0;R<c;R++){var D=R*c+k;for(var B=0;B<c;B++){var A=R*c+B,O=k*c+B;if(f[D]+f[O]<f[A]){f[A]=f[D]+f[O];v[A]=v[D]}}}}var L=function e(t){return(E(t)?r.filter(t):t)[0]};var N=function e(t){return p(L(t))};var M={distance:function e(t,r){var a=N(t);var n=N(r);return f[a*c+n]},path:function e(t,a){var n=N(t);var i=N(a);var o=u(n);if(n===i){return o.collection()}if(v[n*c+i]==null){return r.collection()}var e=r.collection();var s=n;var l;e.merge(o);while(n!==i){s=n;n=v[n*c+i];l=m[s*c+n];e.merge(l);e.merge(u(n))}return e}};return M}};var xr=Wt({weight:function e(t){return 1},directed:!1,root:null});var _r={bellmanFord:function t(r){var a=this;var n=xr(r),i=n.weight,o=n.directed,s=n.root;var l=this;var c=this.cy();var d=this.byGroup(),p=d.edges,u=d.nodes;var f=u.length;var h=new Qt;var g=!1;var y=[];s=c.collection(s)[0];p.unmergeBy(function(e){return e.isLoop()});var v=p.length;var m=function e(t){var r=h.get(t.id());if(!r){r={};h.set(t.id(),r)}return r};var b=function e(t){return(E(t)?c.$(t):t)[0]};var x=function e(t){return m(b(t)).dist};var _=function t(r){var n=arguments.length>1&&arguments[1]!==e?arguments[1]:s;var i=b(r);var o=[];var c=i;for(;;){if(c==null){return a.spawn()}var d=m(c),p=d.edge,u=d.pred;o.unshift(c[0]);if(c.same(n)&&o.length>0){break}p!=null&&o.unshift(p);c=u}return l.spawn(o)};for(var w=0;w<f;w++){var S=u[w],P=m(S);if(S.same(s)){P.dist=0}else{P.dist=Infinity}P.pred=null;P.edge=null}var C=!1;var T=function e(t,r,a,n,i,o){var s=n.dist+o;if(s<i.dist&&!a.same(n.edge)){i.dist=s;i.pred=t;i.edge=a;C=!0}};for(var I=1;I<f;I++){C=!1;for(var k=0;k<v;k++){var R=p[k],D=R.source(),B=R.target(),A=i(R),O=m(D),L=m(B);T(D,B,R,O,L,A);o||T(B,D,R,L,O,A)}if(!C){break}}if(C){var N=[];for(var M=0;M<v;M++){var j=p[M],q=j.source(),z=j.target(),$=i(j),V=m(q).dist,F=m(z).dist;if(V+$<F||!o&&F+$<V){if(!g){Mt("Graph contains a negative weight cycle for Bellman-Ford");g=!0}if(r.findNegativeWeightCycles!==!1){var W=[];V+$<F&&W.push(q);!o&&F+$<V&&W.push(z);var H=W.length;for(var X=0;X<H;X++){var Y=W[X],G=[Y];G.push(m(Y).edge);var K=m(Y).pred;while(G.indexOf(K)===-1){G.push(K);G.push(m(K).edge);K=m(K).pred}G=G.slice(G.indexOf(K));var U=G[0].id(),Q=0;for(var Z=2;Z<G.length;Z+=2){if(G[Z].id()<U){U=G[Z].id();Q=Z}}G=G.slice(Q).concat(G.slice(0,Q));G.push(G[0]);var J=G.map(function(e){return e.id()}).join(",");if(N.indexOf(J)===-1){y.push(l.spawn(G));N.push(J)}}}else{break}}}}return{distanceTo:x,pathTo:_,hasNegativeWeightCycle:g,
negativeWeightCycles:y}}};var wr=Math.sqrt(2);var Sr=function e(t,r,a){a.length===0&&Lt("Karger-Stein must be run on a connected (sub)graph");var n=a[t];var i=n[1];var o=n[2];var s=r[i];var l=r[o];var c=a;for(var d=a.length-1;d>=0;d--){var p=a[d],u=p[1],f=p[2];(r[u]===s&&r[f]===l||r[u]===l&&r[f]===s)&&a.splice(d,1)}for(var h=0;h<a.length;h++){var g=a[h];if(g[1]===l){c[h]=g.slice();c[h][1]=s}else if(g[2]===l){c[h]=g.slice();c[h][2]=s}}for(var y=0;y<r.length;y++){r[y]===l&&(r[y]=s)}return a};var Pr=function e(t,r,a,n){while(a>n){var i=Math.floor(Math.random()*r.length);r=Sr(i,t,r);a--}return r};var Cr={kargerStein:function t(){var r=this;var a=this.byGroup(),n=a.nodes,i=a.edges;i.unmergeBy(function(e){return e.isLoop()});var o=n.length;var s=i.length;var l=Math.ceil(Math.pow(Math.log(o)/Math.LN2,2));var c=Math.floor(o/wr);if(o<2){Lt("At least 2 nodes are required for Karger-Stein algorithm");return e}var d=[];for(var p=0;p<s;p++){var u=i[p];d.push([p,n.indexOf(u.source()),n.indexOf(u.target())])}var f=Infinity;var h=[];var g=new Array(o);var y=new Array(o);var v=new Array(o);var m=function e(t,r){for(var a=0;a<o;a++){r[a]=t[a]}};for(var b=0;b<=l;b++){for(var x=0;x<o;x++){y[x]=x}var _=Pr(y,d.slice(),o,c),w=_.slice();m(y,v);var S=Pr(y,_,c,2),P=Pr(v,w,c,2);if(S.length<=P.length&&S.length<f){f=S.length;h=S;m(y,g)}else if(P.length<=S.length&&P.length<f){f=P.length;h=P;m(v,g)}}var C=this.spawn(h.map(function(e){return i[e[0]]}));var E=this.spawn();var T=this.spawn();var I=g[0];for(var k=0;k<g.length;k++){var R=g[k],D=n[k];if(R===I){E.merge(D)}else{T.merge(D)}}var B=function e(t){var a=r.spawn();t.forEach(function(e){a.merge(e);e.connectedEdges().forEach(function(e){r.contains(e)&&!C.contains(e)&&a.merge(e)})});return a};var A=[B(E),B(T)];var O={cut:C,components:A,partition1:E,partition2:T};return O}};var Er;var Tr=function e(t){return{x:t.x,y:t.y}};var Ir=function e(t,r,a){return{x:t.x*r+a.x,y:t.y*r+a.y}};var kr=function e(t,r,a){return{x:(t.x-a.x)/r,y:(t.y-a.y)/r}};var Rr=function e(t){return{x:t[0],y:t[1]}};var Dr=function t(r){var a=arguments.length>1&&arguments[1]!==e?arguments[1]:0;var n=arguments.length>2&&arguments[2]!==e?arguments[2]:r.length;var t=Infinity;for(var i=a;i<n;i++){var o=r[i];isFinite(o)&&(t=Math.min(o,t))}return t};var Br=function t(r){var a=arguments.length>1&&arguments[1]!==e?arguments[1]:0;var n=arguments.length>2&&arguments[2]!==e?arguments[2]:r.length;var t=-Infinity;for(var i=a;i<n;i++){var o=r[i];isFinite(o)&&(t=Math.max(o,t))}return t};var Ar=function t(r){var a=arguments.length>1&&arguments[1]!==e?arguments[1]:0;var n=arguments.length>2&&arguments[2]!==e?arguments[2]:r.length;var i=0;var o=0;for(var s=a;s<n;s++){var l=r[s];if(isFinite(l)){i+=l;o++}}return i/o};var Or=function t(r){var a=arguments.length>1&&arguments[1]!==e?arguments[1]:0;var n=arguments.length>2&&arguments[2]!==e?arguments[2]:r.length;var i=arguments.length>3&&arguments[3]!==e?arguments[3]:!0;var o=arguments.length>4&&arguments[4]!==e?arguments[4]:!0;var s=arguments.length>5&&arguments[5]!==e?arguments[5]:!0;if(i){r=r.slice(a,n)}else{n<r.length&&r.splice(n,r.length-n);a>0&&r.splice(0,a)}var l=0;for(var c=r.length-1;c>=0;c--){var d=r[c];if(s){if(!isFinite(d)){r[c]=-Infinity;l++}}else{r.splice(c,1)}}o&&r.sort(function(e,t){return e-t});var p=r.length;var u=Math.floor(p/2);if(p%2!==0){return r[u+1+l]}else{return(r[u-1+l]+r[u+l])/2}};var Lr=function e(t){return Math.PI*t/180};var Nr=function e(t,r){return Math.atan2(r,t)-Math.PI/2};var Mr=Math.log2||function(e){return Math.log(e)/Math.log(2)};var jr=function e(t){if(t>0){return 1}else if(t<0){return-1}else{return 0}};var qr=function e(t,r){return Math.sqrt(zr(t,r))};var zr=function e(t,r){var a=r.x-t.x;var n=r.y-t.y;return a*a+n*n};var $r=function e(t){var r=t.length;var a=0;for(var n=0;n<r;n++){a+=t[n]}for(var i=0;i<r;i++){t[i]=t[i]/a}return t};var Vr=function e(t,r,a,n){return(1-n)*(1-n)*t+2*(1-n)*n*r+n*n*a};var Fr=function e(t,r,a,n){return{x:Vr(t.x,r.x,a.x,n),y:Vr(t.y,r.y,a.y,n)}};var Wr=function e(t,r,a,n){var i={x:r.x-t.x,y:r.y-t.y};var o=qr(t,r);var s={x:i.x/o,y:i.y/o};a=a==null?0:a;n=n!=null?n:a*o;return{x:t.x+s.x*n,y:t.y+s.y*n}};var Hr=function e(t,r,a){return Math.max(t,Math.min(a,r))};var Xr=function e(t){if(t==null){return{x1:Infinity,y1:Infinity,x2:-Infinity,y2:-Infinity,w:0,h:0}}else if(t.x1!=null&&t.y1!=null){if(t.x2!=null&&t.y2!=null&&t.x2>=t.x1&&t.y2>=t.y1){return{x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,w:t.x2-t.x1,h:t.y2-t.y1}}else if(t.w!=null&&t.h!=null&&t.w>=0&&t.h>=0){return{x1:t.x1,y1:t.y1,x2:t.x1+t.w,y2:t.y1+t.h,w:t.w,h:t.h}}}};var Yr=function e(t){return{x1:t.x1,x2:t.x2,w:t.w,y1:t.y1,y2:t.y2,h:t.h}};var Gr=function e(t){t.x1=Infinity;t.y1=Infinity;t.x2=-Infinity;t.y2=-Infinity;t.w=0;t.h=0};var Kr=function e(t,r){t.x1=Math.min(t.x1,r.x1);t.x2=Math.max(t.x2,r.x2);t.w=t.x2-t.x1;t.y1=Math.min(t.y1,r.y1);t.y2=Math.max(t.y2,r.y2);t.h=t.y2-t.y1};var Ur=function e(t,r,a){t.x1=Math.min(t.x1,r);t.x2=Math.max(t.x2,r);t.w=t.x2-t.x1;t.y1=Math.min(t.y1,a);t.y2=Math.max(t.y2,a);t.h=t.y2-t.y1};var Qr=function t(r){var a=arguments.length>1&&arguments[1]!==e?arguments[1]:0;r.x1-=a;r.x2+=a;r.y1-=a;r.y2+=a;r.w=r.x2-r.x1;r.h=r.y2-r.y1;return r};var Zr=function t(r){var a=arguments.length>1&&arguments[1]!==e?arguments[1]:[0];var n,i,o,s;if(a.length===1){n=i=o=s=a[0]}else if(a.length===2){n=o=a[0];s=i=a[1]}else if(a.length===4){var l=f(a,4);n=l[0];i=l[1];o=l[2];s=l[3]}r.x1-=s;r.x2+=i;r.y1-=n;r.y2+=o;r.w=r.x2-r.x1;r.h=r.y2-r.y1;return r};var Jr=function e(t,r){t.x1=r.x1;t.y1=r.y1;t.x2=r.x2;t.y2=r.y2;t.w=t.x2-t.x1;t.h=t.y2-t.y1};var ea=function e(t,r){if(t.x1>r.x2){return!1}if(r.x1>t.x2){return!1}if(t.x2<r.x1){return!1}if(r.x2<t.x1){return!1}if(t.y2<r.y1){return!1}if(r.y2<t.y1){return!1}if(t.y1>r.y2){return!1}if(r.y1>t.y2){return!1}return!0};var ta=function e(t,r,a){return t.x1<=r&&r<=t.x2&&t.y1<=a&&a<=t.y2};var ra=function e(t,r){return ta(t,r.x,r.y)};var aa=function e(t,r){return ta(t,r.x1,r.y1)&&ta(t,r.x2,r.y2)};var na=(Er=Math.hypot)!==null&&Er!==e?Er:function(e,t){return Math.sqrt(e*e+t*t)};function ia(e,t){if(e.length<3){throw new Error("Need at least 3 vertices")}var r=function e(t,r){return{x:t.x+r.x,y:t.y+r.y}};var a=function e(t,r){return{x:t.x-r.x,y:t.y-r.y}};var n=function e(t,r){return{x:t.x*r,y:t.y*r}};var i=function e(t,r){return t.x*r.y-t.y*r.x};var o=function e(t){var r=na(t.x,t.y);return r===0?{x:0,y:0}:{x:t.x/r,y:t.y/r}};var s=function e(t){var r=0;for(var a=0;a<t.length;a++){var n=t[a],i=t[(a+1)%t.length];r+=n.x*i.y-i.x*n.y}return r/2};var l=function e(t,o,s,l){var c=a(o,t);var d=a(l,s);var p=i(c,d);if(Math.abs(p)<1E-09){return r(t,n(c,.5))}var u=i(a(s,t),d)/p;return r(t,n(c,u))};var c=e.map(function(e){return{x:e.x,y:e.y}});s(c)<0&&c.reverse();var d=c.length;var p=[];for(var u=0;u<d;u++){var f=c[u],h=c[(u+1)%d],g=a(h,f),y=o({x:g.y,y:-g.x});p.push(y)}var v=p.map(function(e,a){var i=r(c[a],n(e,t));var o=r(c[(a+1)%d],n(e,t));return{p1:i,p2:o}});var m=[];for(var b=0;b<d;b++){var x=v[(b-1+d)%d],_=v[b],w=l(x.p1,x.p2,_.p1,_.p2);m.push(w)}return m}function oa(e,t,r,a,n,i){var o=Pa(e,t,r,a,n);var s=ia(o,i);var l=Xr();s.forEach(function(e){return Ur(l,e.x,e.y)});return l}var sa=function t(r,a,n,i,o,s,l){var c=arguments.length>7&&arguments[7]!==e?arguments[7]:"auto";var d=c==="auto"?Da(o,s):c;var p=o/2;var u=s/2;d=Math.min(d,p,u);var f=d!==p,h=d!==u;var g;if(f){var y=n-p+d-l,v=i-u-l,m=n+p-d+l,b=v;g=Sa(r,a,n,i,y,v,m,b,!1);if(g.length>0){return g}}if(h){var x=n+p+l,_=i-u+d-l,w=x,S=i+u-d+l;g=Sa(r,a,n,i,x,_,w,S,!1);if(g.length>0){return g}}if(f){var P=n-p+d-l,C=i+u+l,E=n+p-d+l,T=C;g=Sa(r,a,n,i,P,C,E,T,!1);if(g.length>0){return g}}if(h){var I=n-p-l,k=i-u+d-l,R=I,D=i+u-d+l;g=Sa(r,a,n,i,I,k,R,D,!1);if(g.length>0){return g}}var B;{var A=n-p+d,O=i-u+d;B=_a(r,a,n,i,A,O,d+l);if(B.length>0&&B[0]<=A&&B[1]<=O){return[B[0],B[1]]}}{var L=n+p-d,N=i-u+d;B=_a(r,a,n,i,L,N,d+l);if(B.length>0&&B[0]>=L&&B[1]<=N){return[B[0],B[1]]}}{var M=n+p-d,j=i+u-d;B=_a(r,a,n,i,M,j,d+l);if(B.length>0&&B[0]>=M&&B[1]>=j){return[B[0],B[1]]}}{var q=n-p+d,z=i+u-d;B=_a(r,a,n,i,q,z,d+l);if(B.length>0&&B[0]<=q&&B[1]>=z){return[B[0],B[1]]}}return[]};var la=function e(t,r,a,n,i,o,s){var l=Math.min(a,i);var c=Math.max(a,i);var d=Math.min(n,o);var p=Math.max(n,o);return l-s<=t&&t<=c+s&&d-s<=r&&r<=p+s};var ca=function e(t,r,a,n,i,o,s,l,c){var d={x1:Math.min(a,s,i)-c,x2:Math.max(a,s,i)+c,y1:Math.min(n,l,o)-c,y2:Math.max(n,l,o)+c};if(t<d.x1||t>d.x2||r<d.y1||r>d.y2){return!1}else{return!0}};var da=function e(t,r,a,n){a-=n;var i=r*r-4*t*a;if(i<0){return[]}var o=Math.sqrt(i);var s=2*t;var l=(-r+o)/s;var c=(-r-o)/s;return[l,c]};var pa=function e(t,r,a,n,i){var o=1E-05;t===0&&(t=o);r/=t;a/=t;n/=t;var s,l,c,d,p,u,f,h;l=(3*a-r*r)/9;c=-(27*n)+r*(9*a-2*(r*r));c/=54;s=l*l*l+c*c;i[1]=0;f=r/3;if(s>0){p=c+Math.sqrt(s);p=p<0?-Math.pow(-p,1/3):Math.pow(p,1/3);u=c-Math.sqrt(s);u=u<0?-Math.pow(-u,1/3):Math.pow(u,1/3);i[0]=-f+p+u;f+=(p+u)/2;i[4]=i[2]=-f;f=Math.sqrt(3)*(-u+p)/2;i[3]=f;i[5]=-f;return}i[5]=i[3]=0;if(s===0){h=c<0?-Math.pow(-c,1/3):Math.pow(c,1/3);i[0]=-f+2*h;i[4]=i[2]=-(h+f);return}l=-l;d=l*l*l;d=Math.acos(c/Math.sqrt(d));h=2*Math.sqrt(l);i[0]=-f+h*Math.cos(d/3);i[2]=-f+h*Math.cos((d+2*Math.PI)/3);i[4]=-f+h*Math.cos((d+4*Math.PI)/3);return};var ua=function e(t,r,a,n,i,o,s,l){var c=1*a*a-4*a*i+2*a*s+4*i*i-4*i*s+s*s+n*n-4*n*o+2*n*l+4*o*o-4*o*l+l*l;var d=1*9*a*i-3*a*a-3*a*s-6*i*i+3*i*s+9*n*o-3*n*n-3*n*l-6*o*o+3*o*l;var p=1*3*a*a-6*a*i+a*s-a*t+2*i*i+2*i*t-s*t+3*n*n-6*n*o+n*l-n*r+2*o*o+2*o*r-l*r;var u=1*a*i-a*a+a*t-i*t+n*o-n*n+n*r-o*r;var f=[];pa(c,d,p,u,f);var h=1E-07;var g=[];for(var y=0;y<6;y+=2){Math.abs(f[y+1])<h&&f[y]>=0&&f[y]<=1&&g.push(f[y])}g.push(1);g.push(0);var v=-1;var m,b,x;for(var _=0;_<g.length;_++){m=Math.pow(1-g[_],2)*a+2*(1-g[_])*g[_]*i+g[_]*g[_]*s;b=Math.pow(1-g[_],2)*n+2*(1-g[_])*g[_]*o+g[_]*g[_]*l;x=Math.pow(m-t,2)+Math.pow(b-r,2);if(v>=0){x<v&&(v=x)}else{v=x}}return v};var fa=function e(t,r,a,n,i,o){var s=[t-a,r-n];var l=[i-a,o-n];var c=l[0]*l[0]+l[1]*l[1];var d=s[0]*s[0]+s[1]*s[1];var p=s[0]*l[0]+s[1]*l[1];var u=p*p/c;if(p<0){return d}if(u>c){return(t-i)*(t-i)+(r-o)*(r-o)}return d-u};var ha=function e(t,r,a){var n,i,o,s;var l;var c=0;for(var d=0;d<a.length/2;d++){n=a[d*2];i=a[d*2+1];if(d+1<a.length/2){o=a[(d+1)*2];s=a[(d+1)*2+1]}else{o=a[(d+1-a.length/2)*2];s=a[(d+1-a.length/2)*2+1]}if(n==t&&o==t);else if(n>=t&&t>=o||n<=t&&t<=o){l=(t-n)/(o-n)*(s-i)+i;l>r&&c++}else{continue}}if(c%2===0){return!1}else{return!0}};var ga=function e(t,r,a,n,i,o,s,l,c){var d=new Array(a.length);var p;if(l[0]!=null){p=Math.atan(l[1]/l[0]);if(l[0]<0){p=p+Math.PI/2}else{p=-p-Math.PI/2}}else{p=l}var u=Math.cos(-p);var f=Math.sin(-p);for(var h=0;h<d.length/2;h++){d[h*2]=o/2*(a[h*2]*u-a[h*2+1]*f);d[h*2+1]=s/2*(a[h*2+1]*u+a[h*2]*f);d[h*2]+=n;d[h*2+1]+=i}var g;if(c>0){var y=ma(d,-c);g=va(y)}else{g=d}return ha(t,r,g)};var ya=function e(t,r,a,n,i,o,s,l){var c=new Array(a.length*2);for(var d=0;d<l.length;d++){var p=l[d];c[d*4+0]=p.startX;c[d*4+1]=p.startY;c[d*4+2]=p.stopX;c[d*4+3]=p.stopY;var u=Math.pow(p.cx-t,2)+Math.pow(p.cy-r,2);if(u<=Math.pow(p.radius,2)){return!0}}return ha(t,r,c)};var va=function e(t){var r=new Array(t.length/2);var a,n,i,o;var s,l,c,d;for(var p=0;p<t.length/4;p++){a=t[p*4];n=t[p*4+1];i=t[p*4+2];o=t[p*4+3];if(p<t.length/4-1){s=t[(p+1)*4];l=t[(p+1)*4+1];c=t[(p+1)*4+2];d=t[(p+1)*4+3]}else{s=t[0];l=t[1];c=t[2];d=t[3]}var u=Sa(a,n,i,o,s,l,c,d,!0);r[p*2]=u[0];r[p*2+1]=u[1]}return r};var ma=function e(t,r){var a=new Array(t.length*2);var n,i,o,s;for(var l=0;l<t.length/2;l++){n=t[l*2];i=t[l*2+1];if(l<t.length/2-1){o=t[(l+1)*2];s=t[(l+1)*2+1]}else{o=t[0];s=t[1]}var c=s-i,d=-(o-n),p=Math.sqrt(c*c+d*d),u=c/p,f=d/p;a[l*4]=n+u*r;a[l*4+1]=i+f*r;a[l*4+2]=o+u*r;a[l*4+3]=s+f*r}return a};var ba=function e(t,r,a,n,i,o){var s=a-t;var l=n-r;s/=i;l/=o;var c=Math.sqrt(s*s+l*l);var d=c-1;if(d<0){return[]}var p=d/c;return[(a-t)*p+t,(n-r)*p+r]};var xa=function e(t,r,a,n,i,o,s){t-=i;r-=o;t/=a/2+s;r/=n/2+s;return t*t+r*r<=1};var _a=function e(t,r,a,n,i,o,s){var l=[a-t,n-r];var c=[t-i,r-o];var d=l[0]*l[0]+l[1]*l[1];var p=2*(c[0]*l[0]+c[1]*l[1]);var u=c[0]*c[0]+c[1]*c[1]-s*s;var f=p*p-4*d*u;if(f<0){return[]}var h=(-p+Math.sqrt(f))/(2*d);var g=(-p-Math.sqrt(f))/(2*d);var y=Math.min(h,g);var v=Math.max(h,g);var m=[];y>=0&&y<=1&&m.push(y);v>=0&&v<=1&&m.push(v);if(m.length===0){return[]}var b=m[0]*l[0]+t;var x=m[0]*l[1]+r;if(m.length>1){if(m[0]==m[1]){return[b,x]}else{var _=m[1]*l[0]+t,w=m[1]*l[1]+r;return[b,x,_,w]}}else{return[b,x]}};var wa=function e(t,r,a){if(r<=t&&t<=a||a<=t&&t<=r){return t}else if(t<=r&&r<=a||a<=r&&r<=t){return r}else{return a}};var Sa=function e(t,r,a,n,i,o,s,l,c){var d=t-i;var p=a-t;var u=s-i;var f=r-o;var h=n-r;var g=l-o;var y=u*f-g*d;var v=p*f-h*d;var m=g*p-u*h;if(m!==0){var b=y/m,x=v/m,_=.001,w=0-_,S=1+_;if(w<=b&&b<=S&&w<=x&&x<=S){return[t+b*p,r+b*h]}else{if(!c){return[]}else{return[t+b*p,r+b*h]}}}else{if(y===0||v===0){if(wa(t,a,s)===s){return[s,l]}if(wa(t,a,i)===i){return[i,o]}if(wa(i,s,a)===a){return[a,n]}return[]}else{return[]}}};var Pa=function e(t,r,a,n,i){var o=[];var s=n/2;var l=i/2;o.push({x:r+s*t[0],y:a+l*t[1]});for(var c=1;c<t.length/2;c++){o.push({x:r+s*t[c*2],y:a+l*t[c*2+1]})}return o};var Ca=function e(t,r,a,n,i,o,s,l){var c=[];var d;var p=new Array(a.length);var u=!0;o==null&&(u=!1);var f;if(u){for(var h=0;h<p.length/2;h++){p[h*2]=a[h*2]*o+n;p[h*2+1]=a[h*2+1]*s+i}if(l>0){var g=ma(p,-l);f=va(g)}else{f=p}}else{f=a}var y,v,m,b;for(var x=0;x<f.length/2;x++){y=f[x*2];v=f[x*2+1];if(x<f.length/2-1){m=f[(x+1)*2];b=f[(x+1)*2+1]}else{m=f[0];b=f[1]}d=Sa(t,r,n,i,y,v,m,b);d.length!==0&&c.push(d[0],d[1])}return c};var Ea=function e(t,r,a,n,i,o,s,l,c){var d=[];var p;var u=new Array(a.length*2);c.forEach(function(e,a){if(a===0){u[u.length-2]=e.startX;u[u.length-1]=e.startY}else{u[a*4-2]=e.startX;u[a*4-1]=e.startY}u[a*4]=e.stopX;u[a*4+1]=e.stopY;p=_a(t,r,n,i,e.cx,e.cy,e.radius);p.length!==0&&d.push(p[0],p[1])});for(var f=0;f<u.length/4;f++){p=Sa(t,r,n,i,u[f*4],u[f*4+1],u[f*4+2],u[f*4+3],!1);p.length!==0&&d.push(p[0],p[1])}if(d.length>2){var h=[d[0],d[1]],g=Math.pow(h[0]-t,2)+Math.pow(h[1]-r,2);for(var y=1;y<d.length/2;y++){var v=Math.pow(d[y*2]-t,2)+Math.pow(d[y*2+1]-r,2);if(v<=g){h[0]=d[y*2];h[1]=d[y*2+1];g=v}}return h}return d};var Ta=function e(t,r,a){var n=[t[0]-r[0],t[1]-r[1]];var i=Math.sqrt(n[0]*n[0]+n[1]*n[1]);var o=(i-a)/i;o<0&&(o=1E-05);return[r[0]+o*n[0],r[1]+o*n[1]]};var Ia=function e(t,r){var a=Ra(t,r);a=ka(a);return a};var ka=function e(t){var r,a;var n=t.length/2;var i=Infinity,o=Infinity,s=-Infinity,l=-Infinity;for(var c=0;c<n;c++){r=t[2*c];a=t[2*c+1];i=Math.min(i,r);s=Math.max(s,r);o=Math.min(o,a);l=Math.max(l,a)}var d=2/(s-i);var p=2/(l-o);for(var u=0;u<n;u++){r=t[2*u]=t[2*u]*d;a=t[2*u+1]=t[2*u+1]*p;i=Math.min(i,r);s=Math.max(s,r);o=Math.min(o,a);l=Math.max(l,a)}if(o<-1){for(var f=0;f<n;f++){a=t[2*f+1]=t[2*f+1]+(-1-o)}}return t};var Ra=function e(t,r){var a=1/t*2*Math.PI;var n=t%2===0?Math.PI/2+a/2:Math.PI/2;n+=r;var i=new Array(t*2);var o;for(var s=0;s<t;s++){o=s*a+n;i[2*s]=Math.cos(o);i[2*s+1]=Math.sin(-o)}return i};var Da=function e(t,r){return Math.min(t/4,r/4,8)};var Ba=function e(t,r){return Math.min(t/10,r/10,8)};var Aa=function e(){return 8};var Oa=function e(t,r,a){return[t-2*r+a,2*(r-t),t]};var La=function e(t,r){return{heightOffset:Math.min(15,.05*r),widthOffset:Math.min(100,.25*t),ctrlPtOffsetPct:.05}};function Na(e,t){function r(e){var t=[];for(var r=0;r<e.length;r++){var a=e[r],n=e[(r+1)%e.length],i={x:n.x-a.x,y:n.y-a.y},o={x:-i.y,y:i.x},s=Math.sqrt(o.x*o.x+o.y*o.y);t.push({x:o.x/s,y:o.y/s})}return t}function a(e,t){var r=Infinity;var a=-Infinity;var n=s(e),i;try{for(n.s();!(i=n.n()).done;){var o=i.value,l=o.x*t.x+o.y*t.y;r=Math.min(r,l);a=Math.max(a,l)}}catch(e){n.e(e)}finally{n.f()}return{min:r,max:a}}function n(e,t){return!(e.max<t.min||t.max<e.min)}var i=[].concat(h(r(e)),h(r(t)));var o=s(i),l;try{for(o.s();!(l=o.n()).done;){var c=l.value,d=a(e,c),p=a(t,c);if(!n(d,p)){return!1}}}catch(e){o.e(e)}finally{o.f()}return!0}var Ma=Wt({dampingFactor:.8,precision:1E-06,iterations:200,weight:function e(t){return 1}});var ja={pageRank:function e(t){var r=Ma(t),a=r.dampingFactor,n=r.precision,i=r.iterations,o=r.weight;var s=this._private.cy;var l=this.byGroup(),c=l.nodes,d=l.edges;var p=c.length;var u=p*p;var f=d.length;var h=new Array(u);var g=new Array(p);var y=(1-a)/p;for(var v=0;v<p;v++){for(var m=0;m<p;m++){var b=v*p+m;h[b]=0}g[v]=0}for(var x=0;x<f;x++){var _=d[x],w=_.data("source"),S=_.data("target");if(w===S){continue}var P=c.indexOfId(w),C=c.indexOfId(S),E=o(_),T=C*p+P;h[T]+=E;g[P]+=E}var I=1/p+y;for(var k=0;k<p;k++){if(g[k]===0){for(var R=0;R<p;R++){var D=R*p+k;h[D]=I}}else{for(var B=0;B<p;B++){var A=B*p+k;h[A]=h[A]/g[k]+y}}}var O=new Array(p);var L=new Array(p);var N;for(var M=0;M<p;M++){O[M]=1}for(var j=0;j<i;j++){for(var q=0;q<p;q++){L[q]=0}for(var z=0;z<p;z++){for(var $=0;$<p;$++){var V=z*p+$;L[z]+=h[V]*O[$]}}$r(L);N=O;O=L;L=N;var F=0;for(var W=0;W<p;W++){var H=N[W]-O[W];F+=H*H}if(F<n){break}}var X={rank:function e(t){t=s.collection(t)[0];return O[c.indexOf(t)]}};return X}};var qa=Wt({root:null,weight:function e(t){return 1},directed:!1,alpha:0});var za={degreeCentralityNormalized:function e(t){t=qa(t);var r=this.cy();var a=this.nodes();var n=a.length;if(!t.directed){var i={},o=0;for(var s=0;s<n;s++){var l=a[s];t.root=l;var c=this.degreeCentrality(t);o<c.degree&&(o=c.degree);i[l.id()]=c.degree}return{degree:function e(t){if(o===0){return 0}E(t)&&(t=r.filter(t));return i[t.id()]/o}}}else{var d={},p={},u=0,f=0;for(var h=0;h<n;h++){var g=a[h],y=g.id();t.root=g;var v=this.degreeCentrality(t);u<v.indegree&&(u=v.indegree);f<v.outdegree&&(f=v.outdegree);d[y]=v.indegree;p[y]=v.outdegree}return{indegree:function e(t){if(u==0){return 0}E(t)&&(t=r.filter(t));return d[t.id()]/u},outdegree:function e(t){if(f===0){return 0}E(t)&&(t=r.filter(t));return p[t.id()]/f}}}},degreeCentrality:function e(t){t=qa(t);var r=this.cy();var a=this;var n=t,i=n.root,o=n.weight,s=n.directed,l=n.alpha;i=r.collection(i)[0];if(!s){var c=i.connectedEdges().intersection(a),d=c.length,p=0;for(var u=0;u<c.length;u++){p+=o(c[u])}return{degree:Math.pow(d,1-l)*Math.pow(p,l)}}else{var f=i.connectedEdges(),h=f.filter(function(e){return e.target().same(i)&&a.has(e)}),g=f.filter(function(e){return e.source().same(i)&&a.has(e)}),y=h.length,v=g.length,m=0,b=0;for(var x=0;x<h.length;x++){m+=o(h[x])}for(var _=0;_<g.length;_++){b+=o(g[_])}return{indegree:Math.pow(y,1-l)*Math.pow(m,l),outdegree:Math.pow(v,1-l)*Math.pow(b,l)}}}};za.dc=za.degreeCentrality;za.dcn=za.degreeCentralityNormalised=za.degreeCentralityNormalized;var $a=Wt({harmonic:!0,weight:function e(){return 1},directed:!1,root:null});var Va={closenessCentralityNormalized:function e(t){var r=$a(t),a=r.harmonic,n=r.weight,i=r.directed;var o=this.cy();var s={};var l=0;var c=this.nodes();var d=this.floydWarshall({weight:n,directed:i});for(var p=0;p<c.length;p++){var u=0,f=c[p];for(var h=0;h<c.length;h++){if(p!==h){var g=d.distance(f,c[h]);if(a){u+=1/g}else{u+=g}}}a||(u=1/u);l<u&&(l=u);s[f.id()]=u}return{closeness:function e(t){if(l==0){return 0}if(E(t)){t=o.filter(t)[0].id()}else{t=t.id()}return s[t]/l}}},closenessCentrality:function e(t){var r=$a(t),a=r.root,n=r.weight,i=r.directed,o=r.harmonic;a=this.filter(a)[0];var s=this.dijkstra({root:a,weight:n,directed:i});var l=0;var c=this.nodes();for(var d=0;d<c.length;d++){var p=c[d];if(!p.same(a)){var u=s.distanceTo(p);if(o){l+=1/u}else{l+=u}}}return o?l:1/l}};Va.cc=Va.closenessCentrality;Va.ccn=Va.closenessCentralityNormalised=Va.closenessCentralityNormalized;var Fa=Wt({weight:null,directed:!1});var Wa={betweennessCentrality:function t(r){var a=Fa(r),n=a.directed,i=a.weight;var o=i!=null;var s=this.cy();var l=this.nodes();var c={};var d={};var p=0;var u={set:function e(t,r){d[t]=r;r>p&&(p=r)},get:function e(t){return d[t]}};for(var f=0;f<l.length;f++){var h=l[f],g=h.id();if(n){c[g]=h.outgoers().nodes()}else{c[g]=h.openNeighborhood().nodes()}u.set(g,0)}var y=function t(){var r=l[v].id();var a=[];var n={};var d={};var p={};var f=new ur(function(e,t){return p[e]-p[t]});for(var h=0;h<l.length;h++){var g=l[h].id();n[g]=[];d[g]=0;p[g]=Infinity}d[r]=1;p[r]=0;f.push(r);while(!f.empty()){var y=f.pop();a.push(y);if(o){for(var m=0;m<c[y].length;m++){var b=c[y][m],x=s.getElementById(y),_=e;if(x.edgesTo(b).length>0){_=x.edgesTo(b)[0]}else{_=b.edgesTo(x)[0]}var w=i(_);b=b.id();if(p[b]>p[y]+w){p[b]=p[y]+w;if(f.nodes.indexOf(b)<0){f.push(b)}else{f.updateItem(b)}d[b]=0;n[b]=[]}if(p[b]==p[y]+w){d[b]=d[b]+d[y];n[b].push(y)}}}else{for(var S=0;S<c[y].length;S++){var P=c[y][S].id();if(p[P]==Infinity){f.push(P);p[P]=p[y]+1}if(p[P]==p[y]+1){d[P]=d[P]+d[y];n[P].push(y)}}}}var C={};for(var E=0;E<l.length;E++){C[l[E].id()]=0}while(a.length>0){var T=a.pop();for(var I=0;I<n[T].length;I++){var k=n[T][I];C[k]=C[k]+d[k]/d[T]*(1+C[T])}T!=l[v].id()&&u.set(T,u.get(T)+C[T])}};for(var v=0;v<l.length;v++){y()}var m={betweenness:function e(t){var r=s.collection(t).id();return u.get(r)},betweennessNormalized:function e(t){if(p==0){return 0}var r=s.collection(t).id();return u.get(r)/p}};m.betweennessNormalised=m.betweennessNormalized;return m}};Wa.bc=Wa.betweennessCentrality;var Ha=Wt({expandFactor:2,inflateFactor:2,multFactor:1,maxIterations:20,attributes:[function(e){return 1}]});var Xa=function e(t){return Ha(t)};var Ya=function e(t,r){var a=0;for(var n=0;n<r.length;n++){a+=r[n](t)}return a};var Ga=function e(t,r,a){for(var n=0;n<r;n++){t[n*r+n]=a}};var Ka=function e(t,r){var a;for(var n=0;n<r;n++){a=0;for(var i=0;i<r;i++){a+=t[i*r+n]}for(var o=0;o<r;o++){t[o*r+n]=t[o*r+n]/a}}};var Ua=function e(t,r,a){var n=new Array(a*a);for(var i=0;i<a;i++){for(var o=0;o<a;o++){n[i*a+o]=0}for(var s=0;s<a;s++){for(var l=0;l<a;l++){n[i*a+l]+=t[i*a+s]*r[s*a+l]}}}return n};var Qa=function e(t,r,a){var n=t.slice(0);for(var i=1;i<a;i++){t=Ua(t,n,r)}return t};var Za=function e(t,r,a){var n=new Array(r*r);for(var i=0;i<r*r;i++){n[i]=Math.pow(t[i],a)}Ka(n,r);return n};var Ja=function e(t,r,a,n){for(var i=0;i<a;i++){var o=Math.round(t[i]*Math.pow(10,n))/Math.pow(10,n),s=Math.round(r[i]*Math.pow(10,n))/Math.pow(10,n);if(o!==s){return!1}}return!0};var en=function e(t,r,a,n){var i=[];for(var o=0;o<r;o++){var s=[];for(var l=0;l<r;l++){Math.round(t[o*r+l]*1e3)/1e3>0&&s.push(a[l])}s.length!==0&&i.push(n.collection(s))}return i};var tn=function e(t,r){for(var a=0;a<t.length;a++){if(!r[a]||t[a].id()!==r[a].id()){return!1}}return!0};var rn=function e(t){for(var r=0;r<t.length;r++){for(var a=0;a<t.length;a++){r!=a&&tn(t[r],t[a])&&t.splice(a,1)}}return t};var an=function e(t){var r=this.nodes();var a=this.edges();var n=this.cy();var i=Xa(t);var o={};for(var s=0;s<r.length;s++){o[r[s].id()]=s}var l=r.length,c=l*l;var d=new Array(c),p;for(var u=0;u<c;u++){d[u]=0}for(var f=0;f<a.length;f++){var h=a[f],g=o[h.source().id()],y=o[h.target().id()],v=Ya(h,i.attributes);d[g*l+y]+=v;d[y*l+g]+=v}Ga(d,l,i.multFactor);Ka(d,l);var m=!0;var b=0;while(m&&b<i.maxIterations){m=!1;p=Qa(d,l,i.expandFactor);d=Za(p,l,i.inflateFactor);Ja(d,p,c,4)||(m=!0);b++}var x=en(d,l,r,n);x=rn(x);return x};var nn={markovClustering:an,mcl:an};var on=function e(t){return t};var sn=function e(t,r){return Math.abs(r-t)};var ln=function e(t,r,a){return t+sn(r,a)};var cn=function e(t,r,a){return t+Math.pow(a-r,2)};var dn=function e(t){return Math.sqrt(t)};var pn=function e(t,r,a){return Math.max(t,sn(r,a))};var un=function t(r,a,n,i,o){var s=arguments.length>5&&arguments[5]!==e?arguments[5]:on;var l=i;var c,d;for(var p=0;p<r;p++){c=a(p);d=n(p);l=o(l,c,d)}return s(l)};var fn={euclidean:function e(t,r,a){if(t>=2){return un(t,r,a,0,cn,dn)}else{return un(t,r,a,0,ln)}},squaredEuclidean:function e(t,r,a){return un(t,r,a,0,cn)},manhattan:function e(t,r,a){return un(t,r,a,0,ln)},max:function e(t,r,a){return un(t,r,a,-Infinity,pn)}};fn["squared-euclidean"]=fn["squaredEuclidean"];fn["squaredeuclidean"]=fn["squaredEuclidean"];function hn(e,t,r,a,n,i){var o;if(T(e)){o=e}else{o=fn[e]||fn.euclidean}if(t===0&&T(e)){return o(n,i)}else{return o(t,r,a,n,i)}}var gn=Wt({k:2,m:2,sensitivityThreshold:.0001,distance:"euclidean",maxIterations:10,attributes:[],testMode:!1,testCentroids:null});var yn=function e(t){return gn(t)};var vn=function e(t,r,a,n,i){var o=i!=="kMedoids";var s=o?function(e){return a[e]}:function(e){return n[e](a)};var l=function e(t){return n[t](r)};return hn(t,n.length,s,l,a,r)};var mn=function e(t,r,a){var n=a.length;var i=new Array(n);var o=new Array(n);var s=new Array(r);var l=null;for(var c=0;c<n;c++){i[c]=t.min(a[c]).value;o[c]=t.max(a[c]).value}for(var d=0;d<r;d++){l=[];for(var p=0;p<n;p++){l[p]=Math.random()*(o[p]-i[p])+i[p]}s[d]=l}return s};var bn=function e(t,r,a,n,i){var o=Infinity;var s=0;for(var l=0;l<r.length;l++){var c=vn(a,t,r[l],n,i);if(c<o){o=c;s=l}}return s};var xn=function e(t,r,a){var n=[];var i=null;for(var o=0;o<r.length;o++){i=r[o];a[i.id()]===t&&n.push(i)}return n};var _n=function e(t,r,a){return Math.abs(r-t)<=a};var wn=function e(t,r,a){for(var n=0;n<t.length;n++){for(var i=0;i<t[n].length;i++){var o=Math.abs(t[n][i]-r[n][i]);if(o>a){return!1}}}return!0};var Sn=function e(t,r,a){for(var n=0;n<a;n++){if(t===r[n])return!0}return!1};var Pn=function e(t,r){var a=new Array(r);if(t.length<50){for(var n=0;n<r;n++){var i=t[Math.floor(Math.random()*t.length)];while(Sn(i,a,n)){i=t[Math.floor(Math.random()*t.length)]}a[n]=i}}else{for(var o=0;o<r;o++){a[o]=t[Math.floor(Math.random()*t.length)]}}return a};var Cn=function e(t,r,a){var n=0;for(var i=0;i<r.length;i++){n+=vn("manhattan",r[i],t,a,"kMedoids")}return n};var En=function e(t){var r=this.cy();var a=this.nodes();var n=null;var i=yn(t);var o=new Array(i.k);var s={};var l;if(i.testMode){if(typeof i.testCentroids==="number"){i.testCentroids;l=mn(a,i.k,i.attributes)}else if(v(i.testCentroids)==="object"){l=i.testCentroids}else{l=mn(a,i.k,i.attributes)}}else{l=mn(a,i.k,i.attributes)}var c=!0;var d=0;while(c&&d<i.maxIterations){for(var p=0;p<a.length;p++){n=a[p];s[n.id()]=bn(n,l,i.distance,i.attributes,"kMeans")}c=!1;for(var u=0;u<i.k;u++){var f=xn(u,a,s);if(f.length===0){continue}var h=i.attributes.length,g=l[u],y=new Array(h),m=new Array(h);for(var b=0;b<h;b++){m[b]=0;for(var x=0;x<f.length;x++){n=f[x];m[b]+=i.attributes[b](n)}y[b]=m[b]/f.length;_n(y[b],g[b],i.sensitivityThreshold)||(c=!0)}l[u]=y;o[u]=r.collection(f)}d++}return o};var Tn=function e(t){var r=this.cy();var a=this.nodes();var n=null;var i=yn(t);var o=new Array(i.k);var s;var l={};var c;var d=new Array(i.k);if(i.testMode){if(typeof i.testCentroids==="number");else if(v(i.testCentroids)==="object"){s=i.testCentroids}else{s=Pn(a,i.k)}}else{s=Pn(a,i.k)}var p=!0;var u=0;while(p&&u<i.maxIterations){for(var f=0;f<a.length;f++){n=a[f];l[n.id()]=bn(n,s,i.distance,i.attributes,"kMedoids")}p=!1;for(var h=0;h<s.length;h++){var g=xn(h,a,l);if(g.length===0){continue}d[h]=Cn(s[h],g,i.attributes);for(var y=0;y<g.length;y++){c=Cn(g[y],g,i.attributes);if(c<d[h]){d[h]=c;s[h]=g[y];p=!0}}o[h]=r.collection(g)}u++}return o};var In=function e(t,r,a,n,i){var o,s;for(var l=0;l<r.length;l++){for(var c=0;c<t.length;c++){n[l][c]=Math.pow(a[l][c],i.m)}}for(var d=0;d<t.length;d++){for(var p=0;p<i.attributes.length;p++){o=0;s=0;for(var u=0;u<r.length;u++){o+=n[u][d]*i.attributes[p](r[u]);s+=n[u][d]}t[d][p]=o/s}}};var kn=function e(t,r,a,n,i){for(var o=0;o<t.length;o++){r[o]=t[o].slice()}var s,l,c;var d=2/(i.m-1);for(var p=0;p<a.length;p++){for(var u=0;u<n.length;u++){s=0;for(var f=0;f<a.length;f++){l=vn(i.distance,n[u],a[p],i.attributes,"cmeans");c=vn(i.distance,n[u],a[f],i.attributes,"cmeans");s+=Math.pow(l/c,d)}t[u][p]=1/s}}};var Rn=function e(t,r,a,n){var i=new Array(a.k);for(var o=0;o<i.length;o++){i[o]=[]}var s;var l;for(var c=0;c<r.length;c++){s=-Infinity;l=-1;for(var d=0;d<r[0].length;d++){if(r[c][d]>s){s=r[c][d];l=d}}i[l].push(t[c])}for(var p=0;p<i.length;p++){i[p]=n.collection(i[p])}return i};var Dn=function e(t){var r=this.cy();var a=this.nodes();var n=yn(t);var i;var o;var s;var l;var c;l=new Array(a.length);for(var d=0;d<a.length;d++){l[d]=new Array(n.k)}s=new Array(a.length);for(var p=0;p<a.length;p++){s[p]=new Array(n.k)}for(var u=0;u<a.length;u++){var f=0;for(var h=0;h<n.k;h++){s[u][h]=Math.random();f+=s[u][h]}for(var g=0;g<n.k;g++){s[u][g]=s[u][g]/f}}o=new Array(n.k);for(var y=0;y<n.k;y++){o[y]=new Array(n.attributes.length)}c=new Array(a.length);for(var v=0;v<a.length;v++){c[v]=new Array(n.k)}var m=!0;var b=0;while(m&&b<n.maxIterations){m=!1;In(o,a,s,c,n);kn(s,l,o,a,n);wn(s,l,n.sensitivityThreshold)||(m=!0);b++}i=Rn(a,s,n,r);return{clusters:i,degreeOfMembership:s}};var Bn={kMeans:En,kMedoids:Tn,fuzzyCMeans:Dn,fcm:Dn};var An=Wt({distance:"euclidean",linkage:"min",mode:"threshold",threshold:Infinity,addDendrogram:!1,dendrogramDepth:0,attributes:[]});var On={single:"min",complete:"max"};var Ln=function e(t){var r=An(t);var a=On[r.linkage];a!=null&&(r.linkage=a);return r};var Nn=function e(t,r,a,n,i){var o=0;var s=Infinity;var l;var c=i.attributes;var d=function e(t,r){return hn(i.distance,c.length,function(e){return c[e](t)},function(e){return c[e](r)},t,r)};for(var p=0;p<t.length;p++){var u=t[p].key,f=a[u][n[u]];if(f<s){o=u;s=f}}if(i.mode==="threshold"&&s>=i.threshold||i.mode==="dendrogram"&&t.length===1){return!1}var h=r[o];var g=r[n[o]];var y;if(i.mode==="dendrogram"){y={left:h,right:g,key:h.key}}else{y={value:h.value.concat(g.value),key:h.key}}t[h.index]=y;t.splice(g.index,1);r[h.key]=y;for(var v=0;v<t.length;v++){var m=t[v];if(h.key===m.key){l=Infinity}else if(i.linkage==="min"){l=a[h.key][m.key];a[h.key][m.key]>a[g.key][m.key]&&(l=a[g.key][m.key])}else if(i.linkage==="max"){l=a[h.key][m.key];a[h.key][m.key]<a[g.key][m.key]&&(l=a[g.key][m.key])}else if(i.linkage==="mean"){l=(a[h.key][m.key]*h.size+a[g.key][m.key]*g.size)/(h.size+g.size)}else{if(i.mode==="dendrogram")l=d(m.value,h.value);else l=d(m.value[0],h.value[0])}a[h.key][m.key]=a[m.key][h.key]=l}for(var b=0;b<t.length;b++){var x=t[b].key;if(n[x]===h.key||n[x]===g.key){var _=x;for(var w=0;w<t.length;w++){var S=t[w].key;a[x][S]<a[x][_]&&(_=S)}n[x]=_}t[b].index=b}h.key=g.key=h.index=g.index=null;return!0};var Mn=function e(t,r,a){if(!t)return;if(t.value){r.push(t.value)}else{t.left&&Mn(t.left,r);t.right&&Mn(t.right,r)}};var jn=function e(t,r){if(!t)return"";if(t.left&&t.right){var a=jn(t.left,r),n=jn(t.right,r),i=r.add({group:"nodes",data:{id:a+","+n}});r.add({group:"edges",data:{source:a,target:i.id()}});r.add({group:"edges",data:{source:n,target:i.id()}});return i.id()}else if(t.value){return t.value.id()}};var qn=function e(t,r,a){if(!t)return[];var n=[],i=[],o=[];if(r===0){t.left&&Mn(t.left,n);t.right&&Mn(t.right,i);o=n.concat(i);return[a.collection(o)]}else if(r===1){if(t.value){return[a.collection(t.value)]}else{t.left&&Mn(t.left,n);t.right&&Mn(t.right,i);return[a.collection(n),a.collection(i)]}}else{if(t.value){return[a.collection(t.value)]}else{t.left&&(n=qn(t.left,r-1,a));t.right&&(i=qn(t.right,r-1,a));return n.concat(i)}}};var zn=function t(r){var a=this.cy();var n=this.nodes();var i=Ln(r);var o=i.attributes;var s=function e(t,r){return hn(i.distance,o.length,function(e){return o[e](t)},function(e){return o[e](r)},t,r)};var l=[];var c=[];var d=[];var p=[];for(var u=0;u<n.length;u++){var f={value:i.mode==="dendrogram"?n[u]:[n[u]],key:u,index:u};l[u]=f;p[u]=f;c[u]=[];d[u]=0}for(var h=0;h<l.length;h++){for(var g=0;g<=h;g++){var y=e;if(i.mode==="dendrogram"){y=h===g?Infinity:s(l[h].value,l[g].value)}else{y=h===g?Infinity:s(l[h].value[0],l[g].value[0])}c[h][g]=y;c[g][h]=y;y<c[h][d[h]]&&(d[h]=g)}}var v=Nn(l,p,c,d,i);while(v){v=Nn(l,p,c,d,i)}var m;if(i.mode==="dendrogram"){m=qn(l[0],i.dendrogramDepth,a);i.addDendrogram&&jn(l[0],a)}else{m=new Array(l.length);l.forEach(function(e,t){e.key=e.index=null;m[t]=a.collection(e.value)})}return m};var $n={hierarchicalClustering:zn,hca:zn};var Vn=Wt({distance:"euclidean",preference:"median",damping:.8,maxIterations:1e3,minIterations:100,attributes:[]});var Fn=function e(t){var r=t.damping;var a=t.preference;.5<=r&&r<1||Lt("Damping must range on [0.5, 1).  Got: ".concat(r));var n=["median","mean","min","max"];n.some(function(e){
return e===a})||D(a)||Lt("Preference must be one of [".concat(n.map(function(e){return"'".concat(e,"'")}).join(", "),"] or a number.  Got: ").concat(a));return Vn(t)};var Wn=function e(t,r,a,n){var i=function e(t,r){return n[r](t)};return-hn(t,n.length,function(e){return i(r,e)},function(e){return i(a,e)},r,a)};var Hn=function e(t,r){var a=null;if(r==="median"){a=Or(t)}else if(r==="mean"){a=Ar(t)}else if(r==="min"){a=Dr(t)}else if(r==="max"){a=Br(t)}else{a=r}return a};var Xn=function e(t,r,a){var n=[];for(var i=0;i<t;i++){r[i*t+i]+a[i*t+i]>0&&n.push(i)}return n};var Yn=function e(t,r,a){var n=[];for(var i=0;i<t;i++){var o=-1,s=-Infinity;for(var l=0;l<a.length;l++){var c=a[l];if(r[i*t+c]>s){o=c;s=r[i*t+c]}}o>0&&n.push(o)}for(var d=0;d<a.length;d++){n[a[d]]=a[d]}return n};var Gn=function e(t,r,a){var n=Yn(t,r,a);for(var i=0;i<a.length;i++){var o=[];for(var s=0;s<n.length;s++){n[s]===a[i]&&o.push(s)}var l=-1,c=-Infinity;for(var d=0;d<o.length;d++){var p=0;for(var u=0;u<o.length;u++){p+=r[o[u]*t+o[d]]}if(p>c){l=d;c=p}}a[i]=o[l]}n=Yn(t,r,a);return n};var Kn=function e(t){var r=this.cy();var a=this.nodes();var n=Fn(t);var i={};for(var o=0;o<a.length;o++){i[a[o].id()]=o}var s;var l;var c;var d;var p;var u;s=a.length;l=s*s;c=new Array(l);for(var f=0;f<l;f++){c[f]=-Infinity}for(var h=0;h<s;h++){for(var g=0;g<s;g++){h!==g&&(c[h*s+g]=Wn(n.distance,a[h],a[g],n.attributes))}}d=Hn(c,n.preference);for(var y=0;y<s;y++){c[y*s+y]=d}p=new Array(l);for(var v=0;v<l;v++){p[v]=0}u=new Array(l);for(var m=0;m<l;m++){u[m]=0}var b=new Array(s);var x=new Array(s);var _=new Array(s);for(var w=0;w<s;w++){b[w]=0;x[w]=0;_[w]=0}var S=new Array(s*n.minIterations);for(var P=0;P<S.length;P++){S[P]=0}var C;for(C=0;C<n.maxIterations;C++){for(var E=0;E<s;E++){var T=-Infinity,I=-Infinity,k=-1,R=0;for(var D=0;D<s;D++){b[D]=p[E*s+D];R=u[E*s+D]+c[E*s+D];if(R>=T){I=T;T=R;k=D}else R>I&&(I=R)}for(var B=0;B<s;B++){p[E*s+B]=(1-n.damping)*(c[E*s+B]-T)+n.damping*b[B]}p[E*s+k]=(1-n.damping)*(c[E*s+k]-I)+n.damping*b[k]}for(var A=0;A<s;A++){var O=0;for(var L=0;L<s;L++){b[L]=u[L*s+A];x[L]=Math.max(0,p[L*s+A]);O+=x[L]}O-=x[A];x[A]=p[A*s+A];O+=x[A];for(var N=0;N<s;N++){u[N*s+A]=(1-n.damping)*Math.min(0,O-x[N])+n.damping*b[N]}u[A*s+A]=(1-n.damping)*(O-x[A])+n.damping*b[A]}var M=0;for(var j=0;j<s;j++){var q=u[j*s+j]+p[j*s+j]>0?1:0;S[C%n.minIterations*s+j]=q;M+=q}if(M>0&&(C>=n.minIterations-1||C==n.maxIterations-1)){var z=0;for(var $=0;$<s;$++){_[$]=0;for(var V=0;V<n.minIterations;V++){_[$]+=S[V*s+$]}(_[$]===0||_[$]===n.minIterations)&&z++}if(z===s){break}}}var F=Xn(s,p,u);var W=Gn(s,c,F);var H={};for(var X=0;X<F.length;X++){H[F[X]]=[]}for(var Y=0;Y<a.length;Y++){var G=i[a[Y].id()],K=W[G];K!=null&&H[K].push(a[Y])}var U=new Array(F.length);for(var Q=0;Q<F.length;Q++){U[Q]=r.collection(H[F[Q]])}return U};var Un={affinityPropagation:Kn,ap:Kn};var Qn=Wt({root:e,directed:!1});var Zn={hierholzer:function t(r){if(!k(r)){var a=arguments;r={root:a[0],directed:a[1]}}var n=Qn(r),i=n.root,o=n.directed;var s=this;var l=!1;var c;var d;var p;i&&(p=E(i)?this.filter(i)[0].id():i[0].id());var u={};var f={};if(o){s.forEach(function(t){var r=t.id();if(t.isNode()){var a=t.indegree(!0),n=t.outdegree(!0),i=a-n,o=n-a;if(i==1){if(c)l=!0;else c=r}else if(o==1){if(d)l=!0;else d=r}else(o>1||i>1)&&(l=!0);u[r]=[];t.outgoers().forEach(function(e){e.isEdge()&&u[r].push(e.id())})}else{f[r]=[e,t.target().id()]}})}else{s.forEach(function(e){var t=e.id();if(e.isNode()){var r=e.degree(!0);if(r%2){if(!c)c=t;else if(!d)d=t;else l=!0}u[t]=[];e.connectedEdges().forEach(function(e){return u[t].push(e.id())})}else{f[t]=[e.source().id(),e.target().id()]}})}var h={found:!1,trail:e};if(l)return h;else if(d&&c){if(o){if(p&&d!=p){return h}p=d}else{if(p&&d!=p&&c!=p){return h}else p||(p=d)}}else{p||(p=s[0].id())}var g=function e(t){var r=t;var a=[t];var n,i,s;while(u[r].length){n=u[r].shift();i=f[n][0];s=f[n][1];if(r!=s){u[s]=u[s].filter(function(e){return e!=n});r=s}else if(!o&&r!=i){u[i]=u[i].filter(function(e){return e!=n});r=i}a.unshift(n);a.unshift(r)}return a};var y=[];var v=[];v=g(p);while(v.length!=1){if(u[v[0]].length==0){y.unshift(s.getElementById(v.shift()));y.unshift(s.getElementById(v.shift()))}else{v=g(v.shift()).concat(v)}}y.unshift(s.getElementById(v.shift()));for(var m in u){if(u[m].length){return h}}h.found=!0;h.trail=this.spawn(y,!0);return h}};var Jn=function e(){var t=this;var r={};var a=0;var n=0;var i=[];var o=[];var s={};var l=function e(a,n){var s=o.length-1;var l=[];var c=t.spawn();while(o[s].x!=a||o[s].y!=n){l.push(o.pop().edge);s--}l.push(o.pop().edge);l.forEach(function(e){var a=e.connectedNodes().intersection(t);c.merge(e);a.forEach(function(e){var a=e.id();var n=e.connectedEdges().intersection(t);c.merge(e);if(!r[a].cutVertex){c.merge(n)}else{c.merge(n.filter(function(e){return e.isLoop()}))}})});i.push(c)};var c=function e(d,p,u){d===u&&(n+=1);r[p]={id:a,low:a++,cutVertex:!1};var f=t.getElementById(p).connectedEdges().intersection(t);if(f.size()===0){i.push(t.spawn(t.getElementById(p)))}else{var h,g,y,v;f.forEach(function(e){h=e.source().id();g=e.target().id();y=h===p?g:h;if(y!==u){v=e.id();if(!s[v]){s[v]=!0;o.push({x:p,y:y,edge:e})}if(!(y in r)){c(d,y,p);r[p].low=Math.min(r[p].low,r[y].low);if(r[p].id<=r[y].low){r[p].cutVertex=!0;l(p,y)}}else{r[p].low=Math.min(r[p].low,r[y].id)}}})}};t.forEach(function(e){if(e.isNode()){var t=e.id();if(!(t in r)){n=0;c(t,t);r[t].cutVertex=n>1}}});var d=Object.keys(r).filter(function(e){return r[e].cutVertex}).map(function(e){return t.getElementById(e)});return{cut:t.spawn(d),components:i}};var ei={hopcroftTarjanBiconnected:Jn,htbc:Jn,htb:Jn,hopcroftTarjanBiconnectedComponents:Jn};var ti=function e(){var t=this;var r={};var a=0;var n=[];var i=[];var o=t.spawn(t);var s=function e(l){i.push(l);r[l]={index:a,low:a++,explored:!1};var c=t.getElementById(l).connectedEdges().intersection(t);c.forEach(function(e){var t=e.target().id();if(t!==l){t in r||s(t);r[t].explored||(r[l].low=Math.min(r[l].low,r[t].low))}});if(r[l].index===r[l].low){var d=t.spawn();for(;;){var p=i.pop();d.merge(t.getElementById(p));r[p].low=r[l].index;r[p].explored=!0;if(p===l){break}}var u=d.edgesWith(d),f=d.merge(u);n.push(f);o=o.difference(f)}};t.forEach(function(e){if(e.isNode()){var t=e.id();t in r||s(t)}});return{cut:o,components:n}};var ri={tarjanStronglyConnected:ti,tsc:ti,tscc:ti,tarjanStronglyConnectedComponents:ti};var ai={};[ar,hr,gr,vr,br,_r,Cr,ja,za,Va,Wa,nn,Bn,$n,Un,Zn,ei,ri].forEach(function(e){oe(ai,e)});var ni=0;var ii=1;var oi=2;var si=function t(r){if(!(this instanceof si))return new si(r);this.id="Thenable/1.0.7";this.state=ni;this.fulfillValue=e;this.rejectReason=e;this.onFulfilled=[];this.onRejected=[];this.proxy={then:this.then.bind(this)};typeof r==="function"&&r.call(this,this.fulfill.bind(this),this.reject.bind(this))};si.prototype={fulfill:function e(t){return li(this,ii,"fulfillValue",t)},reject:function e(t){return li(this,oi,"rejectReason",t)},then:function e(t,r){var a=this;var n=new si;a.onFulfilled.push(pi(t,n,"fulfill"));a.onRejected.push(pi(r,n,"reject"));ci(a);return n.proxy}};var li=function e(t,r,a,n){if(t.state===ni){t.state=r;t[a]=n;ci(t)}return t};var ci=function e(t){if(t.state===ii)di(t,"onFulfilled",t.fulfillValue);else t.state===oi&&di(t,"onRejected",t.rejectReason)};var di=function e(t,r,a){if(t[r].length===0)return;var n=t[r];t[r]=[];var i=function e(){for(var t=0;t<n.length;t++)n[t](a)};if(typeof setImmediate==="function")setImmediate(i);else setTimeout(i,0)};var pi=function e(t,r,a){return function(e){if(typeof t!=="function")r[a].call(r,e);else{var n;try{n=t(e)}catch(e){r.reject(e);return}ui(r,n)}}};var ui=function e(t,r){if(t===r||t.proxy===r){t.reject(new TypeError("cannot resolve promise with itself"));return}var a;if(v(r)==="object"&&r!==null||typeof r==="function"){try{a=r.then}catch(e){t.reject(e);return}}if(typeof a==="function"){var n=!1;try{a.call(r,function(e){if(n)return;n=!0;if(e===r)t.reject(new TypeError("circular thenable chain"));else ui(t,e)},function(e){if(n)return;n=!0;t.reject(e)})}catch(e){if(!n)t.reject(e)}return}t.fulfill(r)};si.all=function(e){return new si(function(t,r){var a=new Array(e.length);var n=0;var i=function r(i,o){a[i]=o;n++;n===e.length&&t(a)};for(var o=0;o<e.length;o++){(function(t){var a=e[t];var n=a!=null&&a.then!=null;if(n){a.then(function(e){i(t,e)},function(e){r(e)})}else{var o=a;i(t,o)}})(o)}})};si.resolve=function(e){return new si(function(t,r){t(e)})};si.reject=function(e){return new si(function(t,r){r(e)})};var fi=typeof Promise!=="undefined"?Promise:si;var hi=function e(t,r,a){var n=M(t);var i=!n;var o=this._private=oe({duration:1e3},r,a);o.target=t;o.style=o.style||o.css;o.started=!1;o.playing=!1;o.hooked=!1;o.applying=!1;o.progress=0;o.completes=[];o.frames=[];o.complete&&T(o.complete)&&o.completes.push(o.complete);if(i){var s=t.position();o.startPosition=o.startPosition||{x:s.x,y:s.y};o.startStyle=o.startStyle||t.cy().style().getAnimationStartStyle(t,o.style)}if(n){var l=t.pan();o.startPan={x:l.x,y:l.y};o.startZoom=t.zoom()}this.length=1;this[0]=this};var gi=hi.prototype;oe(gi,{instanceString:function e(){return"animation"},hook:function e(){var t=this._private;if(!t.hooked){var r,a=t.target._private.animation;if(t.queue){r=a.queue}else{r=a.current}r.push(this);O(t.target)&&t.target.cy().addToAnimationPool(t.target);t.hooked=!0}return this},play:function e(){var t=this._private;t.progress===1&&(t.progress=0);t.playing=!0;t.started=!1;t.stopped=!1;this.hook();return this},playing:function e(){return this._private.playing},apply:function e(){var t=this._private;t.applying=!0;t.started=!1;t.stopped=!1;this.hook();return this},applying:function e(){return this._private.applying},pause:function e(){var t=this._private;t.playing=!1;t.started=!1;return this},stop:function e(){var t=this._private;t.playing=!1;t.started=!1;t.stopped=!0;return this},rewind:function e(){return this.progress(0)},fastforward:function e(){return this.progress(1)},time:function t(r){var a=this._private;if(r===e){return a.progress*a.duration}else{return this.progress(r/a.duration)}},progress:function t(r){var a=this._private;var n=a.playing;if(r===e){return a.progress}else{n&&this.pause();a.progress=r;a.started=!1;n&&this.play()}return this},completed:function e(){return this._private.progress===1},reverse:function e(){var t=this._private;var r=t.playing;r&&this.pause();t.progress=1-t.progress;t.started=!1;var a=function e(r,a){var n=t[r];if(n==null){return}t[r]=t[a];t[a]=n};a("zoom","startZoom");a("pan","startPan");a("position","startPosition");if(t.style){for(var n=0;n<t.style.length;n++){var i=t.style[n],o=i.name,s=t.startStyle[o];t.startStyle[o]=i;t.style[n]=s}}r&&this.play();return this},promise:function e(t){var r=this._private;var a;switch(t){case"frame":a=r.frames;break;default:case"complete":case"completed":a=r.completes}return new fi(function(e,t){a.push(function(){e()})})}});gi.complete=gi.completed;gi.run=gi.play;gi.running=gi.playing;var yi={animated:function t(){return function t(){var r=this;var a=r.length!==e;var n=a?r:[r];var i=this._private.cy||this;if(!i.styleEnabled()){return!1}var o=n[0];if(o){return o._private.animation.current.length>0}}},clearQueue:function t(){return function t(){var r=this;var a=r.length!==e;var n=a?r:[r];var i=this._private.cy||this;if(!i.styleEnabled()){return this}for(var o=0;o<n.length;o++){var s=n[o];s._private.animation.queue=[]}return this}},delay:function e(){return function e(t,r){var a=this._private.cy||this;if(!a.styleEnabled()){return this}return this.animate({delay:t,duration:t,complete:r})}},delayAnimation:function e(){return function e(t,r){var a=this._private.cy||this;if(!a.styleEnabled()){return this}return this.animation({delay:t,duration:t,complete:r})}},animation:function t(){return function t(r,a){var n=this;var i=n.length!==e;var o=i?n:[n];var s=this._private.cy||this;var l=!i;var c=!l;if(!s.styleEnabled()){return this}var d=s.style();r=oe({},r,a);var p=Object.keys(r).length===0;if(p){return new hi(o[0],r)}r.duration===e&&(r.duration=400);switch(r.duration){case"slow":r.duration=600;break;case"fast":r.duration=200;break}if(c){r.style=d.getPropsList(r.style||r.css);r.css=e}if(c&&r.renderedPosition!=null){var u=r.renderedPosition,f=s.pan(),h=s.zoom();r.position=kr(u,h,f)}if(l&&r.panBy!=null){var g=r.panBy,y=s.pan();r.pan={x:y.x+g.x,y:y.y+g.y}}var v=r.center||r.centre;if(l&&v!=null){var m=s.getCenterPan(v.eles,r.zoom);m!=null&&(r.pan=m)}if(l&&r.fit!=null){var b=r.fit,x=s.getFitViewport(b.eles||b.boundingBox,b.padding);if(x!=null){r.pan=x.pan;r.zoom=x.zoom}}if(l&&k(r.zoom)){var _=s.getZoomedViewport(r.zoom);if(_!=null){_.zoomed&&(r.zoom=_.zoom);_.panned&&(r.pan=_.pan)}else{r.zoom=null}}return new hi(o[0],r)}},animate:function t(){return function t(r,a){var n=this;var i=n.length!==e;var o=i?n:[n];var s=this._private.cy||this;if(!s.styleEnabled()){return this}a&&(r=oe({},r,a));for(var l=0;l<o.length;l++){var c=o[l],d=c.animated()&&(r.queue===e||r.queue),p=c.animation(r,d?{queue:!0}:e);p.play()}return this}},stop:function t(){return function t(r,a){var n=this;var i=n.length!==e;var o=i?n:[n];var s=this._private.cy||this;if(!s.styleEnabled()){return this}for(var l=0;l<o.length;l++){var c=o[l],d=c._private,p=d.animation.current;for(var u=0;u<p.length;u++){var f=p[u],h=f._private;a&&(h.duration=0)}r&&(d.animation.queue=[]);a||(d.animation.current=[])}s.notify("draw");return this}}};var vi;var mi;function bi(){if(mi)return vi;mi=1;var e=Array.isArray;vi=e;return vi}var xi;var _i;function wi(){if(_i)return xi;_i=1;var e=bi(),t=Ze();var r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;function n(n,i){if(e(n)){return!1}var o=typeof n;if(o=="number"||o=="symbol"||o=="boolean"||n==null||t(n)){return!0}return a.test(n)||!r.test(n)||i!=null&&n in Object(i)}xi=n;return xi}var Si;var Pi;function Ci(){if(Pi)return Si;Pi=1;var e=Xe(),t=be();var r="[object AsyncFunction]",a="[object Function]",n="[object GeneratorFunction]",i="[object Proxy]";function o(o){if(!t(o)){return!1}var s=e(o);return s==a||s==n||s==r||s==i}Si=o;return Si}var Ei;var Ti;function Ii(){if(Ti)return Ei;Ti=1;var e=Ce();var t=e["__core-js_shared__"];Ei=t;return Ei}var ki;var Ri;function Di(){if(Ri)return ki;Ri=1;var e=Ii();var t=function(){var t=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function r(e){return!!t&&t in e}ki=r;return ki}var Bi;var Ai;function Oi(){if(Ai)return Bi;Ai=1;var e=Function.prototype;var t=e.toString;function r(e){if(e!=null){try{return t.call(e)}catch(e){}try{return e+""}catch(e){}}return""}Bi=r;return Bi}var Li;var Ni;function Mi(){if(Ni)return Li;Ni=1;var e=Ci(),t=Di(),r=be(),a=Oi();var n=/[\\^$.*+?()[\]{}|]/g;var i=/^\[object .+?Constructor\]$/;var o=Function.prototype,s=Object.prototype;var l=o.toString;var c=s.hasOwnProperty;var d=RegExp("^"+l.call(c).replace(n,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function p(n){if(!r(n)||t(n)){return!1}var o=e(n)?d:i;return o.test(a(n))}Li=p;return Li}var ji;var qi;function zi(){if(qi)return ji;qi=1;function t(t,r){return t==null?e:t[r]}ji=t;return ji}var $i;var Vi;function Fi(){if(Vi)return $i;Vi=1;var t=Mi(),r=zi();function a(a,n){var i=r(a,n);return t(i)?i:e}$i=a;return $i}var Wi;var Hi;function Xi(){if(Hi)return Wi;Hi=1;var e=Fi();var t=e(Object,"create");Wi=t;return Wi}var Yi;var Gi;function Ki(){if(Gi)return Yi;Gi=1;var e=Xi();function t(){this.__data__=e?e(null):{};this.size=0}Yi=t;return Yi}var Ui;var Qi;function Zi(){if(Qi)return Ui;Qi=1;function e(e){var t=this.has(e)&&delete this.__data__[e];this.size-=t?1:0;return t}Ui=e;return Ui}var Ji;var eo;function to(){if(eo)return Ji;eo=1;var t=Xi();var r="__lodash_hash_undefined__";var a=Object.prototype;var n=a.hasOwnProperty;function i(a){var i=this.__data__;if(t){var o=i[a];return o===r?e:o}return n.call(i,a)?i[a]:e}Ji=i;return Ji}var ro;var ao;function no(){if(ao)return ro;ao=1;var t=Xi();var r=Object.prototype;var a=r.hasOwnProperty;function n(r){var n=this.__data__;return t?n[r]!==e:a.call(n,r)}ro=n;return ro}var io;var oo;function so(){if(oo)return io;oo=1;var t=Xi();var r="__lodash_hash_undefined__";function a(a,n){var i=this.__data__;this.size+=this.has(a)?0:1;i[a]=t&&n===e?r:n;return this}io=a;return io}var lo;var co;function po(){if(co)return lo;co=1;var e=Ki(),t=Zi(),r=to(),a=no(),n=so();function i(e){var t=-1,r=e==null?0:e.length;this.clear();while(++t<r){var a=e[t];this.set(a[0],a[1])}}i.prototype.clear=e;i.prototype["delete"]=t;i.prototype.get=r;i.prototype.has=a;i.prototype.set=n;lo=i;return lo}var uo;var fo;function ho(){if(fo)return uo;fo=1;function e(){this.__data__=[];this.size=0}uo=e;return uo}var go;var yo;function vo(){if(yo)return go;yo=1;function e(e,t){return e===t||e!==e&&t!==t}go=e;return go}var mo;var bo;function xo(){if(bo)return mo;bo=1;var e=vo();function t(t,r){var a=t.length;while(a--){if(e(t[a][0],r)){return a}}return-1}mo=t;return mo}var _o;var wo;function So(){if(wo)return _o;wo=1;var e=xo();var t=Array.prototype;var r=t.splice;function a(t){var a=this.__data__,n=e(a,t);if(n<0){return!1}var i=a.length-1;if(n==i){a.pop()}else{r.call(a,n,1)}--this.size;return!0}_o=a;return _o}var Po;var Co;function Eo(){if(Co)return Po;Co=1;var t=xo();function r(r){var a=this.__data__,n=t(a,r);return n<0?e:a[n][1]}Po=r;return Po}var To;var Io;function ko(){if(Io)return To;Io=1;var e=xo();function t(t){return e(this.__data__,t)>-1}To=t;return To}var Ro;var Do;function Bo(){if(Do)return Ro;Do=1;var e=xo();function t(t,r){var a=this.__data__,n=e(a,t);if(n<0){++this.size;a.push([t,r])}else{a[n][1]=r}return this}Ro=t;return Ro}var Ao;var Oo;function Lo(){if(Oo)return Ao;Oo=1;var e=ho(),t=So(),r=Eo(),a=ko(),n=Bo();function i(e){var t=-1,r=e==null?0:e.length;this.clear();while(++t<r){var a=e[t];this.set(a[0],a[1])}}i.prototype.clear=e;i.prototype["delete"]=t;i.prototype.get=r;i.prototype.has=a;i.prototype.set=n;Ao=i;return Ao}var No;var Mo;function jo(){if(Mo)return No;Mo=1;var e=Fi(),t=Ce();var r=e(t,"Map");No=r;return No}var qo;var zo;function $o(){if(zo)return qo;zo=1;var e=po(),t=Lo(),r=jo();function a(){this.size=0;this.__data__={hash:new e,map:new(r||t),string:new e}}qo=a;return qo}var Vo;var Fo;function Wo(){if(Fo)return Vo;Fo=1;function e(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}Vo=e;return Vo}var Ho;var Xo;function Yo(){if(Xo)return Ho;Xo=1;var e=Wo();function t(t,r){var a=t.__data__;return e(r)?a[typeof r=="string"?"string":"hash"]:a.map}Ho=t;return Ho}var Go;var Ko;function Uo(){if(Ko)return Go;Ko=1;var e=Yo();function t(t){var r=e(this,t)["delete"](t);this.size-=r?1:0;return r}Go=t;return Go}var Qo;var Zo;function Jo(){if(Zo)return Qo;Zo=1;var e=Yo();function t(t){return e(this,t).get(t)}Qo=t;return Qo}var es;var ts;function rs(){if(ts)return es;ts=1;var e=Yo();function t(t){return e(this,t).has(t)}es=t;return es}var as;var ns;function is(){if(ns)return as;ns=1;var e=Yo();function t(t,r){var a=e(this,t),n=a.size;a.set(t,r);this.size+=a.size==n?0:1;return this}as=t;return as}var os;var ss;function ls(){if(ss)return os;ss=1;var e=$o(),t=Uo(),r=Jo(),a=rs(),n=is();function i(e){var t=-1,r=e==null?0:e.length;this.clear();while(++t<r){var a=e[t];this.set(a[0],a[1])}}i.prototype.clear=e;i.prototype["delete"]=t;i.prototype.get=r;i.prototype.has=a;i.prototype.set=n;os=i;return os}var cs;var ds;function ps(){if(ds)return cs;ds=1;var e=ls();var t="Expected a function";function r(a,n){if(typeof a!="function"||n!=null&&typeof n!="function"){throw new TypeError(t)}var i=function(){var e=n?n.apply(this,arguments):arguments[0],t=i.cache;if(t.has(e)){return t.get(e)}var r=a.apply(this,arguments);i.cache=t.set(e,r)||t;return r};i.cache=new(r.Cache||e);return i}r.Cache=e;cs=r;return cs}var us;var fs;function hs(){if(fs)return us;fs=1;var e=ps();var t=500;function r(r){var a=e(r,function(e){n.size===t&&n.clear();return e});var n=a.cache;return a}us=r;return us}var gs;var ys;function vs(){if(ys)return gs;ys=1;var e=hs();var t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g;var r=/\\(\\)?/g;var a=e(function(e){var a=[];e.charCodeAt(0)===46&&a.push("");e.replace(t,function(e,t,n,i){a.push(n?i.replace(r,"$1"):t||e)});return a});gs=a;return gs}var ms;var bs;function xs(){if(bs)return ms;bs=1;function e(e,t){var r=-1,a=e==null?0:e.length,n=Array(a);while(++r<a){n[r]=t(e[r],r,e)}return n}ms=e;return ms}var _s;var ws;function Ss(){if(ws)return _s;ws=1;var t=Me(),r=xs(),a=bi(),n=Ze();var i=t?t.prototype:e,o=i?i.toString:e;function s(e){if(typeof e=="string"){return e}if(a(e)){return r(e,s)+""}if(n(e)){return o?o.call(e):""}var t=e+"";return t=="0"&&1/e==-Infinity?"-0":t}_s=s;return _s}var Ps;var Cs;function Es(){if(Cs)return Ps;Cs=1;var e=Ss();function t(t){return t==null?"":e(t)}Ps=t;return Ps}var Ts;var Is;function ks(){if(Is)return Ts;Is=1;var e=bi(),t=wi(),r=vs(),a=Es();function n(n,i){if(e(n)){return n}return t(n,i)?[n]:r(a(n))}Ts=n;return Ts}var Rs;var Ds;function Bs(){if(Ds)return Rs;Ds=1;var e=Ze();function t(t){if(typeof t=="string"||e(t)){return t}var r=t+"";return r=="0"&&1/t==-Infinity?"-0":r}Rs=t;return Rs}var As;var Os;function Ls(){if(Os)return As;Os=1;var t=ks(),r=Bs();function a(a,n){n=t(n,a);var i=0,o=n.length;while(a!=null&&i<o){a=a[r(n[i++])]}return i&&i==o?a:e}As=a;return As}var Ns;var Ms;function js(){if(Ms)return Ns;Ms=1;var t=Ls();function r(r,a,n){var i=r==null?e:t(r,a);return i===e?n:i}Ns=r;return Ns}var qs=js();var zs=ye(qs);var $s;var Vs;function Fs(){if(Vs)return $s;Vs=1;var e=Fi();var t=function(){try{var t=e(Object,"defineProperty");t({},"",{});return t}catch(e){}}();$s=t;return $s}var Ws;var Hs;function Xs(){if(Hs)return Ws;Hs=1;var e=Fs();function t(t,r,a){if(r=="__proto__"&&e){e(t,r,{configurable:!0,enumerable:!0,value:a,writable:!0})}else{t[r]=a}}Ws=t;return Ws}var Ys;var Gs;function Ks(){if(Gs)return Ys;Gs=1;var t=Xs(),r=vo();var a=Object.prototype;var n=a.hasOwnProperty;function i(a,i,o){var s=a[i];(!(n.call(a,i)&&r(s,o))||o===e&&!(i in a))&&t(a,i,o)}Ys=i;return Ys}var Us;var Qs;function Zs(){if(Qs)return Us;Qs=1;var e=9007199254740991;var t=/^(?:0|[1-9]\d*)$/;function r(r,a){var n=typeof r;a=a==null?e:a;return!!a&&(n=="number"||n!="symbol"&&t.test(r))&&(r>-1&&r%1==0&&r<a)}Us=r;return Us}var Js;var el;function tl(){if(el)return Js;el=1;var t=Ks(),r=ks(),a=Zs(),n=be(),i=Bs();function o(o,s,l,c){if(!n(o)){return o}s=r(s,o);var d=-1,p=s.length,u=p-1,f=o;while(f!=null&&++d<p){var h=i(s[d]),g=l;if(h==="__proto__"||h==="constructor"||h==="prototype"){return o}if(d!=u){var y=f[h];g=c?c(y,h,f):e;g===e&&(g=n(y)?y:a(s[d+1])?[]:{})}t(f,h,g);f=f[h]}return o}Js=o;return Js}var rl;var al;function nl(){if(al)return rl;al=1;var e=tl();function t(t,r,a){return t==null?t:e(t,r,a)}rl=t;return rl}var il=nl();var ol=ye(il);var sl;var ll;function cl(){if(ll)return sl;ll=1;function e(e,t){var r=-1,a=e.length;t||(t=Array(a));while(++r<a){t[r]=e[r]}return t}sl=e;return sl}var dl;var pl;function ul(){if(pl)return dl;pl=1;var e=xs(),t=cl(),r=bi(),a=Ze(),n=vs(),i=Bs(),o=Es();function s(s){if(r(s)){return e(s,i)}return a(s)?[s]:t(n(o(s)))}dl=s;return dl}var fl=ul();var hl=ye(fl);var gl={data:function t(r){var a={field:"data",bindingEvent:"data",allowBinding:!1,allowSetting:!1,allowGetting:!1,settingEvent:"data",settingTriggersEvent:!1,triggerFnName:"trigger",immutableKeys:{},updateStyle:!1,beforeGet:function e(t){},beforeSet:function e(t,r){},onSet:function e(t){},canSet:function e(t){return!0}};r=oe({},a,r);return function t(a,n){var i=r;var o=this;var s=o.length!==e;var c=s?o:[o];var d=s?o[0]:o;if(E(a)){var p=a.indexOf(".")!==-1,u=p&&hl(a);if(i.allowGetting&&n===e){var f;if(d){i.beforeGet(d);if(u&&d._private[i.field][a]===e){f=zs(d._private[i.field],u)}else{f=d._private[i.field][a]}}return f}else if(i.allowSetting&&n!==e){var h=!i.immutableKeys[a];if(h){var g=l({},a,n);i.beforeSet(o,g);for(var y=0,v=c.length;y<v;y++){var m=c[y];if(i.canSet(m)){if(u&&d._private[i.field][a]===e){ol(m._private[i.field],u,n)}else{m._private[i.field][a]=n}}}i.updateStyle&&o.updateStyle();i.onSet(o);i.settingTriggersEvent&&o[i.triggerFnName](i.settingEvent)}}}else if(i.allowSetting&&k(a)){var b=a,x,_,w=Object.keys(b);i.beforeSet(o,b);for(var S=0;S<w.length;S++){x=w[S];_=b[x];var P=!i.immutableKeys[x];if(P){for(var C=0;C<c.length;C++){var I=c[C];i.canSet(I)&&(I._private[i.field][x]=_)}}}i.updateStyle&&o.updateStyle();i.onSet(o);i.settingTriggersEvent&&o[i.triggerFnName](i.settingEvent)}else if(i.allowBinding&&T(a)){var R=a;o.on(i.bindingEvent,R)}else if(i.allowGetting&&a===e){var D;if(d){i.beforeGet(d);D=d._private[i.field]}return D}return o}},removeData:function t(r){var a={field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!1,immutableKeys:{}};r=oe({},a,r);return function t(a){var n=r;var i=this;var o=i.length!==e;var s=o?i:[i];if(E(a)){var l=a.split(/\s+/),c=l.length;for(var d=0;d<c;d++){var p=l[d];if(z(p)){continue}var u=!n.immutableKeys[p];if(u){for(var f=0,h=s.length;f<h;f++){s[f]._private[n.field][p]=e}}}n.triggerEvent&&i[n.triggerFnName](n.event)}else if(a===e){for(var g=0,y=s.length;g<y;g++){var v=s[g]._private[n.field],m=Object.keys(v);for(var b=0;b<m.length;b++){var x=m[b],_=!n.immutableKeys[x];_&&(v[x]=e)}}n.triggerEvent&&i[n.triggerFnName](n.event)}return i}}};var yl={eventAliasesOn:function e(t){var r=t;r.addListener=t.listen=t.bind=t.on;r.unlisten=t.unbind=t.off=t.removeListener;r.trigger=t.emit;r.pon=t.promiseOn=function(e,t){var r=this;var a=Array.prototype.slice.call(arguments,0);return new fi(function(e,t){var n=function t(a){r.off.apply(r,o);e(a)};var i=a.concat([n]);var o=i.concat([]);r.on.apply(r,i)})}}};var vl={};[yi,gl,yl].forEach(function(e){oe(vl,e)});var ml={animate:vl.animate(),animation:vl.animation(),animated:vl.animated(),clearQueue:vl.clearQueue(),delay:vl.delay(),delayAnimation:vl.delayAnimation(),stop:vl.stop()};var bl={classes:function t(r){var a=this;if(r===e){var n=[];a[0]._private.classes.forEach(function(e){return n.push(e)});return n}else I(r)||(r=(r||"").match(/\S+/g)||[]);var i=[];var o=new er(r);for(var s=0;s<a.length;s++){var l=a[s],c=l._private,d=c.classes,p=!1;for(var u=0;u<r.length;u++){var f=r[u],h=d.has(f);if(!h){p=!0;break}}p||(p=d.size!==r.length);if(p){c.classes=o;i.push(l)}}i.length>0&&this.spawn(i).updateStyle().emit("class");return a},addClass:function e(t){return this.toggleClass(t,!0)},hasClass:function e(t){var r=this[0];return r!=null&&r._private.classes.has(t)},toggleClass:function t(r,a){I(r)||(r=r.match(/\S+/g)||[]);var n=this;var i=a===e;var o=[];for(var s=0,l=n.length;s<l;s++){var c=n[s],d=c._private.classes,p=!1;for(var u=0;u<r.length;u++){var f=r[u],h=d.has(f),g=!1;if(a||i&&!h){d.add(f);g=!0}else if(!a||i&&h){d["delete"](f);g=!0}if(!p&&g){o.push(c);p=!0}}}o.length>0&&this.spawn(o).updateStyle().emit("class");return n},removeClass:function e(t){return this.toggleClass(t,!1)},flashClass:function e(t,r){var a=this;if(r==null){r=250}else if(r===0){return a}a.addClass(t);setTimeout(function(){a.removeClass(t)},r);return a}};bl.className=bl.classNames=bl.classes;var xl={metaChar:"[\\!\\\"\\#\\$\\%\\&\\'\\(\\)\\*\\+\\,\\.\\/\\:\\;\\<\\=\\>\\?\\@\\[\\]\\^\\`\\{\\|\\}\\~]",comparatorOp:"=|\\!=|>|>=|<|<=|\\$=|\\^=|\\*=",boolOp:"\\?|\\!|\\^",string:'"(?:\\\\"|[^"])*"'+"|"+"'(?:\\\\'|[^'])*'",number:Q,meta:"degree|indegree|outdegree",separator:"\\s*,\\s*",descendant:"\\s+",child:"\\s+>\\s+",subject:"\\$",group:"node|edge|\\*",directedEdge:"\\s+->\\s+",undirectedEdge:"\\s+<->\\s+"};xl.variable="(?:[\\w-.]|(?:\\\\"+xl.metaChar+"))+";xl.className="(?:[\\w-]|(?:\\\\"+xl.metaChar+"))+";xl.value=xl.string+"|"+xl.number;xl.id=xl.variable;(function(){var e,t,r;e=xl.comparatorOp.split("|");for(r=0;r<e.length;r++){t=e[r];xl.comparatorOp+="|@"+t}e=xl.comparatorOp.split("|");for(r=0;r<e.length;r++){t=e[r];if(t.indexOf("!")>=0){continue}if(t==="="){continue}xl.comparatorOp+="|\\!"+t}})();var _l=function e(){return{checks:[]}};var wl={GROUP:0,COLLECTION:1,FILTER:2,DATA_COMPARE:3,DATA_EXIST:4,DATA_BOOL:5,META_COMPARE:6,STATE:7,ID:8,CLASS:9,UNDIRECTED_EDGE:10,DIRECTED_EDGE:11,NODE_SOURCE:12,NODE_TARGET:13,NODE_NEIGHBOR:14,CHILD:15,DESCENDANT:16,PARENT:17,ANCESTOR:18,COMPOUND_SPLIT:19,TRUE:20};var Sl=[{selector:":selected",matches:function e(t){return t.selected()}},{selector:":unselected",matches:function e(t){return!t.selected()}},{selector:":selectable",matches:function e(t){return t.selectable()}},{selector:":unselectable",matches:function e(t){return!t.selectable()}},{selector:":locked",matches:function e(t){return t.locked()}},{selector:":unlocked",matches:function e(t){return!t.locked()}},{selector:":visible",matches:function e(t){return t.visible()}},{selector:":hidden",matches:function e(t){return!t.visible()}},{selector:":transparent",matches:function e(t){return t.transparent()}},{selector:":grabbed",matches:function e(t){return t.grabbed()}},{selector:":free",matches:function e(t){return!t.grabbed()}},{selector:":removed",matches:function e(t){return t.removed()}},{selector:":inside",matches:function e(t){return!t.removed()}},{selector:":grabbable",matches:function e(t){return t.grabbable()}},{selector:":ungrabbable",matches:function e(t){return!t.grabbable()}},{selector:":animated",matches:function e(t){return t.animated()}},{selector:":unanimated",matches:function e(t){return!t.animated()}},{selector:":parent",matches:function e(t){return t.isParent()}},{selector:":childless",matches:function e(t){return t.isChildless()}},{selector:":child",matches:function e(t){return t.isChild()}},{selector:":orphan",matches:function e(t){return t.isOrphan()}},{selector:":nonorphan",matches:function e(t){return t.isChild()}},{selector:":compound",matches:function e(t){if(t.isNode()){return t.isParent()}else{return t.source().isParent()||t.target().isParent()}}},{selector:":loop",matches:function e(t){return t.isLoop()}},{selector:":simple",matches:function e(t){return t.isSimple()}},{selector:":active",matches:function e(t){return t.active()}},{selector:":inactive",matches:function e(t){return!t.active()}},{selector:":backgrounding",matches:function e(t){return t.backgrounding()}},{selector:":nonbackgrounding",matches:function e(t){return!t.backgrounding()}}].sort(function(e,t){return ie(e.selector,t.selector)});var Pl=function(){var e={};var t;for(var r=0;r<Sl.length;r++){t=Sl[r];e[t.selector]=t.matches}return e}();var Cl=function e(t,r){return Pl[t](r)};var El="("+Sl.map(function(e){return e.selector}).join("|")+")";var Tl=function e(t){return t.replace(new RegExp("\\\\("+xl.metaChar+")","g"),function(e,t){return t})};var Il=function e(t,r,a){t[t.length-1]=a};var kl=[{name:"group",query:!0,regex:"("+xl.group+")",populate:function e(t,r,a){var n=f(a,1),i=n[0];r.checks.push({type:wl.GROUP,value:i==="*"?i:i+"s"})}},{name:"state",query:!0,regex:El,populate:function e(t,r,a){var n=f(a,1),i=n[0];r.checks.push({type:wl.STATE,value:i})}},{name:"id",query:!0,regex:"\\#("+xl.id+")",populate:function e(t,r,a){var n=f(a,1),i=n[0];r.checks.push({type:wl.ID,value:Tl(i)})}},{name:"className",query:!0,regex:"\\.("+xl.className+")",populate:function e(t,r,a){var n=f(a,1),i=n[0];r.checks.push({type:wl.CLASS,value:Tl(i)})}},{name:"dataExists",query:!0,regex:"\\[\\s*("+xl.variable+")\\s*\\]",populate:function e(t,r,a){var n=f(a,1),i=n[0];r.checks.push({type:wl.DATA_EXIST,field:Tl(i)})}},{name:"dataCompare",query:!0,regex:"\\[\\s*("+xl.variable+")\\s*("+xl.comparatorOp+")\\s*("+xl.value+")\\s*\\]",populate:function e(t,r,a){var n=f(a,3),i=n[0],o=n[1],s=n[2];var l=new RegExp("^"+xl.string+"$").exec(s)!=null;if(l){s=s.substring(1,s.length-1)}else{s=parseFloat(s)}r.checks.push({type:wl.DATA_COMPARE,field:Tl(i),operator:o,value:s})}},{name:"dataBool",query:!0,regex:"\\[\\s*("+xl.boolOp+")\\s*("+xl.variable+")\\s*\\]",populate:function e(t,r,a){var n=f(a,2),i=n[0],o=n[1];r.checks.push({type:wl.DATA_BOOL,field:Tl(o),operator:i})}},{name:"metaCompare",query:!0,regex:"\\[\\[\\s*("+xl.meta+")\\s*("+xl.comparatorOp+")\\s*("+xl.number+")\\s*\\]\\]",populate:function e(t,r,a){
var n=f(a,3),i=n[0],o=n[1],s=n[2];r.checks.push({type:wl.META_COMPARE,field:Tl(i),operator:o,value:parseFloat(s)})}},{name:"nextQuery",separator:!0,regex:xl.separator,populate:function e(t,r){var a=t.currentSubject;var n=t.edgeCount;var i=t.compoundCount;var o=t[t.length-1];if(a!=null){o.subject=a;t.currentSubject=null}o.edgeCount=n;o.compoundCount=i;t.edgeCount=0;t.compoundCount=0;var s=t[t.length++]=_l();return s}},{name:"directedEdge",separator:!0,regex:xl.directedEdge,populate:function e(t,r){if(t.currentSubject==null){var a=_l(),n=r,i=_l();a.checks.push({type:wl.DIRECTED_EDGE,source:n,target:i});Il(t,r,a);t.edgeCount++;return i}else{var o=_l(),s=r,l=_l();o.checks.push({type:wl.NODE_SOURCE,source:s,target:l});Il(t,r,o);t.edgeCount++;return l}}},{name:"undirectedEdge",separator:!0,regex:xl.undirectedEdge,populate:function e(t,r){if(t.currentSubject==null){var a=_l(),n=r,i=_l();a.checks.push({type:wl.UNDIRECTED_EDGE,nodes:[n,i]});Il(t,r,a);t.edgeCount++;return i}else{var o=_l(),s=r,l=_l();o.checks.push({type:wl.NODE_NEIGHBOR,node:s,neighbor:l});Il(t,r,o);return l}}},{name:"child",separator:!0,regex:xl.child,populate:function e(t,r){if(t.currentSubject==null){var a=_l(),n=_l(),i=t[t.length-1];a.checks.push({type:wl.CHILD,parent:i,child:n});Il(t,r,a);t.compoundCount++;return n}else if(t.currentSubject===r){var o=_l(),s=t[t.length-1],l=_l(),c=_l(),d=_l(),p=_l();o.checks.push({type:wl.COMPOUND_SPLIT,left:s,right:l,subject:c});c.checks=r.checks;r.checks=[{type:wl.TRUE}];p.checks.push({type:wl.TRUE});l.checks.push({type:wl.PARENT,parent:p,child:d});Il(t,s,o);t.currentSubject=c;t.compoundCount++;return d}else{var u=_l(),f=_l(),h=[{type:wl.PARENT,parent:u,child:f}];u.checks=r.checks;r.checks=h;t.compoundCount++;return f}}},{name:"descendant",separator:!0,regex:xl.descendant,populate:function e(t,r){if(t.currentSubject==null){var a=_l(),n=_l(),i=t[t.length-1];a.checks.push({type:wl.DESCENDANT,ancestor:i,descendant:n});Il(t,r,a);t.compoundCount++;return n}else if(t.currentSubject===r){var o=_l(),s=t[t.length-1],l=_l(),c=_l(),d=_l(),p=_l();o.checks.push({type:wl.COMPOUND_SPLIT,left:s,right:l,subject:c});c.checks=r.checks;r.checks=[{type:wl.TRUE}];p.checks.push({type:wl.TRUE});l.checks.push({type:wl.ANCESTOR,ancestor:p,descendant:d});Il(t,s,o);t.currentSubject=c;t.compoundCount++;return d}else{var u=_l(),f=_l(),h=[{type:wl.ANCESTOR,ancestor:u,descendant:f}];u.checks=r.checks;r.checks=h;t.compoundCount++;return f}}},{name:"subject",modifier:!0,regex:xl.subject,populate:function e(t,r){if(t.currentSubject!=null&&t.currentSubject!==r){Mt("Redefinition of subject in selector `"+t.toString()+"`");return!1}t.currentSubject=r;var a=t[t.length-1];var n=a.checks[0];var i=n==null?null:n.type;if(i===wl.DIRECTED_EDGE){n.type=wl.NODE_TARGET}else if(i===wl.UNDIRECTED_EDGE){n.type=wl.NODE_NEIGHBOR;n.node=n.nodes[1];n.neighbor=n.nodes[0];n.nodes=null}}}];kl.forEach(function(e){return e.regexObj=new RegExp("^"+e.regex)});var Rl=function e(t){var r;var a;var n;for(var i=0;i<kl.length;i++){var o=kl[i],s=o.name,l=t.match(o.regexObj);if(l!=null){a=l;r=o;n=s;var c=l[0];t=t.substring(c.length);break}}return{expr:r,match:a,name:n,remaining:t}};var Dl=function e(t){var r=t.match(/^\s+/);if(r){var a=r[0];t=t.substring(a.length)}return t};var Bl=function e(t){var r=this;var a=r.inputText=t;var n=r[0]=_l();r.length=1;a=Dl(a);for(;;){var i=Rl(a);if(i.expr==null){Mt("The selector `"+t+"`is invalid");return!1}else{var o=i.match.slice(1),s=i.expr.populate(r,n,o);if(s===!1){return!1}else s!=null&&(n=s)}a=i.remaining;if(a.match(/^\s*$/)){break}}var l=r[r.length-1];r.currentSubject!=null&&(l.subject=r.currentSubject);l.edgeCount=r.edgeCount;l.compoundCount=r.compoundCount;for(var c=0;c<r.length;c++){var d=r[c];if(d.compoundCount>0&&d.edgeCount>0){Mt("The selector `"+t+"` is invalid because it uses both a compound selector and an edge selector");return!1}if(d.edgeCount>1){Mt("The selector `"+t+"` is invalid because it uses multiple edge selectors");return!1}else d.edgeCount===1&&Mt("The selector `"+t+"` is deprecated.  Edge selectors do not take effect on changes to source and target nodes after an edge is added, for performance reasons.  Use a class or data selector on edges instead, updating the class or data of an edge when your app detects a change in source or target nodes.")}return!0};var Al=function e(){if(this.toStringCache!=null){return this.toStringCache}var t=function e(t){if(t==null){return""}else{return t}};var r=function e(r){if(E(r)){return'"'+r+'"'}else{return t(r)}};var a=function e(t){return" "+t+" "};var n=function e(n,o){var s=n.type,l=n.value;switch(s){case wl.GROUP:var c=t(l);return c.substring(0,c.length-1);case wl.DATA_COMPARE:var d=n.field,p=n.operator;return"["+d+a(t(p))+r(l)+"]";case wl.DATA_BOOL:var u=n.operator,f=n.field;return"["+t(u)+f+"]";case wl.DATA_EXIST:var h=n.field;return"["+h+"]";case wl.META_COMPARE:var g=n.operator,y=n.field;return"[["+y+a(t(g))+r(l)+"]]";case wl.STATE:return l;case wl.ID:return"#"+l;case wl.CLASS:return"."+l;case wl.PARENT:case wl.CHILD:return i(n.parent,o)+a(">")+i(n.child,o);case wl.ANCESTOR:case wl.DESCENDANT:return i(n.ancestor,o)+" "+i(n.descendant,o);case wl.COMPOUND_SPLIT:var v=i(n.left,o),m=i(n.subject,o),b=i(n.right,o);return v+(v.length>0?" ":"")+m+b;case wl.TRUE:return""}};var i=function e(t,r){return t.checks.reduce(function(e,a,i){return e+(r===t&&i===0?"$":"")+n(a,r)},"")};var o="";for(var s=0;s<this.length;s++){var l=this[s];o+=i(l,l.subject);this.length>1&&s<this.length-1&&(o+=", ")}this.toStringCache=o;return o};var Ol={parse:Bl,toString:Al};var Ll=function e(t,r,a){var n;var i=E(t);var o=D(t);var s=E(a);var l,c;var d=!1;var p=!1;var u=!1;if(r.indexOf("!")>=0){r=r.replace("!","");p=!0}if(r.indexOf("@")>=0){r=r.replace("@","");d=!0}if(i||s||d){l=!i&&!o?"":""+t;c=""+a}if(d){t=l=l.toLowerCase();a=c=c.toLowerCase()}switch(r){case"*=":n=l.indexOf(c)>=0;break;case"$=":n=l.indexOf(c,l.length-c.length)>=0;break;case"^=":n=l.indexOf(c)===0;break;case"=":n=t===a;break;case">":u=!0;n=t>a;break;case">=":u=!0;n=t>=a;break;case"<":u=!0;n=t<a;break;case"<=":u=!0;n=t<=a;break;default:n=!1;break}p&&(t!=null||!u)&&(n=!n);return n};var Nl=function t(r,a){switch(a){case"?":return r?!0:!1;case"!":return r?!1:!0;case"^":return r===e}};var Ml=function t(r){return r!==e};var jl=function e(t,r){return t.data(r)};var ql=function e(t,r){return t[r]()};var zl=[];var $l=function e(t,r){return t.checks.every(function(e){return zl[e.type](e,r)})};zl[wl.GROUP]=function(e,t){var r=e.value;return r==="*"||r===t.group()};zl[wl.STATE]=function(e,t){var r=e.value;return Cl(r,t)};zl[wl.ID]=function(e,t){var r=e.value;return t.id()===r};zl[wl.CLASS]=function(e,t){var r=e.value;return t.hasClass(r)};zl[wl.META_COMPARE]=function(e,t){var r=e.field,a=e.operator,n=e.value;return Ll(ql(t,r),a,n)};zl[wl.DATA_COMPARE]=function(e,t){var r=e.field,a=e.operator,n=e.value;return Ll(jl(t,r),a,n)};zl[wl.DATA_BOOL]=function(e,t){var r=e.field,a=e.operator;return Nl(jl(t,r),a)};zl[wl.DATA_EXIST]=function(e,t){var r=e.field;e.operator;return Ml(jl(t,r))};zl[wl.UNDIRECTED_EDGE]=function(e,t){var r=e.nodes[0];var a=e.nodes[1];var n=t.source();var i=t.target();return $l(r,n)&&$l(a,i)||$l(a,n)&&$l(r,i)};zl[wl.NODE_NEIGHBOR]=function(e,t){return $l(e.node,t)&&t.neighborhood().some(function(t){return t.isNode()&&$l(e.neighbor,t)})};zl[wl.DIRECTED_EDGE]=function(e,t){return $l(e.source,t.source())&&$l(e.target,t.target())};zl[wl.NODE_SOURCE]=function(e,t){return $l(e.source,t)&&t.outgoers().some(function(t){return t.isNode()&&$l(e.target,t)})};zl[wl.NODE_TARGET]=function(e,t){return $l(e.target,t)&&t.incomers().some(function(t){return t.isNode()&&$l(e.source,t)})};zl[wl.CHILD]=function(e,t){return $l(e.child,t)&&$l(e.parent,t.parent())};zl[wl.PARENT]=function(e,t){return $l(e.parent,t)&&t.children().some(function(t){return $l(e.child,t)})};zl[wl.DESCENDANT]=function(e,t){return $l(e.descendant,t)&&t.ancestors().some(function(t){return $l(e.ancestor,t)})};zl[wl.ANCESTOR]=function(e,t){return $l(e.ancestor,t)&&t.descendants().some(function(t){return $l(e.descendant,t)})};zl[wl.COMPOUND_SPLIT]=function(e,t){return $l(e.subject,t)&&$l(e.left,t)&&$l(e.right,t)};zl[wl.TRUE]=function(){return!0};zl[wl.COLLECTION]=function(e,t){var r=e.value;return r.has(t)};zl[wl.FILTER]=function(e,t){var r=e.value;return r(t)};var Vl=function e(t){var r=this;if(r.length===1&&r[0].checks.length===1&&r[0].checks[0].type===wl.ID){return t.getElementById(r[0].checks[0].value).collection()}var a=function e(t){for(var a=0;a<r.length;a++){var n=r[a];if($l(n,t)){return!0}}return!1};r.text()==null&&(a=function e(){return!0});return t.filter(a)};var Fl=function e(t){var r=this;for(var a=0;a<r.length;a++){var n=r[a];if($l(n,t)){return!0}}return!1};var Wl={matches:Fl,filter:Vl};var Hl=function e(t){this.inputText=t;this.currentSubject=null;this.compoundCount=0;this.edgeCount=0;this.length=0;if(t==null||E(t)&&t.match(/^\s*$/));else if(O(t)){this.addQuery({checks:[{type:wl.COLLECTION,value:t.collection()}]})}else if(T(t)){this.addQuery({checks:[{type:wl.FILTER,value:t}]})}else if(E(t)){this.parse(t)||(this.invalid=!0)}else{Lt("A selector must be created from a string; found ")}};var Xl=Hl.prototype;[Ol,Wl].forEach(function(e){return oe(Xl,e)});Xl.text=function(){return this.inputText};Xl.size=function(){return this.length};Xl.eq=function(e){return this[e]};Xl.sameText=function(e){return!this.invalid&&!e.invalid&&this.text()===e.text()};Xl.addQuery=function(e){this[this.length++]=e};Xl.selector=Xl.toString;var Yl={allAre:function e(t){var r=new Hl(t);return this.every(function(e){return r.matches(e)})},is:function e(t){var r=new Hl(t);return this.some(function(e){return r.matches(e)})},some:function e(t,r){for(var a=0;a<this.length;a++){var n=!r?t(this[a],a,this):t.apply(r,[this[a],a,this]);if(n){return!0}}return!1},every:function e(t,r){for(var a=0;a<this.length;a++){var n=!r?t(this[a],a,this):t.apply(r,[this[a],a,this]);if(!n){return!1}}return!0},same:function e(t){if(this===t){return!0}t=this.cy().collection(t);var r=this.length;var a=t.length;if(r!==a){return!1}if(r===1){return this[0]===t[0]}return this.every(function(e){return t.hasElementWithId(e.id())})},anySame:function e(t){t=this.cy().collection(t);return this.some(function(e){return t.hasElementWithId(e.id())})},allAreNeighbors:function e(t){t=this.cy().collection(t);var r=this.neighborhood();return t.every(function(e){return r.hasElementWithId(e.id())})},contains:function e(t){t=this.cy().collection(t);var r=this;return t.every(function(e){return r.hasElementWithId(e.id())})}};Yl.allAreNeighbours=Yl.allAreNeighbors;Yl.has=Yl.contains;Yl.equal=Yl.equals=Yl.same;var Gl=function e(t,r){return function e(a,n,i,o){var s=this;var l;if(a==null){l=""}else O(a)&&a.length===1&&(l=a.id());if(s.length===1&&l){var c=s[0]._private,d=c.traversalCache=c.traversalCache||{},p=d[r]=d[r]||[],u=_t(l),f=p[u];if(f){return f}else{return p[u]=t.call(s,a,n,i,o)}}else{return t.call(s,a,n,i,o)}}};var Kl={parent:function e(t){var r=[];if(this.length===1){var e=this[0]._private.parent;if(e){return e}}for(var a=0;a<this.length;a++){var n=this[a],i=n._private.parent;i&&r.push(i)}return this.spawn(r,!0).filter(t)},parents:function e(t){var e=[];var r=this.parent();while(r.nonempty()){for(var a=0;a<r.length;a++){var n=r[a];e.push(n)}r=r.parent()}return this.spawn(e,!0).filter(t)},commonAncestors:function e(t){var r;for(var a=0;a<this.length;a++){var n=this[a],i=n.parents();r=r||i;r=r.intersect(i)}return r.filter(t)},orphans:function e(t){return this.stdFilter(function(e){return e.isOrphan()}).filter(t)},nonorphans:function e(t){return this.stdFilter(function(e){return e.isChild()}).filter(t)},children:Gl(function(e){var t=[];for(var r=0;r<this.length;r++){var a=this[r],n=a._private.children;for(var i=0;i<n.length;i++){t.push(n[i])}}return this.spawn(t,!0).filter(e)},"children"),siblings:function e(t){return this.parent().children().not(this).filter(t)},isParent:function e(){var t=this[0];if(t){return t.isNode()&&t._private.children.length!==0}},isChildless:function e(){var t=this[0];if(t){return t.isNode()&&t._private.children.length===0}},isChild:function e(){var t=this[0];if(t){return t.isNode()&&t._private.parent!=null}},isOrphan:function e(){var t=this[0];if(t){return t.isNode()&&t._private.parent==null}},descendants:function e(t){var r=[];function a(e){for(var t=0;t<e.length;t++){var n=e[t];r.push(n);n.children().nonempty()&&a(n.children())}}a(this.children());return this.spawn(r,!0).filter(t)}};function Ul(e,t,r,a){var n=[];var i=new er;var o=e.cy();var s=o.hasCompoundNodes();for(var l=0;l<e.length;l++){var c=e[l];if(r){n.push(c)}else s&&a(n,i,c)}while(n.length>0){var d=n.shift();t(d);i.add(d.id());s&&a(n,i,d)}return e}function Ql(e,t,r){if(r.isParent()){var a=r._private.children;for(var n=0;n<a.length;n++){var i=a[n];t.has(i.id())||e.push(i)}}}Kl.forEachDown=function(t){var r=arguments.length>1&&arguments[1]!==e?arguments[1]:!0;return Ul(this,t,r,Ql)};function Zl(e,t,r){if(r.isChild()){var a=r._private.parent;t.has(a.id())||e.push(a)}}Kl.forEachUp=function(t){var r=arguments.length>1&&arguments[1]!==e?arguments[1]:!0;return Ul(this,t,r,Zl)};function Jl(e,t,r){Zl(e,t,r);Ql(e,t,r)}Kl.forEachUpAndDown=function(t){var r=arguments.length>1&&arguments[1]!==e?arguments[1]:!0;return Ul(this,t,r,Jl)};Kl.ancestors=Kl.parents;var ec,tc;ec=tc={data:vl.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),removeData:vl.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),scratch:vl.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:vl.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),rscratch:vl.data({field:"rscratch",allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!0}),removeRscratch:vl.removeData({field:"rscratch",triggerEvent:!1}),id:function e(){var t=this[0];if(t){return t._private.data.id}}};ec.attr=ec.data;ec.removeAttr=ec.removeData;var rc=tc;var ac={};function nc(t){return function(r){var a=this;r===e&&(r=!0);if(a.length===0){return}if(a.isNode()&&!a.removed()){var n=0,i=a[0],o=i._private.edges;for(var s=0;s<o.length;s++){var l=o[s];if(!r&&l.isLoop()){continue}n+=t(i,l)}return n}else{return}}}oe(ac,{degree:nc(function(e,t){if(t.source().same(t.target())){return 2}else{return 1}}),indegree:nc(function(e,t){if(t.target().same(e)){return 1}else{return 0}}),outdegree:nc(function(e,t){if(t.source().same(e)){return 1}else{return 0}})});function ic(t,r){return function(a){var n;var i=this.nodes();for(var o=0;o<i.length;o++){var s=i[o],l=s[t](a);l!==e&&(n===e||r(l,n))&&(n=l)}return n}}oe(ac,{minDegree:ic("degree",function(e,t){return e<t}),maxDegree:ic("degree",function(e,t){return e>t}),minIndegree:ic("indegree",function(e,t){return e<t}),maxIndegree:ic("indegree",function(e,t){return e>t}),minOutdegree:ic("outdegree",function(e,t){return e<t}),maxOutdegree:ic("outdegree",function(e,t){return e>t})});oe(ac,{totalDegree:function e(t){var r=0;var a=this.nodes();for(var n=0;n<a.length;n++){r+=a[n].degree(t)}return r}});var oc,sc;var lc=function e(t,r,a){for(var n=0;n<t.length;n++){var i=t[n];if(!i.locked()){var o=i._private.position,s={x:r.x!=null?r.x-o.x:0,y:r.y!=null?r.y-o.y:0};i.isParent()&&!(s.x===0&&s.y===0)&&i.children().shift(s,a);i.dirtyBoundingBoxCache()}}};var cc={field:"position",bindingEvent:"position",allowBinding:!0,allowSetting:!0,settingEvent:"position",settingTriggersEvent:!0,triggerFnName:"emitAndNotify",allowGetting:!0,validKeys:["x","y"],beforeGet:function e(t){t.updateCompoundBounds()},beforeSet:function e(t,r){lc(t,r,!1)},onSet:function e(t){t.dirtyCompoundBoundsCache()},canSet:function e(t){return!t.locked()}};oc=sc={position:vl.data(cc),silentPosition:vl.data(oe({},cc,{allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!1,beforeSet:function e(t,r){lc(t,r,!0)},onSet:function e(t){t.dirtyCompoundBoundsCache()}})),positions:function t(r,a){if(k(r)){if(a){this.silentPosition(r)}else{this.position(r)}}else if(T(r)){var n=r,i=this.cy();i.startBatch();for(var o=0;o<this.length;o++){var s=this[o],l=e;if(l=n(s,o)){if(a){s.silentPosition(l)}else{s.position(l)}}}i.endBatch()}return this},silentPositions:function e(t){return this.positions(t,!0)},shift:function e(t,r,a){var n;if(k(t)){n={x:D(t.x)?t.x:0,y:D(t.y)?t.y:0};a=r}else if(E(t)&&D(r)){n={x:0,y:0};n[t]=r}if(n!=null){var i=this.cy();i.startBatch();for(var o=0;o<this.length;o++){var s=this[o];if(i.hasCompoundNodes()&&s.isChild()&&s.ancestors().anySame(this)){continue}var l=s.position(),c={x:l.x+n.x,y:l.y+n.y};if(a){s.silentPosition(c)}else{s.position(c)}}i.endBatch()}return this},silentShift:function e(t,r){if(k(t)){this.shift(t,!0)}else E(t)&&D(r)&&this.shift(t,r,!0);return this},renderedPosition:function t(r,a){var n=this[0];var i=this.cy();var o=i.zoom();var s=i.pan();var l=k(r)?r:e;var c=l!==e||a!==e&&E(r);if(n&&n.isNode()){if(c){for(var d=0;d<this.length;d++){var p=this[d];if(a!==e){p.position(r,(a-s[r])/o)}else l!==e&&p.position(kr(l,o,s))}}else{var u=n.position();l=Ir(u,o,s);if(r===e){return l}else{return l[r]}}}else if(!c){return e}return this},relativePosition:function t(r,a){var n=this[0];var i=this.cy();var o=k(r)?r:e;var s=o!==e||a!==e&&E(r);var l=i.hasCompoundNodes();if(n&&n.isNode()){if(s){for(var c=0;c<this.length;c++){var d=this[c],p=l?d.parent():null,u=p&&p.length>0,f=u;u&&(p=p[0]);var h=f?p.position():{x:0,y:0};if(a!==e){d.position(r,a+h[r])}else o!==e&&d.position({x:o.x+h.x,y:o.y+h.y})}}else{var g=n.position(),y=l?n.parent():null,v=y&&y.length>0,m=v;v&&(y=y[0]);var b=m?y.position():{x:0,y:0};o={x:g.x-b.x,y:g.y-b.y};if(r===e){return o}else{return o[r]}}}else if(!s){return e}return this}};oc.modelPosition=oc.point=oc.position;oc.modelPositions=oc.points=oc.positions;oc.renderedPoint=oc.renderedPosition;oc.relativePoint=oc.relativePosition;var dc=sc;var pc,uc;pc=uc={};uc.renderedBoundingBox=function(e){var t=this.boundingBox(e);var r=this.cy();var a=r.zoom();var n=r.pan();var i=t.x1*a+n.x;var o=t.x2*a+n.x;var s=t.y1*a+n.y;var l=t.y2*a+n.y;return{x1:i,x2:o,y1:s,y2:l,w:o-i,h:l-s}};uc.dirtyCompoundBoundsCache=function(){var t=arguments.length>0&&arguments[0]!==e?arguments[0]:!1;var r=this.cy();if(!r.styleEnabled()||!r.hasCompoundNodes()){return this}this.forEachUp(function(e){if(e.isParent()){var r=e._private;r.compoundBoundsClean=!1;r.bbCache=null;t||e.emitAndNotify("bounds")}});return this};uc.updateCompoundBounds=function(){var t=arguments.length>0&&arguments[0]!==e?arguments[0]:!1;var r=this.cy();if(!r.styleEnabled()||!r.hasCompoundNodes()){return this}if(!t&&r.batching()){return this}function a(e){if(!e.isParent()){return}var t=e._private;var r=e.children();var a=e.pstyle("compound-sizing-wrt-labels").value==="include";var n={width:{val:e.pstyle("min-width").pfValue,left:e.pstyle("min-width-bias-left"),right:e.pstyle("min-width-bias-right")},height:{val:e.pstyle("min-height").pfValue,top:e.pstyle("min-height-bias-top"),bottom:e.pstyle("min-height-bias-bottom")}};var i=r.boundingBox({includeLabels:a,includeOverlays:!1,useCache:!1});var o=t.position;if(i.w===0||i.h===0){i={w:e.pstyle("width").pfValue,h:e.pstyle("height").pfValue};i.x1=o.x-i.w/2;i.x2=o.x+i.w/2;i.y1=o.y-i.h/2;i.y2=o.y+i.h/2}function s(e,t,r){var a=0;var n=0;var i=t+r;if(e>0&&i>0){a=t/i*e;n=r/i*e}return{biasDiff:a,biasComplementDiff:n}}function l(e,t,r,a){if(r.units==="%"){switch(a){case"width":return e>0?r.pfValue*e:0;case"height":return t>0?r.pfValue*t:0;case"average":return e>0&&t>0?r.pfValue*(e+t)/2:0;case"min":return e>0&&t>0?e>t?r.pfValue*t:r.pfValue*e:0;case"max":return e>0&&t>0?e>t?r.pfValue*e:r.pfValue*t:0;default:return 0}}else if(r.units==="px"){return r.pfValue}else{return 0}}var c=n.width.left.value;n.width.left.units==="px"&&n.width.val>0&&(c=c*100/n.width.val);var d=n.width.right.value;n.width.right.units==="px"&&n.width.val>0&&(d=d*100/n.width.val);var p=n.height.top.value;n.height.top.units==="px"&&n.height.val>0&&(p=p*100/n.height.val);var u=n.height.bottom.value;n.height.bottom.units==="px"&&n.height.val>0&&(u=u*100/n.height.val);var f=s(n.width.val-i.w,c,d);var h=f.biasDiff;var g=f.biasComplementDiff;var y=s(n.height.val-i.h,p,u);var v=y.biasDiff;var m=y.biasComplementDiff;t.autoPadding=l(i.w,i.h,e.pstyle("padding"),e.pstyle("padding-relative-to").value);t.autoWidth=Math.max(i.w,n.width.val);o.x=(-h+i.x1+i.x2+g)/2;t.autoHeight=Math.max(i.h,n.height.val);o.y=(-v+i.y1+i.y2+m)/2}for(var n=0;n<this.length;n++){var i=this[n],o=i._private;if(!o.compoundBoundsClean||t){a(i);r.batching()||(o.compoundBoundsClean=!0)}}return this};var fc=function e(t){if(t===Infinity||t===-Infinity){return 0}return t};var hc=function e(t,r,a,n,i){if(n-r===0||i-a===0){return}if(r==null||a==null||n==null||i==null){return}t.x1=r<t.x1?r:t.x1;t.x2=n>t.x2?n:t.x2;t.y1=a<t.y1?a:t.y1;t.y2=i>t.y2?i:t.y2;t.w=t.x2-t.x1;t.h=t.y2-t.y1};var gc=function e(t,r){if(r==null){return t}return hc(t,r.x1,r.y1,r.x2,r.y2)};var yc=function e(t,r,a){return Gt(t,r,a)};var vc=function e(t,r,a){if(r.cy().headless()){return}var n=r._private;var i=n.rstyle;var o=i.arrowWidth/2;var s=r.pstyle(a+"-arrow-shape").value;var l;var c;if(s!=="none"){if(a==="source"){l=i.srcX;c=i.srcY}else if(a==="target"){l=i.tgtX;c=i.tgtY}else{l=i.midX;c=i.midY}var d=n.arrowBounds=n.arrowBounds||{},p=d[a]=d[a]||{};p.x1=l-o;p.y1=c-o;p.x2=l+o;p.y2=c+o;p.w=p.x2-p.x1;p.h=p.y2-p.y1;Qr(p,1);hc(t,p.x1,p.y1,p.x2,p.y2)}};var mc=function e(t,r,a){if(r.cy().headless()){return}var n;if(a){n=a+"-"}else{n=""}var i=r._private;var o=i.rstyle;var s=r.pstyle(n+"label").strValue;if(s){var l=r.pstyle("text-halign"),c=r.pstyle("text-valign"),d=yc(o,"labelWidth",a),p=yc(o,"labelHeight",a),u=yc(o,"labelX",a),f=yc(o,"labelY",a),h=r.pstyle(n+"text-margin-x").pfValue,g=r.pstyle(n+"text-margin-y").pfValue,y=r.isEdge(),v=r.pstyle(n+"text-rotation"),m=r.pstyle("text-outline-width").pfValue,b=r.pstyle("text-border-width").pfValue,x=b/2,_=r.pstyle("text-background-padding").pfValue,w=2,S=p,P=d,C=P/2,E=S/2,T,I,k,R;if(y){T=u-C;I=u+C;k=f-E;R=f+E}else{switch(l.value){case"left":T=u-P;I=u;break;case"center":T=u-C;I=u+C;break;case"right":T=u;I=u+P;break}switch(c.value){case"top":k=f-S;R=f;break;case"center":k=f-E;R=f+E;break;case"bottom":k=f;R=f+S;break}}var D=h-Math.max(m,x)-_-w,B=h+Math.max(m,x)+_+w,A=g-Math.max(m,x)-_-w,O=g+Math.max(m,x)+_+w;T+=D;I+=B;k+=A;R+=O;var L=a||"main",N=i.labelBounds,M=N[L]=N[L]||{};M.x1=T;M.y1=k;M.x2=I;M.y2=R;M.w=I-T;M.h=R-k;M.leftPad=D;M.rightPad=B;M.topPad=A;M.botPad=O;var j=y&&v.strValue==="autorotate",q=v.pfValue!=null&&v.pfValue!==0;if(j||q){var z=j?yc(i.rstyle,"labelAngle",a):v.pfValue,$=Math.cos(z),V=Math.sin(z),F=(T+I)/2,W=(k+R)/2;if(!y){switch(l.value){case"left":F=I;break;case"right":F=T;break}switch(c.value){case"top":W=R;break;case"bottom":W=k;break}}var H=function e(t,r){t=t-F;r=r-W;return{x:t*$-r*V+F,y:t*V+r*$+W}},X=H(T,k),Y=H(T,R),G=H(I,k),K=H(I,R);T=Math.min(X.x,Y.x,G.x,K.x);I=Math.max(X.x,Y.x,G.x,K.x);k=Math.min(X.y,Y.y,G.y,K.y);R=Math.max(X.y,Y.y,G.y,K.y)}var U=L+"Rot",Q=N[U]=N[U]||{};Q.x1=T;Q.y1=k;Q.x2=I;Q.y2=R;Q.w=I-T;Q.h=R-k;hc(t,T,k,I,R);hc(i.labelBounds.all,T,k,I,R)}return t};var bc=function e(t,r){if(r.cy().headless()){return}var a=r.pstyle("outline-opacity").value;var n=r.pstyle("outline-width").value;var i=r.pstyle("outline-offset").value;var o=n+i;xc(t,r,a,o,"outside",o/2)};var xc=function e(t,r,a,n,i,o){if(a===0||n<=0||i==="inside"){return}var s=r.cy();var l=r.pstyle("shape").value;var c=s.renderer().nodeShapes[l];var d=r.position(),p=d.x,u=d.y;var f=r.width();var h=r.height();if(c.hasMiterBounds){i==="center"&&(n/=2);var g=c.miterBounds(p,u,f,h,n);gc(t,g)}else o!=null&&o>0&&Zr(t,[o,o,o,o])};var _c=function e(t,r){if(r.cy().headless()){return}var a=r.pstyle("border-opacity").value;var n=r.pstyle("border-width").pfValue;var i=r.pstyle("border-position").value;xc(t,r,a,n,i)};var wc=function e(t,r){var a=t._private.cy;var n=a.styleEnabled();var i=a.headless();var o=Xr();var s=t._private;var l=t.isNode();var c=t.isEdge();var d,p,u,f;var h,g;var y=s.rstyle;var v=l&&n?t.pstyle("bounds-expansion").pfValue:[0];var m=function e(t){return t.pstyle("display").value!=="none"};var b=!n||m(t)&&(!c||m(t.source())&&m(t.target()));if(b){var x=0,_=0;if(n&&r.includeOverlays){x=t.pstyle("overlay-opacity").value;x!==0&&(_=t.pstyle("overlay-padding").value)}var w=0,S=0;if(n&&r.includeUnderlays){w=t.pstyle("underlay-opacity").value;w!==0&&(S=t.pstyle("underlay-padding").value)}var P=Math.max(_,S),C=0,E=0;if(n){C=t.pstyle("width").pfValue;E=C/2}if(l&&r.includeNodes){var T=t.position();h=T.x;g=T.y;var I=t.outerWidth(),k=I/2,R=t.outerHeight(),D=R/2;d=h-k;p=h+k;u=g-D;f=g+D;hc(o,d,u,p,f);n&&bc(o,t);n&&r.includeOutlines&&!i&&bc(o,t);n&&_c(o,t)}else if(c&&r.includeEdges){if(n&&!i){var B=t.pstyle("curve-style").strValue;d=Math.min(y.srcX,y.midX,y.tgtX);p=Math.max(y.srcX,y.midX,y.tgtX);u=Math.min(y.srcY,y.midY,y.tgtY);f=Math.max(y.srcY,y.midY,y.tgtY);d-=E;p+=E;u-=E;f+=E;hc(o,d,u,p,f);if(B==="haystack"){var A=y.haystackPts;if(A&&A.length===2){d=A[0].x;u=A[0].y;p=A[1].x;f=A[1].y;if(d>p){var O=d;d=p;p=O}if(u>f){var L=u;u=f;f=L}hc(o,d-E,u-E,p+E,f+E)}}else if(B==="bezier"||B==="unbundled-bezier"||U(B,"segments")||U(B,"taxi")){var N;switch(B){case"bezier":case"unbundled-bezier":N=y.bezierPts;break;case"segments":case"taxi":case"round-segments":case"round-taxi":N=y.linePts;break}if(N!=null){for(var M=0;M<N.length;M++){var j=N[M];d=j.x-E;p=j.x+E;u=j.y-E;f=j.y+E;hc(o,d,u,p,f)}}}}else{var q=t.source(),z=q.position(),$=t.target(),V=$.position();d=z.x;p=V.x;u=z.y;f=V.y;if(d>p){var F=d;d=p;p=F}if(u>f){var W=u;u=f;f=W}d-=E;p+=E;u-=E;f+=E;hc(o,d,u,p,f)}}if(n&&r.includeEdges&&c){vc(o,t,"mid-source");vc(o,t,"mid-target");vc(o,t,"source");vc(o,t,"target")}if(n){var H=t.pstyle("ghost").value==="yes";if(H){var X=t.pstyle("ghost-offset-x").pfValue,Y=t.pstyle("ghost-offset-y").pfValue;hc(o,o.x1+X,o.y1+Y,o.x2+X,o.y2+Y)}}var G=s.bodyBounds=s.bodyBounds||{};Jr(G,o);Zr(G,v);Qr(G,1);if(n){d=o.x1;p=o.x2;u=o.y1;f=o.y2;hc(o,d-P,u-P,p+P,f+P)}var K=s.overlayBounds=s.overlayBounds||{};Jr(K,o);Zr(K,v);Qr(K,1);var Q=s.labelBounds=s.labelBounds||{};if(Q.all!=null){Gr(Q.all)}else{Q.all=Xr()}if(n&&r.includeLabels){r.includeMainLabels&&mc(o,t,null);if(c){r.includeSourceLabels&&mc(o,t,"source");r.includeTargetLabels&&mc(o,t,"target")}}}o.x1=fc(o.x1);o.y1=fc(o.y1);o.x2=fc(o.x2);o.y2=fc(o.y2);o.w=fc(o.x2-o.x1);o.h=fc(o.y2-o.y1);if(o.w>0&&o.h>0&&b){Zr(o,v);Qr(o,1)}return o};var Sc=function e(t){var r=0;var a=function e(t){return(t?1:0)<<r++};var n=0;n+=a(t.incudeNodes);n+=a(t.includeEdges);n+=a(t.includeLabels);n+=a(t.includeMainLabels);n+=a(t.includeSourceLabels);n+=a(t.includeTargetLabels);n+=a(t.includeOverlays);n+=a(t.includeOutlines);return n};var Pc=function e(t){var r=function e(t){return Math.round(t)};if(t.isEdge()){var a=t.source().position(),n=t.target().position();return xt([r(a.x),r(a.y),r(n.x),r(n.y)])}else{var i=t.position();return xt([r(i.x),r(i.y)])}};var Cc=function e(t,r){var a=t._private;var n;var i=t.isEdge();var o=r==null?Tc:Sc(r);var s=o===Tc;if(a.bbCache==null){n=wc(t,Ec);a.bbCache=n;a.bbCachePosKey=Pc(t)}else{n=a.bbCache}if(!s){var l=t.isNode();n=Xr();if(r.includeNodes&&l||r.includeEdges&&!l){if(r.includeOverlays){gc(n,a.overlayBounds)}else{gc(n,a.bodyBounds)}}if(r.includeLabels){if(r.includeMainLabels&&(!i||r.includeSourceLabels&&r.includeTargetLabels)){gc(n,a.labelBounds.all)}else{r.includeMainLabels&&gc(n,a.labelBounds.mainRot);r.includeSourceLabels&&gc(n,a.labelBounds.sourceRot);r.includeTargetLabels&&gc(n,a.labelBounds.targetRot)}}n.w=n.x2-n.x1;n.h=n.y2-n.y1}return n};var Ec={includeNodes:!0,includeEdges:!0,includeLabels:!0,includeMainLabels:!0,includeSourceLabels:!0,includeTargetLabels:!0,includeOverlays:!0,includeUnderlays:!0,includeOutlines:!0,useCache:!0};var Tc=Sc(Ec);var Ic=Wt(Ec);uc.boundingBox=function(t){var r;var a=t===e||t.useCache===e||t.useCache===!0;var n=H(function(e){var t=e._private;return t.bbCache==null||t.styleDirty||t.bbCachePosKey!==Pc(e)},function(e){return e.id()});if(a&&this.length===1&&!n(this[0])){if(t===e){t=Ec}else{t=Ic(t)}r=Cc(this[0],t)}else{r=Xr();t=t||Ec;var i=Ic(t),o=this,s=o.cy(),l=s.styleEnabled();this.edges().forEach(n);this.nodes().forEach(n);l&&this.recalculateRenderedStyle(a);this.updateCompoundBounds(!a);for(var c=0;c<o.length;c++){var d=o[c];n(d)&&d.dirtyBoundingBoxCache();gc(r,Cc(d,i))}}r.x1=fc(r.x1);r.y1=fc(r.y1);r.x2=fc(r.x2);r.y2=fc(r.y2);r.w=fc(r.x2-r.x1);r.h=fc(r.y2-r.y1);return r};uc.dirtyBoundingBoxCache=function(){for(var e=0;e<this.length;e++){var t=this[e]._private;t.bbCache=null;t.bbCachePosKey=null;t.bodyBounds=null;t.overlayBounds=null;t.labelBounds.all=null;t.labelBounds.source=null;t.labelBounds.target=null;t.labelBounds.main=null;t.labelBounds.sourceRot=null;t.labelBounds.targetRot=null;t.labelBounds.mainRot=null;t.arrowBounds.source=null;t.arrowBounds.target=null;t.arrowBounds["mid-source"]=null;t.arrowBounds["mid-target"]=null}this.emitAndNotify("bounds");return this};uc.boundingBoxAt=function(e){var t=this.nodes();var r=this.cy();var a=r.hasCompoundNodes();var n=r.collection();if(a){n=t.filter(function(e){return e.isParent()});t=t.not(n)}if(k(e)){var i=e;e=function e(){return i}}var o=function t(r,a){return r._private.bbAtOldPos=e(r,a)};var s=function e(t){return t._private.bbAtOldPos};r.startBatch();t.forEach(o).silentPositions(e);if(a){n.dirtyCompoundBoundsCache();n.dirtyBoundingBoxCache();n.updateCompoundBounds(!0)}var l=Yr(this.boundingBox({useCache:!1}));t.silentPositions(s);if(a){n.dirtyCompoundBoundsCache();n.dirtyBoundingBoxCache();n.updateCompoundBounds(!0)}r.endBatch();return l};pc.boundingbox=pc.bb=pc.boundingBox;pc.renderedBoundingbox=pc.renderedBoundingBox;var kc=uc;var Rc,Dc;Rc=Dc={};var Bc=function e(t){t.uppercaseName=K(t.name);t.autoName="auto"+t.uppercaseName;t.labelName="label"+t.uppercaseName;t.outerName="outer"+t.uppercaseName;t.uppercaseOuterName=K(t.outerName);Rc[t.name]=function e(){var r=this[0];var a=r._private;var n=a.cy;var i=n._private.styleEnabled;if(r){if(i){if(r.isParent()){r.updateCompoundBounds();return a[t.autoName]||0}var o=r.pstyle(t.name);switch(o.strValue){case"label":r.recalculateRenderedStyle();return a.rstyle[t.labelName]||0;default:return o.pfValue}}else{return 1}}};Rc["outer"+t.uppercaseName]=function e(){var r=this[0];var a=r._private;var n=a.cy;var i=n._private.styleEnabled;if(r){if(i){var o=r[t.name](),s=r.pstyle("border-position").value,l;if(s==="center"){l=r.pstyle("border-width").pfValue}else if(s==="outside"){l=2*r.pstyle("border-width").pfValue}else{l=0}var c=2*r.padding();return o+l+c}else{return 1}}};Rc["rendered"+t.uppercaseName]=function e(){var r=this[0];if(r){var a=r[t.name]();return a*this.cy().zoom()}};Rc["rendered"+t.uppercaseOuterName]=function e(){var r=this[0];if(r){var a=r[t.outerName]();return a*this.cy().zoom()}}};Bc({name:"width"});Bc({name:"height"});Dc.padding=function(){var t=this[0];var r=t._private;if(t.isParent()){t.updateCompoundBounds();if(r.autoPadding!==e){return r.autoPadding}else{return t.pstyle("padding").pfValue}}else{return t.pstyle("padding").pfValue}};Dc.paddedHeight=function(){var e=this[0];return e.height()+2*e.padding()};Dc.paddedWidth=function(){var e=this[0];return e.width()+2*e.padding()};var Ac=Dc;var Oc=function e(t,r){if(t.isEdge()&&t.takesUpSpace()){return r(t)}};var Lc=function e(t,r){if(t.isEdge()&&t.takesUpSpace()){var a=t.cy();return Ir(r(t),a.zoom(),a.pan())}};var Nc=function e(t,r){if(t.isEdge()&&t.takesUpSpace()){var a=t.cy(),n=a.pan(),i=a.zoom();return r(t).map(function(e){return Ir(e,i,n)})}};var Mc=function e(t){return t.renderer().getControlPoints(t)};var jc=function e(t){return t.renderer().getSegmentPoints(t)}
var qc=function e(t){return t.renderer().getSourceEndpoint(t)};var zc=function e(t){return t.renderer().getTargetEndpoint(t)};var $c=function e(t){return t.renderer().getEdgeMidpoint(t)};var Vc={controlPoints:{get:Mc,mult:!0},segmentPoints:{get:jc,mult:!0},sourceEndpoint:{get:qc},targetEndpoint:{get:zc},midpoint:{get:$c}};var Fc=function e(t){return"rendered"+t[0].toUpperCase()+t.substr(1)};var Wc=Object.keys(Vc).reduce(function(e,t){var r=Vc[t];var a=Fc(t);e[t]=function(){return Oc(this,r.get)};if(r.mult){e[a]=function(){return Nc(this,r.get)}}else{e[a]=function(){return Lc(this,r.get)}}return e},{});var Hc=oe({},dc,kc,Ac,Wc);var Xc=function e(t,r){this.recycle(t,r)};function Yc(){return!1}function Gc(){return!0}Xc.prototype={instanceString:function e(){return"event"},recycle:function e(t,r){this.isImmediatePropagationStopped=this.isPropagationStopped=this.isDefaultPrevented=Yc;if(t!=null&&t.preventDefault){this.type=t.type;this.isDefaultPrevented=t.defaultPrevented?Gc:Yc}else if(t!=null&&t.type){r=t}else{this.type=t}if(r!=null){this.originalEvent=r.originalEvent;this.type=r.type!=null?r.type:this.type;this.cy=r.cy;this.target=r.target;this.position=r.position;this.renderedPosition=r.renderedPosition;this.namespace=r.namespace;this.layout=r.layout}if(this.cy!=null&&this.position!=null&&this.renderedPosition==null){var a=this.position,n=this.cy.zoom(),i=this.cy.pan();this.renderedPosition={x:a.x*n+i.x,y:a.y*n+i.y}}this.timeStamp=t&&t.timeStamp||Date.now()},preventDefault:function e(){this.isDefaultPrevented=Gc;var t=this.originalEvent;if(!t){return}t.preventDefault&&t.preventDefault()},stopPropagation:function e(){this.isPropagationStopped=Gc;var t=this.originalEvent;if(!t){return}t.stopPropagation&&t.stopPropagation()},stopImmediatePropagation:function e(){this.isImmediatePropagationStopped=Gc;this.stopPropagation()},isDefaultPrevented:Yc,isPropagationStopped:Yc,isImmediatePropagationStopped:Yc};var Kc=/^([^.]+)(\.(?:[^.]+))?$/;var Uc=".*";var Qc={qualifierCompare:function e(t,r){return t===r},eventMatches:function e(){return!0},addEventFields:function e(){},callbackContext:function e(t){return t},beforeEmit:function e(){},afterEmit:function e(){},bubble:function e(){return!1},parent:function e(){return null},context:null};var Zc=Object.keys(Qc);var Jc={};function ed(){var t=arguments.length>0&&arguments[0]!==e?arguments[0]:Jc;var r=arguments.length>1?arguments[1]:e;for(var a=0;a<Zc.length;a++){var n=Zc[a];this[n]=t[n]||Qc[n]}this.context=r||this.context;this.listeners=[];this.emitting=0}var td=ed.prototype;var rd=function e(t,r,a,n,i,o,s){if(T(n)){i=n;n=null}if(s){if(o==null){o=s}else{o=oe({},o,s)}}var l=I(a)?a:a.split(/\s+/);for(var c=0;c<l.length;c++){var d=l[c];if(z(d)){continue}var p=d.match(Kc);if(p){var u=p[1],f=p[2]?p[2]:null,h=r(t,d,u,f,n,i,o);if(h===!1){break}}}};var ad=function e(t,r){t.addEventFields(t.context,r);return new Xc(r.type,r)};var nd=function e(t,r,a){if(q(a)){r(t,a);return}else if(k(a)){r(t,ad(t,a));return}var n=I(a)?a:a.split(/\s+/);for(var i=0;i<n.length;i++){var o=n[i];if(z(o)){continue}var s=o.match(Kc);if(s){var l=s[1],c=s[2]?s[2]:null,d=ad(t,{type:l,namespace:c,target:t.context});r(t,d)}}};td.on=td.addListener=function(e,t,r,a,n){rd(this,function(e,t,r,a,n,i,o){T(i)&&e.listeners.push({event:t,callback:i,type:r,namespace:a,qualifier:n,conf:o})},e,t,r,a,n);return this};td.one=function(e,t,r,a){return this.on(e,t,r,a,{one:!0})};td.removeListener=td.off=function(e,t,r,a){var n=this;this.emitting!==0&&(this.listeners=zt(this.listeners));var i=this.listeners;var o=function o(s){var l=i[s];rd(n,function(t,r,a,n,o,c){if((l.type===a||e==="*")&&(!n&&l.namespace!==".*"||l.namespace===n)&&(!o||t.qualifierCompare(l.qualifier,o))&&(!c||l.callback===c)){i.splice(s,1);return!1}},e,t,r,a)};for(var s=i.length-1;s>=0;s--){o(s)}return this};td.removeAllListeners=function(){return this.removeListener("*")};td.emit=td.trigger=function(e,t,r){var a=this.listeners;var n=a.length;this.emitting++;I(t)||(t=[t]);nd(this,function(e,i){if(r!=null){a=[{event:i.event,type:i.type,namespace:i.namespace,callback:r}];n=a.length}var o=function r(){var n=a[s];if(n.type===i.type&&(!n.namespace||n.namespace===i.namespace||n.namespace===Uc)&&e.eventMatches(e.context,n,i)){var o=[i];t!=null&&Yt(o,t);e.beforeEmit(e.context,n,i);n.conf&&n.conf.one&&(e.listeners=e.listeners.filter(function(e){return e!==n}));var l=e.callbackContext(e.context,n,i),c=n.callback.apply(l,o);e.afterEmit(e.context,n,i);if(c===!1){i.stopPropagation();i.preventDefault()}}};for(var s=0;s<n;s++){o()}e.bubble(e.context)&&!i.isPropagationStopped()&&e.parent(e.context).emit(i,t)},e);this.emitting--;return this};var id={qualifierCompare:function e(t,r){if(t==null||r==null){return t==null&&r==null}else{return t.sameText(r)}},eventMatches:function e(t,r,a){var n=r.qualifier;if(n!=null){return t!==a.target&&L(a.target)&&n.matches(a.target)}return!0},addEventFields:function e(t,r){r.cy=t.cy();r.target=t},callbackContext:function e(t,r,a){return r.qualifier!=null?a.target:t},beforeEmit:function e(t,r){r.conf&&r.conf.once&&r.conf.onceCollection.removeListener(r.event,r.qualifier,r.callback)},bubble:function e(){return!0},parent:function e(t){return t.isChild()?t.parent():t.cy()}};var od=function e(t){if(E(t)){return new Hl(t)}else{return t}};var sd={createEmitter:function e(){for(var t=0;t<this.length;t++){var r=this[t],a=r._private;a.emitter||(a.emitter=new ed(id,r))}return this},emitter:function e(){return this._private.emitter},on:function e(t,r,a){var n=od(r);for(var i=0;i<this.length;i++){var o=this[i];o.emitter().on(t,n,a)}return this},removeListener:function e(t,r,a){var n=od(r);for(var i=0;i<this.length;i++){var o=this[i];o.emitter().removeListener(t,n,a)}return this},removeAllListeners:function e(){for(var t=0;t<this.length;t++){var r=this[t];r.emitter().removeAllListeners()}return this},one:function e(t,r,a){var n=od(r);for(var i=0;i<this.length;i++){var o=this[i];o.emitter().one(t,n,a)}return this},once:function e(t,r,a){var n=od(r);for(var i=0;i<this.length;i++){var o=this[i];o.emitter().on(t,n,a,{once:!0,onceCollection:this})}},emit:function e(t,r){for(var a=0;a<this.length;a++){var n=this[a];n.emitter().emit(t,r)}return this},emitAndNotify:function e(t,r){if(this.length===0){return}this.cy().notify(t,this);this.emit(t,r);return this}};vl.eventAliasesOn(sd);var ld={nodes:function e(t){return this.filter(function(e){return e.isNode()}).filter(t)},edges:function e(t){return this.filter(function(e){return e.isEdge()}).filter(t)},byGroup:function e(){var t=this.spawn();var r=this.spawn();for(var a=0;a<this.length;a++){var n=this[a];if(n.isNode()){t.push(n)}else{r.push(n)}}return{nodes:t,edges:r}},filter:function t(r,a){if(r===e){return this}else if(E(r)||O(r)){return new Hl(r).filter(this)}else if(T(r)){var n=this.spawn(),i=this;for(var o=0;o<i.length;o++){var s=i[o],l=a?r.apply(a,[s,o,i]):r(s,o,i);l&&n.push(s)}return n}return this.spawn()},not:function e(t){if(!t){return this}else{E(t)&&(t=this.filter(t));var r=this.spawn();for(var a=0;a<this.length;a++){var n=this[a],i=t.has(n);i||r.push(n)}return r}},absoluteComplement:function e(){var t=this.cy();return t.mutableElements().not(this)},intersect:function e(t){if(E(t)){var r=t;return this.filter(r)}var a=this.spawn();var n=this;var i=this.length<t.length;var o=i?n:t;var s=i?t:n;for(var l=0;l<o.length;l++){var c=o[l];s.has(c)&&a.push(c)}return a},xor:function e(t){var r=this._private.cy;E(t)&&(t=r.$(t));var a=this.spawn();var n=this;var i=t;var o=function e(t,r){for(var n=0;n<t.length;n++){var i=t[n],o=i._private.data.id,s=r.hasElementWithId(o);s||a.push(i)}};o(n,i);o(i,n);return a},diff:function e(t){var r=this._private.cy;E(t)&&(t=r.$(t));var a=this.spawn();var n=this.spawn();var i=this.spawn();var o=this;var s=t;var l=function e(t,r,a){for(var n=0;n<t.length;n++){var o=t[n],s=o._private.data.id,l=r.hasElementWithId(s);if(l){i.merge(o)}else{a.push(o)}}};l(o,s,a);l(s,o,n);return{left:a,right:n,both:i}},add:function e(t){var r=this._private.cy;if(!t){return this}if(E(t)){var a=t;t=r.mutableElements().filter(a)}var n=this.spawnSelf();for(var i=0;i<t.length;i++){var o=t[i],e=!this.has(o);e&&n.push(o)}return n},merge:function e(t){var r=this._private;var a=r.cy;if(!t){return this}if(t&&E(t)){var n=t;t=a.mutableElements().filter(n)}var i=r.map;for(var o=0;o<t.length;o++){var s=t[o],l=s._private.data.id,c=!i.has(l);if(c){var d=this.length++;this[d]=s;i.set(l,{ele:s,index:d})}}return this},unmergeAt:function t(r){var a=this[r];var n=a.id();var i=this._private;var o=i.map;this[r]=e;o["delete"](n);var s=r===this.length-1;if(this.length>1&&!s){var l=this.length-1,c=this[l],d=c._private.data.id;this[l]=e;this[r]=c;o.set(d,{ele:c,index:r})}this.length--;return this},unmergeOne:function e(t){t=t[0];var r=this._private;var a=t._private.data.id;var n=r.map;var i=n.get(a);if(!i){return this}var o=i.index;this.unmergeAt(o);return this},unmerge:function e(t){var r=this._private.cy;if(!t){return this}if(t&&E(t)){var a=t;t=r.mutableElements().filter(a)}for(var n=0;n<t.length;n++){this.unmergeOne(t[n])}return this},unmergeBy:function e(t){for(var r=this.length-1;r>=0;r--){var a=this[r];t(a)&&this.unmergeAt(r)}return this},map:function e(t,r){var a=[];var n=this;for(var i=0;i<n.length;i++){var o=n[i],s=r?t.apply(r,[o,i,n]):t(o,i,n);a.push(s)}return a},reduce:function e(t,r){var a=r;var n=this;for(var i=0;i<n.length;i++){a=t(a,n[i],i,n)}return a},max:function e(t,r){var e=-Infinity;var a;var n=this;for(var i=0;i<n.length;i++){var o=n[i],s=r?t.apply(r,[o,i,n]):t(o,i,n);if(s>e){e=s;a=o}}return{value:e,ele:a}},min:function e(t,r){var e=Infinity;var a;var n=this;for(var i=0;i<n.length;i++){var o=n[i],s=r?t.apply(r,[o,i,n]):t(o,i,n);if(s<e){e=s;a=o}}return{value:e,ele:a}}};var cd=ld;cd["u"]=ld["|"]=ld["+"]=ld.union=ld.or=ld.add;cd["\\"]=ld["!"]=ld["-"]=ld.difference=ld.relativeComplement=ld.subtract=ld.not;cd["n"]=ld["&"]=ld["."]=ld.and=ld.intersection=ld.intersect;cd["^"]=ld["(+)"]=ld["(-)"]=ld.symmetricDifference=ld.symdiff=ld.xor;cd.fnFilter=ld.filterFn=ld.stdFilter=ld.filter;cd.complement=ld.abscomp=ld.absoluteComplement;var dd={isNode:function e(){return this.group()==="nodes"},isEdge:function e(){return this.group()==="edges"},isLoop:function e(){return this.isEdge()&&this.source()[0]===this.target()[0]},isSimple:function e(){return this.isEdge()&&this.source()[0]!==this.target()[0]},group:function e(){var t=this[0];if(t){return t._private.group}}};var pd=function e(t,r){var a=t.cy();var n=a.hasCompoundNodes();function i(e){var t=e.pstyle("z-compound-depth");if(t.value==="auto"){return n?e.zDepth():0}else if(t.value==="bottom"){return-1}else if(t.value==="top"){return Rt}return 0}var o=i(t)-i(r);if(o!==0){return o}function s(e){var t=e.pstyle("z-index-compare");if(t.value==="auto"){return e.isNode()?1:0}return 0}var l=s(t)-s(r);if(l!==0){return l}var c=t.pstyle("z-index").value-r.pstyle("z-index").value;if(c!==0){return c}return t.poolIndex()-r.poolIndex()};var ud={forEach:function e(t,r){if(T(t)){var a=this.length;for(var n=0;n<a;n++){var i=this[n],o=r?t.apply(r,[i,n,this]):t(i,n,this);if(o===!1){break}}}return this},toArray:function e(){var t=[];for(var r=0;r<this.length;r++){t.push(this[r])}return t},slice:function e(t,r){var a=[];var n=this.length;r==null&&(r=n);t==null&&(t=0);t<0&&(t=n+t);r<0&&(r=n+r);for(var i=t;i>=0&&i<r&&i<n;i++){a.push(this[i])}return this.spawn(a)},size:function e(){return this.length},eq:function e(t){return this[t]||this.spawn()},first:function e(){return this[0]||this.spawn()},last:function e(){return this[this.length-1]||this.spawn()},empty:function e(){return this.length===0},nonempty:function e(){return!this.empty()},sort:function e(t){if(!T(t)){return this}var r=this.toArray().sort(t);return this.spawn(r)},sortByZIndex:function e(){return this.sort(pd)},zDepth:function t(){var r=this[0];if(!r){return e}var a=r._private;var n=a.group;if(n==="nodes"){var i=a.data.parent?r.parents().size():0;if(!r.isParent()){return Rt-1}return i}else{var o=a.source,s=a.target,l=o.zDepth(),c=s.zDepth();return Math.max(l,c,0)}}};ud.each=ud.forEach;var fd=function t(){var r="undefined";var a=(typeof Symbol==="undefined"?"undefined":v(Symbol))!=r&&v(Symbol.iterator)!=r;a&&(ud[Symbol.iterator]=function(){var t=this;var r={value:e,done:!1};var a=0;var n=this.length;return l({next:function i(){if(a<n){r.value=t[a++]}else{r.value=e;r.done=!0}return r}},Symbol.iterator,function(){return this})})};fd();var hd=Wt({nodeDimensionsIncludeLabels:!1});var gd={layoutDimensions:function e(t){t=hd(t);var r;if(!this.takesUpSpace()){r={w:0,h:0}}else if(t.nodeDimensionsIncludeLabels){var a=this.boundingBox();r={w:a.w,h:a.h}}else{r={w:this.outerWidth(),h:this.outerHeight()}}(r.w===0||r.h===0)&&(r.w=r.h=1);return r},layoutPositions:function t(r,a,n){var i=this.nodes().filter(function(e){return!e.isParent()});var o=this.cy();var s=a.eles;var l=function e(t){return t.id()};var c=H(n,l);r.emit({type:"layoutstart",layout:r});r.animations=[];var d=function e(t,r,a){var n={x:r.x1+r.w/2,y:r.y1+r.h/2};var i={x:(a.x-n.x)*t,y:(a.y-n.y)*t};return{x:n.x+i.x,y:n.y+i.y}};var p=a.spacingFactor&&a.spacingFactor!==1;var u=function e(){if(!p){return null}var t=Xr();for(var r=0;r<i.length;r++){var a=i[r],n=c(a,r);Ur(t,n.x,n.y)}return t};var f=u();var h=H(function(e,t){var r=c(e,t);if(p){var n=Math.abs(a.spacingFactor);r=d(n,f,r)}a.transform!=null&&(r=a.transform(e,r));return r},l);if(a.animate){for(var g=0;g<i.length;g++){var y=i[g],v=h(y,g),m=a.animateFilter==null||a.animateFilter(y,g);if(m){var b=y.animation({position:v,duration:a.animationDuration,easing:a.animationEasing});r.animations.push(b)}else{y.position(v)}}if(a.fit){var x=o.animation({fit:{boundingBox:s.boundingBoxAt(h),padding:a.padding},duration:a.animationDuration,easing:a.animationEasing});r.animations.push(x)}else if(a.zoom!==e&&a.pan!==e){var _=o.animation({zoom:a.zoom,pan:a.pan,duration:a.animationDuration,easing:a.animationEasing});r.animations.push(_)}r.animations.forEach(function(e){return e.play()});r.one("layoutready",a.ready);r.emit({type:"layoutready",layout:r});fi.all(r.animations.map(function(e){return e.promise()})).then(function(){r.one("layoutstop",a.stop);r.emit({type:"layoutstop",layout:r})})}else{i.positions(h);a.fit&&o.fit(a.eles,a.padding);a.zoom!=null&&o.zoom(a.zoom);a.pan&&o.pan(a.pan);r.one("layoutready",a.ready);r.emit({type:"layoutready",layout:r});r.one("layoutstop",a.stop);r.emit({type:"layoutstop",layout:r})}return this},layout:function e(t){var r=this.cy();return r.makeLayout(oe({},t,{eles:this}))}};gd.createLayout=gd.makeLayout=gd.layout;function yd(e,t,r){var a=r._private;var n=a.styleCache=a.styleCache||[];var i;if((i=n[e])!=null){return i}else{i=n[e]=t(r);return i}}function vd(e,t){e=_t(e);return function r(a){return yd(e,t,a)}}function md(e,t){e=_t(e);var r=function e(r){return t.call(r)};return function t(){var a=this[0];if(a){return yd(e,r,a)}}}var bd={recalculateRenderedStyle:function e(t){var r=this.cy();var a=r.renderer();var n=r.styleEnabled();a&&n&&a.recalculateRenderedStyle(this,t);return this},dirtyStyleCache:function e(){var t=this.cy();var r=function e(t){return t._private.styleCache=null};if(t.hasCompoundNodes()){var a;a=this.spawnSelf().merge(this.descendants()).merge(this.parents());a.merge(a.connectedEdges());a.forEach(r)}else{this.forEach(function(e){r(e);e.connectedEdges().forEach(r)})}return this},updateStyle:function t(r){var a=this._private.cy;if(!a.styleEnabled()){return this}if(a.batching()){var n=a._private.batchStyleEles;n.merge(this);return this}var i=a.hasCompoundNodes();var o=this;r=r||r===e?!0:!1;i&&(o=this.spawnSelf().merge(this.descendants()).merge(this.parents()));var s=o;if(r){s.emitAndNotify("style")}else{s.emit("style")}o.forEach(function(e){return e._private.styleDirty=!0});return this},cleanStyle:function e(){var t=this.cy();if(!t.styleEnabled()){return}for(var r=0;r<this.length;r++){var a=this[r];if(a._private.styleDirty){a._private.styleDirty=!1;t.style().apply(a)}}},parsedStyle:function t(r){var a=arguments.length>1&&arguments[1]!==e?arguments[1]:!0;var n=this[0];var i=n.cy();if(!i.styleEnabled()){return}if(n){if(n._private.styleDirty){n._private.styleDirty=!1;i.style().apply(n)}var o=n._private.style[r];if(o!=null){return o}else if(a){return i.style().getDefaultProperty(r)}else{return null}}},numericStyle:function t(r){var a=this[0];if(!a.cy().styleEnabled()){return}if(a){var n=a.pstyle(r);return n.pfValue!==e?n.pfValue:n.value}},numericStyleUnits:function e(t){var r=this[0];if(!r.cy().styleEnabled()){return}if(r){return r.pstyle(t).units}},renderedStyle:function e(t){var r=this.cy();if(!r.styleEnabled()){return this}var a=this[0];if(a){return r.style().getRenderedStyle(a,t)}},style:function t(r,a){var n=this.cy();if(!n.styleEnabled()){return this}var i=!1;var t=n.style();if(k(r)){var o=r;t.applyBypass(this,o,i);this.emitAndNotify("style")}else if(E(r)){if(a===e){var s=this[0];if(s){return t.getStylePropertyValue(s,r)}else{return}}else{t.applyBypass(this,r,a,i);this.emitAndNotify("style")}}else if(r===e){var l=this[0];if(l){return t.getRawStyle(l)}else{return}}return this},removeStyle:function t(r){var a=this.cy();if(!a.styleEnabled()){return this}var n=!1;var i=a.style();var o=this;if(r===e){for(var s=0;s<o.length;s++){var l=o[s];i.removeAllBypasses(l,n)}}else{r=r.split(/\s+/);for(var c=0;c<o.length;c++){var d=o[c];i.removeBypasses(d,r,n)}}this.emitAndNotify("style");return this},show:function e(){this.css("display","element");return this},hide:function e(){this.css("display","none");return this},effectiveOpacity:function e(){var t=this.cy();if(!t.styleEnabled()){return 1}var r=t.hasCompoundNodes();var a=this[0];if(a){var n=a._private,i=a.pstyle("opacity").value;if(!r){return i}var o=!n.data.parent?null:a.parents();if(o){for(var s=0;s<o.length;s++){var l=o[s],c=l.pstyle("opacity").value;i=c*i}}return i}},transparent:function e(){var t=this.cy();if(!t.styleEnabled()){return!1}var r=this[0];var a=r.cy().hasCompoundNodes();if(r){if(!a){return r.pstyle("opacity").value===0}else{return r.effectiveOpacity()===0}}},backgrounding:function e(){var t=this.cy();if(!t.styleEnabled()){return!1}var r=this[0];return r._private.backgrounding?!0:!1}};function xd(e,t){var r=e._private;var a=r.data.parent?e.parents():null;if(a){for(var n=0;n<a.length;n++){var i=a[n];if(!t(i)){return!1}}}return!0}function _d(e){var t=e.ok;var r=e.edgeOkViaNode||e.ok;var a=e.parentOk||e.ok;return function(){var e=this.cy();if(!e.styleEnabled()){return!0}var n=this[0];var i=e.hasCompoundNodes();if(n){var o=n._private;if(!t(n)){return!1}if(n.isNode()){return!i||xd(n,a)}else{var s=o.source,l=o.target;return r(s)&&(!i||xd(s,r))&&(s===l||r(l)&&(!i||xd(l,r)))}}}}var wd=vd("eleTakesUpSpace",function(e){return e.pstyle("display").value==="element"&&e.width()!==0&&(e.isNode()?e.height()!==0:!0)});bd.takesUpSpace=md("takesUpSpace",_d({ok:wd}));var Sd=vd("eleInteractive",function(e){return e.pstyle("events").value==="yes"&&e.pstyle("visibility").value==="visible"&&wd(e)});var Pd=vd("parentInteractive",function(e){return e.pstyle("visibility").value==="visible"&&wd(e)});bd.interactive=md("interactive",_d({ok:Sd,parentOk:Pd,edgeOkViaNode:wd}));bd.noninteractive=function(){var e=this[0];if(e){return!e.interactive()}};var Cd=vd("eleVisible",function(e){return e.pstyle("visibility").value==="visible"&&e.pstyle("opacity").pfValue!==0&&wd(e)});bd.visible=md("visible",_d({ok:Cd,edgeOkViaNode:wd}));bd.hidden=function(){var e=this[0];if(e){return!e.visible()}};bd.isBundledBezier=md("isBundledBezier",function(){if(!this.cy().styleEnabled()){return!1}return!this.removed()&&this.pstyle("curve-style").value==="bezier"&&this.takesUpSpace()});bd.bypass=bd.css=bd.style;bd.renderedCss=bd.renderedStyle;bd.removeBypass=bd.removeCss=bd.removeStyle;bd.pstyle=bd.parsedStyle;var Ed={};function Td(t){return function(){var r=[];if(arguments.length===2){var a=arguments[0],n=arguments[1];this.on(t.event,a,n)}else if(arguments.length===1&&T(arguments[0])){var i=arguments[0];this.on(t.event,i)}else if(arguments.length===0||arguments.length===1&&I(arguments[0])){var o=arguments.length===1?arguments[0]:null;for(var s=0;s<this.length;s++){var l=this[s],c=!t.ableField||l._private[t.ableField],d=l._private[t.field]!=t.value;if(t.overrideAble){var p=t.overrideAble(l);if(p!==e){c=p;if(!p){return this}}}if(c){l._private[t.field]=t.value;d&&r.push(l)}}var u=this.spawn(r);u.updateStyle();u.emit(t.event);o&&u.emit(o)}return this}}function Id(t){Ed[t.field]=function(){var r=this[0];if(r){if(t.overrideField){var a=t.overrideField(r);if(a!==e){return a}}return r._private[t.field]}};Ed[t.on]=Td({event:t.on,field:t.field,ableField:t.ableField,overrideAble:t.overrideAble,value:!0});Ed[t.off]=Td({event:t.off,field:t.field,ableField:t.ableField,overrideAble:t.overrideAble,value:!1})}Id({field:"locked",overrideField:function t(r){return r.cy().autolock()?!0:e},on:"lock",off:"unlock"});Id({field:"grabbable",overrideField:function t(r){return r.cy().autoungrabify()||r.pannable()?!1:e},on:"grabify",off:"ungrabify"});Id({field:"selected",ableField:"selectable",overrideAble:function t(r){return r.cy().autounselectify()?!1:e},on:"select",off:"unselect"});Id({field:"selectable",overrideField:function t(r){return r.cy().autounselectify()?!1:e},on:"selectify",off:"unselectify"});Ed.deselect=Ed.unselect;Ed.grabbed=function(){var e=this[0];if(e){return e._private.grabbed}};Id({field:"active",on:"activate",off:"unactivate"});Id({field:"pannable",on:"panify",off:"unpanify"});Ed.inactive=function(){var e=this[0];if(e){return!e._private.active}};var kd={};var Rd=function e(t){return function e(r){var a=this;var n=[];for(var i=0;i<a.length;i++){var o=a[i];if(!o.isNode()){continue}var s=!1,l=o.connectedEdges();for(var c=0;c<l.length;c++){var d=l[c],p=d.source(),u=d.target();if(t.noIncomingEdges&&u===o&&p!==o||t.noOutgoingEdges&&p===o&&u!==o){s=!0;break}}s||n.push(o)}return this.spawn(n,!0).filter(r)}};var Dd=function e(t){return function(e){var r=this;var a=[];for(var n=0;n<r.length;n++){var i=r[n];if(!i.isNode()){continue}var o=i.connectedEdges();for(var s=0;s<o.length;s++){var l=o[s],c=l.source(),d=l.target();if(t.outgoing&&c===i){a.push(l);a.push(d)}else if(t.incoming&&d===i){a.push(l);a.push(c)}}}return this.spawn(a,!0).filter(e)}};var Bd=function e(t){return function(e){var r=this;var a=[];var n={};for(;;){var i=t.outgoing?r.outgoers():r.incomers();if(i.length===0){break}var o=!1;for(var s=0;s<i.length;s++){var l=i[s],c=l.id();if(!n[c]){n[c]=!0;a.push(l);o=!0}}if(!o){break}r=i}return this.spawn(a,!0).filter(e)}};kd.clearTraversalCache=function(){for(var e=0;e<this.length;e++){this[e]._private.traversalCache=null}};oe(kd,{roots:Rd({noIncomingEdges:!0}),leaves:Rd({noOutgoingEdges:!0}),outgoers:Gl(Dd({outgoing:!0}),"outgoers"),successors:Bd({outgoing:!0}),incomers:Gl(Dd({incoming:!0}),"incomers"),predecessors:Bd({})});oe(kd,{neighborhood:Gl(function(e){var t=[];var r=this.nodes();for(var a=0;a<r.length;a++){var n=r[a],i=n.connectedEdges();for(var o=0;o<i.length;o++){var s=i[o],l=s.source(),c=s.target(),d=n===l?c:l;d.length>0&&t.push(d[0]);t.push(s[0])}}return this.spawn(t,!0).filter(e)},"neighborhood"),closedNeighborhood:function e(t){return this.neighborhood().add(this).filter(t)},openNeighborhood:function e(t){return this.neighborhood(t)}});kd.neighbourhood=kd.neighborhood;kd.closedNeighbourhood=kd.closedNeighborhood;kd.openNeighbourhood=kd.openNeighborhood;oe(kd,{source:Gl(function e(t){var r=this[0];var a;r&&(a=r._private.source||r.cy().collection());return a&&t?a.filter(t):a},"source"),target:Gl(function e(t){var r=this[0];var a;r&&(a=r._private.target||r.cy().collection());return a&&t?a.filter(t):a},"target"),sources:Ad({attr:"source"}),targets:Ad({attr:"target"})});function Ad(e){return function t(r){var a=[];for(var n=0;n<this.length;n++){var i=this[n],o=i._private[e.attr];o&&a.push(o)}return this.spawn(a,!0).filter(r)}}oe(kd,{edgesWith:Gl(Od(),"edgesWith"),edgesTo:Gl(Od({thisIsSrc:!0}),"edgesTo")});function Od(e){return function t(r){var a=[];var n=this._private.cy;var i=e||{};E(r)&&(r=n.$(r));for(var o=0;o<r.length;o++){var s=r[o]._private.edges;for(var l=0;l<s.length;l++){var c=s[l],d=c._private.data,p=this.hasElementWithId(d.source)&&r.hasElementWithId(d.target),u=r.hasElementWithId(d.source)&&this.hasElementWithId(d.target),f=p||u;if(!f){continue}if(i.thisIsSrc||i.thisIsTgt){if(i.thisIsSrc&&!p){continue}if(i.thisIsTgt&&!u){continue}}a.push(c)}}return this.spawn(a,!0)}}oe(kd,{connectedEdges:Gl(function(e){var t=[];var r=this;for(var a=0;a<r.length;a++){var n=r[a];if(!n.isNode()){continue}var i=n._private.edges;for(var o=0;o<i.length;o++){var s=i[o];t.push(s)}}return this.spawn(t,!0).filter(e)},"connectedEdges"),connectedNodes:Gl(function(e){var t=[];var r=this;for(var a=0;a<r.length;a++){var n=r[a];if(!n.isEdge()){continue}t.push(n.source()[0]);t.push(n.target()[0])}return this.spawn(t,!0).filter(e)},"connectedNodes"),parallelEdges:Gl(Ld(),"parallelEdges"),codirectedEdges:Gl(Ld({codirected:!0}),"codirectedEdges")});function Ld(e){var t={codirected:!1};e=oe({},t,e);return function t(r){var a=[];var n=this.edges();var i=e;for(var o=0;o<n.length;o++){var s=n[o],l=s._private,c=l.source,d=c._private.data.id,p=l.data.target,u=c._private.edges;for(var f=0;f<u.length;f++){var h=u[f],g=h._private.data,y=g.target,v=g.source,m=y===p&&v===d,b=d===y&&p===v;(i.codirected&&m||!i.codirected&&(m||b))&&a.push(h)}}return this.spawn(a,!0).filter(r)}}oe(kd,{components:function e(t){var r=this;var a=r.cy();var n=a.collection();var i=t==null?r.nodes():t.nodes();var e=[];t!=null&&i.empty()&&(i=t.sources());var o=function e(t,r){n.merge(t);i.unmerge(t);r.merge(t)};if(i.empty()){return r.spawn()}var s=function t(){var n=a.collection();e.push(n);var s=i[0];o(s,n);r.bfs({directed:!1,roots:s,visit:function e(t){return o(t,n)}});n.forEach(function(e){e.connectedEdges().forEach(function(e){r.has(e)&&n.has(e.source())&&n.has(e.target())&&n.merge(e)})})};do{s()}while(i.length>0);return e},component:function e(){var t=this[0];return t.cy().mutableElements().components(t)[0]}});kd.componentsOf=kd.components;var Nd=function t(r,a){var n=arguments.length>2&&arguments[2]!==e?arguments[2]:!1;var i=arguments.length>3&&arguments[3]!==e?arguments[3]:!1;if(r===e){Lt("A collection must have a reference to the core");return}var o=new Qt;var s=!1;if(!a){a=[]}else if(a.length>0&&k(a[0])&&!L(a[0])){s=!0;var l=[],c=new er;for(var d=0,p=a.length;d<p;d++){var u=a[d];u.data==null&&(u.data={});var f=u.data;if(f.id==null){f.id=$t()}else if(r.hasElementWithId(f.id)||c.has(f.id)){continue}var h=new tr(r,u,!1);l.push(h);c.add(f.id)}a=l}this.length=0;for(var g=0,y=a.length;g<y;g++){var v=a[g][0];if(v==null){continue}var m=v._private.data.id;if(!n||!o.has(m)){n&&o.set(m,{index:this.length,ele:v});this[this.length]=v;this.length++}}this._private={eles:this,cy:r,get map(){this.lazyMap==null&&this.rebuildMap();return this.lazyMap},set map(e){this.lazyMap=e},rebuildMap:function e(){var t=this.lazyMap=new Qt;var r=this.eles;for(var a=0;a<r.length;a++){var n=r[a];t.set(n.id(),{index:a,ele:n})}}};n&&(this._private.map=o);s&&!i&&this.restore()};var Md=tr.prototype=Nd.prototype=Object.create(Array.prototype);Md.instanceString=function(){return"collection"};Md.spawn=function(e,t){return new Nd(this.cy(),e,t)};Md.spawnSelf=function(){return this.spawn(this)};Md.cy=function(){return this._private.cy};Md.renderer=function(){return this._private.cy.renderer()};Md.element=function(){return this[0]};Md.collection=function(){if(N(this)){return this}else{return new Nd(this._private.cy,[this])}};Md.unique=function(){return new Nd(this._private.cy,this,!0)};Md.hasElementWithId=function(e){e=""+e;return this._private.map.has(e)};Md.getElementById=function(e){e=""+e;var t=this._private.cy;var r=this._private.map.get(e);return r?r.ele:new Nd(t)};Md.$id=Md.getElementById;Md.poolIndex=function(){var e=this._private.cy;var t=e._private.elements;var r=this[0]._private.data.id;return t._private.map.get(r).index};Md.indexOf=function(e){var t=e[0]._private.data.id;return this._private.map.get(t).index};Md.indexOfId=function(e){e=""+e;return this._private.map.get(e).index};Md.json=function(t){var r=this.element();var a=this.cy();if(r==null&&t){return this}if(r==null){return e}var n=r._private;if(k(t)){a.startBatch();if(t.data){r.data(t.data);var i=n.data;if(r.isEdge()){var o=!1,s={},l=t.data.source,c=t.data.target;if(l!=null&&l!=i.source){s.source=""+l;o=!0}if(c!=null&&c!=i.target){s.target=""+c;o=!0}o&&(r=r.move(s))}else{var d="parent"in t.data,p=t.data.parent;if(d&&(p!=null||i.parent!=null)&&p!=i.parent){p===e&&(p=null);p!=null&&(p=""+p);r=r.move({parent:p})}}}t.position&&r.position(t.position);var u=function e(a,i,o){var s=t[a];if(s!=null&&s!==n[a]){if(s){r[i]()}else{r[o]()}}};u("removed","remove","restore");u("selected","select","unselect");u("selectable","selectify","unselectify");u("locked","lock","unlock");u("grabbable","grabify","ungrabify");u("pannable","panify","unpanify");t.classes!=null&&r.classes(t.classes);a.endBatch();return this}else if(t===e){var f={data:qt(n.data),position:qt(n.position),group:n.group,removed:n.removed,selected:n.selected,selectable:n.selectable,locked:n.locked,grabbable:n.grabbable,pannable:n.pannable,classes:null};f.classes="";var h=0;n.classes.forEach(function(e){return f.classes+=h++===0?e:" "+e});return f}};Md.jsons=function(){var e=[];for(var t=0;t<this.length;t++){var r=this[t],a=r.json();e.push(a)}return e};Md.clone=function(){var e=this.cy();var t=[];for(var r=0;r<this.length;r++){var a=this[r],n=a.json(),i=new tr(e,n,!1);t.push(i)}return new Nd(e,t)};Md.copy=Md.clone;Md.restore=function(){var t=arguments.length>0&&arguments[0]!==e?arguments[0]:!0;var r=arguments.length>1&&arguments[1]!==e?arguments[1]:!0;var a=this;var n=a.cy();var i=n._private;var o=[];var s=[];var l;for(var c=0,d=a.length;c<d;c++){var p=a[c];if(r&&!p.removed()){continue}if(p.isNode()){o.push(p)}else{s.push(p)}}l=o.concat(s);var u;var f=function e(){l.splice(u,1);u--};for(u=0;u<l.length;u++){var h=l[u],g=h._private,y=g.data;h.clearTraversalCache();if(!r&&!g.removed);else if(y.id===e){y.id=$t()}else if(D(y.id)){y.id=""+y.id}else if(z(y.id)||!E(y.id)){Lt("Can not create element with invalid string ID `"+y.id+"`");f();continue}else if(n.hasElementWithId(y.id)){Lt("Can not create second element with ID `"+y.id+"`");f();continue}var v=y.id;if(h.isNode()){var m=g.position;m.x==null&&(m.x=0);m.y==null&&(m.y=0)}if(h.isEdge()){var b=h,x=["source","target"],_=x.length,w=!1;for(var S=0;S<_;S++){var P=x[S],C=y[P];D(C)&&(C=y[P]=""+y[P]);if(C==null||C===""){Lt("Can not create edge `"+v+"` with unspecified "+P);w=!0}else if(!n.hasElementWithId(C)){Lt("Can not create edge `"+v+"` with nonexistant "+P+" `"+C+"`");w=!0}}if(w){f();continue}var T=n.getElementById(y.source),I=n.getElementById(y.target);if(T.same(I)){T._private.edges.push(b)}else{T._private.edges.push(b);I._private.edges.push(b)}b._private.source=T;b._private.target=I}g.map=new Qt;g.map.set(v,{ele:h,index:0});g.removed=!1;r&&n.addToPool(h)}for(var k=0;k<o.length;k++){var R=o[k],B=R._private.data;D(B.parent)&&(B.parent=""+B.parent);var A=B.parent,O=A!=null;if(O||R._private.parent){var L=R._private.parent?n.collection().merge(R._private.parent):n.getElementById(A);if(L.empty()){B.parent=e}else if(L[0].removed()){Mt("Node added with missing parent, reference to parent removed");B.parent=e;R._private.parent=null}else{var N=!1,M=L;while(!M.empty()){if(R.same(M)){N=!0;B.parent=e;break}M=M.parent()}if(!N){L[0]._private.children.push(R);R._private.parent=L[0];i.hasCompoundNodes=!0}}}}if(l.length>0){var j=l.length===a.length?a:new Nd(n,l);for(var q=0;q<j.length;q++){var $=j[q];if($.isNode()){continue}$.parallelEdges().clearTraversalCache();$.source().clearTraversalCache();$.target().clearTraversalCache()}var V;if(i.hasCompoundNodes){V=n.collection().merge(j).merge(j.connectedNodes()).merge(j.parent())}else{V=j}V.dirtyCompoundBoundsCache().dirtyBoundingBoxCache().updateStyle(t);if(t){j.emitAndNotify("add")}else r&&j.emit("add")}
return a};Md.removed=function(){var e=this[0];return e&&e._private.removed};Md.inside=function(){var e=this[0];return e&&!e._private.removed};Md.remove=function(){var t=arguments.length>0&&arguments[0]!==e?arguments[0]:!0;var r=arguments.length>1&&arguments[1]!==e?arguments[1]:!0;var a=this;var n=[];var i={};var o=a._private.cy;function s(e){var t=e._private.edges;for(var r=0;r<t.length;r++){c(t[r])}}function l(e){var t=e._private.children;for(var r=0;r<t.length;r++){c(t[r])}}function c(e){var t=i[e.id()];if(r&&e.removed()||t){return}else{i[e.id()]=!0}if(e.isNode()){n.push(e);s(e);l(e)}else{n.unshift(e)}}for(var d=0,p=a.length;d<p;d++){var u=a[d];c(u)}function f(e,t){var r=e._private.edges;Ht(r,t);e.clearTraversalCache()}function h(e){e.clearTraversalCache()}var g=[];g.ids={};function y(e,t){t=t[0];e=e[0];var r=e._private.children;var a=e.id();Ht(r,t);t._private.parent=null;if(!g.ids[a]){g.ids[a]=!0;g.push(e)}}a.dirtyCompoundBoundsCache();r&&o.removeFromPool(n);for(var v=0;v<n.length;v++){var m=n[v];if(m.isEdge()){var b=m.source()[0],x=m.target()[0];f(b,m);f(x,m);var _=m.parallelEdges();for(var w=0;w<_.length;w++){var S=_[w];h(S);S.isBundledBezier()&&S.dirtyBoundingBoxCache()}}else{var P=m.parent();P.length!==0&&y(P,m)}r&&(m._private.removed=!0)}var C=o._private.elements;o._private.hasCompoundNodes=!1;for(var E=0;E<C.length;E++){var T=C[E];if(T.isParent()){o._private.hasCompoundNodes=!0;break}}var I=new Nd(this.cy(),n);if(I.size()>0){if(t){I.emitAndNotify("remove")}else r&&I.emit("remove")}for(var k=0;k<g.length;k++){var R=g[k];(!r||!R.removed())&&R.updateStyle()}return I};Md.move=function(t){var r=this._private.cy;var a=this;var n=!1;var i=!1;var o=function e(t){return t==null?t:""+t};if(t.source!==e||t.target!==e){var s=o(t.source),l=o(t.target),c=s!=null&&r.hasElementWithId(s),d=l!=null&&r.hasElementWithId(l);if(c||d){r.batch(function(){a.remove(n,i);a.emitAndNotify("moveout");for(var e=0;e<a.length;e++){var t=a[e],r=t._private.data;if(t.isEdge()){c&&(r.source=s);d&&(r.target=l)}}a.restore(n,i)});a.emitAndNotify("move")}}else if(t.parent!==e){var p=o(t.parent),u=p===null||r.hasElementWithId(p);if(u){var f=p===null?e:p;r.batch(function(){var e=a.remove(n,i);e.emitAndNotify("moveout");for(var t=0;t<a.length;t++){var r=a[t],o=r._private.data;r.isNode()&&(o.parent=f)}e.restore(n,i)});a.emitAndNotify("move")}}return this};[ai,ml,bl,Yl,Kl,rc,ac,Hc,sd,ld,dd,ud,gd,bd,Ed,kd].forEach(function(e){oe(Md,e)});var jd={add:function e(t){var r;var a=this;if(O(t)){var n=t;if(n._private.cy===a){r=n.restore()}else{var i=[];for(var o=0;o<n.length;o++){var s=n[o];i.push(s.json())}r=new Nd(a,i)}}else if(I(t)){var l=t;r=new Nd(a,l)}else if(k(t)&&(I(t.nodes)||I(t.edges))){var c=t,d=[],p=["nodes","edges"];for(var u=0,f=p.length;u<f;u++){var h=p[u],g=c[h];if(I(g)){for(var y=0,v=g.length;y<v;y++){var m=oe({group:h},g[y]);d.push(m)}}}r=new Nd(a,d)}else{var b=t;r=new tr(a,b).collection()}return r},remove:function e(t){if(O(t));else if(E(t)){var r=t;t=this.$(r)}return t.remove()}};function qd(e,t,r,a){var n=4,i=.001,o=1E-07,s=10,l=11,c=1/(l-1),d=typeof Float32Array!=="undefined";if(arguments.length!==4){return!1}for(var p=0;p<4;++p){if(typeof arguments[p]!=="number"||isNaN(arguments[p])||!isFinite(arguments[p])){return!1}}e=Math.min(e,1);r=Math.min(r,1);e=Math.max(e,0);r=Math.max(r,0);var u=d?new Float32Array(l):new Array(l);function f(e,t){return 1-3*t+3*e}function h(e,t){return 3*t-6*e}function g(e){return 3*e}function y(e,t,r){return((f(t,r)*e+h(t,r))*e+g(t))*e}function v(e,t,r){return 3*f(t,r)*e*e+2*h(t,r)*e+g(t)}function m(t,a){for(var i=0;i<n;++i){var o=v(a,e,r);if(o===0){return a}var s=y(a,e,r)-t;a-=s/o}return a}function b(){for(var t=0;t<l;++t){u[t]=y(t*c,e,r)}}function x(t,a,n){var i,l,c=0;do{l=a+(n-a)/2;i=y(l,e,r)-t;if(i>0){n=l}else{a=l}}while(Math.abs(i)>o&&++c<s);return l}function _(t){var a=0,n=1,o=l-1;for(;n!==o&&u[n]<=t;++n){a+=c}--n;var s=(t-u[n])/(u[n+1]-u[n]),d=a+s*c,p=v(d,e,r);if(p>=i){return m(t,d)}else if(p===0){return d}else{return x(t,a,a+c)}}var w=!1;function S(){w=!0;(e!==t||r!==a)&&b()}var P=function n(i){w||S();if(e===t&&r===a){return i}if(i===0){return 0}if(i===1){return 1}return y(_(i),t,a)};P.getControlPoints=function(){return[{x:e,y:t},{x:r,y:a}]};var C="generateBezier("+[e,t,r,a]+")";P.toString=function(){return C};return P}var zd=function(){function e(e){return-e.tension*e.x-e.friction*e.v}function t(t,r,a){var n={x:t.x+a.dx*r,v:t.v+a.dv*r,tension:t.tension,friction:t.friction};return{dx:n.v,dv:e(n)}}function r(r,a){var n={dx:r.v,dv:e(r)},i=t(r,a*.5,n),o=t(r,a*.5,i),s=t(r,a,o),l=1/6*(n.dx+2*(i.dx+o.dx)+s.dx),c=1/6*(n.dv+2*(i.dv+o.dv)+s.dv);r.x=r.x+l*a;r.v=r.v+c*a;return r}return function e(t,a,n){var i={x:-1,v:0,tension:null,friction:null},o=[0],s=0,l=1/1e4,c=16/1e3,d,p,u;t=parseFloat(t)||500;a=parseFloat(a)||20;n=n||null;i.tension=t;i.friction=a;d=n!==null;if(d){s=e(t,a);p=s/n*c}else{p=c}for(;;){u=r(u||i,p);o.push(1+u.x);s+=16;if(!(Math.abs(u.x)>l&&Math.abs(u.v)>l)){break}}return!d?s:function(e){return o[e*(o.length-1)|0]}}}();var $d=function e(t,r,a,n){var i=qd(t,r,a,n);return function(e,t,r){return e+(t-e)*i(r)}};var Vd={linear:function e(t,r,a){return t+(r-t)*a},ease:$d(.25,.1,.25,1),"ease-in":$d(.42,0,1,1),"ease-out":$d(0,0,.58,1),"ease-in-out":$d(.42,0,.58,1),"ease-in-sine":$d(.47,0,.745,.715),"ease-out-sine":$d(.39,.575,.565,1),"ease-in-out-sine":$d(.445,.05,.55,.95),"ease-in-quad":$d(.55,.085,.68,.53),"ease-out-quad":$d(.25,.46,.45,.94),"ease-in-out-quad":$d(.455,.03,.515,.955),"ease-in-cubic":$d(.55,.055,.675,.19),"ease-out-cubic":$d(.215,.61,.355,1),"ease-in-out-cubic":$d(.645,.045,.355,1),"ease-in-quart":$d(.895,.03,.685,.22),"ease-out-quart":$d(.165,.84,.44,1),"ease-in-out-quart":$d(.77,0,.175,1),"ease-in-quint":$d(.755,.05,.855,.06),"ease-out-quint":$d(.23,1,.32,1),"ease-in-out-quint":$d(.86,0,.07,1),"ease-in-expo":$d(.95,.05,.795,.035),"ease-out-expo":$d(.19,1,.22,1),"ease-in-out-expo":$d(1,0,0,1),"ease-in-circ":$d(.6,.04,.98,.335),"ease-out-circ":$d(.075,.82,.165,1),"ease-in-out-circ":$d(.785,.135,.15,.86),spring:function e(t,r,a){if(a===0){return Vd.linear}var e=zd(t,r,a);return function(t,r,a){return t+(r-t)*e(a)}},"cubic-bezier":$d};function Fd(t,r,a,n,i){if(n===1){return a}if(r===a){return a}var o=i(r,a,n);if(t==null){return o}(t.roundValue||t.color)&&(o=Math.round(o));t.min!==e&&(o=Math.max(o,t.min));t.max!==e&&(o=Math.min(o,t.max));return o}function Wd(e,t){if(e.pfValue!=null||e.value!=null){if(e.pfValue!=null&&(t==null||t.type.units!=="%")){return e.pfValue}else{return e.value}}else{return e}}function Hd(t,r,a,n,i){var o=i!=null?i.type:null;if(a<0){a=0}else a>1&&(a=1);var s=Wd(t,i);var l=Wd(r,i);if(D(s)&&D(l)){return Fd(o,s,l,a,n)}else if(I(s)&&I(l)){var c=[];for(var d=0;d<l.length;d++){var p=s[d],u=l[d];if(p!=null&&u!=null){var f=Fd(o,p,u,a,n);c.push(f)}else{c.push(u)}}return c}return e}function Xd(e,t,r,a){var n=!a;var i=e._private;var o=t._private;var s=o.easing;var l=o.startTime;var c=a?e:e.cy();var d=c.style();if(!o.easingImpl){if(s==null){o.easingImpl=Vd["linear"]}else{var p;if(E(s)){var u=d.parse("transition-timing-function",s);p=u.value}else{p=s}var f,h;if(E(p)){f=p;h=[]}else{f=p[1];h=p.slice(2).map(function(e){return+e})}if(h.length>0){f==="spring"&&h.push(o.duration);o.easingImpl=Vd[f].apply(null,h)}else{o.easingImpl=Vd[f]}}}var g=o.easingImpl;var y;if(o.duration===0){y=1}else{y=(r-l)/o.duration}o.applying&&(y=o.progress);if(y<0){y=0}else y>1&&(y=1);if(o.delay==null){var v=o.startPosition,m=o.position;if(m&&n&&!e.locked()){var b={};Yd(v.x,m.x)&&(b.x=Hd(v.x,m.x,y,g));Yd(v.y,m.y)&&(b.y=Hd(v.y,m.y,y,g));e.position(b)}var x=o.startPan,_=o.pan,w=i.pan,S=_!=null&&a;if(S){Yd(x.x,_.x)&&(w.x=Hd(x.x,_.x,y,g));Yd(x.y,_.y)&&(w.y=Hd(x.y,_.y,y,g));e.emit("pan")}var P=o.startZoom,C=o.zoom,T=C!=null&&a;if(T){Yd(P,C)&&(i.zoom=Hr(i.minZoom,Hd(P,C,y,g),i.maxZoom));e.emit("zoom")}(S||T)&&e.emit("viewport");var I=o.style;if(I&&I.length>0&&n){for(var k=0;k<I.length;k++){var R=I[k],D=R.name,B=R,A=o.startStyle[D],O=d.properties[A.name],L=Hd(A,B,y,g,O);d.overrideBypass(e,D,L)}e.emit("style")}}o.progress=y;return y}function Yd(e,t){if(e==null||t==null){return!1}if(D(e)&&D(t)){return!0}else if(e&&t){return!0}return!1}function Gd(e,t,r,a){var n=t._private;n.started=!0;n.startTime=r-n.progress*n.duration}function Kd(e,t){var r=t._private.aniEles;var a=[];function n(t,r){var n=t._private;var i=n.animation.current;var o=n.animation.queue;var s=!1;if(i.length===0){var l=o.shift();l&&i.push(l)}var c=function e(t){for(var r=t.length-1;r>=0;r--){var a=t[r];a()}t.splice(0,t.length)};for(var d=i.length-1;d>=0;d--){var p=i[d],u=p._private;if(u.stopped){i.splice(d,1);u.hooked=!1;u.playing=!1;u.started=!1;c(u.frames);continue}if(!u.playing&&!u.applying){continue}u.playing&&u.applying&&(u.applying=!1);u.started||Gd(t,p,e);Xd(t,p,e,r);u.applying&&(u.applying=!1);c(u.frames);u.step!=null&&u.step(e);if(p.completed()){i.splice(d,1);u.hooked=!1;u.playing=!1;u.started=!1;c(u.completes)}s=!0}!r&&i.length===0&&o.length===0&&a.push(t);return s}var i=!1;for(var o=0;o<r.length;o++){var s=r[o],l=n(s);i=i||l}var c=n(t,!0);if(i||c){if(r.length>0){t.notify("draw",r)}else{t.notify("draw")}}r.unmerge(a);t.emit("step")}var Ud={animate:vl.animate(),animation:vl.animation(),animated:vl.animated(),clearQueue:vl.clearQueue(),delay:vl.delay(),delayAnimation:vl.delayAnimation(),stop:vl.stop(),addToAnimationPool:function e(t){var r=this;if(!r.styleEnabled()){return}r._private.aniEles.merge(t)},stopAnimationLoop:function e(){this._private.animationsRunning=!1},startAnimationLoop:function e(){var t=this;t._private.animationsRunning=!0;if(!t.styleEnabled()){return}function r(){if(!t._private.animationsRunning){return}dt(function e(a){Kd(a,t);r()})}var a=t.renderer();if(a&&a.beforeRender){a.beforeRender(function e(r,a){Kd(a,t)},a.beforeRenderPriorities.animations)}else{r()}}};var Qd={qualifierCompare:function e(t,r){if(t==null||r==null){return t==null&&r==null}else{return t.sameText(r)}},eventMatches:function e(t,r,a){var n=r.qualifier;if(n!=null){return t!==a.target&&L(a.target)&&n.matches(a.target)}return!0},addEventFields:function e(t,r){r.cy=t;r.target=t},callbackContext:function e(t,r,a){return r.qualifier!=null?a.target:t}};var Zd=function e(t){if(E(t)){return new Hl(t)}else{return t}};var Jd={createEmitter:function e(){var t=this._private;t.emitter||(t.emitter=new ed(Qd,this));return this},emitter:function e(){return this._private.emitter},on:function e(t,r,a){this.emitter().on(t,Zd(r),a);return this},removeListener:function e(t,r,a){this.emitter().removeListener(t,Zd(r),a);return this},removeAllListeners:function e(){this.emitter().removeAllListeners();return this},one:function e(t,r,a){this.emitter().one(t,Zd(r),a);return this},once:function e(t,r,a){this.emitter().one(t,Zd(r),a);return this},emit:function e(t,r){this.emitter().emit(t,r);return this},emitAndNotify:function e(t,r){this.emit(t);this.notify(t,r);return this}};vl.eventAliasesOn(Jd);var ep={png:function e(t){var r=this._private.renderer;t=t||{};return r.png(t)},jpg:function e(t){var r=this._private.renderer;t=t||{};t.bg=t.bg||"#fff";return r.jpg(t)}};ep.jpeg=ep.jpg;var tp={layout:function e(t){var r=this;if(t==null){Lt("Layout options must be specified to make a layout");return}if(t.name==null){Lt("A `name` must be specified to make a layout");return}var a=t.name;var n=r.extension("layout",a);if(n==null){Lt("No such layout `"+a+"` found.  Did you forget to import it and `cytoscape.use()` it?");return}var i;if(E(t.eles)){i=r.$(t.eles)}else{i=t.eles!=null?t.eles:r.$()}var e=new n(oe({},t,{cy:r,eles:i}));return e}};tp.createLayout=tp.makeLayout=tp.layout;var rp={notify:function e(t,r){var a=this._private;if(this.batching()){a.batchNotifications=a.batchNotifications||{};var n=a.batchNotifications[t]=a.batchNotifications[t]||this.collection();r!=null&&n.merge(r);return}if(!a.notificationsEnabled){return}var i=this.renderer();if(this.destroyed()||!i){return}i.notify(t,r)},notifications:function t(r){var a=this._private;if(r===e){return a.notificationsEnabled}else{a.notificationsEnabled=r?!0:!1}return this},noNotifications:function e(t){this.notifications(!1);t();this.notifications(!0)},batching:function e(){return this._private.batchCount>0},startBatch:function e(){var t=this._private;t.batchCount==null&&(t.batchCount=0);if(t.batchCount===0){t.batchStyleEles=this.collection();t.batchNotifications={}}t.batchCount++;return this},endBatch:function e(){var t=this._private;if(t.batchCount===0){return this}t.batchCount--;if(t.batchCount===0){t.batchStyleEles.updateStyle();var r=this.renderer();Object.keys(t.batchNotifications).forEach(function(e){var a=t.batchNotifications[e];if(a.empty()){r.notify(e)}else{r.notify(e,a)}})}return this},batch:function e(t){this.startBatch();t();this.endBatch();return this},batchData:function e(t){var r=this;return this.batch(function(){var e=Object.keys(t);for(var a=0;a<e.length;a++){var n=e[a],i=t[n],o=r.getElementById(n);o.data(i)}})}};var ap=Wt({hideEdgesOnViewport:!1,textureOnViewport:!1,motionBlur:!1,motionBlurOpacity:.05,pixelRatio:e,desktopTapThreshold:4,touchTapThreshold:8,wheelSensitivity:1,debug:!1,showFps:!1,webgl:!1,webglDebug:!1,webglDebugShowAtlases:!1,webglTexSize:2048,webglTexRows:36,webglTexRowsNodes:18,webglBatchSize:2048,webglTexPerBatch:14,webglBgColor:[255,255,255]});var np={renderTo:function e(t,r,a,n){var i=this._private.renderer;i.renderTo(t,r,a,n);return this},renderer:function e(){return this._private.renderer},forceRender:function e(){this.notify("draw");return this},resize:function e(){this.invalidateSize();this.emitAndNotify("resize");return this},initRenderer:function t(r){var a=this;var n=a.extension("renderer",r.name);if(n==null){Lt("Can not initialise: No such renderer `".concat(r.name,"` found. Did you forget to import it and `cytoscape.use()` it?"));return}r.wheelSensitivity!==e&&Mt("You have set a custom wheel sensitivity.  This will make your app zoom unnaturally when using mainstream mice.  You should change this value from the default only if you can guarantee that all your users will use the same hardware and OS configuration as your current machine.");var i=ap(r);i.cy=a;a._private.renderer=new n(i);this.notify("init")},destroyRenderer:function e(){var t=this;t.notify("destroy");var r=t.container();if(r){r._cyreg=null;while(r.childNodes.length>0){r.removeChild(r.childNodes[0])}}t._private.renderer=null;t.mutableElements().forEach(function(e){var t=e._private;t.rscratch={};t.rstyle={};t.animation.current=[];t.animation.queue=[]})},onRender:function e(t){return this.on("render",t)},offRender:function e(t){return this.off("render",t)}};np.invalidateDimensions=np.resize;var ip={collection:function e(t,r){if(E(t)){return this.$(t)}else if(O(t)){return t.collection()}else if(I(t)){r||(r={});return new Nd(this,t,r.unique,r.removed)}return new Nd(this)},nodes:function e(t){var e=this.$(function(e){return e.isNode()});if(t){return e.filter(t)}return e},edges:function e(t){var e=this.$(function(e){return e.isEdge()});if(t){return e.filter(t)}return e},$:function e(t){var r=this._private.elements;if(t){return r.filter(t)}else{return r.spawnSelf()}},mutableElements:function e(){return this._private.elements}};ip.elements=ip.filter=ip.$;var op={};var sp="t";var lp="f";op.apply=function(e){var t=this;var r=t._private;var a=r.cy;var n=a.collection();for(var i=0;i<e.length;i++){var o=e[i],s=t.getContextMeta(o);if(s.empty){continue}var l=t.getContextStyle(s),c=t.applyContextStyle(s,l,o);if(o._private.appliedInitStyle){t.updateTransitions(o,c.diffProps)}else{o._private.appliedInitStyle=!0}var d=t.updateStyleHints(o);d&&n.push(o)}return n};op.getPropertiesDiff=function(t,r){var a=this;var n=a._private.propDiffs=a._private.propDiffs||{};var i=t+"-"+r;var o=n[i];if(o){return o}var s=[];var l={};for(var c=0;c<a.length;c++){var d=a[c],p=t[c]===sp,u=r[c]===sp,f=p!==u,h=d.mappedProperties.length>0;if(f||u&&h){var g=e;if(f&&h){g=d.properties}else if(f){g=d.properties}else h&&(g=d.mappedProperties);for(var y=0;y<g.length;y++){var v=g[y],m=v.name,b=!1;for(var x=c+1;x<a.length;x++){var _=a[x],w=r[x]===sp;if(!w){continue}b=_.properties[v.name]!=null;if(b){break}}if(!l[m]&&!b){l[m]=!0;s.push(m)}}}}n[i]=s;return s};op.getContextMeta=function(e){var t=this;var r="";var a;var n=e._private.styleCxtKey||"";for(var i=0;i<t.length;i++){var o=t[i],s=o.selector&&o.selector.matches(e);if(s){r+=sp}else{r+=lp}}a=t.getPropertiesDiff(n,r);e._private.styleCxtKey=r;return{key:r,diffPropNames:a,empty:a.length===0}};op.getContextStyle=function(e){var t=e.key;var r=this;var a=this._private.contextStyles=this._private.contextStyles||{};if(a[t]){return a[t]}var n={_private:{key:t}};for(var i=0;i<r.length;i++){var o=r[i],s=t[i]===sp;if(!s){continue}for(var l=0;l<o.properties.length;l++){var c=o.properties[l];n[c.name]=c}}a[t]=n;return n};op.applyContextStyle=function(e,t,r){var a=this;var n=e.diffPropNames;var i={};var o=a.types;for(var s=0;s<n.length;s++){var l=n[s],c=t[l],d=r.pstyle(l);if(!c){if(!d){continue}else if(d.bypass){c={name:l,deleteBypassed:!0}}else{c={name:l,delete:!0}}}if(d===c){continue}if(c.mapped===o.fn&&d!=null&&d.mapping!=null&&d.mapping.value===c.value){var p=d.mapping,u=p.fnValue=c.value(r);if(u===p.prevFnValue){continue}}var f=i[l]={prev:d};a.applyParsedProperty(r,c);f.next=r.pstyle(l);f.next&&f.next.bypass&&(f.next=f.next.bypassed)}return{diffProps:i}};op.updateStyleHints=function(t){var r=t._private;var a=this;var n=a.propertyGroupNames;var i=a.propertyGroupKeys;var o=function e(t,r,n){return a.getPropertiesHash(t,r,n)};var s=r.styleKey;if(t.removed()){return!1}var l=r.group==="nodes";var c=t._private.style;n=Object.keys(c);for(var d=0;d<i.length;d++){var p=i[d];r.styleKeys[p]=[pt,ft]}var u=function e(t,a){return r.styleKeys[a][0]=gt(t,r.styleKeys[a][0])};var f=function e(t,a){return r.styleKeys[a][1]=yt(t,r.styleKeys[a][1])};var h=function e(t,r){u(t,r);f(t,r)};var g=function e(t,r){for(var a=0;a<t.length;a++){var n=t.charCodeAt(a);u(n,r);f(n,r)}};var y=2e9;var v=function e(t){return-128<t&&t<128&&Math.floor(t)!==t?y-(t*1024|0):t};for(var m=0;m<n.length;m++){var b=n[m],x=c[b];if(x==null){continue}var _=this.properties[b],w=_.type,S=_.groupKey,P=e;if(_.hashOverride!=null){P=_.hashOverride(t,x)}else x.pfValue!=null&&(P=x.pfValue);var C=_.enums==null?x.value:null,E=P!=null,T=C!=null,I=E||T,k=x.units;if(w.number&&I&&!w.multiple){var R=E?P:C;h(v(R),S);!E&&k!=null&&g(k,S)}else{g(x.strValue,S)}}var D=[pt,ft];for(var B=0;B<i.length;B++){var A=i[B],O=r.styleKeys[A];D[0]=gt(O[0],D[0]);D[1]=yt(O[1],D[1])}r.styleKey=vt(D[0],D[1]);var L=r.styleKeys;r.labelDimsKey=mt(L.labelDimensions);var N=o(t,["label"],L.labelDimensions);r.labelKey=mt(N);r.labelStyleKey=mt(bt(L.commonLabel,N));if(!l){var M=o(t,["source-label"],L.labelDimensions);r.sourceLabelKey=mt(M);r.sourceLabelStyleKey=mt(bt(L.commonLabel,M));var j=o(t,["target-label"],L.labelDimensions);r.targetLabelKey=mt(j);r.targetLabelStyleKey=mt(bt(L.commonLabel,j))}if(l){var q=r.styleKeys,z=q.nodeBody,$=q.nodeBorder,V=q.nodeOutline,F=q.backgroundImage,W=q.compound,H=q.pie,X=q.stripe,Y=[z,$,V,F,W,H,X].filter(function(e){return e!=null}).reduce(bt,[pt,ft]);r.nodeKey=mt(Y);r.hasPie=H!=null&&H[0]!==pt&&H[1]!==ft;r.hasStripe=X!=null&&X[0]!==pt&&X[1]!==ft}return s!==r.styleKey};op.clearStyleHints=function(e){var t=e._private;t.styleCxtKey="";t.styleKeys={};t.styleKey=null;t.labelKey=null;t.labelStyleKey=null;t.sourceLabelKey=null;t.sourceLabelStyleKey=null;t.targetLabelKey=null;t.targetLabelStyleKey=null;t.nodeKey=null;t.hasPie=null;t.hasStripe=null};op.applyParsedProperty=function(t,r){var a=this;var n=r;var i=t._private.style;var o;var s=a.types;var l=a.properties[n.name].type;var c=n.bypass;var d=i[n.name];var p=d&&d.bypass;var u=t._private;var f="mapping";var h=function e(t){if(t==null){return null}else if(t.pfValue!=null){return t.pfValue}else{return t.value}};var g=function e(){var r=h(d);var i=h(n);a.checkTriggers(t,n.name,r,i)};r.name==="curve-style"&&t.isEdge()&&(r.value!=="bezier"&&t.isLoop()||r.value==="haystack"&&(t.source().isParent()||t.target().isParent()))&&(n=r=this.parse(r.name,"bezier",c));if(n["delete"]){i[n.name]=e;g();return!0}if(n.deleteBypassed){if(!d){g();return!0}else if(d.bypass){d.bypassed=e;g();return!0}else{return!1}}if(n.deleteBypass){if(!d){g();return!0}else if(d.bypass){i[n.name]=d.bypassed;g();return!0}else{return!1}}var y=function e(){Mt("Do not assign mappings to elements without corresponding data (i.e. ele `"+t.id()+"` has no mapping for property `"+n.name+"` with data field `"+n.field+"`); try a `["+n.field+"]` selector to limit scope to elements with `"+n.field+"` defined")};switch(n.mapped){case s.mapData:var v=n.field.split("."),m=u.data;for(var b=0;b<v.length&&m;b++){var x=v[b];m=m[x]}if(m==null){y();return!1}var _;if(!D(m)){Mt("Do not use continuous mappers without specifying numeric data (i.e. `"+n.field+": "+m+"` for `"+t.id()+"` is non-numeric)");return!1}else{var w=n.fieldMax-n.fieldMin;if(w===0){_=0}else{_=(m-n.fieldMin)/w}}if(_<0){_=0}else _>1&&(_=1);if(l.color){var S=n.valueMin[0],P=n.valueMax[0],C=n.valueMin[1],E=n.valueMax[1],T=n.valueMin[2],I=n.valueMax[2],k=n.valueMin[3]==null?1:n.valueMin[3],R=n.valueMax[3]==null?1:n.valueMax[3],B=[Math.round(S+(P-S)*_),Math.round(C+(E-C)*_),Math.round(T+(I-T)*_),Math.round(k+(R-k)*_)];o={bypass:n.bypass,name:n.name,value:B,strValue:"rgb("+B[0]+", "+B[1]+", "+B[2]+")"}}else if(l.number){var A=n.valueMin+(n.valueMax-n.valueMin)*_;o=this.parse(n.name,A,n.bypass,f)}else{return!1}if(!o){y();return!1}o.mapping=n;n=o;break;case s.data:var O=n.field.split("."),L=u.data;for(var N=0;N<O.length&&L;N++){var M=O[N];L=L[M]}L!=null&&(o=this.parse(n.name,L,n.bypass,f));if(!o){y();return!1}o.mapping=n;n=o;break;case s.fn:var j=n.value,q=n.fnValue!=null?n.fnValue:j(t);n.prevFnValue=q;if(q==null){Mt("Custom function mappers may not return null (i.e. `"+n.name+"` for ele `"+t.id()+"` is null)");return!1}o=this.parse(n.name,q,n.bypass,f);if(!o){Mt("Custom function mappers may not return invalid values for the property type (i.e. `"+n.name+"` for ele `"+t.id()+"` is invalid)");return!1}o.mapping=qt(n);n=o;break;case e:break;default:return!1}if(c){if(p){n.bypassed=d.bypassed}else{n.bypassed=d}i[n.name]=n}else{if(p){d.bypassed=n}else{i[n.name]=n}}g();return!0};op.cleanElements=function(e,t){for(var r=0;r<e.length;r++){var a=e[r];this.clearStyleHints(a);a.dirtyCompoundBoundsCache();a.dirtyBoundingBoxCache();if(!t){a._private.style={}}else{var n=a._private.style,i=Object.keys(n);for(var o=0;o<i.length;o++){var s=i[o],l=n[s];if(l!=null){if(l.bypass){l.bypassed=null}else{n[s]=null}}}}}};op.update=function(){var e=this._private.cy;var t=e.mutableElements();t.updateStyle()};op.updateTransitions=function(t,r){var a=this;var n=t._private;var i=t.pstyle("transition-property").value;var o=t.pstyle("transition-duration").pfValue;var s=t.pstyle("transition-delay").pfValue;if(i.length>0&&o>0){var l={},c=!1;for(var d=0;d<i.length;d++){var p=i[d],u=t.pstyle(p),f=r[p];if(!f){continue}var h=f.prev,g=h,y=f.next!=null?f.next:u,v=!1,m=e,b=1E-06;if(!g){continue}if(D(g.pfValue)&&D(y.pfValue)){v=y.pfValue-g.pfValue;m=g.pfValue+b*v}else if(D(g.value)&&D(y.value)){v=y.value-g.value;m=g.value+b*v}else if(I(g.value)&&I(y.value)){v=g.value[0]!==y.value[0]||g.value[1]!==y.value[1]||g.value[2]!==y.value[2];m=g.strValue}if(v){l[p]=y.strValue;this.applyBypass(t,p,m);c=!0}}if(!c){return}n.transitioning=!0;new fi(function(e){if(s>0){t.delayAnimation(s).play().promise().then(e)}else{e()}}).then(function(){return t.animation({style:l,duration:o,easing:t.pstyle("transition-timing-function").value,queue:!1}).play().promise()}).then(function(){a.removeBypasses(t,i);t.emitAndNotify("style");n.transitioning=!1})}else if(n.transitioning){this.removeBypasses(t,i);t.emitAndNotify("style");n.transitioning=!1}};op.checkTrigger=function(e,t,r,a,n,i){var o=this.properties[t];var s=n(o);if(e.removed()){return}s!=null&&s(r,a,e)&&i(o)};op.checkZOrderTrigger=function(e,t,r,a){var n=this;this.checkTrigger(e,t,r,a,function(e){return e.triggersZOrder},function(){n._private.cy.notify("zorder",e)})};op.checkBoundsTrigger=function(e,t,r,a){this.checkTrigger(e,t,r,a,function(e){return e.triggersBounds},function(t){e.dirtyCompoundBoundsCache();e.dirtyBoundingBoxCache()})};op.checkConnectedEdgesBoundsTrigger=function(e,t,r,a){this.checkTrigger(e,t,r,a,function(e){return e.triggersBoundsOfConnectedEdges},function(t){e.connectedEdges().forEach(function(e){e.dirtyBoundingBoxCache()})})};op.checkParallelEdgesBoundsTrigger=function(e,t,r,a){this.checkTrigger(e,t,r,a,function(e){return e.triggersBoundsOfParallelEdges},function(t){e.parallelEdges().forEach(function(e){e.dirtyBoundingBoxCache()})})};op.checkTriggers=function(e,t,r,a){e.dirtyStyleCache();this.checkZOrderTrigger(e,t,r,a);this.checkBoundsTrigger(e,t,r,a);this.checkConnectedEdgesBoundsTrigger(e,t,r,a);this.checkParallelEdgesBoundsTrigger(e,t,r,a)};var cp={};cp.applyBypass=function(t,r,a,n){var i=this;var o=[];var s=!0;if(r==="*"||r==="**"){if(a!==e){for(var l=0;l<i.properties.length;l++){var c=i.properties[l],d=c.name,p=this.parse(d,a,!0);p&&o.push(p)}}}else if(E(r)){var u=this.parse(r,a,!0);u&&o.push(u)}else if(k(r)){var f=r;n=a;var h=Object.keys(f);for(var g=0;g<h.length;g++){var y=h[g],v=f[y];v===e&&(v=f[Y(y)]);if(v!==e){var m=this.parse(y,v,!0);m&&o.push(m)}}}else{return!1}if(o.length===0){return!1}var b=!1;for(var x=0;x<t.length;x++){var _=t[x],w={},S=e;for(var P=0;P<o.length;P++){var C=o[P];if(n){var T=_.pstyle(C.name);S=w[C.name]={prev:T}}b=this.applyParsedProperty(_,qt(C))||b;n&&(S.next=_.pstyle(C.name))}b&&this.updateStyleHints(_);n&&this.updateTransitions(_,w,s)}return b};cp.overrideBypass=function(e,t,r){t=X(t);for(var a=0;a<e.length;a++){var n=e[a],i=n._private.style[t],o=this.properties[t].type,s=o.color,l=o.mutiple,c=!i?null:i.pfValue!=null?i.pfValue:i.value;if(!i||!i.bypass){this.applyBypass(n,t,r)}else{i.value=r;i.pfValue!=null&&(i.pfValue=r);if(s){i.strValue="rgb("+r.join(",")+")"}else if(l){i.strValue=r.join(" ")}else{i.strValue=""+r}this.updateStyleHints(n)}this.checkTriggers(n,t,c,r)}};cp.removeAllBypasses=function(e,t){return this.removeBypasses(e,this.propertyNames,t)};cp.removeBypasses=function(e,t,r){var a=!0;for(var n=0;n<e.length;n++){var i=e[n],o={};for(var s=0;s<t.length;s++){var l=t[s],c=this.properties[l],d=i.pstyle(c.name);if(!d||!d.bypass){continue}var p="",u=this.parse(l,p,!0),f=o[c.name]={prev:d};this.applyParsedProperty(i,u);f.next=i.pstyle(c.name)}this.updateStyleHints(i);r&&this.updateTransitions(i,o,a)}};var dp={};dp.getEmSizeInPixels=function(){var e=this.containerCss("font-size");if(e!=null){return parseFloat(e)}else{return 1}};dp.containerCss=function(e){var t=this._private.cy;var r=t.container();var a=t.window();if(a&&r&&a.getComputedStyle){return a.getComputedStyle(r).getPropertyValue(e)}};var pp={};pp.getRenderedStyle=function(e,t){if(t){return this.getStylePropertyValue(e,t,!0)}else{return this.getRawStyle(e,!0)}};pp.getRawStyle=function(e,t){var r=this;e=e[0];if(e){var a={};for(var n=0;n<r.properties.length;n++){var i=r.properties[n],o=r.getStylePropertyValue(e,i.name,t);if(o!=null){a[i.name]=o;a[Y(i.name)]=o}}return a}};pp.getIndexedStyle=function(e,t,r,a){var n=e.pstyle(t)[r][a];return n!=null?n:e.cy().style().getDefaultProperty(t)[r][0]};pp.getStylePropertyValue=function(e,t,r){var a=this;e=e[0];if(e){var n=a.properties[t];n.alias&&(n=n.pointsTo);var i=n.type,o=e.pstyle(n.name);if(o){var s=o.value,l=o.units,c=o.strValue;if(r&&i.number&&s!=null&&D(s)){var d=e.cy().zoom(),p=function e(t){return t*d},u=function e(t,r){return p(t)+r},f=I(s),h=f?l.every(function(e){return e!=null}):l!=null;if(h){if(f){return s.map(function(e,t){return u(e,l[t])}).join(" ")}else{return u(s,l)}}else{if(f){return s.map(function(e){return E(e)?e:""+p(e)}).join(" ")}else{return""+p(s)}}}else if(c!=null){return c}}return null}};pp.getAnimationStartStyle=function(t,r){var a={};for(var n=0;n<r.length;n++){var i=r[n],o=i.name,s=t.pstyle(o);if(s!==e){if(k(s)){s=this.parse(o,s.strValue)}else{s=this.parse(o,s)}}s&&(a[o]=s)}return a};pp.getPropsList=function(e){var t=this;var r=[];var a=t.properties;if(e){var n=Object.keys(e);for(var i=0;i<n.length;i++){var o=n[i],s=e[o],l=a[o]||a[X(o)],c=this.parse(l.name,s);c&&r.push(c)}}return r};pp.getNonDefaultPropertiesHash=function(e,t,r){var a=r.slice();var n,i,o,s;var l,c;for(l=0;l<t.length;l++){n=t[l];i=e.pstyle(n,!1);if(i==null){continue}else if(i.pfValue!=null){a[0]=gt(s,a[0]);a[1]=yt(s,a[1])}else{o=i.strValue;for(c=0;c<o.length;c++){s=o.charCodeAt(c);a[0]=gt(s,a[0]);a[1]=yt(s,a[1])}}}return a};pp.getPropertiesHash=pp.getNonDefaultPropertiesHash;var up={};up.appendFromJson=function(e){var t=this;for(var r=0;r<e.length;r++){var a=e[r],n=a.selector,i=a.style||a.css,o=Object.keys(i);t.selector(n);for(var s=0;s<o.length;s++){var l=o[s],c=i[l];t.css(l,c)}}return t};up.fromJson=function(e){var t=this;t.resetToDefault();t.appendFromJson(e);return t};up.json=function(){var e=[];for(var t=this.defaultLength;t<this.length;t++){var r=this[t],a=r.selector,n=r.properties,i={};for(var o=0;o<n.length;o++){var s=n[o];i[s.name]=s.strValue}e.push({selector:!a?"core":a.toString(),style:i})}return e};var fp={};fp.appendFromString=function(e){var t=this;var r=this;var a=""+e;var n;var i;var o;a=a.replace(/[/][*](\s|.)+?[*][/]/g,"");function s(){if(a.length>n.length){a=a.substr(n.length)}else{a=""}}function l(){if(i.length>o.length){i=i.substr(o.length)}else{i=""}}for(;;){var c=a.match(/^\s*$/);if(c){break}var d=a.match(/^\s*((?:.|\s)+?)\s*\{((?:.|\s)+?)\}/);if(!d){Mt("Halting stylesheet parsing: String stylesheet contains more to parse but no selector and block found in: "+a);break}n=d[0];var p=d[1];if(p!=="core"){var u=new Hl(p);if(u.invalid){Mt("Skipping parsing of block: Invalid selector found in string stylesheet: "+p);s();continue}}var f=d[2],h=!1;i=f;var g=[];for(;;){var y=i.match(/^\s*$/);if(y){break}var v=i.match(/^\s*(.+?)\s*:\s*(.+?)(?:\s*;|\s*$)/);if(!v){Mt("Skipping parsing of block: Invalid formatting of style property and value definitions found in:"+f);h=!0;break}o=v[0];var m=v[1],b=v[2],x=t.properties[m];if(!x){Mt("Skipping property: Invalid property name in: "+o);l();continue}var _=r.parse(m,b);if(!_){Mt("Skipping property: Invalid property definition in: "+o);l();continue}g.push({name:m,val:b});l()}if(h){s();break}r.selector(p);for(var w=0;w<g.length;w++){var S=g[w];r.css(S.name,S.val)}s()}return r};fp.fromString=function(e){var t=this;t.resetToDefault();t.appendFromString(e);return t};var hp={};(function(){var e=function e(t){return"^"+t+"\\s*\\(\\s*([\\w\\.]+)\\s*\\)$"};var t=function e(t){var r=Q+"|\\w+|"+J+"|"+te+"|"+re+"|"+ae;return"^"+t+"\\s*\\(([\\w\\.]+)\\s*\\,\\s*("+Q+")\\s*\\,\\s*("+Q+")\\s*,\\s*("+r+")\\s*\\,\\s*("+r+")\\)$"};var r=["^url\\s*\\(\\s*['\"]?(.+?)['\"]?\\s*\\)$","^(none)$","^(.+)$"];hp.types={time:{number:!0,min:0,units:"s|ms",implicitUnits:"ms"},percent:{number:!0,min:0,max:100,units:"%",implicitUnits:"%"},percentages:{number:!0,min:0,max:100,units:"%",implicitUnits:"%",multiple:!0},zeroOneNumber:{number:!0,min:0,max:1,unitless:!0},zeroOneNumbers:{number:!0,min:0,max:1,unitless:!0,multiple:!0},nOneOneNumber:{number:!0,min:-1,max:1,unitless:!0},nonNegativeInt:{number:!0,min:0,integer:!0,unitless:!0},nonNegativeNumber:{number:!0,min:0,unitless:!0},position:{enums:["parent","origin"]},nodeSize:{number:!0,min:0,enums:["label"]},number:{number:!0,unitless:!0},numbers:{number:!0,unitless:!0,multiple:!0},positiveNumber:{number:!0,unitless:!0,min:0,strictMin:!0},size:{number:!0,min:0},bidirectionalSize:{number:!0},bidirectionalSizeMaybePercent:{number:!0,allowPercent:!0},bidirectionalSizes:{number:!0,multiple:!0},sizeMaybePercent:{number:!0,min:0,allowPercent:!0},axisDirection:{enums:["horizontal","leftward","rightward","vertical","upward","downward","auto"]},axisDirectionExplicit:{enums:["leftward","rightward","upward","downward"]},axisDirectionPrimary:{enums:["horizontal","vertical"]},paddingRelativeTo:{enums:["width","height","average","min","max"]
},bgWH:{number:!0,min:0,allowPercent:!0,enums:["auto"],multiple:!0},bgPos:{number:!0,allowPercent:!0,multiple:!0},bgRelativeTo:{enums:["inner","include-padding"],multiple:!0},bgRepeat:{enums:["repeat","repeat-x","repeat-y","no-repeat"],multiple:!0},bgFit:{enums:["none","contain","cover"],multiple:!0},bgCrossOrigin:{enums:["anonymous","use-credentials","null"],multiple:!0},bgClip:{enums:["none","node"],multiple:!0},bgContainment:{enums:["inside","over"],multiple:!0},boxSelection:{enums:["contain","overlap","none"]},color:{color:!0},colors:{color:!0,multiple:!0},fill:{enums:["solid","linear-gradient","radial-gradient"]},bool:{enums:["yes","no"]},bools:{enums:["yes","no"],multiple:!0},lineStyle:{enums:["solid","dotted","dashed"]},lineCap:{enums:["butt","round","square"]},linePosition:{enums:["center","inside","outside"]},lineJoin:{enums:["round","bevel","miter"]},borderStyle:{enums:["solid","dotted","dashed","double"]},curveStyle:{enums:["bezier","unbundled-bezier","haystack","segments","straight","straight-triangle","taxi","round-segments","round-taxi"]},radiusType:{enums:["arc-radius","influence-radius"],multiple:!0},fontFamily:{regex:'^([\\w- \\"]+(?:\\s*,\\s*[\\w- \\"]+)*)$'},fontStyle:{enums:["italic","normal","oblique"]},fontWeight:{enums:["normal","bold","bolder","lighter","100","200","300","400","500","600","800","900",100,200,300,400,500,600,700,800,900]},textDecoration:{enums:["none","underline","overline","line-through"]},textTransform:{enums:["none","uppercase","lowercase"]},textWrap:{enums:["none","wrap","ellipsis"]},textOverflowWrap:{enums:["whitespace","anywhere"]},textBackgroundShape:{enums:["rectangle","roundrectangle","round-rectangle","circle"]},nodeShape:{enums:["rectangle","roundrectangle","round-rectangle","cutrectangle","cut-rectangle","bottomroundrectangle","bottom-round-rectangle","barrel","ellipse","triangle","round-triangle","square","pentagon","round-pentagon","hexagon","round-hexagon","concavehexagon","concave-hexagon","heptagon","round-heptagon","octagon","round-octagon","tag","round-tag","star","diamond","round-diamond","vee","rhomboid","right-rhomboid","polygon"]},overlayShape:{enums:["roundrectangle","round-rectangle","ellipse"]},cornerRadius:{number:!0,min:0,units:"px|em",implicitUnits:"px",enums:["auto"]},compoundIncludeLabels:{enums:["include","exclude"]},arrowShape:{enums:["tee","triangle","triangle-tee","circle-triangle","triangle-cross","triangle-backcurve","vee","square","circle","diamond","chevron","none"]},arrowFill:{enums:["filled","hollow"]},arrowWidth:{number:!0,units:"%|px|em",implicitUnits:"px",enums:["match-line"]},display:{enums:["element","none"]},visibility:{enums:["hidden","visible"]},zCompoundDepth:{enums:["bottom","orphan","auto","top"]},zIndexCompare:{enums:["auto","manual"]},valign:{enums:["top","center","bottom"]},halign:{enums:["left","center","right"]},justification:{enums:["left","center","right","auto"]},text:{string:!0},data:{mapping:!0,regex:e("data")},layoutData:{mapping:!0,regex:e("layoutData")},scratch:{mapping:!0,regex:e("scratch")},mapData:{mapping:!0,regex:t("mapData")},mapLayoutData:{mapping:!0,regex:t("mapLayoutData")},mapScratch:{mapping:!0,regex:t("mapScratch")},fn:{mapping:!0,fn:!0},url:{regexes:r,singleRegexMatchValue:!0},urls:{regexes:r,singleRegexMatchValue:!0,multiple:!0},propList:{propList:!0},angle:{number:!0,units:"deg|rad",implicitUnits:"rad"},textRotation:{number:!0,units:"deg|rad",implicitUnits:"rad",enums:["none","autorotate"]},polygonPointList:{number:!0,multiple:!0,evenMultiple:!0,min:-1,max:1,unitless:!0},edgeDistances:{enums:["intersection","node-position","endpoints"]},edgeEndpoint:{number:!0,multiple:!0,units:"%|px|em|deg|rad",implicitUnits:"px",enums:["inside-to-node","outside-to-node","outside-to-node-or-label","outside-to-line","outside-to-line-or-label"],singleEnum:!0,validate:function e(t,r){switch(t.length){case 2:return r[0]!=="deg"&&r[0]!=="rad"&&r[1]!=="deg"&&r[1]!=="rad";case 1:return E(t[0])||r[0]==="deg"||r[0]==="rad";default:return!1}}},easing:{regexes:["^(spring)\\s*\\(\\s*("+Q+")\\s*,\\s*("+Q+")\\s*\\)$","^(cubic-bezier)\\s*\\(\\s*("+Q+")\\s*,\\s*("+Q+")\\s*,\\s*("+Q+")\\s*,\\s*("+Q+")\\s*\\)$"],enums:["linear","ease","ease-in","ease-out","ease-in-out","ease-in-sine","ease-out-sine","ease-in-out-sine","ease-in-quad","ease-out-quad","ease-in-out-quad","ease-in-cubic","ease-out-cubic","ease-in-out-cubic","ease-in-quart","ease-out-quart","ease-in-out-quart","ease-in-quint","ease-out-quint","ease-in-out-quint","ease-in-expo","ease-out-expo","ease-in-out-expo","ease-in-circ","ease-out-circ","ease-in-out-circ"]},gradientDirection:{enums:["to-bottom","to-top","to-left","to-right","to-bottom-right","to-bottom-left","to-top-right","to-top-left","to-right-bottom","to-left-bottom","to-right-top","to-left-top"]},boundsExpansion:{number:!0,multiple:!0,min:0,validate:function e(t){var r=t.length;return r===1||r===2||r===4}}};var a={zeroNonZero:function e(t,r){if((t==null||r==null)&&t!==r){return!0}if(t==0&&r!=0){return!0}else if(t!=0&&r==0){return!0}else{return!1}},any:function e(t,r){return t!=r},emptyNonEmpty:function e(t,r){var a=z(t);var n=z(r);return a&&!n||!a&&n}};var n=hp.types;var i=[{name:"label",type:n.text,triggersBounds:a.any,triggersZOrder:a.emptyNonEmpty},{name:"text-rotation",type:n.textRotation,triggersBounds:a.any},{name:"text-margin-x",type:n.bidirectionalSize,triggersBounds:a.any},{name:"text-margin-y",type:n.bidirectionalSize,triggersBounds:a.any}];var o=[{name:"source-label",type:n.text,triggersBounds:a.any},{name:"source-text-rotation",type:n.textRotation,triggersBounds:a.any},{name:"source-text-margin-x",type:n.bidirectionalSize,triggersBounds:a.any},{name:"source-text-margin-y",type:n.bidirectionalSize,triggersBounds:a.any},{name:"source-text-offset",type:n.size,triggersBounds:a.any}];var s=[{name:"target-label",type:n.text,triggersBounds:a.any},{name:"target-text-rotation",type:n.textRotation,triggersBounds:a.any},{name:"target-text-margin-x",type:n.bidirectionalSize,triggersBounds:a.any},{name:"target-text-margin-y",type:n.bidirectionalSize,triggersBounds:a.any},{name:"target-text-offset",type:n.size,triggersBounds:a.any}];var l=[{name:"font-family",type:n.fontFamily,triggersBounds:a.any},{name:"font-style",type:n.fontStyle,triggersBounds:a.any},{name:"font-weight",type:n.fontWeight,triggersBounds:a.any},{name:"font-size",type:n.size,triggersBounds:a.any},{name:"text-transform",type:n.textTransform,triggersBounds:a.any},{name:"text-wrap",type:n.textWrap,triggersBounds:a.any},{name:"text-overflow-wrap",type:n.textOverflowWrap,triggersBounds:a.any},{name:"text-max-width",type:n.size,triggersBounds:a.any},{name:"text-outline-width",type:n.size,triggersBounds:a.any},{name:"line-height",type:n.positiveNumber,triggersBounds:a.any}];var c=[{name:"text-valign",type:n.valign,triggersBounds:a.any},{name:"text-halign",type:n.halign,triggersBounds:a.any},{name:"color",type:n.color},{name:"text-outline-color",type:n.color},{name:"text-outline-opacity",type:n.zeroOneNumber},{name:"text-background-color",type:n.color},{name:"text-background-opacity",type:n.zeroOneNumber},{name:"text-background-padding",type:n.size,triggersBounds:a.any},{name:"text-border-opacity",type:n.zeroOneNumber},{name:"text-border-color",type:n.color},{name:"text-border-width",type:n.size,triggersBounds:a.any},{name:"text-border-style",type:n.borderStyle,triggersBounds:a.any},{name:"text-background-shape",type:n.textBackgroundShape,triggersBounds:a.any},{name:"text-justification",type:n.justification},{name:"box-select-labels",type:n.bool,triggersBounds:a.any}];var d=[{name:"events",type:n.bool,triggersZOrder:a.any},{name:"text-events",type:n.bool,triggersZOrder:a.any},{name:"box-selection",type:n.boxSelection,triggersZOrder:a.any}];var p=[{name:"display",type:n.display,triggersZOrder:a.any,triggersBounds:a.any,triggersBoundsOfConnectedEdges:a.any,triggersBoundsOfParallelEdges:function e(t,r,a){if(t===r){return!1}return a.pstyle("curve-style").value==="bezier"}},{name:"visibility",type:n.visibility,triggersZOrder:a.any},{name:"opacity",type:n.zeroOneNumber,triggersZOrder:a.zeroNonZero},{name:"text-opacity",type:n.zeroOneNumber},{name:"min-zoomed-font-size",type:n.size},{name:"z-compound-depth",type:n.zCompoundDepth,triggersZOrder:a.any},{name:"z-index-compare",type:n.zIndexCompare,triggersZOrder:a.any},{name:"z-index",type:n.number,triggersZOrder:a.any}];var u=[{name:"overlay-padding",type:n.size,triggersBounds:a.any},{name:"overlay-color",type:n.color},{name:"overlay-opacity",type:n.zeroOneNumber,triggersBounds:a.zeroNonZero},{name:"overlay-shape",type:n.overlayShape,triggersBounds:a.any},{name:"overlay-corner-radius",type:n.cornerRadius}];var f=[{name:"underlay-padding",type:n.size,triggersBounds:a.any},{name:"underlay-color",type:n.color},{name:"underlay-opacity",type:n.zeroOneNumber,triggersBounds:a.zeroNonZero},{name:"underlay-shape",type:n.overlayShape,triggersBounds:a.any},{name:"underlay-corner-radius",type:n.cornerRadius}];var h=[{name:"transition-property",type:n.propList},{name:"transition-duration",type:n.time},{name:"transition-delay",type:n.time},{name:"transition-timing-function",type:n.easing}];var g=function e(t,r){if(r.value==="label"){return-t.poolIndex()}else{return r.pfValue}};var y=[{name:"height",type:n.nodeSize,triggersBounds:a.any,hashOverride:g},{name:"width",type:n.nodeSize,triggersBounds:a.any,hashOverride:g},{name:"shape",type:n.nodeShape,triggersBounds:a.any},{name:"shape-polygon-points",type:n.polygonPointList,triggersBounds:a.any},{name:"corner-radius",type:n.cornerRadius},{name:"background-color",type:n.color},{name:"background-fill",type:n.fill},{name:"background-opacity",type:n.zeroOneNumber},{name:"background-blacken",type:n.nOneOneNumber},{name:"background-gradient-stop-colors",type:n.colors},{name:"background-gradient-stop-positions",type:n.percentages},{name:"background-gradient-direction",type:n.gradientDirection},{name:"padding",type:n.sizeMaybePercent,triggersBounds:a.any},{name:"padding-relative-to",type:n.paddingRelativeTo,triggersBounds:a.any},{name:"bounds-expansion",type:n.boundsExpansion,triggersBounds:a.any}];var v=[{name:"border-color",type:n.color},{name:"border-opacity",type:n.zeroOneNumber},{name:"border-width",type:n.size,triggersBounds:a.any},{name:"border-style",type:n.borderStyle},{name:"border-cap",type:n.lineCap},{name:"border-join",type:n.lineJoin},{name:"border-dash-pattern",type:n.numbers},{name:"border-dash-offset",type:n.number},{name:"border-position",type:n.linePosition}];var m=[{name:"outline-color",type:n.color},{name:"outline-opacity",type:n.zeroOneNumber},{name:"outline-width",type:n.size,triggersBounds:a.any},{name:"outline-style",type:n.borderStyle},{name:"outline-offset",type:n.size,triggersBounds:a.any}];var b=[{name:"background-image",type:n.urls},{name:"background-image-crossorigin",type:n.bgCrossOrigin},{name:"background-image-opacity",type:n.zeroOneNumbers},{name:"background-image-containment",type:n.bgContainment},{name:"background-image-smoothing",type:n.bools},{name:"background-position-x",type:n.bgPos},{name:"background-position-y",type:n.bgPos},{name:"background-width-relative-to",type:n.bgRelativeTo},{name:"background-height-relative-to",type:n.bgRelativeTo},{name:"background-repeat",type:n.bgRepeat},{name:"background-fit",type:n.bgFit},{name:"background-clip",type:n.bgClip},{name:"background-width",type:n.bgWH},{name:"background-height",type:n.bgWH},{name:"background-offset-x",type:n.bgPos},{name:"background-offset-y",type:n.bgPos}];var x=[{name:"position",type:n.position,triggersBounds:a.any},{name:"compound-sizing-wrt-labels",type:n.compoundIncludeLabels,triggersBounds:a.any},{name:"min-width",type:n.size,triggersBounds:a.any},{name:"min-width-bias-left",type:n.sizeMaybePercent,triggersBounds:a.any},{name:"min-width-bias-right",type:n.sizeMaybePercent,triggersBounds:a.any},{name:"min-height",type:n.size,triggersBounds:a.any},{name:"min-height-bias-top",type:n.sizeMaybePercent,triggersBounds:a.any},{name:"min-height-bias-bottom",type:n.sizeMaybePercent,triggersBounds:a.any}];var _=[{name:"line-style",type:n.lineStyle},{name:"line-color",type:n.color},{name:"line-fill",type:n.fill},{name:"line-cap",type:n.lineCap},{name:"line-opacity",type:n.zeroOneNumber},{name:"line-dash-pattern",type:n.numbers},{name:"line-dash-offset",type:n.number},{name:"line-outline-width",type:n.size},{name:"line-outline-color",type:n.color},{name:"line-gradient-stop-colors",type:n.colors},{name:"line-gradient-stop-positions",type:n.percentages},{name:"curve-style",type:n.curveStyle,triggersBounds:a.any,triggersBoundsOfParallelEdges:function e(t,r){if(t===r){return!1}return t==="bezier"||r==="bezier"}},{name:"haystack-radius",type:n.zeroOneNumber,triggersBounds:a.any},{name:"source-endpoint",type:n.edgeEndpoint,triggersBounds:a.any},{name:"target-endpoint",type:n.edgeEndpoint,triggersBounds:a.any},{name:"control-point-step-size",type:n.size,triggersBounds:a.any},{name:"control-point-distances",type:n.bidirectionalSizes,triggersBounds:a.any},{name:"control-point-weights",type:n.numbers,triggersBounds:a.any},{name:"segment-distances",type:n.bidirectionalSizes,triggersBounds:a.any},{name:"segment-weights",type:n.numbers,triggersBounds:a.any},{name:"segment-radii",type:n.numbers,triggersBounds:a.any},{name:"radius-type",type:n.radiusType,triggersBounds:a.any},{name:"taxi-turn",type:n.bidirectionalSizeMaybePercent,triggersBounds:a.any},{name:"taxi-turn-min-distance",type:n.size,triggersBounds:a.any},{name:"taxi-direction",type:n.axisDirection,triggersBounds:a.any},{name:"taxi-radius",type:n.number,triggersBounds:a.any},{name:"edge-distances",type:n.edgeDistances,triggersBounds:a.any},{name:"arrow-scale",type:n.positiveNumber,triggersBounds:a.any},{name:"loop-direction",type:n.angle,triggersBounds:a.any},{name:"loop-sweep",type:n.angle,triggersBounds:a.any},{name:"source-distance-from-node",type:n.size,triggersBounds:a.any},{name:"target-distance-from-node",type:n.size,triggersBounds:a.any}];var w=[{name:"ghost",type:n.bool,triggersBounds:a.any},{name:"ghost-offset-x",type:n.bidirectionalSize,triggersBounds:a.any},{name:"ghost-offset-y",type:n.bidirectionalSize,triggersBounds:a.any},{name:"ghost-opacity",type:n.zeroOneNumber}];var S=[{name:"selection-box-color",type:n.color},{name:"selection-box-opacity",type:n.zeroOneNumber},{name:"selection-box-border-color",type:n.color},{name:"selection-box-border-width",type:n.size},{name:"active-bg-color",type:n.color},{name:"active-bg-opacity",type:n.zeroOneNumber},{name:"active-bg-size",type:n.size},{name:"outside-texture-bg-color",type:n.color},{name:"outside-texture-bg-opacity",type:n.zeroOneNumber}];var P=[];hp.pieBackgroundN=16;P.push({name:"pie-size",type:n.sizeMaybePercent});P.push({name:"pie-hole",type:n.sizeMaybePercent});P.push({name:"pie-start-angle",type:n.angle});for(var C=1;C<=hp.pieBackgroundN;C++){P.push({name:"pie-"+C+"-background-color",type:n.color});P.push({name:"pie-"+C+"-background-size",type:n.percent});P.push({name:"pie-"+C+"-background-opacity",type:n.zeroOneNumber})}var T=[];hp.stripeBackgroundN=16;T.push({name:"stripe-size",type:n.sizeMaybePercent});T.push({name:"stripe-direction",type:n.axisDirectionPrimary});for(var I=1;I<=hp.stripeBackgroundN;I++){T.push({name:"stripe-"+I+"-background-color",type:n.color});T.push({name:"stripe-"+I+"-background-size",type:n.percent});T.push({name:"stripe-"+I+"-background-opacity",type:n.zeroOneNumber})}var k=[];var R=hp.arrowPrefixes=["source","mid-source","target","mid-target"];[{name:"arrow-shape",type:n.arrowShape,triggersBounds:a.any},{name:"arrow-color",type:n.color},{name:"arrow-fill",type:n.arrowFill},{name:"arrow-width",type:n.arrowWidth}].forEach(function(e){R.forEach(function(t){var r=t+"-"+e.name;var a=e.type,n=e.triggersBounds;k.push({name:r,type:a,triggersBounds:n})})},{});var D=hp.properties=[].concat(d,h,p,u,f,w,c,l,i,o,s,y,v,m,b,P,T,x,_,k,S);var B=hp.propertyGroups={behavior:d,transition:h,visibility:p,overlay:u,underlay:f,ghost:w,commonLabel:c,labelDimensions:l,mainLabel:i,sourceLabel:o,targetLabel:s,nodeBody:y,nodeBorder:v,nodeOutline:m,backgroundImage:b,pie:P,stripe:T,compound:x,edgeLine:_,edgeArrow:k,core:S};var A=hp.propertyGroupNames={};var O=hp.propertyGroupKeys=Object.keys(B);O.forEach(function(e){A[e]=B[e].map(function(e){return e.name});B[e].forEach(function(t){return t.groupKey=e})});var L=hp.aliases=[{name:"content",pointsTo:"label"},{name:"control-point-distance",pointsTo:"control-point-distances"},{name:"control-point-weight",pointsTo:"control-point-weights"},{name:"segment-distance",pointsTo:"segment-distances"},{name:"segment-weight",pointsTo:"segment-weights"},{name:"segment-radius",pointsTo:"segment-radii"},{name:"edge-text-rotation",pointsTo:"text-rotation"},{name:"padding-left",pointsTo:"padding"},{name:"padding-right",pointsTo:"padding"},{name:"padding-top",pointsTo:"padding"},{name:"padding-bottom",pointsTo:"padding"}];hp.propertyNames=D.map(function(e){return e.name});for(var N=0;N<D.length;N++){var M=D[N];D[M.name]=M}for(var j=0;j<L.length;j++){var q=L[j],$=D[q.pointsTo],V={name:q.name,alias:!0,pointsTo:$};D.push(V);D[q.name]=V}})();hp.getDefaultProperty=function(e){return this.getDefaultProperties()[e]};hp.getDefaultProperties=function(){var e=this._private;if(e.defaultProperties!=null){return e.defaultProperties}var t=oe({"selection-box-color":"#ddd","selection-box-opacity":.65,"selection-box-border-color":"#aaa","selection-box-border-width":1,"active-bg-color":"black","active-bg-opacity":.15,"active-bg-size":30,"outside-texture-bg-color":"#000","outside-texture-bg-opacity":.125,events:"yes","text-events":"no","text-valign":"top","text-halign":"center","text-justification":"auto","line-height":1,color:"#000","box-selection":"contain","text-outline-color":"#000","text-outline-width":0,"text-outline-opacity":1,"text-opacity":1,"text-decoration":"none","text-transform":"none","text-wrap":"none","text-overflow-wrap":"whitespace","text-max-width":9999,"text-background-color":"#000","text-background-opacity":0,"text-background-shape":"rectangle","text-background-padding":0,"text-border-opacity":0,"text-border-width":0,"text-border-style":"solid","text-border-color":"#000","font-family":"Helvetica Neue, Helvetica, sans-serif","font-style":"normal","font-weight":"normal","font-size":16,"min-zoomed-font-size":0,"text-rotation":"none","source-text-rotation":"none","target-text-rotation":"none",visibility:"visible",display:"element",opacity:1,"z-compound-depth":"auto","z-index-compare":"auto","z-index":0,label:"","text-margin-x":0,"text-margin-y":0,"source-label":"","source-text-offset":0,"source-text-margin-x":0,"source-text-margin-y":0,"target-label":"","target-text-offset":0,"target-text-margin-x":0,"target-text-margin-y":0,"overlay-opacity":0,"overlay-color":"#000","overlay-padding":10,"overlay-shape":"round-rectangle","overlay-corner-radius":"auto","underlay-opacity":0,"underlay-color":"#000","underlay-padding":10,"underlay-shape":"round-rectangle","underlay-corner-radius":"auto","transition-property":"none","transition-duration":0,"transition-delay":0,"transition-timing-function":"linear","box-select-labels":"no","background-blacken":0,"background-color":"#999","background-fill":"solid","background-opacity":1,"background-image":"none","background-image-crossorigin":"anonymous","background-image-opacity":1,"background-image-containment":"inside","background-image-smoothing":"yes","background-position-x":"50%","background-position-y":"50%","background-offset-x":0,"background-offset-y":0,"background-width-relative-to":"include-padding","background-height-relative-to":"include-padding","background-repeat":"no-repeat","background-fit":"none","background-clip":"node","background-width":"auto","background-height":"auto","border-color":"#000","border-opacity":1,"border-width":0,"border-style":"solid","border-dash-pattern":[4,2],"border-dash-offset":0,"border-cap":"butt","border-join":"miter","border-position":"center","outline-color":"#999","outline-opacity":1,"outline-width":0,"outline-offset":0,"outline-style":"solid",height:30,width:30,shape:"ellipse","shape-polygon-points":"-1, -1,   1, -1,   1, 1,   -1, 1","corner-radius":"auto","bounds-expansion":0,"background-gradient-direction":"to-bottom","background-gradient-stop-colors":"#999","background-gradient-stop-positions":"0%",ghost:"no","ghost-offset-y":0,"ghost-offset-x":0,"ghost-opacity":0,padding:0,"padding-relative-to":"width",position:"origin","compound-sizing-wrt-labels":"include","min-width":0,"min-width-bias-left":0,"min-width-bias-right":0,"min-height":0,"min-height-bias-top":0,"min-height-bias-bottom":0},{"pie-size":"100%","pie-hole":0,"pie-start-angle":"0deg"},[{name:"pie-{{i}}-background-color",value:"black"},{name:"pie-{{i}}-background-size",value:"0%"},{name:"pie-{{i}}-background-opacity",value:1}].reduce(function(e,t){for(var r=1;r<=hp.pieBackgroundN;r++){var a=t.name.replace("{{i}}",r),n=t.value;e[a]=n}return e},{}),{"stripe-size":"100%","stripe-direction":"horizontal"},[{name:"stripe-{{i}}-background-color",value:"black"},{name:"stripe-{{i}}-background-size",value:"0%"},{name:"stripe-{{i}}-background-opacity",value:1}].reduce(function(e,t){for(var r=1;r<=hp.stripeBackgroundN;r++){var a=t.name.replace("{{i}}",r),n=t.value;e[a]=n}return e},{}),{"line-style":"solid","line-color":"#999","line-fill":"solid","line-cap":"butt","line-opacity":1,"line-outline-width":0,"line-outline-color":"#000","line-gradient-stop-colors":"#999","line-gradient-stop-positions":"0%","control-point-step-size":40,"control-point-weights":.5,"segment-weights":.5,"segment-distances":20,"segment-radii":15,"radius-type":"arc-radius","taxi-turn":"50%","taxi-radius":15,"taxi-turn-min-distance":10,"taxi-direction":"auto","edge-distances":"intersection","curve-style":"haystack","haystack-radius":0,"arrow-scale":1,"loop-direction":"-45deg","loop-sweep":"-90deg","source-distance-from-node":0,"target-distance-from-node":0,"source-endpoint":"outside-to-node","target-endpoint":"outside-to-node","line-dash-pattern":[6,3],"line-dash-offset":0},[{name:"arrow-shape",value:"none"},{name:"arrow-color",value:"#999"},{name:"arrow-fill",value:"filled"},{name:"arrow-width",value:1}].reduce(function(e,t){hp.arrowPrefixes.forEach(function(r){var a=r+"-"+t.name;var n=t.value;e[a]=n});return e},{}));var r={};for(var a=0;a<this.properties.length;a++){var n=this.properties[a];if(n.pointsTo){continue}var i=n.name,o=t[i],s=this.parse(i,o);r[i]=s}e.defaultProperties=r;return e.defaultProperties};hp.addDefaultStylesheet=function(){this.selector(":parent").css({shape:"rectangle",padding:10,"background-color":"#eee","border-color":"#ccc","border-width":1}).selector("edge").css({width:3}).selector(":loop").css({"curve-style":"bezier"}).selector("edge:compound").css({"curve-style":"bezier","source-endpoint":"outside-to-line","target-endpoint":"outside-to-line"}).selector(":selected").css({"background-color":"#0169D9","line-color":"#0169D9","source-arrow-color":"#0169D9","target-arrow-color":"#0169D9","mid-source-arrow-color":"#0169D9","mid-target-arrow-color":"#0169D9"}).selector(":parent:selected").css({"background-color":"#CCE1F9","border-color":"#aec8e5"}).selector(":active").css({"overlay-color":"black","overlay-padding":10,"overlay-opacity":.25});this.defaultLength=this.length};var gp={};gp.parse=function(e,t,r,a){var n=this;if(T(t)){return n.parseImplWarn(e,t,r,a)}var i=a==="mapping"||a===!0||a===!1||a==null?"dontcare":a;var o=r?"t":"f";var s=""+t;var l=wt(e,s,o,i);var c=n.propCache=n.propCache||[];var d;(d=c[l])||(d=c[l]=n.parseImplWarn(e,t,r,a));if(r||a==="mapping"){d=qt(d);d&&(d.value=qt(d.value))}return d};gp.parseImplWarn=function(e,t,r,a){var n=this.parseImpl(e,t,r,a);!n&&t!=null&&Mt("The style property `".concat(e,": ").concat(t,"` is invalid"));n&&(n.name==="width"||n.name==="height")&&t==="label"&&Mt("The style value of `label` is deprecated for `"+n.name+"`");return n};gp.parseImpl=function(t,r,a,n){var i=this;t=X(t);var o=i.properties[t];var s=r;var l=i.types;if(!o){return null}if(r===e){return null}if(o.alias){o=o.pointsTo;t=o.name}var c=E(r);c&&(r=r.trim());var d=o.type;if(!d){return null}if(a&&(r===""||r===null)){return{name:t,value:r,bypass:!0,deleteBypass:!0}}if(T(r)){return{name:t,value:r,strValue:"fn",mapped:l.fn,bypass:a}}var p,u;if(!c||n||r.length<7||r[1]!=="a");else if(r.length>=7&&r[0]==="d"&&(p=new RegExp(l.data.regex).exec(r))){if(a){return!1}var f=l.data;return{name:t,value:p,strValue:""+r,mapped:f,field:p[1],bypass:a}}else if(r.length>=10&&r[0]==="m"&&(u=new RegExp(l.mapData.regex).exec(r))){if(a){return!1}if(d.multiple){return!1}var h=l.mapData;if(!(d.color||d.number)){return!1}var g=this.parse(t,u[4]);if(!g||g.mapped){return!1}var y=this.parse(t,u[5]);if(!y||y.mapped){return!1}if(g.pfValue===y.pfValue||g.strValue===y.strValue){Mt("`"+t+": "+r+"` is not a valid mapper because the output range is zero; converting to `"+t+": "+g.strValue+"`");return this.parse(t,g.strValue)}else if(d.color){var v=g.value,m=y.value,b=v[0]===m[0]&&v[1]===m[1]&&v[2]===m[2]&&(v[3]===m[3]||(v[3]==null||v[3]===1)&&(m[3]==null||m[3]===1));if(b){return!1}}return{name:t,value:u,strValue:""+r,mapped:h,field:u[1],fieldMin:parseFloat(u[2]),fieldMax:parseFloat(u[3]),valueMin:g.value,valueMax:y.value,bypass:a}}if(d.multiple&&n!=="multiple"){var x;if(c){x=r.split(/\s+/)}else if(I(r)){x=r}else{x=[r]}if(d.evenMultiple&&x.length%2!==0){return null}var _=[],w=[],S=[],P="",C=!1;for(var k=0;k<x.length;k++){var R=i.parse(t,x[k],a,"multiple");C=C||E(R.value);_.push(R.value);S.push(R.pfValue!=null?R.pfValue:R.value);w.push(R.units);P+=(k>0?" ":"")+R.strValue}if(d.validate&&!d.validate(_,w)){return null}if(d.singleEnum&&C){if(_.length===1&&E(_[0])){return{name:t,value:_[0],strValue:_[0],bypass:a}}else{return null}}return{name:t,value:_,pfValue:S,strValue:P,bypass:a,units:w}}var D=function e(){for(var n=0;n<d.enums.length;n++){var i=d.enums[n];if(i===r){return{name:t,value:r,strValue:""+r,bypass:a}}}return null};if(d.number){var A,O="px";d.units&&(A=d.units);d.implicitUnits&&(O=d.implicitUnits);if(!d.unitless){if(c){var L="px|em"+(d.allowPercent?"|\\%":"");A&&(L=A);var N=r.match("^("+Q+")("+L+")?"+"$");if(N){r=N[1];A=N[2]||O}}else(!A||d.implicitUnits)&&(A=O)}r=parseFloat(r);if(isNaN(r)&&d.enums===e){return null}if(isNaN(r)&&d.enums!==e){r=s;return D()}if(d.integer&&!B(r)){return null}if(d.min!==e&&(r<d.min||d.strictMin&&r===d.min)||d.max!==e&&(r>d.max||d.strictMax&&r===d.max)){return null}var M={name:t,value:r,strValue:""+r+(A?A:""),units:A,bypass:a};if(d.unitless||A!=="px"&&A!=="em"){M.pfValue=r}else{M.pfValue=A==="px"||!A?r:this.getEmSizeInPixels()*r}(A==="ms"||A==="s")&&(M.pfValue=A==="ms"?r:1e3*r);(A==="deg"||A==="rad")&&(M.pfValue=A==="rad"?r:Lr(r));A==="%"&&(M.pfValue=r/100);return M}else if(d.propList){var j=[],q=""+r;if(q==="none");else{var z=q.split(/\s*,\s*|\s+/);for(var $=0;$<z.length;$++){var V=z[$].trim();if(i.properties[V]){j.push(V)}else{Mt("`"+V+"` is not a valid property name")}}if(j.length===0){return null}}return{name:t,value:j,strValue:j.length===0?"none":j.join(" "),bypass:a}}else if(d.color){var F=pe(r);if(!F){return null}return{name:t,value:F,pfValue:F,strValue:"rgb("+F[0]+","+F[1]+","+F[2]+")",bypass:a}}else if(d.regex||d.regexes){if(d.enums){var W=D();if(W){return W}}var H=d.regexes?d.regexes:[d.regex];for(var Y=0;Y<H.length;Y++){var G=new RegExp(H[Y]),K=G.exec(r);if(K){return{name:t,value:d.singleRegexMatchValue?K[1]:K,strValue:""+r,bypass:a}}}return null}else if(d.string){return{name:t,value:""+r,strValue:""+r,bypass:a}}else if(d.enums){return D()}else{return null}};var yp=function e(t){if(!(this instanceof yp)){return new yp(t)}if(!M(t)){Lt("A style must have a core reference");return}this._private={cy:t,coreStyle:{}};this.length=0;this.resetToDefault()};var vp=yp.prototype;vp.instanceString=function(){return"style"};vp.clear=function(){var t=this._private;var r=t.cy;var a=r.elements();for(var n=0;n<this.length;n++){this[n]=e}this.length=0;t.contextStyles={};t.propDiffs={};this.cleanElements(a,!0);a.forEach(function(e){var t=e[0]._private;t.styleDirty=!0;t.appliedInitStyle=!1});return this};vp.resetToDefault=function(){this.clear();this.addDefaultStylesheet();return this};vp.core=function(e){return this._private.coreStyle[e]||this.getDefaultProperty(e)};vp.selector=function(e){var t=e==="core"?null:new Hl(e);var r=this.length++;this[r]={selector:t,properties:[],mappedProperties:[],index:r};return this};vp.css=function(){var t=this;if(arguments.length===1){var r=arguments[0];for(var a=0;a<t.properties.length;a++){var n=t.properties[a],i=r[n.name];i===e&&(i=r[Y(n.name)]);i!==e&&this.cssRule(n.name,i)}}else arguments.length===2&&this.cssRule(arguments[0],arguments[1]);return this};vp.style=vp.css;vp.cssRule=function(e,t){var r=this.parse(e,t);if(r){var a=this.length-1;this[a].properties.push(r);this[a].properties[r.name]=r;r.name.match(/pie-(\d+)-background-size/)&&r.value&&(this._private.hasPie=!0);r.name.match(/stripe-(\d+)-background-size/)&&r.value&&(this._private.hasStripe=!0);r.mapped&&this[a].mappedProperties.push(r);var n=!this[a].selector;n&&(this._private.coreStyle[r.name]=r)}return this};vp.append=function(e){if(j(e)){e.appendToStyle(this)}else if(I(e)){this.appendFromJson(e)}else E(e)&&this.appendFromString(e);return this};yp.fromJson=function(e,t){var r=new yp(e);r.fromJson(t);return r};yp.fromString=function(e,t){return new yp(e).fromString(t)};[op,cp,dp,pp,up,fp,hp,gp].forEach(function(e){oe(vp,e)});yp.types=vp.types;yp.properties=vp.properties;yp.propertyGroups=vp.propertyGroups;yp.propertyGroupNames=vp.propertyGroupNames;yp.propertyGroupKeys=vp.propertyGroupKeys;var mp={style:function e(t){if(t){var r=this.setStyle(t);r.update()}return this._private.style},setStyle:function e(t){var r=this._private;if(j(t)){r.style=t.generateStyle(this)}else if(I(t)){r.style=yp.fromJson(this,t)}else if(E(t)){r.style=yp.fromString(this,t)}else{r.style=yp(this)}return r.style},updateStyle:function e(){this.mutableElements().updateStyle()}};var bp="single";var xp={autolock:function t(r){if(r!==e){this._private.autolock=r?!0:!1}else{return this._private.autolock}return this},autoungrabify:function t(r){if(r!==e){this._private.autoungrabify=r?!0:!1}else{return this._private.autoungrabify}return this},autounselectify:function t(r){if(r!==e){this._private.autounselectify=r?!0:!1}else{return this._private.autounselectify}return this},selectionType:function t(r){var a=this._private;a.selectionType==null&&(a.selectionType=bp);if(r!==e){(r==="additive"||r==="single")&&(a.selectionType=r)}else{return a.selectionType}return this},panningEnabled:function t(r){if(r!==e){this._private.panningEnabled=r?!0:!1}else{return this._private.panningEnabled}return this},userPanningEnabled:function t(r){if(r!==e){this._private.userPanningEnabled=r?!0:!1}else{return this._private.userPanningEnabled}return this},zoomingEnabled:function t(r){if(r!==e){this._private.zoomingEnabled=r?!0:!1}else{return this._private.zoomingEnabled}return this},userZoomingEnabled:function t(r){if(r!==e){this._private.userZoomingEnabled=r?!0:!1}else{return this._private.userZoomingEnabled}return this},boxSelectionEnabled:function t(r){if(r!==e){this._private.boxSelectionEnabled=r?!0:!1}else{return this._private.boxSelectionEnabled}return this},pan:function e(){var t=arguments;var e=this._private.pan;var r,a,n,i,o;switch(t.length){case 0:return e;case 1:if(E(arguments[0])){r=arguments[0];return e[r]}else if(k(arguments[0])){if(!this._private.panningEnabled){return this}n=arguments[0];i=n.x;o=n.y;D(i)&&(e.x=i);D(o)&&(e.y=o);this.emit("pan viewport")}break;case 2:if(!this._private.panningEnabled){return this}r=arguments[0];a=arguments[1];(r==="x"||r==="y")&&D(a)&&(e[r]=a);this.emit("pan viewport");break}this.notify("viewport");return this},panBy:function e(t,r){var a=arguments;var n=this._private.pan;var i,o,s,l,c;if(!this._private.panningEnabled){return this}switch(a.length){case 1:if(k(t)){s=arguments[0];l=s.x;c=s.y;D(l)&&(n.x+=l);D(c)&&(n.y+=c);this.emit("pan viewport")}
break;case 2:i=t;o=r;(i==="x"||i==="y")&&D(o)&&(n[i]+=o);this.emit("pan viewport");break}this.notify("viewport");return this},gc:function e(){this.notify("gc")},fit:function e(t,r){var a=this.getFitViewport(t,r);if(a){var n=this._private;n.zoom=a.zoom;n.pan=a.pan;this.emit("pan zoom viewport");this.notify("viewport")}return this},getFitViewport:function t(r,a){if(D(r)&&a===e){a=r;r=e}if(!this._private.panningEnabled||!this._private.zoomingEnabled){return}var n;if(E(r)){var i=r;r=this.$(i)}else if(V(r)){var o=r;n={x1:o.x1,y1:o.y1,x2:o.x2,y2:o.y2};n.w=n.x2-n.x1;n.h=n.y2-n.y1}else O(r)||(r=this.mutableElements());if(O(r)&&r.empty()){return}n=n||r.boundingBox();var s=this.width();var l=this.height();var c;a=D(a)?a:0;if(!isNaN(s)&&!isNaN(l)&&s>0&&l>0&&!isNaN(n.w)&&!isNaN(n.h)&&n.w>0&&n.h>0){c=Math.min((s-2*a)/n.w,(l-2*a)/n.h);c=c>this._private.maxZoom?this._private.maxZoom:c;c=c<this._private.minZoom?this._private.minZoom:c;var d={x:(s-c*(n.x1+n.x2))/2,y:(l-c*(n.y1+n.y2))/2};return{zoom:c,pan:d}}return},zoomRange:function t(r,a){var n=this._private;if(a==null){var i=r;r=i.min;a=i.max}if(D(r)&&D(a)&&r<=a){n.minZoom=r;n.maxZoom=a}else if(D(r)&&a===e&&r<=n.maxZoom){n.minZoom=r}else D(a)&&r===e&&a>=n.minZoom&&(n.maxZoom=a);return this},minZoom:function t(r){if(r===e){return this._private.minZoom}else{return this.zoomRange({min:r})}},maxZoom:function t(r){if(r===e){return this._private.maxZoom}else{return this.zoomRange({max:r})}},getZoomedViewport:function e(t){var r=this._private;var a=r.pan;var n=r.zoom;var i;var o;var s=!1;r.zoomingEnabled||(s=!0);if(D(t)){o=t}else if(k(t)){o=t.level;if(t.position!=null){i=Ir(t.position,n,a)}else t.renderedPosition!=null&&(i=t.renderedPosition);i!=null&&!r.panningEnabled&&(s=!0)}o=o>r.maxZoom?r.maxZoom:o;o=o<r.minZoom?r.minZoom:o;if(s||!D(o)||o===n||i!=null&&(!D(i.x)||!D(i.y))){return null}if(i!=null){var l=a,c=n,d=o,p={x:-d/c*(i.x-l.x)+i.x,y:-d/c*(i.y-l.y)+i.y};return{zoomed:!0,panned:!0,zoom:d,pan:p}}else{return{zoomed:!0,panned:!1,zoom:o,pan:a}}},zoom:function t(r){if(r===e){return this._private.zoom}else{var a=this.getZoomedViewport(r),n=this._private;if(a==null||!a.zoomed){return this}n.zoom=a.zoom;if(a.panned){n.pan.x=a.pan.x;n.pan.y=a.pan.y}this.emit("zoom"+(a.panned?" pan":"")+" viewport");this.notify("viewport");return this}},viewport:function e(t){var r=this._private;var a=!0;var n=!0;var i=[];var o=!1;var s=!1;if(!t){return this}D(t.zoom)||(a=!1);k(t.pan)||(n=!1);if(!a&&!n){return this}if(a){var l=t.zoom;if(l<r.minZoom||l>r.maxZoom||!r.zoomingEnabled){o=!0}else{r.zoom=l;i.push("zoom")}}if(n&&(!o||!t.cancelOnFailedZoom)&&r.panningEnabled){var c=t.pan;if(D(c.x)){r.pan.x=c.x;s=!1}if(D(c.y)){r.pan.y=c.y;s=!1}s||i.push("pan")}if(i.length>0){i.push("viewport");this.emit(i.join(" "));this.notify("viewport")}return this},center:function e(t){var r=this.getCenterPan(t);if(r){this._private.pan=r;this.emit("pan viewport");this.notify("viewport")}return this},getCenterPan:function t(r,a){if(!this._private.panningEnabled){return}if(E(r)){var n=r;r=this.mutableElements().filter(n)}else O(r)||(r=this.mutableElements());if(r.length===0){return}var i=r.boundingBox();var o=this.width();var s=this.height();a=a===e?this._private.zoom:a;var l={x:(o-a*(i.x1+i.x2))/2,y:(s-a*(i.y1+i.y2))/2};return l},reset:function e(){if(!this._private.panningEnabled||!this._private.zoomingEnabled){return this}this.viewport({pan:{x:0,y:0},zoom:1});return this},invalidateSize:function e(){this._private.sizeCache=null},size:function e(){var t=this._private;var r=t.container;var a=this;return t.sizeCache=t.sizeCache||(r?function(){var e=a.window().getComputedStyle(r);var t=function t(r){return parseFloat(e.getPropertyValue(r))};return{width:r.clientWidth-t("padding-left")-t("padding-right"),height:r.clientHeight-t("padding-top")-t("padding-bottom")}}():{width:1,height:1})},width:function e(){return this.size().width},height:function e(){return this.size().height},extent:function e(){var t=this._private.pan;var r=this._private.zoom;var a=this.renderedExtent();var n={x1:(a.x1-t.x)/r,x2:(a.x2-t.x)/r,y1:(a.y1-t.y)/r,y2:(a.y2-t.y)/r};n.w=n.x2-n.x1;n.h=n.y2-n.y1;return n},renderedExtent:function e(){var t=this.width();var r=this.height();return{x1:0,y1:0,x2:t,y2:r,w:t,h:r}},multiClickDebounceTime:function e(t){if(t)this._private.multiClickDebounceTime=t;else return this._private.multiClickDebounceTime;return this}};xp.centre=xp.center;xp.autolockNodes=xp.autolock;xp.autoungrabifyNodes=xp.autoungrabify;var _p={data:vl.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeData:vl.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),scratch:vl.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:vl.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0})};_p.attr=_p.data;_p.removeAttr=_p.removeData;var wp=function t(r){var a=this;r=oe({},r);var n=r.container;n&&!A(n)&&A(n[0])&&(n=n[0]);var i=n?n._cyreg:null;i=i||{};if(i&&i.cy){i.cy.destroy();i={}}var o=i.readies=i.readies||[];n&&(n._cyreg=i);i.cy=a;var s=b!==e&&n!==e&&!r.headless;var l=r;l.layout=oe({name:s?"grid":"null"},l.layout);l.renderer=oe({name:s?"canvas":"null"},l.renderer);var c=function t(r,a,n){if(a!==e){return a}else if(n!==e){return n}else{return r}};var d=this._private={container:n,ready:!1,options:l,elements:new Nd(this),listeners:[],aniEles:new Nd(this),data:l.data||{},scratch:{},layout:null,renderer:null,destroyed:!1,notificationsEnabled:!0,minZoom:1E-50,maxZoom:1E+50,zoomingEnabled:c(!0,l.zoomingEnabled),userZoomingEnabled:c(!0,l.userZoomingEnabled),panningEnabled:c(!0,l.panningEnabled),userPanningEnabled:c(!0,l.userPanningEnabled),boxSelectionEnabled:c(!0,l.boxSelectionEnabled),autolock:c(!1,l.autolock,l.autolockNodes),autoungrabify:c(!1,l.autoungrabify,l.autoungrabifyNodes),autounselectify:c(!1,l.autounselectify),styleEnabled:l.styleEnabled===e?s:l.styleEnabled,zoom:D(l.zoom)?l.zoom:1,pan:{x:k(l.pan)&&D(l.pan.x)?l.pan.x:0,y:k(l.pan)&&D(l.pan.y)?l.pan.y:0},animation:{current:[],queue:[]},hasCompoundNodes:!1,multiClickDebounceTime:c(250,l.multiClickDebounceTime)};this.createEmitter();this.selectionType(l.selectionType);this.zoomRange({min:l.minZoom,max:l.maxZoom});var p=function e(t,r){var a=t.some(F);if(a){return fi.all(t).then(r)}else{r(t)}};d.styleEnabled&&a.setStyle([]);var u=oe({},l,l.renderer);a.initRenderer(u);var f=function e(t,r,n){a.notifications(!1);var i=a.mutableElements();i.length>0&&i.remove();t!=null&&((k(t)||I(t))&&a.add(t));a.one("layoutready",function(e){a.notifications(!0);a.emit(e);a.one("load",r);a.emitAndNotify("load")}).one("layoutstop",function(){a.one("done",n);a.emit("done")});var o=oe({},a._private.options.layout);o.eles=a.elements();a.layout(o).run()};p([l.style,l.elements],function(e){var t=e[0];var r=e[1];d.styleEnabled&&a.style().append(t);f(r,function(){a.startAnimationLoop();d.ready=!0;T(l.ready)&&a.on("ready",l.ready);for(var e=0;e<o.length;e++){var t=o[e];a.on("ready",t)}i&&(i.readies=[]);a.emit("ready")},l.done)})};var Sp=wp.prototype;oe(Sp,{instanceString:function e(){return"core"},isReady:function e(){return this._private.ready},destroyed:function e(){return this._private.destroyed},ready:function e(t){if(this.isReady()){this.emitter().emit("ready",[],t)}else{this.on("ready",t)}return this},destroy:function e(){var t=this;if(t.destroyed())return;t.stopAnimationLoop();t.destroyRenderer();this.emit("destroy");t._private.destroyed=!0;return t},hasElementWithId:function e(t){return this._private.elements.hasElementWithId(t)},getElementById:function e(t){return this._private.elements.getElementById(t)},hasCompoundNodes:function e(){return this._private.hasCompoundNodes},headless:function e(){return this._private.renderer.isHeadless()},styleEnabled:function e(){return this._private.styleEnabled},addToPool:function e(t){this._private.elements.merge(t);return this},removeFromPool:function e(t){this._private.elements.unmerge(t);return this},container:function e(){return this._private.container||null},window:function t(){var r=this._private.container;if(r==null)return b;var a=this._private.container.ownerDocument;if(a===e||a==null){return b}return a.defaultView||b},mount:function e(t){if(t==null){return}var r=this;var a=r._private;var n=a.options;!A(t)&&A(t[0])&&(t=t[0]);r.stopAnimationLoop();r.destroyRenderer();a.container=t;a.styleEnabled=!0;r.invalidateSize();r.initRenderer(oe({},n,n.renderer,{name:n.renderer.name==="null"?"canvas":n.renderer.name}));r.startAnimationLoop();r.style(n.style);r.emit("mount");return r},unmount:function e(){var t=this;t.stopAnimationLoop();t.destroyRenderer();t.initRenderer({name:"null"});t.emit("unmount");return t},options:function e(){return qt(this._private.options)},json:function e(t){var r=this;var a=r._private;var n=r.mutableElements();var i=function e(t){return r.getElementById(t.id())};if(k(t)){r.startBatch();if(t.elements){var o={},s=function e(t,a){var n=[];var i=[];for(var s=0;s<t.length;s++){var l=t[s];if(!l.data.id){Mt("cy.json() cannot handle elements without an ID attribute");continue}var c=""+l.data.id,d=r.getElementById(c);o[c]=!0;if(d.length!==0){i.push({ele:d,json:l})}else{if(a){l.group=a;n.push(l)}else{n.push(l)}}}r.add(n);for(var p=0;p<i.length;p++){var u=i[p],f=u.ele,h=u.json;f.json(h)}};if(I(t.elements)){s(t.elements)}else{var l=["nodes","edges"];for(var c=0;c<l.length;c++){var d=l[c],p=t.elements[d];I(p)&&s(p,d)}}var u=r.collection();n.filter(function(e){return!o[e.id()]}).forEach(function(e){if(e.isParent()){u.merge(e)}else{e.remove()}});u.forEach(function(e){return e.children().move({parent:null})});u.forEach(function(e){return i(e).remove()})}t.style&&r.style(t.style);t.zoom!=null&&t.zoom!==a.zoom&&r.zoom(t.zoom);t.pan&&((t.pan.x!==a.pan.x||t.pan.y!==a.pan.y)&&r.pan(t.pan));t.data&&r.data(t.data);var f=["minZoom","maxZoom","zoomingEnabled","userZoomingEnabled","panningEnabled","userPanningEnabled","boxSelectionEnabled","autolock","autoungrabify","autounselectify","multiClickDebounceTime"];for(var h=0;h<f.length;h++){var g=f[h];t[g]!=null&&r[g](t[g])}r.endBatch();return this}else{var y=!!t,e={};if(y){e.elements=this.elements().map(function(e){return e.json()})}else{e.elements={};n.forEach(function(t){var r=t.group();e.elements[r]||(e.elements[r]=[]);e.elements[r].push(t.json())})}this._private.styleEnabled&&(e.style=r.style().json());e.data=qt(r.data());var v=a.options;e.zoomingEnabled=a.zoomingEnabled;e.userZoomingEnabled=a.userZoomingEnabled;e.zoom=a.zoom;e.minZoom=a.minZoom;e.maxZoom=a.maxZoom;e.panningEnabled=a.panningEnabled;e.userPanningEnabled=a.userPanningEnabled;e.pan=qt(a.pan);e.boxSelectionEnabled=a.boxSelectionEnabled;e.renderer=qt(v.renderer);e.hideEdgesOnViewport=v.hideEdgesOnViewport;e.textureOnViewport=v.textureOnViewport;e.wheelSensitivity=v.wheelSensitivity;e.motionBlur=v.motionBlur;e.multiClickDebounceTime=v.multiClickDebounceTime;return e}}});Sp.$id=Sp.getElementById;[jd,Ud,Jd,ep,tp,rp,np,ip,mp,xp,_p].forEach(function(e){oe(Sp,e)});var Pp={fit:!0,directed:!1,direction:"downward",padding:30,circle:!1,grid:!1,spacingFactor:1.75,boundingBox:e,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,roots:e,depthSort:e,animate:!1,animationDuration:500,animationEasing:e,animateFilter:function e(t,r){return!0},ready:e,stop:e,transform:function e(t,r){return r}};var Cp={maximal:!1,acyclic:!1};var Ep=function e(t){return t.scratch("breadthfirst")};var Tp=function e(t,r){return t.scratch("breadthfirst",r)};function Ip(e){this.options=oe({},Pp,Cp,e)}Ip.prototype.run=function(){var t=this.options;var r=t.cy;var a=t.eles;var n=a.nodes().filter(function(e){return e.isChildless()});var i=t.directed;var o=t.acyclic||t.maximal||t.maximalAdjustments>0;var s=!!t.boundingBox;var l=Xr(s?t.boundingBox:structuredClone(r.extent()));var c;if(O(t.roots)){c=t.roots}else if(I(t.roots)){var d=[];for(var p=0;p<t.roots.length;p++){var u=t.roots[p],f=r.getElementById(u);d.push(f)}c=r.collection(d)}else if(E(t.roots)){c=r.$(t.roots)}else{if(i){c=n.roots()}else{var h=a.components();c=r.collection();var g=function e(){var t=h[y];var r=t.maxDegree(!1);var a=t.filter(function(e){return e.degree(!1)===r});c=c.add(a)};for(var y=0;y<h.length;y++){g()}}}var v=[];var m={};var b=function e(t,r){v[r]==null&&(v[r]=[]);var a=v[r].length;v[r].push(t);Tp(t,{index:a,depth:r})};var x=function e(t,r){var a=Ep(t),n=a.depth,i=a.index;v[n][i]=null;t.isChildless()&&b(t,r)};a.bfs({roots:c,directed:t.directed,visit:function e(t,r,a,n,i){var o=t[0];var s=o.id();o.isChildless()&&b(o,i);m[s]=!0}});var _=[];for(var w=0;w<n.length;w++){var S=n[w];if(m[S.id()]){continue}else{_.push(S)}}var P=function e(t){var r=v[t];for(var a=0;a<r.length;a++){var n=r[a];if(n==null){r.splice(a,1);a--;continue}Tp(n,{depth:t,index:a})}};var C=function e(r,n){var i=Ep(r);var o=r.incomers().filter(function(e){return e.isNode()&&a.has(e)});var s=-1;var l=r.id();for(var c=0;c<o.length;c++){var d=o[c],p=Ep(d);s=Math.max(s,p.depth)}if(i.depth<=s){if(!t.acyclic&&n[l]){return null}var u=s+1;x(r,u);n[l]=u;return!0}return!1};if(i&&o){var T=[],k={},R=function e(t){return T.push(t)},D=function e(){return T.shift()};n.forEach(function(e){return T.push(e)});while(T.length>0){var B=D(),A=C(B,k);if(A){B.outgoers().filter(function(e){return e.isNode()&&a.has(e)}).forEach(R)}else if(A===null){Mt("Detected double maximal shift for node `"+B.id()+"`.  Bailing maximal adjustment due to cycle.  Use `options.maximal: true` only on DAGs.");break}}}var L=0;if(t.avoidOverlap){for(var N=0;N<n.length;N++){var M=n[N],j=M.layoutDimensions(t),q=j.w,z=j.h;L=Math.max(L,q,z)}}var $={};var V=function e(t){if($[t.id()]){return $[t.id()]}var r=Ep(t).depth;var a=t.neighborhood();var i=0;var o=0;for(var s=0;s<a.length;s++){var l=a[s];if(l.isEdge()||l.isParent()||!n.has(l)){continue}var c=Ep(l);if(c==null){continue}var d=c.index,p=c.depth;if(d==null||p==null){continue}var u=v[p].length;if(p<r){i+=d/u;o++}}o=Math.max(1,o);i=i/o;o===0&&(i=0);$[t.id()]=i;return i};var F=function e(t,r){var a=V(t);var n=V(r);var i=a-n;if(i===0){return ne(t.id(),r.id())}else{return i}};t.depthSort!==e&&(F=t.depthSort);var W=v.length;for(var H=0;H<W;H++){v[H].sort(F);P(H)}var X=[];for(var Y=0;Y<_.length;Y++){X.push(_[Y])}var G=function e(){for(var t=0;t<W;t++){P(t)}};if(X.length){v.unshift(X);W=v.length;G()}var K=0;for(var U=0;U<W;U++){K=Math.max(v[U].length,K)}var Q={x:l.x1+l.w/2,y:l.y1+l.h/2};var Z=n.reduce(function(e,r){return function(t){return{w:e.w===-1?t.w:(e.w+t.w)/2,h:e.h===-1?t.h:(e.h+t.h)/2}}(r.boundingBox({includeLabels:t.nodeDimensionsIncludeLabels}))},{w:-1,h:-1});var J=Math.max(W===1?0:s?(l.h-t.padding*2-Z.h)/(W-1):(l.h-t.padding*2-Z.h)/(W+1),L);var ee=v.reduce(function(e,t){return Math.max(e,t.length)},0);var te=function e(r){var a=Ep(r),n=a.depth,i=a.index;if(t.circle){var o=Math.min(l.w/2/W,l.h/2/W);o=Math.max(o,L);var c=o*n+o-(W>0&&v[0].length<=3?o/2:0),d=2*Math.PI/v[n].length*i;n===0&&v[0].length===1&&(c=1);return{x:Q.x+c*Math.cos(d),y:Q.y+c*Math.sin(d)}}else{var p=v[n].length,u=Math.max(p===1?0:s?(l.w-t.padding*2-Z.w)/((t.grid?ee:p)-1):(l.w-t.padding*2-Z.w)/((t.grid?ee:p)+1),L),f={x:Q.x+(i+1-(p+1)/2)*u,y:Q.y+(n+1-(W+1)/2)*J};return f}};var re={downward:0,leftward:90,upward:180,rightward:-90};Object.keys(re).indexOf(t.direction)===-1&&Lt("Invalid direction '".concat(t.direction,"' specified for breadthfirst layout. Valid values are: ").concat(Object.keys(re).join(", ")));var ae=function e(r){return Et(te(r),l,re[t.direction])};a.nodes().layoutPositions(this,t,ae);return this};var kp={fit:!0,padding:30,boundingBox:e,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,spacingFactor:e,radius:e,startAngle:3/2*Math.PI,sweep:e,clockwise:!0,sort:e,animate:!1,animationDuration:500,animationEasing:e,animateFilter:function e(t,r){return!0},ready:e,stop:e,transform:function e(t,r){return r}};function Rp(e){this.options=oe({},kp,e)}Rp.prototype.run=function(){var t=this.options;var r=t.cy;var a=t.eles;var n=t.counterclockwise!==e?!t.counterclockwise:t.clockwise;var i=a.nodes().not(":parent");t.sort&&(i=i.sort(t.sort));var o=Xr(t.boundingBox?t.boundingBox:{x1:0,y1:0,w:r.width(),h:r.height()});var s={x:o.x1+o.w/2,y:o.y1+o.h/2};var l=t.sweep===e?2*Math.PI-2*Math.PI/i.length:t.sweep;var c=l/Math.max(1,i.length-1);var d;var p=0;for(var u=0;u<i.length;u++){var f=i[u],h=f.layoutDimensions(t),g=h.w,y=h.h;p=Math.max(p,g,y)}if(D(t.radius)){d=t.radius}else if(i.length<=1){d=0}else{d=Math.min(o.h,o.w)/2-p}if(i.length>1&&t.avoidOverlap){p*=1.75;var v=Math.cos(c)-Math.cos(0),m=Math.sin(c)-Math.sin(0),b=Math.sqrt(p*p/(v*v+m*m));d=Math.max(b,d)}var x=function e(r,a){var i=t.startAngle+a*c*(n?1:-1);var o=d*Math.cos(i);var l=d*Math.sin(i);var p={x:s.x+o,y:s.y+l};return p};a.nodes().layoutPositions(this,t,x);return this};var Dp={fit:!0,padding:30,startAngle:3/2*Math.PI,sweep:e,clockwise:!0,equidistant:!1,minNodeSpacing:10,boundingBox:e,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,height:e,width:e,spacingFactor:e,concentric:function e(t){return t.degree()},levelWidth:function e(t){return t.maxDegree()/4},animate:!1,animationDuration:500,animationEasing:e,animateFilter:function e(t,r){return!0},ready:e,stop:e,transform:function e(t,r){return r}};function Bp(e){this.options=oe({},Dp,e)}Bp.prototype.run=function(){var t=this.options;var r=t.counterclockwise!==e?!t.counterclockwise:t.clockwise;var a=t.cy;var n=t.eles;var i=n.nodes().not(":parent");var o=Xr(t.boundingBox?t.boundingBox:{x1:0,y1:0,w:a.width(),h:a.height()});var s={x:o.x1+o.w/2,y:o.y1+o.h/2};var l=[];var c=0;for(var d=0;d<i.length;d++){var p=i[d],u=e;u=t.concentric(p);l.push({value:u,node:p});p._private.scratch.concentric=u}i.updateStyle();for(var f=0;f<i.length;f++){var h=i[f],g=h.layoutDimensions(t);c=Math.max(c,g.w,g.h)}l.sort(function(e,t){return t.value-e.value});var y=t.levelWidth(i);var v=[[]];var m=v[0];for(var b=0;b<l.length;b++){var x=l[b];if(m.length>0){var _=Math.abs(m[0].value-x.value);if(_>=y){m=[];v.push(m)}}m.push(x)}var w=c+t.minNodeSpacing;if(!t.avoidOverlap){var S=v.length>0&&v[0].length>1,P=Math.min(o.w,o.h)/2-w,C=P/(v.length+S?1:0);w=Math.min(w,C)}var E=0;for(var T=0;T<v.length;T++){var I=v[T],k=t.sweep===e?2*Math.PI-2*Math.PI/I.length:t.sweep,R=I.dTheta=k/Math.max(1,I.length-1);if(I.length>1&&t.avoidOverlap){var D=Math.cos(R)-Math.cos(0),B=Math.sin(R)-Math.sin(0),A=Math.sqrt(w*w/(D*D+B*B));E=Math.max(A,E)}I.r=E;E+=w}if(t.equidistant){var O=0,L=0;for(var N=0;N<v.length;N++){var M=v[N],j=M.r-L;O=Math.max(O,j)}L=0;for(var q=0;q<v.length;q++){var z=v[q];q===0&&(L=z.r);z.r=L;L+=O}}var $={};for(var V=0;V<v.length;V++){var F=v[V],W=F.dTheta,H=F.r;for(var X=0;X<F.length;X++){var Y=F[X],G=t.startAngle+(r?1:-1)*W*X,K={x:s.x+H*Math.cos(G),y:s.y+H*Math.sin(G)};$[Y.node.id()]=K}}n.nodes().layoutPositions(this,t,function(e){var t=e.id();return $[t]});return this};var Ap;var Op={ready:function e(){},stop:function e(){},animate:!0,animationEasing:e,animationDuration:e,animateFilter:function e(t,r){return!0},animationThreshold:250,refresh:20,fit:!0,padding:30,boundingBox:e,nodeDimensionsIncludeLabels:!1,randomize:!1,componentSpacing:40,nodeRepulsion:function e(t){return 2048},nodeOverlap:4,idealEdgeLength:function e(t){return 32},edgeElasticity:function e(t){return 32},nestingFactor:1.2,gravity:1,numIter:1e3,initialTemp:1e3,coolingFactor:.99,minTemp:1};function Lp(e){this.options=oe({},Op,e);this.options.layout=this;var t=this.options.eles.nodes();var r=this.options.eles.edges();var a=r.filter(function(e){var r=e.source().data("id");var a=e.target().data("id");var n=t.some(function(e){return e.data("id")===r});var i=t.some(function(e){return e.data("id")===a});return!n||!i});this.options.eles=this.options.eles.not(a)}Lp.prototype.run=function(){var e=this.options;var t=e.cy;var r=this;r.stopped=!1;(e.animate===!0||e.animate===!1)&&r.emit({type:"layoutstart",layout:r});if(!0===e.debug){Ap=!0}else{Ap=!1}var a=Np(t,r,e);Ap&&qp(a);e.randomize&&zp(a);var n=lt();var i=function r(){Vp(a,t,e);!0===e.fit&&t.fit(e.padding)};var o=function t(n){if(r.stopped||n>=e.numIter){return!1}Fp(a,e);a.temperature=a.temperature*e.coolingFactor;if(a.temperature<e.minTemp){return!1}return!0};var s=function t(){if(e.animate===!0||e.animate===!1){i();r.one("layoutstop",e.stop);r.emit({type:"layoutstop",layout:r})}else{var n=e.eles.nodes(),o=$p(a,e,n);n.layoutPositions(r,e,o)}};var l=0;var c=!0;if(e.animate===!0){var d=function t(){var r=0;while(c&&r<e.refresh){c=o(l);l++;r++}if(!c){tu(a,e);s()}else{var p=lt();p-n>=e.animationThreshold&&i();dt(d)}};d()}else{while(c){c=o(l);l++}tu(a,e);s()}return this};Lp.prototype.stop=function(){this.stopped=!0;this.thread&&this.thread.stop();this.emit("layoutstop");return this};Lp.prototype.destroy=function(){this.thread&&this.thread.stop();return this};var Np=function e(t,r,a){var n=a.eles.edges();var i=a.eles.nodes();var o=Xr(a.boundingBox?a.boundingBox:{x1:0,y1:0,w:t.width(),h:t.height()});var s={isCompound:t.hasCompoundNodes(),layoutNodes:[],idToIndex:{},nodeSize:i.size(),graphSet:[],indexToGraph:[],layoutEdges:[],edgeSize:n.size(),temperature:a.initialTemp,clientWidth:o.w,clientHeight:o.h,boundingBox:o};var l=a.eles.components();var c={};for(var d=0;d<l.length;d++){var p=l[d];for(var u=0;u<p.length;u++){var f=p[u];c[f.id()]=d}}for(var d=0;d<s.nodeSize;d++){var h=i[d],g=h.layoutDimensions(a),y={};y.isLocked=h.locked();y.id=h.data("id");y.parentId=h.data("parent");y.cmptId=c[h.id()];y.children=[];y.positionX=h.position("x");y.positionY=h.position("y");y.offsetX=0;y.offsetY=0;y.height=g.w;y.width=g.h;y.maxX=y.positionX+y.width/2;y.minX=y.positionX-y.width/2;y.maxY=y.positionY+y.height/2;y.minY=y.positionY-y.height/2;y.padLeft=parseFloat(h.style("padding"));y.padRight=parseFloat(h.style("padding"));y.padTop=parseFloat(h.style("padding"));y.padBottom=parseFloat(h.style("padding"));y.nodeRepulsion=T(a.nodeRepulsion)?a.nodeRepulsion(h):a.nodeRepulsion;s.layoutNodes.push(y);s.idToIndex[y.id]=d}var v=[];var m=0;var b=-1;var x=[];for(var d=0;d<s.nodeSize;d++){var h=s.layoutNodes[d],_=h.parentId;if(null!=_){s.layoutNodes[s.idToIndex[_]].children.push(h.id)}else{v[++b]=h.id;x.push(h.id)}}s.graphSet.push(x);while(m<=b){var w=v[m++],S=s.idToIndex[w],f=s.layoutNodes[S],P=f.children;if(P.length>0){s.graphSet.push(P);for(var d=0;d<P.length;d++){v[++b]=P[d]}}}for(var d=0;d<s.graphSet.length;d++){var C=s.graphSet[d];for(var u=0;u<C.length;u++){var E=s.idToIndex[C[u]];s.indexToGraph[E]=d}}for(var d=0;d<s.edgeSize;d++){var I=n[d],k={};k.id=I.data("id");k.sourceId=I.data("source");k.targetId=I.data("target");var R=T(a.idealEdgeLength)?a.idealEdgeLength(I):a.idealEdgeLength,D=T(a.edgeElasticity)?a.edgeElasticity(I):a.edgeElasticity,B=s.idToIndex[k.sourceId],A=s.idToIndex[k.targetId],O=s.indexToGraph[B],L=s.indexToGraph[A];if(O!=L){var N=Mp(k.sourceId,k.targetId,s),M=s.graphSet[N],j=0,y=s.layoutNodes[B];while(-1===M.indexOf(y.id)){y=s.layoutNodes[s.idToIndex[y.parentId]];j++}y=s.layoutNodes[A];while(-1===M.indexOf(y.id)){y=s.layoutNodes[s.idToIndex[y.parentId]];j++}R*=j*a.nestingFactor}k.idealLength=R;k.elasticity=D;s.layoutEdges.push(k)}return s};var Mp=function e(t,r,a){var n=jp(t,r,0,a);if(2>n.count){return 0}else{return n.graph}};var jp=function e(t,r,a,n){var i=n.graphSet[a];if(-1<i.indexOf(t)&&-1<i.indexOf(r)){return{count:2,graph:a}}var o=0;for(var s=0;s<i.length;s++){var l=i[s],c=n.idToIndex[l],d=n.layoutNodes[c].children;if(0===d.length){continue}var p=n.indexToGraph[n.idToIndex[d[0]]],u=jp(t,r,p,n);if(0===u.count){continue}else if(1===u.count){o++;if(2===o){break}}else{return u}}return{count:o,graph:a}};var qp;var zp=function e(t,r){var a=t.clientWidth;var n=t.clientHeight;for(var i=0;i<t.nodeSize;i++){var o=t.layoutNodes[i];if(0===o.children.length&&!o.isLocked){o.positionX=Math.random()*a;o.positionY=Math.random()*n}}};var $p=function e(t,r,a){var n=t.boundingBox;var i={x1:Infinity,x2:-Infinity,y1:Infinity,y2:-Infinity};if(r.boundingBox){a.forEach(function(e){var r=t.layoutNodes[t.idToIndex[e.data("id")]];i.x1=Math.min(i.x1,r.positionX);i.x2=Math.max(i.x2,r.positionX);i.y1=Math.min(i.y1,r.positionY);i.y2=Math.max(i.y2,r.positionY)});i.w=i.x2-i.x1;i.h=i.y2-i.y1}return function(e,a){var o=t.layoutNodes[t.idToIndex[e.data("id")]];if(r.boundingBox){var s=i.w===0?.5:(o.positionX-i.x1)/i.w,l=i.h===0?.5:(o.positionY-i.y1)/i.h;return{x:n.x1+s*n.w,y:n.y1+l*n.h}}else{return{x:o.positionX,y:o.positionY}}}};var Vp=function e(t,r,a){var n=a.layout;var i=a.eles.nodes();var o=$p(t,a,i);i.positions(o);if(!0!==t.ready){t.ready=!0;n.one("layoutready",a.ready);n.emit({type:"layoutready",layout:this})}};var Fp=function e(t,r,a){Wp(t,r);Kp(t);Up(t,r);Qp(t);Zp(t)};var Wp=function e(t,r){for(var a=0;a<t.graphSet.length;a++){var n=t.graphSet[a],i=n.length;for(var o=0;o<i;o++){var s=t.layoutNodes[t.idToIndex[n[o]]];for(var l=o+1;l<i;l++){var c=t.layoutNodes[t.idToIndex[n[l]]];Xp(s,c,t,r)}}}};var Hp=function e(t){return-1+2*t*Math.random()};var Xp=function e(t,r,a,n){var i=t.cmptId;var o=r.cmptId;if(i!==o&&!a.isCompound){return}var s=r.positionX-t.positionX;var l=r.positionY-t.positionY;var c=1;if(0===s&&0===l){s=Hp(c);l=Hp(c)}var d=Yp(t,r,s,l);if(d>0){var p=n.nodeOverlap*d,u=Math.sqrt(s*s+l*l),f=p*s/u,h=p*l/u}else{var g=Gp(t,s,l),y=Gp(r,-1*s,-1*l),v=y.x-g.x,m=y.y-g.y,b=v*v+m*m,u=Math.sqrt(b),p=(t.nodeRepulsion+r.nodeRepulsion)/b,f=p*v/u,h=p*m/u}if(!t.isLocked){t.offsetX-=f;t.offsetY-=h}if(!r.isLocked){r.offsetX+=f;r.offsetY+=h}return};var Yp=function e(t,r,a,n){if(a>0){var i=t.maxX-r.minX}else{var i=r.maxX-t.minX}if(n>0){var o=t.maxY-r.minY}else{var o=r.maxY-t.minY}if(i>=0&&o>=0){return Math.sqrt(i*i+o*o)}else{return 0}};var Gp=function e(t,r,a){var n=t.positionX;var i=t.positionY;var o=t.height||1;var s=t.width||1;var l=a/r;var c=o/s;var d={};if(0===r&&0<a){d.x=n;d.y=i+o/2;return d}if(0===r&&0>a){d.x=n;d.y=i+o/2;return d}if(0<r&&-1*c<=l&&l<=c){d.x=n+s/2;d.y=i+s*a/2/r;return d}if(0>r&&-1*c<=l&&l<=c){d.x=n-s/2;d.y=i-s*a/2/r;return d}if(0<a&&(l<=-1*c||l>=c)){d.x=n+o*r/2/a;d.y=i+o/2;return d}if(0>a&&(l<=-1*c||l>=c)){d.x=n-o*r/2/a;d.y=i-o/2;return d}return d};var Kp=function e(t,r){for(var a=0;a<t.edgeSize;a++){var n=t.layoutEdges[a],i=t.idToIndex[n.sourceId],o=t.layoutNodes[i],s=t.idToIndex[n.targetId],l=t.layoutNodes[s],c=l.positionX-o.positionX,d=l.positionY-o.positionY;if(0===c&&0===d){continue}var p=Gp(o,c,d),u=Gp(l,-1*c,-1*d),f=u.x-p.x,h=u.y-p.y,g=Math.sqrt(f*f+h*h),y=Math.pow(n.idealLength-g,2)/n.elasticity;if(0!==g){var v=y*f/g,m=y*h/g}else{var v=0,m=0}if(!o.isLocked){o.offsetX+=v;o.offsetY+=m}if(!l.isLocked){l.offsetX-=v;l.offsetY-=m}}};var Up=function e(t,r){if(r.gravity===0){return}var a=1;for(var n=0;n<t.graphSet.length;n++){var i=t.graphSet[n],o=i.length;if(0===n){var s=t.clientHeight/2,l=t.clientWidth/2}else{var c=t.layoutNodes[t.idToIndex[i[0]]],d=t.layoutNodes[t.idToIndex[c.parentId]],s=d.positionX,l=d.positionY}for(var p=0;p<o;p++){var u=t.layoutNodes[t.idToIndex[i[p]]];if(u.isLocked){continue}var f=s-u.positionX,h=l-u.positionY,g=Math.sqrt(f*f+h*h);if(g>a){var y=r.gravity*f/g,v=r.gravity*h/g;u.offsetX+=y;u.offsetY+=v}}}};var Qp=function e(t,r){var a=[];var n=0;var i=-1;a.push.apply(a,t.graphSet[0]);i+=t.graphSet[0].length;while(n<=i){var o=a[n++],s=t.idToIndex[o],l=t.layoutNodes[s],c=l.children;if(0<c.length&&!l.isLocked){var d=l.offsetX,p=l.offsetY;for(var u=0;u<c.length;u++){var f=t.layoutNodes[t.idToIndex[c[u]]];f.offsetX+=d;f.offsetY+=p;a[++i]=c[u]}l.offsetX=0;l.offsetY=0}}};var Zp=function t(r,a){for(var n=0;n<r.nodeSize;n++){var i=r.layoutNodes[n];if(0<i.children.length){i.maxX=e;i.minX=e;i.maxY=e;i.minY=e}}for(var n=0;n<r.nodeSize;n++){var i=r.layoutNodes[n];if(0<i.children.length||i.isLocked){continue}var o=Jp(i.offsetX,i.offsetY,r.temperature);i.positionX+=o.x;i.positionY+=o.y;i.offsetX=0;i.offsetY=0;i.minX=i.positionX-i.width;i.maxX=i.positionX+i.width;i.minY=i.positionY-i.height;i.maxY=i.positionY+i.height;eu(i,r)}for(var n=0;n<r.nodeSize;n++){var i=r.layoutNodes[n];if(0<i.children.length&&!i.isLocked){i.positionX=(i.maxX+i.minX)/2;i.positionY=(i.maxY+i.minY)/2;i.width=i.maxX-i.minX;i.height=i.maxY-i.minY}}};var Jp=function e(t,r,a){var n=Math.sqrt(t*t+r*r);if(n>a){var i={x:a*t/n,y:a*r/n}}else{var i={x:t,y:r}}return i};var eu=function e(t,r){var a=t.parentId;if(null==a){return}var n=r.layoutNodes[r.idToIndex[a]];var i=!1;if(null==n.maxX||t.maxX+n.padRight>n.maxX){n.maxX=t.maxX+n.padRight;i=!0}if(null==n.minX||t.minX-n.padLeft<n.minX){n.minX=t.minX-n.padLeft;i=!0}if(null==n.maxY||t.maxY+n.padBottom>n.maxY){n.maxY=t.maxY+n.padBottom;i=!0}if(null==n.minY||t.minY-n.padTop<n.minY){n.minY=t.minY-n.padTop;i=!0}if(i){return eu(n,r)}return};var tu=function e(t,r){var a=t.layoutNodes;var n=[];for(var i=0;i<a.length;i++){var o=a[i],s=o.cmptId,l=n[s]=n[s]||[];l.push(o)}var c=0;for(var i=0;i<n.length;i++){var d=n[i];if(!d){continue}d.x1=Infinity;d.x2=-Infinity;d.y1=Infinity;d.y2=-Infinity;for(var p=0;p<d.length;p++){var u=d[p];d.x1=Math.min(d.x1,u.positionX-u.width/2);d.x2=Math.max(d.x2,u.positionX+u.width/2);d.y1=Math.min(d.y1,u.positionY-u.height/2);d.y2=Math.max(d.y2,u.positionY+u.height/2)}d.w=d.x2-d.x1;d.h=d.y2-d.y1;c+=d.w*d.h}n.sort(function(e,t){return t.w*t.h-e.w*e.h});var f=0;var h=0;var g=0;var y=0;var v=Math.sqrt(c)*t.clientWidth/t.clientHeight;for(var i=0;i<n.length;i++){var d=n[i];if(!d){continue}for(var p=0;p<d.length;p++){var u=d[p];if(!u.isLocked){u.positionX+=f-d.x1;u.positionY+=h-d.y1}}f+=d.w+r.componentSpacing;g+=d.w+r.componentSpacing;y=Math.max(y,d.h);if(g>v){h+=y+r.componentSpacing;f=0;g=0;y=0}}};var ru={fit:!0,padding:30,boundingBox:e,avoidOverlap:!0,avoidOverlapPadding:10,nodeDimensionsIncludeLabels:!1,spacingFactor:e,condense:!1,rows:e,cols:e,position:function e(t){},sort:e,animate:!1,animationDuration:500,animationEasing:e,animateFilter:function e(t,r){return!0},ready:e,stop:e,transform:function e(t,r){return r}};function au(e){this.options=oe({},ru,e)}au.prototype.run=function(){var t=this.options;var r=t.cy;var a=t.eles;var n=a.nodes().not(":parent");t.sort&&(n=n.sort(t.sort));var i=Xr(t.boundingBox?t.boundingBox:{x1:0,y1:0,w:r.width(),h:r.height()});if(i.h===0||i.w===0){a.nodes().layoutPositions(this,t,function(e){return{x:i.x1,y:i.y1}})}else{var o=n.size(),s=Math.sqrt(o*i.h/i.w),l=Math.round(s),c=Math.round(i.w/i.h*s),d=function e(t){if(t==null){return Math.min(l,c)}else{var r=Math.min(l,c);if(r==l){l=t}else{c=t}}},p=function e(t){if(t==null){return Math.max(l,c)}else{var r=Math.max(l,c);if(r==l){l=t}else{c=t}}},u=t.rows,f=t.cols!=null?t.cols:t.columns;if(u!=null&&f!=null){l=u;c=f}else if(u!=null&&f==null){l=u;c=Math.ceil(o/l)}else if(u==null&&f!=null){c=f;l=Math.ceil(o/c)}else if(c*l>o){var h=d(),g=p();if((h-1)*g>=o){d(h-1)}else(g-1)*h>=o&&p(g-1)}else{while(c*l<o){var y=d(),v=p();if((v+1)*y>=o){p(v+1)}else{d(y+1)}}}var m=i.w/c,b=i.h/l;if(t.condense){m=0;b=0}if(t.avoidOverlap){for(var x=0;x<n.length;x++){var _=n[x],w=_._private.position;if(w.x==null||w.y==null){w.x=0;w.y=0}var S=_.layoutDimensions(t),P=t.avoidOverlapPadding,C=S.w+P,E=S.h+P;m=Math.max(m,C);b=Math.max(b,E)}}var T={},I=function e(t,r){return T["c-"+t+"-"+r]?!0:!1},k=function e(t,r){T["c-"+t+"-"+r]=!0},R=0,D=0,B=function e(){D++;if(D>=c){D=0;R++}},A={};for(var O=0;O<n.length;O++){var L=n[O],N=t.position(L);if(N&&(N.row!==e||N.col!==e)){var M={row:N.row,col:N.col};if(M.col===e){M.col=0;while(I(M.row,M.col)){M.col++}}else if(M.row===e){M.row=0;while(I(M.row,M.col)){M.row++}}A[L.id()]=M;k(M.row,M.col)}}var j=function e(t,r){var a,n;if(t.locked()||t.isParent()){return!1}var o=A[t.id()];if(o){a=o.col*m+m/2+i.x1;n=o.row*b+b/2+i.y1}else{while(I(R,D)){B()}a=D*m+m/2+i.x1;n=R*b+b/2+i.y1;k(R,D);B()}return{x:a,y:n}};n.layoutPositions(this,t,j)}return this};var nu={ready:function e(){},stop:function e(){}};function iu(e){this.options=oe({},nu,e)}iu.prototype.run=function(){var e=this.options;var t=e.eles;var r=this
e.cy;r.emit("layoutstart");t.nodes().positions(function(){return{x:0,y:0}});r.one("layoutready",e.ready);r.emit("layoutready");r.one("layoutstop",e.stop);r.emit("layoutstop");return this};iu.prototype.stop=function(){return this};var ou={positions:e,zoom:e,pan:e,fit:!0,padding:30,spacingFactor:e,animate:!1,animationDuration:500,animationEasing:e,animateFilter:function e(t,r){return!0},ready:e,stop:e,transform:function e(t,r){return r}};function su(e){this.options=oe({},ou,e)}su.prototype.run=function(){var e=this.options;var t=e.eles;var r=t.nodes();var a=T(e.positions);function n(t){if(e.positions==null){return Tr(t.position())}if(a){return e.positions(t)}var r=e.positions[t._private.data.id];if(r==null){return null}return r}r.layoutPositions(this,e,function(e,t){var r=n(e);if(e.locked()||r==null){return!1}return r});return this};var lu={fit:!0,padding:30,boundingBox:e,animate:!1,animationDuration:500,animationEasing:e,animateFilter:function e(t,r){return!0},ready:e,stop:e,transform:function e(t,r){return r}};function cu(e){this.options=oe({},lu,e)}cu.prototype.run=function(){var e=this.options;var t=e.cy;var r=e.eles;var a=Xr(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:t.width(),h:t.height()});var n=function e(t,r){return{x:a.x1+Math.round(Math.random()*a.w),y:a.y1+Math.round(Math.random()*a.h)}};r.nodes().layoutPositions(this,e,n);return this};var du=[{name:"breadthfirst",impl:Ip},{name:"circle",impl:Rp},{name:"concentric",impl:Bp},{name:"cose",impl:Lp},{name:"grid",impl:au},{name:"null",impl:iu},{name:"preset",impl:su},{name:"random",impl:cu}];function pu(e){this.options=e;this.notifications=0}var uu=function e(){};var fu=function e(){throw new Error("A headless instance can not render images")};pu.prototype={recalculateRenderedStyle:uu,notify:function e(){this.notifications++},init:uu,isHeadless:function e(){return!0},png:fu,jpg:fu};var hu={};hu.arrowShapeWidth=.3;hu.registerArrowShapes=function(){var e=this.arrowShapes={};var t=this;var r=function e(t,r,a,n,i,o,s){var l=i.x-a/2-s;var c=i.x+a/2+s;var d=i.y-a/2-s;var p=i.y+a/2+s;var u=l<=t&&t<=c&&d<=r&&r<=p;return u};var a=function e(t,r,a,n,i){var o=t*Math.cos(n)-r*Math.sin(n);var s=t*Math.sin(n)+r*Math.cos(n);var l=o*a;var c=s*a;var d=l+i.x;var p=c+i.y;return{x:d,y:p}};var n=function e(t,r,n,i){var o=[];for(var s=0;s<t.length;s+=2){var l=t[s],c=t[s+1];o.push(a(l,c,r,n,i))}return o};var i=function e(t){var r=[];for(var a=0;a<t.length;a++){var n=t[a];r.push(n.x,n.y)}return r};var o=function e(t){return t.pstyle("width").pfValue*t.pstyle("arrow-scale").pfValue*2};var s=function a(s,l){E(l)&&(l=e[l]);e[s]=oe({name:s,points:[-.15,-.3,.15,-.3,.15,.3,-.15,.3],collide:function e(t,r,a,o,s,l){var c=i(n(this.points,a+2*l,o,s));var d=ha(t,r,c);return d},roughCollide:r,draw:function e(r,a,i,o){var s=n(this.points,a,i,o);t.arrowShapeImpl("polygon")(r,s)},spacing:function e(t){return 0},gap:o},l)};s("none",{collide:Bt,roughCollide:Bt,draw:Ot,spacing:At,gap:At});s("triangle",{points:[-.15,-.3,0,0,.15,-.3]});s("arrow","triangle");s("triangle-backcurve",{points:e["triangle"].points,controlPoint:[0,-.15],roughCollide:r,draw:function e(r,i,o,s,l){var c=n(this.points,i,o,s);var d=this.controlPoint;var p=a(d[0],d[1],i,o,s);t.arrowShapeImpl(this.name)(r,c,p)},gap:function e(t){return o(t)*.8}});s("triangle-tee",{points:[0,0,.15,-.3,-.15,-.3,0,0],pointsTee:[-.15,-.4,-.15,-.5,.15,-.5,.15,-.4],collide:function e(t,r,a,o,s,l,c){var d=i(n(this.points,a+2*c,o,s));var p=i(n(this.pointsTee,a+2*c,o,s));var u=ha(t,r,d)||ha(t,r,p);return u},draw:function e(r,a,i,o,s){var l=n(this.points,a,i,o);var c=n(this.pointsTee,a,i,o);t.arrowShapeImpl(this.name)(r,l,c)}});s("circle-triangle",{radius:.15,pointsTr:[0,-.15,.15,-.45,-.15,-.45,0,-.15],collide:function e(t,r,a,o,s,l,c){var d=Math.pow(s.x-t,2)+Math.pow(s.y-r,2)<=Math.pow((a+2*c)*this.radius,2);var p=i(n(this.points,a+2*c,o,s));return ha(t,r,p)||d},draw:function e(r,a,i,o,s){var l=n(this.pointsTr,a,i,o);t.arrowShapeImpl(this.name)(r,l,o.x,o.y,this.radius*a)},spacing:function e(r){return t.getArrowWidth(r.pstyle("width").pfValue,r.pstyle("arrow-scale").value)*this.radius}});s("triangle-cross",{points:[0,0,.15,-.3,-.15,-.3,0,0],baseCrossLinePts:[-.15,-.4,-.15,-.4,.15,-.4,.15,-.4],crossLinePts:function e(t,r){var a=this.baseCrossLinePts.slice();var n=r/t;var i=3;var o=5;a[i]=a[i]-n;a[o]=a[o]-n;return a},collide:function e(t,r,a,o,s,l,c){var d=i(n(this.points,a+2*c,o,s));var p=i(n(this.crossLinePts(a,l),a+2*c,o,s));var u=ha(t,r,d)||ha(t,r,p);return u},draw:function e(r,a,i,o,s){var l=n(this.points,a,i,o);var c=n(this.crossLinePts(a,s),a,i,o);t.arrowShapeImpl(this.name)(r,l,c)}});s("vee",{points:[-.15,-.3,0,0,.15,-.3,0,-.15],gap:function e(t){return o(t)*.525}});s("circle",{radius:.15,collide:function e(t,r,a,n,i,o,s){var l=Math.pow(i.x-t,2)+Math.pow(i.y-r,2)<=Math.pow((a+2*s)*this.radius,2);return l},draw:function e(r,a,n,i,o){t.arrowShapeImpl(this.name)(r,i.x,i.y,this.radius*a)},spacing:function e(r){return t.getArrowWidth(r.pstyle("width").pfValue,r.pstyle("arrow-scale").value)*this.radius}});s("tee",{points:[-.15,0,-.15,-.1,.15,-.1,.15,0],spacing:function e(t){return 1},gap:function e(t){return 1}});s("square",{points:[-.15,0,.15,0,.15,-.3,-.15,-.3]});s("diamond",{points:[-.15,-.15,0,-.3,.15,-.15,0,0],gap:function e(t){return t.pstyle("width").pfValue*t.pstyle("arrow-scale").value}});s("chevron",{points:[0,0,-.15,-.15,-.1,-.2,0,-.1,.1,-.2,.15,-.15],gap:function e(t){return.95*t.pstyle("width").pfValue*t.pstyle("arrow-scale").value}})};var gu={};gu.projectIntoViewport=function(e,t){var r=this.cy;var a=this.findContainerClientCoords();var n=a[0];var i=a[1];var o=a[4];var s=r.pan();var l=r.zoom();var c=((e-n)/o-s.x)/l;var d=((t-i)/o-s.y)/l;return[c,d]};gu.findContainerClientCoords=function(){if(this.containerBB){return this.containerBB}var e=this.container;var t=e.getBoundingClientRect();var r=this.cy.window().getComputedStyle(e);var a=function e(t){return parseFloat(r.getPropertyValue(t))};var n={left:a("padding-left"),right:a("padding-right"),top:a("padding-top"),bottom:a("padding-bottom")};var i={left:a("border-left-width"),right:a("border-right-width"),top:a("border-top-width"),bottom:a("border-bottom-width")};var o=e.clientWidth;var s=e.clientHeight;var l=n.left+n.right;var c=n.top+n.bottom;var d=i.left+i.right;var p=t.width/(o+d);var u=o-l;var f=s-c;var h=t.left+n.left+i.left;var g=t.top+n.top+i.top;return this.containerBB=[h,g,u,f,p]};gu.invalidateContainerClientCoordsCache=function(){this.containerBB=null};gu.findNearestElement=function(e,t,r,a){return this.findNearestElements(e,t,r,a)[0]};gu.findNearestElements=function(e,t,r,a){var n=this;var i=this;var o=i.getCachedZSortedEles();var s=[];var l=i.cy.zoom();var c=i.cy.hasCompoundNodes();var d=(a?24:8)/l;var p=(a?8:2)/l;var u=(a?8:2)/l;var f=Infinity;var h;var g;r&&(o=o.interactive);function y(e,t){if(e.isNode()){if(g){return}else{g=e;s.push(e)}}if(e.isEdge()&&(t==null||t<f)){if(h){if(h.pstyle("z-compound-depth").value===e.pstyle("z-compound-depth").value&&h.pstyle("z-compound-depth").value===e.pstyle("z-compound-depth").value){for(var r=0;r<s.length;r++){if(s[r].isEdge()){s[r]=e;h=e;f=t!=null?t:f;break}}}}else{s.push(e);h=e;f=t!=null?t:f}}}function v(r){var a=r.outerWidth()+2*p;var o=r.outerHeight()+2*p;var s=a/2;var l=o/2;var c=r.position();var d=r.pstyle("corner-radius").value==="auto"?"auto":r.pstyle("corner-radius").pfValue;var u=r._private.rscratch;if(c.x-s<=e&&e<=c.x+s&&c.y-l<=t&&t<=c.y+l){var f=i.nodeShapes[n.getNodeShape(r)];if(f.checkPoint(e,t,0,a,o,c.x,c.y,d,u)){y(r,0);return!0}}}function m(r){var a=r._private;var o=a.rscratch;var l=r.pstyle("width").pfValue;var p=r.pstyle("arrow-scale").value;var u=l/2+d;var f=u*u;var h=u*2;var g=a.source;var m=a.target;var b;if(o.edgeType==="segments"||o.edgeType==="straight"||o.edgeType==="haystack"){var x=o.allpts;for(var _=0;_+3<x.length;_+=2){if(la(e,t,x[_],x[_+1],x[_+2],x[_+3],h)&&f>(b=fa(e,t,x[_],x[_+1],x[_+2],x[_+3]))){y(r,b);return!0}}}else if(o.edgeType==="bezier"||o.edgeType==="multibezier"||o.edgeType==="self"||o.edgeType==="compound"){var x=o.allpts;for(var _=0;_+5<o.allpts.length;_+=4){if(ca(e,t,x[_],x[_+1],x[_+2],x[_+3],x[_+4],x[_+5],h)&&f>(b=ua(e,t,x[_],x[_+1],x[_+2],x[_+3],x[_+4],x[_+5]))){y(r,b);return!0}}}var g=g||a.source;var m=m||a.target;var w=n.getArrowWidth(l,p);var S=[{name:"source",x:o.arrowStartX,y:o.arrowStartY,angle:o.srcArrowAngle},{name:"target",x:o.arrowEndX,y:o.arrowEndY,angle:o.tgtArrowAngle},{name:"mid-source",x:o.midX,y:o.midY,angle:o.midsrcArrowAngle},{name:"mid-target",x:o.midX,y:o.midY,angle:o.midtgtArrowAngle}];for(var _=0;_<S.length;_++){var P=S[_],C=i.arrowShapes[r.pstyle(P.name+"-arrow-shape").value],E=r.pstyle("width").pfValue;if(C.roughCollide(e,t,w,P.angle,{x:P.x,y:P.y},E,d)&&C.collide(e,t,w,P.angle,{x:P.x,y:P.y},E,d)){y(r);return!0}}if(c&&s.length>0){v(g);v(m)}}function b(e,t,r){return Gt(e,t,r)}function x(r,a){var n=r._private;var i;if(a){i=a+"-"}else{i=""}r.boundingBox();var o=n.labelBounds[a||"main"];var s=r.pstyle(i+"label").value;var l=r.pstyle("text-events").strValue==="yes";if(!l||!s){return}var c=b(n.rscratch,"labelX",a);var d=b(n.rscratch,"labelY",a);var p=b(n.rscratch,"labelAngle",a);var f=r.pstyle(i+"text-margin-x").pfValue;var h=r.pstyle(i+"text-margin-y").pfValue;var g=o.x1-u-f;var v=o.x2+u-f;var m=o.y1-u-h;var x=o.y2+u-h;if(p){var _=Math.cos(p),w=Math.sin(p),S=function e(t,r){t=t-c;r=r-d;return{x:t*_-r*w+c,y:t*w+r*_+d}},P=S(g,m),C=S(g,x),E=S(v,m),T=S(v,x),I=[P.x+f,P.y+h,E.x+f,E.y+h,T.x+f,T.y+h,C.x+f,C.y+h];if(ha(e,t,I)){y(r);return!0}}else{if(ta(o,e,t)){y(r);return!0}}}for(var _=o.length-1;_>=0;_--){var w=o[_];if(w.isNode()){v(w)||x(w)}else{m(w)||x(w)||x(w,"source")||x(w,"target")}}return s};gu.getAllInBox=function(e,t,r,a){var n=this.getCachedZSortedEles().interactive;var i=this.cy.zoom();var o=2/i;var s=[];var l=Math.min(e,r);var c=Math.max(e,r);var d=Math.min(t,a);var p=Math.max(t,a);e=l;r=c;t=d;a=p;var u=Xr({x1:e,y1:t,x2:r,y2:a});var h=[{x:u.x1,y:u.y1},{x:u.x2,y:u.y1},{x:u.x2,y:u.y2},{x:u.x1,y:u.y2}];var g=[[h[0],h[1]],[h[1],h[2]],[h[2],h[3]],[h[3],h[0]]];function y(e,t,r){return Gt(e,t,r)}function v(e,t){var r=e._private;var a="";e.boundingBox();var n=r.labelBounds["main"];if(!n){return null}var i=y(r.rscratch,"labelX",t);var s=y(r.rscratch,"labelY",t);var l=y(r.rscratch,"labelAngle",t);var c=e.pstyle(a+"text-margin-x").pfValue;var d=e.pstyle(a+"text-margin-y").pfValue;var p=n.x1-o-c;var u=n.x2+o-c;var f=n.y1-o-d;var h=n.y2+o-d;if(l){var g=Math.cos(l),v=Math.sin(l),m=function e(t,r){t=t-i;r=r-s;return{x:t*g-r*v+i,y:t*v+r*g+s}};return[m(p,f),m(u,f),m(u,h),m(p,h)]}else{return[{x:p,y:f},{x:u,y:f},{x:u,y:h},{x:p,y:h}]}}function m(e,t,r,a){function n(e,t,r){return(r.y-e.y)*(t.x-e.x)>(t.y-e.y)*(r.x-e.x)}return n(e,r,a)!==n(t,r,a)&&n(e,t,r)!==n(e,t,a)}for(var b=0;b<n.length;b++){var x=n[b];if(x.isNode()){var _=x,w=_.pstyle("text-events").strValue==="yes",S=_.pstyle("box-selection").strValue,P=_.pstyle("box-select-labels").strValue==="yes";if(S==="none"){continue}var C=(S==="overlap"||P)&&w,E=_.boundingBox({includeNodes:!0,includeEdges:!1,includeLabels:C});if(S==="contain"){var T=!1;if(P&&w){var I=v(_);if(I&&Na(I,h)){s.push(_);T=!0}}!T&&aa(u,E)&&s.push(_)}else if(S==="overlap"){if(ea(u,E)){var k=_.boundingBox({includeNodes:!0,includeEdges:!0,includeLabels:!1,includeMainLabels:!1,includeSourceLabels:!1,includeTargetLabels:!1}),R=[{x:k.x1,y:k.y1},{x:k.x2,y:k.y1},{x:k.x2,y:k.y2},{x:k.x1,y:k.y2}];if(Na(R,h)){s.push(_)}else{var D=v(_);D&&Na(D,h)&&s.push(_)}}}}else{var B=x,A=B._private,O=A.rscratch,L=B.pstyle("box-selection").strValue;if(L==="none"){continue}if(L==="contain"){if(O.startX!=null&&O.startY!=null&&!ta(u,O.startX,O.startY)){continue}if(O.endX!=null&&O.endY!=null&&!ta(u,O.endX,O.endY)){continue}if(O.edgeType==="bezier"||O.edgeType==="multibezier"||O.edgeType==="self"||O.edgeType==="compound"||O.edgeType==="segments"||O.edgeType==="haystack"){var N=A.rstyle.bezierPts||A.rstyle.linePts||A.rstyle.haystackPts,M=!0;for(var j=0;j<N.length;j++){if(!ra(u,N[j])){M=!1;break}}M&&s.push(B)}else O.edgeType==="straight"&&s.push(B)}else if(L==="overlap"){var q=!1;if(O.startX!=null&&O.startY!=null&&O.endX!=null&&O.endY!=null&&(ta(u,O.startX,O.startY)||ta(u,O.endX,O.endY))){s.push(B);q=!0}else if(!q&&O.edgeType==="haystack"){var z=A.rstyle.haystackPts;for(var $=0;$<z.length;$++){if(ra(u,z[$])){s.push(B);q=!0;break}}}if(!q){var V=A.rstyle.bezierPts||A.rstyle.linePts||A.rstyle.haystackPts;(!V||V.length<2)&&O.edgeType==="straight"&&(O.startX!=null&&O.startY!=null&&O.endX!=null&&O.endY!=null&&(V=[{x:O.startX,y:O.startY},{x:O.endX,y:O.endY}]));if(!V||V.length<2)continue;for(var F=0;F<V.length-1;F++){var W=V[F],H=V[F+1];for(var X=0;X<g.length;X++){var Y=f(g[X],2),G=Y[0],K=Y[1];if(m(W,H,G,K)){s.push(B);q=!0;break}}if(q)break}}}}}return s};var yu={};yu.calculateArrowAngles=function(e){var t=e._private.rscratch;var r=t.edgeType==="haystack";var a=t.edgeType==="bezier";var n=t.edgeType==="multibezier";var i=t.edgeType==="segments";var o=t.edgeType==="compound";var s=t.edgeType==="self";var l,c;var d,p,u,f,h,g;if(r){d=t.haystackPts[0];p=t.haystackPts[1];u=t.haystackPts[2];f=t.haystackPts[3]}else{d=t.arrowStartX;p=t.arrowStartY;u=t.arrowEndX;f=t.arrowEndY}h=t.midX;g=t.midY;if(i){l=d-t.segpts[0];c=p-t.segpts[1]}else if(n||o||s||a){var y=t.allpts,v=Vr(y[0],y[2],y[4],.1),m=Vr(y[1],y[3],y[5],.1);l=d-v;c=p-m}else{l=d-h;c=p-g}t.srcArrowAngle=Nr(l,c);var h=t.midX;var g=t.midY;if(r){h=(d+u)/2;g=(p+f)/2}l=u-d;c=f-p;if(i){var y=t.allpts;if(y.length/2%2===0){var b=y.length/2,x=b-2;l=y[b]-y[x];c=y[b+1]-y[x+1]}else if(t.isRound){l=t.midVector[1];c=-t.midVector[0]}else{var b=y.length/2-1,x=b-2;l=y[b]-y[x];c=y[b+1]-y[x+1]}}else if(n||o||s){var y=t.allpts,_=t.ctrlpts,w,S,P,C;if(_.length/2%2===0){var E=y.length/2-1,T=E+2,I=T+2;w=Vr(y[E],y[T],y[I],0);S=Vr(y[E+1],y[T+1],y[I+1],0);P=Vr(y[E],y[T],y[I],.0001);C=Vr(y[E+1],y[T+1],y[I+1],.0001)}else{var T=y.length/2-1,E=T-2,I=T+2;w=Vr(y[E],y[T],y[I],.4999);S=Vr(y[E+1],y[T+1],y[I+1],.4999);P=Vr(y[E],y[T],y[I],.5);C=Vr(y[E+1],y[T+1],y[I+1],.5)}l=P-w;c=C-S}t.midtgtArrowAngle=Nr(l,c);t.midDispX=l;t.midDispY=c;l*=-1;c*=-1;if(i){var y=t.allpts;if(y.length/2%2===0);else if(!t.isRound){var b=y.length/2-1,k=b+2;l=-(y[k]-y[b]);c=-(y[k+1]-y[b+1])}}t.midsrcArrowAngle=Nr(l,c);if(i){l=u-t.segpts[t.segpts.length-2];c=f-t.segpts[t.segpts.length-1]}else if(n||o||s||a){var y=t.allpts,R=y.length,v=Vr(y[R-6],y[R-4],y[R-2],.9),m=Vr(y[R-5],y[R-3],y[R-1],.9);l=u-v;c=f-m}else{l=u-h;c=f-g}t.tgtArrowAngle=Nr(l,c)};yu.getArrowWidth=yu.getArrowHeight=function(e,t){var r=this.arrowWidthCache=this.arrowWidthCache||{};var a=r[e+", "+t];if(a){return a}a=Math.max(Math.pow(e*13.37,.9),29)*t;r[e+", "+t]=a;return a};var vu,mu,bu={},xu={},_u,wu,Su,Pu,Cu,Eu,Tu,Iu,ku,Ru;var Du,Bu,Au,Ou;var Lu;var Nu=function e(t,r,a){a.x=r.x-t.x;a.y=r.y-t.y;a.len=Math.sqrt(a.x*a.x+a.y*a.y);a.nx=a.x/a.len;a.ny=a.y/a.len;a.ang=Math.atan2(a.ny,a.nx)};var Mu=function e(t,r){r.x=t.x*-1;r.y=t.y*-1;r.nx=t.nx*-1;r.ny=t.ny*-1;r.ang=t.ang>0?-(Math.PI-t.ang):Math.PI+t.ang};var ju=function t(r,a,n,i,o){r!==Lu?Nu(a,r,bu):Mu(xu,bu);Nu(a,n,xu);_u=bu.nx*xu.ny-bu.ny*xu.nx;wu=bu.nx*xu.nx-bu.ny*-xu.ny;Cu=Math.asin(Math.max(-1,Math.min(1,_u)));if(Math.abs(Cu)<1E-06){vu=a.x;mu=a.y;Tu=ku=0;return}Su=1;Pu=!1;if(wu<0){if(Cu<0){Cu=Math.PI+Cu}else{Cu=Math.PI-Cu;Su=-1;Pu=!0}}else{if(Cu>0){Su=-1;Pu=!0}}if(a.radius!==e){ku=a.radius}else{ku=i}Eu=Cu/2;Ru=Math.min(bu.len/2,xu.len/2);if(o){Iu=Math.abs(Math.cos(Eu)*ku/Math.sin(Eu));if(Iu>Ru){Iu=Ru;Tu=Math.abs(Iu*Math.sin(Eu)/Math.cos(Eu))}else{Tu=ku}}else{Iu=Math.min(Ru,ku);Tu=Math.abs(Iu*Math.sin(Eu)/Math.cos(Eu))}Au=a.x+xu.nx*Iu;Ou=a.y+xu.ny*Iu;vu=Au-xu.ny*Tu*Su;mu=Ou+xu.nx*Tu*Su;Du=a.x+bu.nx*Iu;Bu=a.y+bu.ny*Iu;Lu=a};function qu(e,t){if(t.radius===0)e.lineTo(t.cx,t.cy);else e.arc(t.cx,t.cy,t.radius,t.startAngle,t.endAngle,t.counterClockwise)}function zu(t,r,a,n){var i=arguments.length>4&&arguments[4]!==e?arguments[4]:!0;if(n===0||r.radius===0)return{cx:r.x,cy:r.y,radius:0,startX:r.x,startY:r.y,stopX:r.x,stopY:r.y,startAngle:e,endAngle:e,counterClockwise:e};ju(t,r,a,n,i);return{cx:vu,cy:mu,radius:Tu,startX:Du,startY:Bu,stopX:Au,stopY:Ou,startAngle:bu.ang+Math.PI/2*Su,endAngle:xu.ang-Math.PI/2*Su,counterClockwise:Pu}}var $u=.01;var Vu=Math.sqrt(2*$u);var Fu={};Fu.findMidptPtsEtc=function(e,t){var r=t.posPts,a=t.intersectionPts,n=t.vectorNormInverse;var i;var o=e.pstyle("source-endpoint");var s=e.pstyle("target-endpoint");var l=o.units!=null&&s.units!=null;var c=function e(t,r,a,n){var i=n-r;var o=a-t;var s=Math.sqrt(o*o+i*i);return{x:-i/s,y:o/s}};var d=e.pstyle("edge-distances").value;switch(d){case"node-position":i=r;break;case"intersection":i=a;break;case"endpoints":if(l){var p=this.manualEndptToPx(e.source()[0],o),u=f(p,2),h=u[0],g=u[1],y=this.manualEndptToPx(e.target()[0],s),v=f(y,2),m=v[0],b=v[1],x={x1:h,y1:g,x2:m,y2:b};n=c(h,g,m,b);i=x}else{Mt("Edge ".concat(e.id()," has edge-distances:endpoints specified without manual endpoints specified via source-endpoint and target-endpoint.  Falling back on edge-distances:intersection (default)."));i=a}break}return{midptPts:i,vectorNormInverse:n}};Fu.findHaystackPoints=function(e){for(var t=0;t<e.length;t++){var r=e[t],a=r._private,n=a.rscratch;if(!n.haystack){var i=Math.random()*2*Math.PI;n.source={x:Math.cos(i),y:Math.sin(i)};i=Math.random()*2*Math.PI;n.target={x:Math.cos(i),y:Math.sin(i)}}var o=a.source,s=a.target,l=o.position(),c=s.position(),d=o.width(),p=s.width(),u=o.height(),f=s.height(),h=r.pstyle("haystack-radius").value,g=h/2;n.haystackPts=n.allpts=[n.source.x*d*g+l.x,n.source.y*u*g+l.y,n.target.x*p*g+c.x,n.target.y*f*g+c.y];n.midX=(n.allpts[0]+n.allpts[2])/2;n.midY=(n.allpts[1]+n.allpts[3])/2;n.edgeType="haystack";n.haystack=!0;this.storeEdgeProjections(r);this.calculateArrowAngles(r);this.recalculateEdgeLabelProjections(r);this.calculateLabelAngles(r)}};Fu.findSegmentsPoints=function(t,r){var a=t._private.rscratch;var n=t.pstyle("segment-weights");var i=t.pstyle("segment-distances");var o=t.pstyle("segment-radii");var s=t.pstyle("radius-type");var l=Math.min(n.pfValue.length,i.pfValue.length);var c=o.pfValue[o.pfValue.length-1];var d=s.pfValue[s.pfValue.length-1];a.edgeType="segments";a.segpts=[];a.radii=[];a.isArcRadius=[];for(var p=0;p<l;p++){var u=n.pfValue[p],f=i.pfValue[p],h=1-u,g=u,y=this.findMidptPtsEtc(t,r),v=y.midptPts,m=y.vectorNormInverse,b={x:v.x1*h+v.x2*g,y:v.y1*h+v.y2*g};a.segpts.push(b.x+m.x*f,b.y+m.y*f);a.radii.push(o.pfValue[p]!==e?o.pfValue[p]:c);a.isArcRadius.push((s.pfValue[p]!==e?s.pfValue[p]:d)==="arc-radius")}};Fu.findLoopPoints=function(t,r,a,n){var i=t._private.rscratch;var o=r.dirCounts,s=r.srcPos;var l=t.pstyle("control-point-distances");var c=l?l.pfValue[0]:e;var d=t.pstyle("loop-direction").pfValue;var p=t.pstyle("loop-sweep").pfValue;var u=t.pstyle("control-point-step-size").pfValue;i.edgeType="self";var f=a;var h=u;if(n){f=0;h=c}var g=d-Math.PI/2;var y=g-p/2;var v=g+p/2;var m=String(d+"_"+p);f=o[m]===e?o[m]=0:++o[m];i.ctrlpts=[s.x+Math.cos(y)*1.4*h*(f/3+1),s.y+Math.sin(y)*1.4*h*(f/3+1),s.x+Math.cos(v)*1.4*h*(f/3+1),s.y+Math.sin(v)*1.4*h*(f/3+1)]};Fu.findCompoundLoopPoints=function(t,r,a,n){var i=t._private.rscratch;i.edgeType="compound";var o=r.srcPos,s=r.tgtPos,l=r.srcW,c=r.srcH,d=r.tgtW,p=r.tgtH;var u=t.pstyle("control-point-step-size").pfValue;var f=t.pstyle("control-point-distances");var h=f?f.pfValue[0]:e;var g=a;var y=u;if(n){g=0;y=h}var v=50;var m={x:o.x-l/2,y:o.y-c/2};var b={x:s.x-d/2,y:s.y-p/2};var x={x:Math.min(m.x,b.x),y:Math.min(m.y,b.y)};var _=.5;var w=Math.max(_,Math.log(l*$u));var S=Math.max(_,Math.log(d*$u));i.ctrlpts=[x.x,x.y-(1+Math.pow(v,1.12)/100)*y*(g/3+1)*w,x.x-(1+Math.pow(v,1.12)/100)*y*(g/3+1)*S,x.y]};Fu.findStraightEdgePoints=function(e){e._private.rscratch.edgeType="straight"};Fu.findBezierPoints=function(t,r,a,n,i){var o=t._private.rscratch;var s=t.pstyle("control-point-step-size").pfValue;var l=t.pstyle("control-point-distances");var c=t.pstyle("control-point-weights");var d=l&&c?Math.min(l.value.length,c.value.length):1;var p=l?l.pfValue[0]:e;var u=c.value[0];o.edgeType=n?"multibezier":"bezier";o.ctrlpts=[];for(var f=0;f<d;f++){var h=(.5-r.eles.length/2+a)*s*(i?-1:1),g=e,y=jr(h);if(n){p=l?l.pfValue[f]:s;u=c.value[f]}if(n){g=p}else{g=p!==e?y*p:e}var v=g!==e?g:h,m=1-u,b=u,x=this.findMidptPtsEtc(t,r),_=x.midptPts,w=x.vectorNormInverse,S={x:_.x1*m+_.x2*b,y:_.y1*m+_.y2*b};o.ctrlpts.push(S.x+w.x*v,S.y+w.y*v)}};Fu.findTaxiPoints=function(e,t){var r=e._private.rscratch;r.edgeType="segments";var a="vertical";var n="horizontal";var i="leftward";var o="rightward";var s="downward";var l="upward";var c="auto";var d=t.posPts,p=t.srcW,u=t.srcH,f=t.tgtW,h=t.tgtH;var g=e.pstyle("edge-distances").value;var y=g!=="node-position";var v=e.pstyle("taxi-direction").value;var m=v;var b=e.pstyle("taxi-turn");var x=b.units==="%";var _=b.pfValue;var w=_<0;var S=e.pstyle("taxi-turn-min-distance").pfValue;var P=y?(p+f)/2:0;var C=y?(u+h)/2:0;var E=d.x2-d.x1;var T=d.y2-d.y1;var I=function e(t,r){if(t>0){return Math.max(t-r,0)}else{return Math.min(t+r,0)}};var k=I(E,P);var R=I(T,C);var D=!1;if(m===c){v=Math.abs(k)>Math.abs(R)?n:a}else if(m===l||m===s){v=a;D=!0}else if(m===i||m===o){v=n;D=!0}var B=v===a;var A=B?R:k;var O=B?T:E;var L=jr(O);var N=!1;if(!(D&&(x||w))&&(m===s&&O<0||m===l&&O>0||m===i&&O>0||m===o&&O<0)){L*=-1;A=L*Math.abs(A);N=!0}var M;if(x){var j=_<0?1+_:_;M=j*A}else{var q=_<0?A:0;M=q+_*L}var z=function e(t){return Math.abs(t)<S||Math.abs(t)>=Math.abs(A)};var $=z(M);var V=z(Math.abs(A)-Math.abs(M));var F=$||V;if(F&&!N){if(B){var W=Math.abs(O)<=u/2,H=Math.abs(E)<=f/2;if(W){var X=(d.x1+d.x2)/2,Y=d.y1,G=d.y2;r.segpts=[X,Y,X,G]}else if(H){var K=(d.y1+d.y2)/2,U=d.x1,Q=d.x2;r.segpts=[U,K,Q,K]}else{r.segpts=[d.x1,d.y2]}}else{var Z=Math.abs(O)<=p/2,J=Math.abs(T)<=h/2;if(Z){var ee=(d.y1+d.y2)/2,te=d.x1,re=d.x2;r.segpts=[te,ee,re,ee]}else if(J){var ae=(d.x1+d.x2)/2,ne=d.y1,ie=d.y2;r.segpts=[ae,ne,ae,ie]}else{r.segpts=[d.x2,d.y1]}}}else{if(B){var oe=d.y1+M+(y?u/2*L:0),se=d.x1,le=d.x2;r.segpts=[se,oe,le,oe]}else{var ce=d.x1+M+(y?p/2*L:0),de=d.y1,pe=d.y2;r.segpts=[ce,de,ce,pe]}}if(r.isRound){var ue=e.pstyle("taxi-radius").value,fe=e.pstyle("radius-type").value[0]==="arc-radius";r.radii=new Array(r.segpts.length/2).fill(ue);r.isArcRadius=new Array(r.segpts.length/2).fill(fe)}};Fu.tryToCorrectInvalidPoints=function(e,t){var r=e._private.rscratch;if(r.edgeType==="bezier"){var a=t.srcPos,n=t.tgtPos,i=t.srcW,o=t.srcH,s=t.tgtW,l=t.tgtH,c=t.srcShape,d=t.tgtShape,p=t.srcCornerRadius,u=t.tgtCornerRadius,f=t.srcRs,h=t.tgtRs,g=!D(r.startX)||!D(r.startY),y=!D(r.arrowStartX)||!D(r.arrowStartY),v=!D(r.endX)||!D(r.endY),m=!D(r.arrowEndX)||!D(r.arrowEndY),b=3,x=this.getArrowWidth(e.pstyle("width").pfValue,e.pstyle("arrow-scale").value)*this.arrowShapeWidth,_=b*x,w=qr({x:r.ctrlpts[0],y:r.ctrlpts[1]},{x:r.startX,y:r.startY}),S=w<_,P=qr({x:r.ctrlpts[0],y:r.ctrlpts[1]},{x:r.endX,y:r.endY}),C=P<_,E=!1;if(g||y||S){E=!0;var T={x:r.ctrlpts[0]-a.x,y:r.ctrlpts[1]-a.y},I=Math.sqrt(T.x*T.x+T.y*T.y),k={x:T.x/I,y:T.y/I},R=Math.max(i,o),B={x:r.ctrlpts[0]+k.x*2*R,y:r.ctrlpts[1]+k.y*2*R},A=c.intersectLine(a.x,a.y,i,o,B.x,B.y,0,p,f);if(S){r.ctrlpts[0]=r.ctrlpts[0]+k.x*(_-w);r.ctrlpts[1]=r.ctrlpts[1]+k.y*(_-w)}else{r.ctrlpts[0]=A[0]+k.x*_;r.ctrlpts[1]=A[1]+k.y*_}}if(v||m||C){E=!0;var O={x:r.ctrlpts[0]-n.x,y:r.ctrlpts[1]-n.y},L=Math.sqrt(O.x*O.x+O.y*O.y),N={x:O.x/L,y:O.y/L},M=Math.max(i,o),j={x:r.ctrlpts[0]+N.x*2*M,y:r.ctrlpts[1]+N.y*2*M},q=d.intersectLine(n.x,n.y,s,l,j.x,j.y,0,u,h);if(C){r.ctrlpts[0]=r.ctrlpts[0]+N.x*(_-P);r.ctrlpts[1]=r.ctrlpts[1]+N.y*(_-P)}else{r.ctrlpts[0]=q[0]+N.x*_;r.ctrlpts[1]=q[1]+N.y*_}}E&&this.findEndpoints(e)}};Fu.storeAllpts=function(e){var t=e._private.rscratch;if(t.edgeType==="multibezier"||t.edgeType==="bezier"||t.edgeType==="self"||t.edgeType==="compound"){t.allpts=[];t.allpts.push(t.startX,t.startY);for(var r=0;r+1<t.ctrlpts.length;r+=2){t.allpts.push(t.ctrlpts[r],t.ctrlpts[r+1]);r+3<t.ctrlpts.length&&t.allpts.push((t.ctrlpts[r]+t.ctrlpts[r+2])/2,(t.ctrlpts[r+1]+t.ctrlpts[r+3])/2)}t.allpts.push(t.endX,t.endY);var a,n;if(t.ctrlpts.length/2%2===0){a=t.allpts.length/2-1;t.midX=t.allpts[a];t.midY=t.allpts[a+1]}else{a=t.allpts.length/2-3;n=.5;t.midX=Vr(t.allpts[a],t.allpts[a+2],t.allpts[a+4],n);t.midY=Vr(t.allpts[a+1],t.allpts[a+3],t.allpts[a+5],n)}}else if(t.edgeType==="straight"){t.allpts=[t.startX,t.startY,t.endX,t.endY];t.midX=(t.startX+t.endX+t.arrowStartX+t.arrowEndX)/4;t.midY=(t.startY+t.endY+t.arrowStartY+t.arrowEndY)/4}else if(t.edgeType==="segments"){t.allpts=[];t.allpts.push(t.startX,t.startY);t.allpts.push.apply(t.allpts,t.segpts);t.allpts.push(t.endX,t.endY);if(t.isRound){t.roundCorners=[];for(var i=2;i+3<t.allpts.length;i+=2){var o=t.radii[i/2-1],s=t.isArcRadius[i/2-1];t.roundCorners.push(zu({x:t.allpts[i-2],y:t.allpts[i-1]},{x:t.allpts[i],y:t.allpts[i+1],radius:o},{x:t.allpts[i+2],y:t.allpts[i+3]},o,s))}}if(t.segpts.length%4===0){var l=t.segpts.length/2,c=l-2;t.midX=(t.segpts[c]+t.segpts[l])/2;t.midY=(t.segpts[c+1]+t.segpts[l+1])/2}else{var d=t.segpts.length/2-1;if(!t.isRound){t.midX=t.segpts[d];t.midY=t.segpts[d+1]}else{var p={x:t.segpts[d],y:t.segpts[d+1]},u=t.roundCorners[d/2];if(u.radius===0){var f={x:t.segpts[d+2],y:t.segpts[d+3]};t.midX=p.x;t.midY=p.y;t.midVector=[p.y-f.y,f.x-p.x]}else{var h=[p.x-u.cx,p.y-u.cy],g=u.radius/Math.sqrt(Math.pow(h[0],2)+Math.pow(h[1],2));h=h.map(function(e){return e*g});t.midX=u.cx+h[0];t.midY=u.cy+h[1];t.midVector=h}}}}};Fu.checkForInvalidEdgeWarning=function(e){var t=e[0]._private.rscratch;if(t.nodesOverlap||D(t.startX)&&D(t.startY)&&D(t.endX)&&D(t.endY)){t.loggedErr=!1}else{if(!t.loggedErr){t.loggedErr=!0;Mt("Edge `"+e.id()+"` has invalid endpoints and so it is impossible to draw.  Adjust your edge style (e.g. control points) accordingly or use an alternative edge type.  This is expected behaviour when the source node and the target node overlap.")}}};Fu.findEdgeControlPoints=function(e){var t=this;if(!e||e.length===0){return}var r=this;var a=r.cy;var n=a.hasCompoundNodes();var i=new Qt;var o=function e(t,r){return[].concat(h(t),[r?1:0]).join("-")};var s=[];var l=[];for(var c=0;c<e.length;c++){var d=e[c],p=d._private,u=d.pstyle("curve-style").value;if(d.removed()||!d.takesUpSpace()){continue}if(u==="haystack"){l.push(d);continue}var f=u==="unbundled-bezier"||U(u,"segments")||u==="straight"||u==="straight-triangle"||U(u,"taxi"),g=u==="unbundled-bezier"||u==="bezier",y=p.source,v=p.target,m=y.poolIndex(),b=v.poolIndex(),x=[m,b].sort(),_=o(x,f),w=i.get(_);if(w==null){w={eles:[]};s.push({pairId:x,edgeIsUnbundled:f});i.set(_,w)}w.eles.push(d);f&&(w.hasUnbundled=!0);g&&(w.hasBezier=!0)}var S=function e(){var a=s[P],l=a.pairId,c=a.edgeIsUnbundled;var d=o(l,c);var p=i.get(d);var u;if(!p.hasUnbundled){var f=p.eles[0].parallelEdges().filter(function(e){return e.isBundledBezier()});Xt(p.eles);f.forEach(function(e){return p.eles.push(e)});p.eles.sort(function(e,t){return e.poolIndex()-t.poolIndex()})}var h=p.eles[0];var g=h.source();var y=h.target();if(g.poolIndex()>y.poolIndex()){var v=g;g=y;y=v}var m=p.srcPos=g.position();var b=p.tgtPos=y.position();var x=p.srcW=g.outerWidth();var _=p.srcH=g.outerHeight();var w=p.tgtW=y.outerWidth();var S=p.tgtH=y.outerHeight();var C=p.srcShape=r.nodeShapes[t.getNodeShape(g)];var E=p.tgtShape=r.nodeShapes[t.getNodeShape(y)];var T=p.srcCornerRadius=g.pstyle("corner-radius").value==="auto"?"auto":g.pstyle("corner-radius").pfValue;var I=p.tgtCornerRadius=y.pstyle("corner-radius").value==="auto"?"auto":y.pstyle("corner-radius").pfValue;var k=p.tgtRs=y._private.rscratch;var R=p.srcRs=g._private.rscratch;p.dirCounts={north:0,west:0,south:0,east:0,northwest:0,southwest:0,northeast:0,southeast:0};for(var B=0;B<p.eles.length;B++){var A=p.eles[B],O=A[0]._private.rscratch,L=A.pstyle("curve-style").value,N=L==="unbundled-bezier"||U(L,"segments")||U(L,"taxi"),M=!g.same(A.source());if(!p.calculatedIntersection&&g!==y&&(p.hasBezier||p.hasUnbundled)){p.calculatedIntersection=!0;var j=C.intersectLine(m.x,m.y,x,_,b.x,b.y,0,T,R),q=p.srcIntn=j,z=E.intersectLine(b.x,b.y,w,S,m.x,m.y,0,I,k),$=p.tgtIntn=z,V=p.intersectionPts={x1:j[0],x2:z[0],y1:j[1],y2:z[1]},F=p.posPts={x1:m.x,x2:b.x,y1:m.y,y2:b.y},W=z[1]-j[1],H=z[0]-j[0],X=Math.sqrt(H*H+W*W);if(D(X)&&X>=Vu);else{X=Math.sqrt(Math.max(H*H,$u)+Math.max(W*W,$u))}var Y=p.vector={x:H,y:W},G=p.vectorNorm={x:Y.x/X,y:Y.y/X},K={x:-G.y,y:G.x};p.nodesOverlap=!D(X)||E.checkPoint(j[0],j[1],0,w,S,b.x,b.y,I,k)||C.checkPoint(z[0],z[1],0,x,_,m.x,m.y,T,R);p.vectorNormInverse=K;u={nodesOverlap:p.nodesOverlap,dirCounts:p.dirCounts,calculatedIntersection:!0,hasBezier:p.hasBezier,hasUnbundled:p.hasUnbundled,eles:p.eles,srcPos:b,srcRs:k,tgtPos:m,tgtRs:R,srcW:w,srcH:S,tgtW:x,tgtH:_,srcIntn:$,tgtIntn:q,srcShape:E,tgtShape:C,posPts:{x1:F.x2,y1:F.y2,x2:F.x1,y2:F.y1},intersectionPts:{x1:V.x2,y1:V.y2,x2:V.x1,y2:V.y1},vector:{x:-Y.x,y:-Y.y},vectorNorm:{x:-G.x,y:-G.y},vectorNormInverse:{x:-K.x,y:-K.y}}}var Q=M?u:p;O.nodesOverlap=Q.nodesOverlap;O.srcIntn=Q.srcIntn;O.tgtIntn=Q.tgtIntn;O.isRound=L.startsWith("round");if(n&&(g.isParent()||g.isChild()||y.isParent()||y.isChild())&&(g.parents().anySame(y)||y.parents().anySame(g)||g.same(y)&&g.isParent())){t.findCompoundLoopPoints(A,Q,B,N)}else if(g===y){t.findLoopPoints(A,Q,B,N)}else if(L.endsWith("segments")){t.findSegmentsPoints(A,Q)}else if(L.endsWith("taxi")){t.findTaxiPoints(A,Q)}else if(L==="straight"||!N&&p.eles.length%2===1&&B===Math.floor(p.eles.length/2)){t.findStraightEdgePoints(A)}else{t.findBezierPoints(A,Q,B,N,M)}t.findEndpoints(A);t.tryToCorrectInvalidPoints(A,Q);t.checkForInvalidEdgeWarning(A);t.storeAllpts(A);t.storeEdgeProjections(A);t.calculateArrowAngles(A);t.recalculateEdgeLabelProjections(A);t.calculateLabelAngles(A)}};for(var P=0;P<s.length;P++){S()}this.findHaystackPoints(l)};function Wu(e){var t=[];if(e==null){return}for(var r=0;r<e.length;r+=2){var a=e[r],n=e[r+1];t.push({x:a,y:n})}return t}Fu.getSegmentPoints=function(e){var t=e[0]._private.rscratch;this.recalculateRenderedStyle(e);var r=t.edgeType;if(r==="segments"){return Wu(t.segpts)}};Fu.getControlPoints=function(e){var t=e[0]._private.rscratch;this.recalculateRenderedStyle(e);var r=t.edgeType;if(r==="bezier"||r==="multibezier"||r==="self"||r==="compound"){return Wu(t.ctrlpts)}};Fu.getEdgeMidpoint=function(e){var t=e[0]._private.rscratch;this.recalculateRenderedStyle(e);return{x:t.midX,y:t.midY}};var Hu={};Hu.manualEndptToPx=function(e,t){var r=this;var a=e.position();var n=e.outerWidth();var i=e.outerHeight();var o=e._private.rscratch;if(t.value.length===2){var s=[t.pfValue[0],t.pfValue[1]];t.units[0]==="%"&&(s[0]=s[0]*n);t.units[1]==="%"&&(s[1]=s[1]*i);s[0]+=a.x;s[1]+=a.y;return s}else{var l=t.pfValue[0];l=-Math.PI/2+l;var c=2*Math.max(n,i),d=[a.x+Math.cos(l)*c,a.y+Math.sin(l)*c];return r.nodeShapes[this.getNodeShape(e)].intersectLine(a.x,a.y,n,i,d[0],d[1],0,e.pstyle("corner-radius").value==="auto"?"auto":e.pstyle("corner-radius").pfValue,o)}};Hu.findEndpoints=function(t){var r,a,n,i;var o=this;var s;var l=t.source()[0];var c=t.target()[0];var d=l.position();var p=c.position();var u=t.pstyle("target-arrow-shape").value;var f=t.pstyle("source-arrow-shape").value;var h=t.pstyle("target-distance-from-node").pfValue;var g=t.pstyle("source-distance-from-node").pfValue;var y=l._private.rscratch;var v=c._private.rscratch;var m=t.pstyle("curve-style").value;var b=t._private.rscratch;var x=b.edgeType;var _=U(m,"taxi");var w=x==="self"||x==="compound";var S=x==="bezier"||x==="multibezier"||w;var P=x!=="bezier";var C=x==="straight"||x==="segments";var E=x==="segments";var T=S||P||C;var I=w||_;var k=t.pstyle("source-endpoint");var R=I?"outside-to-node":k.value;var B=l.pstyle("corner-radius").value==="auto"?"auto":l.pstyle("corner-radius").pfValue;var A=t.pstyle("target-endpoint");var O=I?"outside-to-node":A.value;var L=c.pstyle("corner-radius").value==="auto"?"auto":c.pstyle("corner-radius").pfValue;b.srcManEndpt=k;b.tgtManEndpt=A;var N;var M;var j;var q;var z=(r=(A===null||A===e||(a=A.pfValue)===null||a===e?e:a.length)===2?A.pfValue:null)!==null&&r!==e?r:[0,0]
var $=(n=(k===null||k===e||(i=k.pfValue)===null||i===e?e:i.length)===2?k.pfValue:null)!==null&&n!==e?n:[0,0];if(S){var V=[b.ctrlpts[0],b.ctrlpts[1]],F=P?[b.ctrlpts[b.ctrlpts.length-2],b.ctrlpts[b.ctrlpts.length-1]]:V;N=F;M=V}else if(C){var W=!E?[p.x+z[0],p.y+z[1]]:b.segpts.slice(0,2),H=!E?[d.x+$[0],d.y+$[1]]:b.segpts.slice(b.segpts.length-2);N=H;M=W}if(O==="inside-to-node"){s=[p.x,p.y]}else if(A.units){s=this.manualEndptToPx(c,A)}else if(O==="outside-to-line"){s=b.tgtIntn}else{if(O==="outside-to-node"||O==="outside-to-node-or-label"){j=N}else(O==="outside-to-line"||O==="outside-to-line-or-label")&&(j=[d.x,d.y]);s=o.nodeShapes[this.getNodeShape(c)].intersectLine(p.x,p.y,c.outerWidth(),c.outerHeight(),j[0],j[1],0,L,v);if(O==="outside-to-node-or-label"||O==="outside-to-line-or-label"){var X=c._private.rscratch,Y=X.labelWidth,G=X.labelHeight,K=X.labelX,Q=X.labelY,Z=Y/2,J=G/2,ee=c.pstyle("text-valign").value;if(ee==="top"){Q-=J}else ee==="bottom"&&(Q+=J);var te=c.pstyle("text-halign").value;if(te==="left"){K-=Z}else te==="right"&&(K+=Z);var re=Ca(j[0],j[1],[K-Z,Q-J,K+Z,Q-J,K+Z,Q+J,K-Z,Q+J],p.x,p.y);if(re.length>0){var ae=d,ne=zr(ae,Rr(s)),ie=zr(ae,Rr(re)),oe=ne;if(ie<ne){s=re;oe=ie}if(re.length>2){var se=zr(ae,{x:re[2],y:re[3]});se<oe&&(s=[re[2],re[3]])}}}}var le=Ta(s,N,o.arrowShapes[u].spacing(t)+h);var ce=Ta(s,N,o.arrowShapes[u].gap(t)+h);b.endX=ce[0];b.endY=ce[1];b.arrowEndX=le[0];b.arrowEndY=le[1];if(R==="inside-to-node"){s=[d.x,d.y]}else if(k.units){s=this.manualEndptToPx(l,k)}else if(R==="outside-to-line"){s=b.srcIntn}else{if(R==="outside-to-node"||R==="outside-to-node-or-label"){q=M}else(R==="outside-to-line"||R==="outside-to-line-or-label")&&(q=[p.x,p.y]);s=o.nodeShapes[this.getNodeShape(l)].intersectLine(d.x,d.y,l.outerWidth(),l.outerHeight(),q[0],q[1],0,B,y);if(R==="outside-to-node-or-label"||R==="outside-to-line-or-label"){var de=l._private.rscratch,pe=de.labelWidth,ue=de.labelHeight,fe=de.labelX,he=de.labelY,ge=pe/2,ye=ue/2,ve=l.pstyle("text-valign").value;if(ve==="top"){he-=ye}else ve==="bottom"&&(he+=ye);var me=l.pstyle("text-halign").value;if(me==="left"){fe-=ge}else me==="right"&&(fe+=ge);var be=Ca(q[0],q[1],[fe-ge,he-ye,fe+ge,he-ye,fe+ge,he+ye,fe-ge,he+ye],d.x,d.y);if(be.length>0){var xe=p,_e=zr(xe,Rr(s)),we=zr(xe,Rr(be)),Se=_e;if(we<_e){s=[be[0],be[1]];Se=we}if(be.length>2){var Pe=zr(xe,{x:be[2],y:be[3]});Pe<Se&&(s=[be[2],be[3]])}}}}var Ce=Ta(s,M,o.arrowShapes[f].spacing(t)+g);var Ee=Ta(s,M,o.arrowShapes[f].gap(t)+g);b.startX=Ee[0];b.startY=Ee[1];b.arrowStartX=Ce[0];b.arrowStartY=Ce[1];if(T){if(!D(b.startX)||!D(b.startY)||!D(b.endX)||!D(b.endY)){b.badLine=!0}else{b.badLine=!1}}};Hu.getSourceEndpoint=function(e){var t=e[0]._private.rscratch;this.recalculateRenderedStyle(e);switch(t.edgeType){case"haystack":return{x:t.haystackPts[0],y:t.haystackPts[1]};default:return{x:t.arrowStartX,y:t.arrowStartY}}};Hu.getTargetEndpoint=function(e){var t=e[0]._private.rscratch;this.recalculateRenderedStyle(e);switch(t.edgeType){case"haystack":return{x:t.haystackPts[2],y:t.haystackPts[3]};default:return{x:t.arrowEndX,y:t.arrowEndY}}};var Xu={};function Yu(e,t,r){var a=function e(t,r,a,n){return Vr(t,r,a,n)};var n=t._private;var i=n.rstyle.bezierPts;for(var o=0;o<e.bezierProjPcts.length;o++){var s=e.bezierProjPcts[o];i.push({x:a(r[0],r[2],r[4],s),y:a(r[1],r[3],r[5],s)})}}Xu.storeEdgeProjections=function(e){var t=e._private;var r=t.rscratch;var a=r.edgeType;t.rstyle.bezierPts=null;t.rstyle.linePts=null;t.rstyle.haystackPts=null;if(a==="multibezier"||a==="bezier"||a==="self"||a==="compound"){t.rstyle.bezierPts=[];for(var n=0;n+5<r.allpts.length;n+=4){Yu(this,e,r.allpts.slice(n,n+6))}}else if(a==="segments"){var i=t.rstyle.linePts=[];for(var n=0;n+1<r.allpts.length;n+=2){i.push({x:r.allpts[n],y:r.allpts[n+1]})}}else if(a==="haystack"){var o=r.haystackPts;t.rstyle.haystackPts=[{x:o[0],y:o[1]},{x:o[2],y:o[3]}]}t.rstyle.arrowWidth=this.getArrowWidth(e.pstyle("width").pfValue,e.pstyle("arrow-scale").value)*this.arrowShapeWidth};Xu.recalculateEdgeProjections=function(e){this.findEdgeControlPoints(e)};var Gu={};Gu.recalculateNodeLabelProjection=function(e){var t=e.pstyle("label").strValue;if(z(t)){return}var r,a;var n=e._private;var i=e.width();var o=e.height();var s=e.padding();var l=e.position();var c=e.pstyle("text-halign").strValue;var d=e.pstyle("text-valign").strValue;var p=n.rscratch;var u=n.rstyle;switch(c){case"left":r=l.x-i/2-s;break;case"right":r=l.x+i/2+s;break;default:r=l.x}switch(d){case"top":a=l.y-o/2-s;break;case"bottom":a=l.y+o/2+s;break;default:a=l.y}p.labelX=r;p.labelY=a;u.labelX=r;u.labelY=a;this.calculateLabelAngles(e);this.applyLabelDimensions(e)};var Ku=function e(t,r){var a=Math.atan(r/t);t===0&&a<0&&(a=a*-1);return a};var Uu=function e(t,r){var a=r.x-t.x;var n=r.y-t.y;return Ku(a,n)};var Qu=function e(t,r,a,n){var i=Hr(0,n-.001,1);var o=Hr(0,n+.001,1);var s=Fr(t,r,a,i);var l=Fr(t,r,a,o);return Uu(s,l)};Gu.recalculateEdgeLabelProjections=function(e){var t;var r=e._private;var a=r.rscratch;var n=this;var i={mid:e.pstyle("label").strValue,source:e.pstyle("source-label").strValue,target:e.pstyle("target-label").strValue};if(i.mid||i.source||i.target);else{return}t={x:a.midX,y:a.midY};var o=function e(t,a,n){Kt(r.rscratch,t,a,n);Kt(r.rstyle,t,a,n)};o("labelX",null,t.x);o("labelY",null,t.y);var s=Ku(a.midDispX,a.midDispY);o("labelAutoAngle",null,s);var l=function e(){if(l.cache){return l.cache}var t=[];for(var i=0;i+5<a.allpts.length;i+=4){var o={x:a.allpts[i],y:a.allpts[i+1]},s={x:a.allpts[i+2],y:a.allpts[i+3]},c={x:a.allpts[i+4],y:a.allpts[i+5]};t.push({p0:o,p1:s,p2:c,startDist:0,length:0,segments:[]})}var d=r.rstyle.bezierPts;var p=n.bezierProjPcts.length;function u(e,t,r,a,n){var i=qr(t,r);var o=e.segments[e.segments.length-1];var s={p0:t,p1:r,t0:a,t1:n,startDist:o?o.startDist+o.length:0,length:i};e.segments.push(s);e.length+=i}for(var f=0;f<t.length;f++){var h=t[f],g=t[f-1];g&&(h.startDist=g.startDist+g.length);u(h,h.p0,d[f*p],0,n.bezierProjPcts[0]);for(var y=0;y<p-1;y++){u(h,d[f*p+y],d[f*p+y+1],n.bezierProjPcts[y],n.bezierProjPcts[y+1])}u(h,d[f*p+p-1],h.p2,n.bezierProjPcts[p-1],1)}return l.cache=t};var c=function r(n){var s;var c=n==="source";if(!i[n]){return}var d=e.pstyle(n+"-text-offset").pfValue;switch(a.edgeType){case"self":case"compound":case"bezier":case"multibezier":var p=l(),u,f=0,h=0;for(var g=0;g<p.length;g++){var y=p[c?g:p.length-1-g];for(var v=0;v<y.segments.length;v++){var m=y.segments[c?v:y.segments.length-1-v],b=g===p.length-1&&v===y.segments.length-1;f=h;h+=m.length;if(h>=d||b){u={cp:y,segment:m};break}}if(u){break}}var x=u.cp,_=u.segment,w=(d-f)/_.length,S=_.t1-_.t0,P=c?_.t0+S*w:_.t1-S*w;P=Hr(0,P,1);t=Fr(x.p0,x.p1,x.p2,P);s=Qu(x.p0,x.p1,x.p2,P);break;case"straight":case"segments":case"haystack":var C=0,E,T,I,k,R=a.allpts.length;for(var D=0;D+3<R;D+=2){if(c){I={x:a.allpts[D],y:a.allpts[D+1]};k={x:a.allpts[D+2],y:a.allpts[D+3]}}else{I={x:a.allpts[R-2-D],y:a.allpts[R-1-D]};k={x:a.allpts[R-4-D],y:a.allpts[R-3-D]}}E=qr(I,k);T=C;C+=E;if(C>=d){break}}var B=d-T,A=B/E;A=Hr(0,A,1);t=Wr(I,k,A);s=Uu(I,k);break}o("labelX",n,t.x);o("labelY",n,t.y);o("labelAutoAngle",n,s)};c("source");c("target");this.applyLabelDimensions(e)};Gu.applyLabelDimensions=function(e){this.applyPrefixedLabelDimensions(e);if(e.isEdge()){this.applyPrefixedLabelDimensions(e,"source");this.applyPrefixedLabelDimensions(e,"target")}};Gu.applyPrefixedLabelDimensions=function(e,t){var r=e._private;var a=this.getLabelText(e,t);var n=_t(a,e._private.labelDimsKey);if(Gt(r.rscratch,"prefixedLabelDimsKey",t)===n){return}Kt(r.rscratch,"prefixedLabelDimsKey",t,n);var i=this.calculateLabelDimensions(e,a);var o=e.pstyle("line-height").pfValue;var s=e.pstyle("text-wrap").strValue;var l=Gt(r.rscratch,"labelWrapCachedLines",t)||[];var c=s!=="wrap"?1:Math.max(l.length,1);var d=i.height/c;var p=d*o;var u=i.width;var f=i.height+(c-1)*(o-1)*d;Kt(r.rstyle,"labelWidth",t,u);Kt(r.rscratch,"labelWidth",t,u);Kt(r.rstyle,"labelHeight",t,f);Kt(r.rscratch,"labelHeight",t,f);Kt(r.rscratch,"labelLineHeight",t,p)};Gu.getLabelText=function(e,t){var r=e._private;var a=t?t+"-":"";var n=e.pstyle(a+"label").strValue;var i=e.pstyle("text-transform").value;var o=function e(a,n){if(n){Kt(r.rscratch,a,t,n);return n}else{return Gt(r.rscratch,a,t)}};if(!n){return""}if(i=="none");else if(i=="uppercase"){n=n.toUpperCase()}else i=="lowercase"&&(n=n.toLowerCase());var l=e.pstyle("text-wrap").value;if(l==="wrap"){var c=o("labelKey");if(c!=null&&o("labelWrapKey")===c){return o("labelWrapCachedText")}var d="",p=n.split("\n"),u=e.pstyle("text-max-width").pfValue,f=e.pstyle("text-overflow-wrap").value,h=f==="anywhere",g=[],y=/[\s\u200b]+|$/g;for(var v=0;v<p.length;v++){var m=p[v],b=this.calculateLabelDimensions(e,m),x=b.width;if(h){var _=m.split("").join(d);m=_}if(x>u){var w=m.matchAll(y),S="",P=0,C=s(w),E;try{for(C.s();!(E=C.n()).done;){var T=E.value,I=T[0],k=m.substring(P,T.index);P=T.index+I.length;var R=S.length===0?k:S+k+I,D=this.calculateLabelDimensions(e,R),B=D.width;if(B<=u){S+=k+I}else{S&&g.push(S);S=k+I}}}catch(e){C.e(e)}finally{C.f()}S.match(/^[\s\u200b]+$/)||g.push(S)}else{g.push(m)}}o("labelWrapCachedLines",g);n=o("labelWrapCachedText",g.join("\n"));o("labelWrapKey",c)}else if(l==="ellipsis"){var A=e.pstyle("text-max-width").pfValue,O="",L="",N=!1;if(this.calculateLabelDimensions(e,n).width<A){return n}for(var M=0;M<n.length;M++){var j=this.calculateLabelDimensions(e,O+n[M]+L).width;if(j>A){break}O+=n[M];M===n.length-1&&(N=!0)}N||(O+=L);return O}return n};Gu.getLabelJustification=function(e){var t=e.pstyle("text-justification").strValue;var r=e.pstyle("text-halign").strValue;if(t==="auto"){if(e.isNode()){switch(r){case"left":return"right";case"right":return"left";default:return"center"}}else{return"center"}}else{return t}};Gu.calculateLabelDimensions=function(e,t){var r=this;var a=r.cy.window();var n=a.document;var i=0;var o=e.pstyle("font-style").strValue;var s=e.pstyle("font-size").pfValue;var l=e.pstyle("font-family").strValue;var c=e.pstyle("font-weight").strValue;var d=this.labelCalcCanvas;var p=this.labelCalcCanvasContext;if(!d){d=this.labelCalcCanvas=n.createElement("canvas");p=this.labelCalcCanvasContext=d.getContext("2d");var u=d.style;u.position="absolute";u.left="-9999px";u.top="-9999px";u.zIndex="-1";u.visibility="hidden";u.pointerEvents="none"}p.font="".concat(o," ").concat(c," ").concat(s,"px ").concat(l);var f=0;var h=0;var g=t.split("\n");for(var y=0;y<g.length;y++){var v=g[y],m=p.measureText(v),b=Math.ceil(m.width),x=s;f=Math.max(b,f);h+=x}f+=i;h+=i;return{width:f,height:h}};Gu.calculateLabelAngle=function(e,t){var r=e._private;var a=r.rscratch;var n=e.isEdge();var i=t?t+"-":"";var o=e.pstyle(i+"text-rotation");var s=o.strValue;if(s==="none"){return 0}else if(n&&s==="autorotate"){return a.labelAutoAngle}else if(s==="autorotate"){return 0}else{return o.pfValue}};Gu.calculateLabelAngles=function(e){var t=this;var r=e.isEdge();var a=e._private;var n=a.rscratch;n.labelAngle=t.calculateLabelAngle(e);if(r){n.sourceLabelAngle=t.calculateLabelAngle(e,"source");n.targetLabelAngle=t.calculateLabelAngle(e,"target")}};var Zu={};var Ju=28;var ef=!1;Zu.getNodeShape=function(e){var t=this;var r=e.pstyle("shape").value;if(r==="cutrectangle"&&(e.width()<Ju||e.height()<Ju)){if(!ef){Mt("The `cutrectangle` node shape can not be used at small sizes so `rectangle` is used instead");ef=!0}return"rectangle"}if(e.isParent()){if(r==="rectangle"||r==="roundrectangle"||r==="round-rectangle"||r==="cutrectangle"||r==="cut-rectangle"||r==="barrel"){return r}else{return"rectangle"}}if(r==="polygon"){var a=e.pstyle("shape-polygon-points").value;return t.nodeShapes.makePolygon(a).name}return r};var tf={};tf.registerCalculationListeners=function(){var t=this.cy;var r=t.collection();var a=this;var n=function t(a){var n=arguments.length>1&&arguments[1]!==e?arguments[1]:!0;r.merge(a);if(n){for(var i=0;i<a.length;i++){var o=a[i],s=o._private,l=s.rstyle;l.clean=!1;l.cleanConnected=!1}}};a.binder(t).on("bounds.* dirty.*",function e(t){var r=t.target;n(r)}).on("style.* background.*",function e(t){var r=t.target;n(r,!1)});var i=function e(i){if(i){var o=a.onUpdateEleCalcsFns;r.cleanStyle();for(var s=0;s<r.length;s++){var l=r[s],c=l._private.rstyle;if(l.isNode()&&!c.cleanConnected){n(l.connectedEdges());c.cleanConnected=!0}}if(o){for(var d=0;d<o.length;d++){var p=o[d];p(i,r)}}a.recalculateRenderedStyle(r);r=t.collection()}};a.flushRenderedStyleQueue=function(){i(!0)};a.beforeRender(i,a.beforeRenderPriorities.eleCalcs)};tf.onUpdateEleCalcs=function(e){var t=this.onUpdateEleCalcsFns=this.onUpdateEleCalcsFns||[];t.push(e)};tf.recalculateRenderedStyle=function(t,r){var a=function e(t){return t._private.rstyle.cleanConnected};if(t.length===0){return}var n=[];var i=[];if(this.destroyed){return}r===e&&(r=!0);for(var o=0;o<t.length;o++){var s=t[o],l=s._private,c=l.rstyle;s.isEdge()&&(!a(s.source())||!a(s.target()))&&(c.clean=!1);s.isEdge()&&s.isBundledBezier()&&(s.parallelEdges().some(function(e){return!e._private.rstyle.clean&&e.isBundledBezier()})&&(c.clean=!1));if(r&&c.clean||s.removed()){continue}if(s.pstyle("display").value==="none"){continue}if(l.group==="nodes"){i.push(s)}else{n.push(s)}c.clean=!0}for(var d=0;d<i.length;d++){var p=i[d],u=p._private,f=u.rstyle,h=p.position();this.recalculateNodeLabelProjection(p);f.nodeX=h.x;f.nodeY=h.y;f.nodeW=p.pstyle("width").pfValue;f.nodeH=p.pstyle("height").pfValue}this.recalculateEdgeProjections(n);for(var g=0;g<n.length;g++){var y=n[g],v=y._private,m=v.rstyle,b=v.rscratch;m.srcX=b.arrowStartX;m.srcY=b.arrowStartY;m.tgtX=b.arrowEndX;m.tgtY=b.arrowEndY;m.midX=b.midX;m.midY=b.midY;m.labelAngle=b.labelAngle;m.sourceLabelAngle=b.sourceLabelAngle;m.targetLabelAngle=b.targetLabelAngle}};var rf={};rf.updateCachedGrabbedEles=function(){var e=this.cachedZSortedEles;if(!e){return}e.drag=[];e.nondrag=[];var t=[];for(var r=0;r<e.length;r++){var a=e[r],n=a._private.rscratch;if(a.grabbed()&&!a.isParent()){t.push(a)}else if(n.inDragLayer){e.drag.push(a)}else{e.nondrag.push(a)}}for(var r=0;r<t.length;r++){var a=t[r];e.drag.push(a)}};rf.invalidateCachedZSortedEles=function(){this.cachedZSortedEles=null};rf.getCachedZSortedEles=function(e){if(e||!this.cachedZSortedEles){var t=this.cy.mutableElements().toArray();t.sort(pd);t.interactive=t.filter(function(e){return e.interactive()});this.cachedZSortedEles=t;this.updateCachedGrabbedEles()}else{t=this.cachedZSortedEles}return t};var af={};[gu,yu,Fu,Hu,Xu,Gu,Zu,tf,rf].forEach(function(e){oe(af,e)});var nf={};nf.getCachedImage=function(e,t,r){var a=this;var n=a.imageCache=a.imageCache||{};var i=n[e];if(i){i.image.complete||i.image.addEventListener("load",r);return i.image}else{i=n[e]=n[e]||{};var o=i.image=new Image;o.addEventListener("load",r);o.addEventListener("error",function(){o.error=!0});var s="data:",l=e.substring(0,s.length).toLowerCase()===s;if(!l){t=t==="null"?null:t;o.crossOrigin=t}o.src=e;return o}};var of={};of.registerBinding=function(t,r,a,n){var i=Array.prototype.slice.apply(arguments,[1]);if(Array.isArray(t)){var o=[];for(var s=0;s<t.length;s++){var l=t[s];if(l!==e){var c=this.binder(l);o.push(c.on.apply(c,i))}}return o}var c=this.binder(t);return c.on.apply(c,i)};of.binder=function(e){var t=this;var r=t.cy.window();var a=e===r||e===r.document||e===r.document.body||$(e);if(t.supportsPassiveEvents==null){var n=!1;try{var i=Object.defineProperty({},"passive",{get:function e(){n=!0;return!0}});r.addEventListener("test",null,i)}catch(e){}t.supportsPassiveEvents=n}var o=function r(n,i,o){var s=Array.prototype.slice.call(arguments);a&&t.supportsPassiveEvents&&(s[2]={capture:o!=null?o:!1,passive:!1,once:!1});t.bindings.push({target:e,args:s});(e.addEventListener||e.on).apply(e,s);return this};return{on:o,addEventListener:o,addListener:o,bind:o}};of.nodeIsDraggable=function(e){return e&&e.isNode()&&!e.locked()&&e.grabbable()};of.nodeIsGrabbable=function(e){return this.nodeIsDraggable(e)&&e.interactive()};of.load=function(){var t=this;var r=t.cy.window();var a=function e(t){return t.selected()};var n=function t(r){var a=r.getRootNode();if(a&&a.nodeType===11&&a.host!==e){return a}};var i=function e(r,a,n,i){r==null&&(r=t.cy);for(var o=0;o<a.length;o++){var s=a[o];r.emit({originalEvent:n,type:s,position:i})}};var o=function e(t){return t.shiftKey||t.metaKey||t.ctrlKey};var s=function e(r,a){var n=!0;if(t.cy.hasCompoundNodes()&&r&&r.pannable()){for(var i=0;a&&i<a.length;i++){var r=a[i];if(r.isNode()&&r.isParent()&&!r.pannable()){n=!1;break}}}else{n=!0}return n};var l=function e(t){t[0]._private.grabbed=!0};var c=function e(t){t[0]._private.grabbed=!1};var d=function e(t){t[0]._private.rscratch.inDragLayer=!0};var p=function e(t){t[0]._private.rscratch.inDragLayer=!1};var u=function e(t){t[0]._private.rscratch.isGrabTarget=!0};var f=function e(t){t[0]._private.rscratch.isGrabTarget=!1};var h=function e(t,r){var a=r.addToList;var n=a.has(t);if(!n&&t.grabbable()&&!t.locked()){a.merge(t);l(t)}};var g=function e(t,r){if(!t.cy().hasCompoundNodes()){return}if(r.inDragLayer==null&&r.addToList==null){return}var a=t.descendants();if(r.inDragLayer){a.forEach(d);a.connectedEdges().forEach(d)}r.addToList&&h(a,r)};var y=function e(r,a){a=a||{};var n=r.cy().hasCompoundNodes();if(a.inDragLayer){r.forEach(d);r.neighborhood().stdFilter(function(e){return!n||e.isEdge()}).forEach(d)}a.addToList&&r.forEach(function(e){h(e,a)});g(r,a);m(r,{inDragLayer:a.inDragLayer});t.updateCachedGrabbedEles()};var v=function e(r){if(!r){return}t.getCachedZSortedEles().forEach(function(e){c(e);p(e);f(e)});t.updateCachedGrabbedEles()};var m=function e(t,r){if(r.inDragLayer==null&&r.addToList==null){return}if(!t.cy().hasCompoundNodes()){return}var a=t.ancestors().orphans();if(a.same(t)){return}var n=a.descendants().spawnSelf().merge(a).unmerge(t).unmerge(t.descendants());var i=n.connectedEdges();if(r.inDragLayer){i.forEach(d);n.forEach(d)}r.addToList&&n.forEach(function(e){h(e,r)})};var b=function e(){document.activeElement!=null&&document.activeElement.blur!=null&&document.activeElement.blur()};var x=typeof MutationObserver!=="undefined";var _=typeof ResizeObserver!=="undefined";if(x){t.removeObserver=new MutationObserver(function(e){for(var r=0;r<e.length;r++){var a=e[r],n=a.removedNodes;if(n){for(var i=0;i<n.length;i++){var o=n[i];if(o===t.container){t.destroy();break}}}}});t.container.parentNode&&t.removeObserver.observe(t.container.parentNode,{childList:!0})}else{t.registerBinding(t.container,"DOMNodeRemoved",function(e){t.destroy()})}var w=ot(function(){t.cy.resize()},100);if(x){t.styleObserver=new MutationObserver(w);t.styleObserver.observe(t.container,{attributes:!0})}t.registerBinding(r,"resize",w);if(_){t.resizeObserver=new ResizeObserver(w);t.resizeObserver.observe(t.container)}var S=function e(t,r){while(t!=null){r(t);t=t.parentNode}};var P=function e(){t.invalidateContainerClientCoordsCache()};S(t.container,function(e){t.registerBinding(e,"transitionend",P);t.registerBinding(e,"animationend",P);t.registerBinding(e,"scroll",P)});t.registerBinding(t.container,"contextmenu",function(e){e.preventDefault()});var C=function e(){return t.selection[4]!==0};var E=function e(r){var a=t.findContainerClientCoords();var n=a[0];var i=a[1];var o=a[2];var s=a[3];var l=r.touches?r.touches:[r];var c=!1;for(var d=0;d<l.length;d++){var p=l[d];if(n<=p.clientX&&p.clientX<=n+o&&i<=p.clientY&&p.clientY<=i+s){c=!0;break}}if(!c){return!1}var u=t.container;var f=r.target;var h=f.parentNode;var g=!1;while(h){if(h===u){g=!0;break}h=h.parentNode}if(!g){return!1}return!0};t.registerBinding(t.container,"mousedown",function e(r){if(!E(r)){return}if(t.hoverData.which===1&&r.which!==1){return}r.preventDefault();b();t.hoverData.capture=!0;t.hoverData.which=r.which;var a=t.cy;var n=[r.clientX,r.clientY];var o=t.projectIntoViewport(n[0],n[1]);var s=t.selection;var l=t.findNearestElements(o[0],o[1],!0,!1);var c=l[0];var d=t.dragData.possibleDragElements;t.hoverData.mdownPos=o;t.hoverData.mdownGPos=n;var p=function e(t){return{originalEvent:r,type:t,position:{x:o[0],y:o[1]}}};var f=function e(){t.hoverData.tapholdCancelled=!1;clearTimeout(t.hoverData.tapholdTimeout);t.hoverData.tapholdTimeout=setTimeout(function(){if(t.hoverData.tapholdCancelled){return}else{var e=t.hoverData.down;if(e){e.emit(p("taphold"))}else{a.emit(p("taphold"))}}},t.tapholdDuration)};if(r.which==3){t.hoverData.cxtStarted=!0;var h={originalEvent:r,type:"cxttapstart",position:{x:o[0],y:o[1]}};if(c){c.activate();c.emit(h);t.hoverData.down=c}else{a.emit(h)}t.hoverData.downTime=(new Date).getTime();t.hoverData.cxtDragged=!1}else if(r.which==1){c&&c.activate();if(c!=null){if(t.nodeIsGrabbable(c)){var g=function e(t){t.emit(p("grab"))};u(c);if(!c.selected()){d=t.dragData.possibleDragElements=a.collection();y(c,{addToList:d});c.emit(p("grabon")).emit(p("grab"))}else{d=t.dragData.possibleDragElements=a.collection();var v=a.$(function(e){return e.isNode()&&e.selected()&&t.nodeIsGrabbable(e)});y(v,{addToList:d});c.emit(p("grabon"));v.forEach(g)}t.redrawHint("eles",!0);t.redrawHint("drag",!0)}}t.hoverData.down=c;t.hoverData.downs=l;t.hoverData.downTime=(new Date).getTime();i(c,["mousedown","tapstart","vmousedown"],r,{x:o[0],y:o[1]});if(c==null){s[4]=1;t.data.bgActivePosistion={x:o[0],y:o[1]};t.redrawHint("select",!0);t.redraw()}else c.pannable()&&(s[4]=1);f()}s[0]=s[2]=o[0];s[1]=s[3]=o[1]},!1);var T=n(t.container);t.registerBinding([r,T],"mousemove",function r(a){var n=t.hoverData.capture;if(!n&&!E(a)){return}var l=!1;var c=t.cy;var d=c.zoom();var p=[a.clientX,a.clientY];var u=t.projectIntoViewport(p[0],p[1]);var f=t.hoverData.mdownPos;var h=t.hoverData.mdownGPos;var g=t.selection;var m=null;!t.hoverData.draggingEles&&!t.hoverData.dragging&&!t.hoverData.selecting&&(m=t.findNearestElement(u[0],u[1],!0,!1));var b=t.hoverData.last;var x=t.hoverData.down;var _=[u[0]-g[2],u[1]-g[3]];var w=t.dragData.possibleDragElements;var S;if(h){var P=p[0]-h[0],C=P*P,T=p[1]-h[1],I=T*T,k=C+I;t.hoverData.isOverThresholdDrag=S=k>=t.desktopTapThreshold2}var R=o(a);S&&(t.hoverData.tapholdCancelled=!0);var B=function e(){var r=t.hoverData.dragDelta=t.hoverData.dragDelta||[];if(r.length===0){r.push(_[0]);r.push(_[1])}else{r[0]+=_[0];r[1]+=_[1]}};l=!0;i(m,["mousemove","vmousemove","tapdrag"],a,{x:u[0],y:u[1]});var A=function e(t){return{originalEvent:a,type:t,position:{x:u[0],y:u[1]}}};var O=function r(){t.data.bgActivePosistion=e;t.hoverData.selecting||c.emit(A("boxstart"));g[4]=1;t.hoverData.selecting=!0;t.redrawHint("select",!0);t.redraw()};if(t.hoverData.which===3){if(S){var L=A("cxtdrag");if(x){x.emit(L)}else{c.emit(L)}t.hoverData.cxtDragged=!0;if(!t.hoverData.cxtOver||m!==t.hoverData.cxtOver){t.hoverData.cxtOver&&t.hoverData.cxtOver.emit(A("cxtdragout"));t.hoverData.cxtOver=m;m&&m.emit(A("cxtdragover"))}}}else if(t.hoverData.dragging){l=!0;if(c.panningEnabled()&&c.userPanningEnabled()){var N;if(t.hoverData.justStartedPan){var M=t.hoverData.mdownPos;N={x:(u[0]-M[0])*d,y:(u[1]-M[1])*d};t.hoverData.justStartedPan=!1}else{N={x:_[0]*d,y:_[1]*d}}c.panBy(N);c.emit(A("dragpan"));t.hoverData.dragged=!0}u=t.projectIntoViewport(a.clientX,a.clientY)}else if(g[4]==1&&(x==null||x.pannable())){if(S){if(!t.hoverData.dragging&&c.boxSelectionEnabled()&&(R||!c.panningEnabled()||!c.userPanningEnabled())){O()}else if(!t.hoverData.selecting&&c.panningEnabled()&&c.userPanningEnabled()){var j=s(x,t.hoverData.downs);if(j){t.hoverData.dragging=!0;t.hoverData.justStartedPan=!0;g[4]=0;t.data.bgActivePosistion=Rr(f);t.redrawHint("select",!0);t.redraw()}}x&&x.pannable()&&x.active()&&x.unactivate()}}else{x&&x.pannable()&&x.active()&&x.unactivate();if((!x||!x.grabbed())&&m!=b){b&&i(b,["mouseout","tapdragout"],a,{x:u[0],y:u[1]});m&&i(m,["mouseover","tapdragover"],a,{x:u[0],y:u[1]});t.hoverData.last=m}if(x){if(S){if(c.boxSelectionEnabled()&&R){if(x&&x.grabbed()){v(w);x.emit(A("freeon"));w.emit(A("free"));if(t.dragData.didDrag){x.emit(A("dragfreeon"));w.emit(A("dragfree"))}}O()}else if(x&&x.grabbed()&&t.nodeIsDraggable(x)){var q=!t.dragData.didDrag;q&&t.redrawHint("eles",!0);t.dragData.didDrag=!0;t.hoverData.draggingEles||y(w,{inDragLayer:!0});var z={x:0,y:0};if(D(_[0])&&D(_[1])){z.x+=_[0];z.y+=_[1];if(q){var $=t.hoverData.dragDelta;if($&&D($[0])&&D($[1])){z.x+=$[0];z.y+=$[1]}}}t.hoverData.draggingEles=!0;w.silentShift(z).emit(A("position")).emit(A("drag"));t.redrawHint("drag",!0);t.redraw()}}else{B()}}l=!0}g[2]=u[0];g[3]=u[1];if(l){a.stopPropagation&&a.stopPropagation();a.preventDefault&&a.preventDefault();return!1}},!1);var I,k,R;t.registerBinding(r,"mouseup",function r(n){if(t.hoverData.which===1&&n.which!==1&&t.hoverData.capture){return}var s=t.hoverData.capture;if(!s){return}t.hoverData.capture=!1;var l=t.cy;var c=t.projectIntoViewport(n.clientX,n.clientY);var d=t.selection;var p=t.findNearestElement(c[0],c[1],!0,!1);var u=t.dragData.possibleDragElements;var f=t.hoverData.down;var h=o(n);if(t.data.bgActivePosistion){t.redrawHint("select",!0);t.redraw()}t.hoverData.tapholdCancelled=!0;t.data.bgActivePosistion=e;f&&f.unactivate();var g=function e(t){return{originalEvent:n,type:t,position:{x:c[0],y:c[1]}}};if(t.hoverData.which===3){var y=g("cxttapend");if(f){f.emit(y)}else{l.emit(y)}if(!t.hoverData.cxtDragged){var m=g("cxttap");if(f){f.emit(m)}else{l.emit(m)}}t.hoverData.cxtDragged=!1;t.hoverData.which=null}else if(t.hoverData.which===1){i(p,["mouseup","tapend","vmouseup"],n,{x:c[0],y:c[1]});if(!t.dragData.didDrag&&!t.hoverData.dragged&&!t.hoverData.selecting&&!t.hoverData.isOverThresholdDrag){i(f,["click","tap","vclick"],n,{x:c[0],y:c[1]});k=!1;if(n.timeStamp-R<=l.multiClickDebounceTime()){I&&clearTimeout(I);k=!0;R=null;i(f,["dblclick","dbltap","vdblclick"],n,{x:c[0],y:c[1]})}else{I=setTimeout(function(){if(k)return;i(f,["oneclick","onetap","voneclick"],n,{x:c[0],y:c[1]})},l.multiClickDebounceTime());R=n.timeStamp}}if(f==null&&!t.dragData.didDrag&&!t.hoverData.selecting&&!t.hoverData.dragged&&!o(n)){l.$(a).unselect(["tapunselect"]);u.length>0&&t.redrawHint("eles",!0);t.dragData.possibleDragElements=u=l.collection()}if(p==f&&!t.dragData.didDrag&&!t.hoverData.selecting){if(p!=null&&p._private.selectable){if(t.hoverData.dragging);else if(l.selectionType()==="additive"||h){if(p.selected()){p.unselect(["tapunselect"])}else{p.select(["tapselect"])}}else{if(!h){l.$(a).unmerge(p).unselect(["tapunselect"]);p.select(["tapselect"])}}t.redrawHint("eles",!0)}}if(t.hoverData.selecting){var b=l.collection(t.getAllInBox(d[0],d[1],d[2],d[3]));t.redrawHint("select",!0);b.length>0&&t.redrawHint("eles",!0);l.emit(g("boxend"));var x=function e(t){return t.selectable()&&!t.selected()};if(l.selectionType()==="additive"){b.emit(g("box")).stdFilter(x).select().emit(g("boxselect"))}else{h||l.$(a).unmerge(b).unselect();b.emit(g("box")).stdFilter(x).select().emit(g("boxselect"))}t.redraw()}if(t.hoverData.dragging){t.hoverData.dragging=!1;t.redrawHint("select",!0);t.redrawHint("eles",!0);t.redraw()}if(!d[4]){t.redrawHint("drag",!0);t.redrawHint("eles",!0);var _=f&&f.grabbed();v(u);if(_){f.emit(g("freeon"));u.emit(g("free"));if(t.dragData.didDrag){f.emit(g("dragfreeon"));u.emit(g("dragfree"))}}}}d[4]=0;t.hoverData.down=null;t.hoverData.cxtStarted=!1;t.hoverData.draggingEles=!1;t.hoverData.selecting=!1;t.hoverData.isOverThresholdDrag=!1;t.dragData.didDrag=!1;t.hoverData.dragged=!1;t.hoverData.dragDelta=[];t.hoverData.mdownPos=null;t.hoverData.mdownGPos=null;t.hoverData.which=null},!1);var B=[];var A=4;var O;var L=1e5;var N=function e(t,r){for(var a=0;a<t.length;a++){if(t[a]%r!==0){return!1}}return!0};var M=function e(t){var r=Math.abs(t[0]);for(var a=1;a<t.length;a++){if(Math.abs(t[a])!==r){return!1}}return!0};var j=function e(r){var a=!1;var n=r.deltaY;if(n==null){if(r.wheelDeltaY!=null){n=r.wheelDeltaY/4}else r.wheelDelta!=null&&(n=r.wheelDelta/4)}if(n===0){return}if(O==null){if(B.length>=A){var i=B;O=N(i,5);if(!O){var o=Math.abs(i[0]);O=M(i)&&o>5}if(O){for(var s=0;s<i.length;s++){L=Math.min(Math.abs(i[s]),L)}}}else{B.push(n);a=!0}}else O&&(L=Math.min(Math.abs(n),L));if(t.scrollingPage){return}var l=t.cy;var c=l.zoom();var d=l.pan();var p=t.projectIntoViewport(r.clientX,r.clientY);var u=[p[0]*c+d.x,p[1]*c+d.y];if(t.hoverData.draggingEles||t.hoverData.dragging||t.hoverData.cxtStarted||C()){r.preventDefault();return}if(l.panningEnabled()&&l.userPanningEnabled()&&l.zoomingEnabled()&&l.userZoomingEnabled()){r.preventDefault();t.data.wheelZooming=!0;clearTimeout(t.data.wheelTimeout);t.data.wheelTimeout=setTimeout(function(){t.data.wheelZooming=!1;t.redrawHint("eles",!0);t.redraw()},150);var f;a&&Math.abs(n)>5&&(n=jr(n)*5);f=n/-250;if(O){f/=L;f*=3}f=f*t.wheelSensitivity;var h=r.deltaMode===1;h&&(f*=33);var g=l.zoom()*Math.pow(10,f);r.type==="gesturechange"&&(g=t.gestureStartZoom*r.scale);l.zoom({level:g,renderedPosition:{x:u[0],y:u[1]}});l.emit({type:r.type==="gesturechange"?"pinchzoom":"scrollzoom",originalEvent:r,position:{x:p[0],y:p[1]}})}};t.registerBinding(t.container,"wheel",j,!0);t.registerBinding(r,"scroll",function e(r){t.scrollingPage=!0;clearTimeout(t.scrollingPageTimeout);t.scrollingPageTimeout=setTimeout(function(){t.scrollingPage=!1},250)},!0);t.registerBinding(t.container,"gesturestart",function e(r){t.gestureStartZoom=t.cy.zoom();t.hasTouchStarted||r.preventDefault()},!0);t.registerBinding(t.container,"gesturechange",function(e){t.hasTouchStarted||j(e)},!0);t.registerBinding(t.container,"mouseout",function e(r){var a=t.projectIntoViewport(r.clientX,r.clientY);t.cy.emit({originalEvent:r,type:"mouseout",position:{x:a[0],y:a[1]}})},!1);t.registerBinding(t.container,"mouseover",function e(r){var a=t.projectIntoViewport(r.clientX,r.clientY);t.cy.emit({originalEvent:r,type:"mouseover",position:{x:a[0],y:a[1]}})},!1);var q,z,$,V;var F,W;var H,X;var Y,G;var K,U;var Q;var Z=function e(t,r,a,n){return Math.sqrt((a-t)*(a-t)+(n-r)*(n-r))};var J=function e(t,r,a,n){return(a-t)*(a-t)+(n-r)*(n-r)};var ee;t.registerBinding(t.container,"touchstart",ee=function r(a){t.hasTouchStarted=!0;if(!E(a)){return}b();t.touchData.capture=!0;t.data.bgActivePosistion=e;var n=t.cy;var o=t.touchData.now;var s=t.touchData.earlier;if(a.touches[0]){var l=t.projectIntoViewport(a.touches[0].clientX,a.touches[0].clientY);o[0]=l[0];o[1]=l[1]}if(a.touches[1]){var l=t.projectIntoViewport(a.touches[1].clientX,a.touches[1].clientY);o[2]=l[0];o[3]=l[1]}if(a.touches[2]){var l=t.projectIntoViewport(a.touches[2].clientX,a.touches[2].clientY);o[4]=l[0];o[5]=l[1]}var c=function e(t){return{originalEvent:a,type:t,position:{x:o[0],y:o[1]}}};if(a.touches[1]){t.touchData.singleTouchMoved=!0;v(t.dragData.touchDragEles);var d=t.findContainerClientCoords();Y=d[0];G=d[1];K=d[2];U=d[3];q=a.touches[0].clientX-Y;z=a.touches[0].clientY-G;$=a.touches[1].clientX-Y;V=a.touches[1].clientY-G;Q=0<=q&&q<=K&&0<=$&&$<=K&&0<=z&&z<=U&&0<=V&&V<=U;var p=n.pan(),f=n.zoom();F=Z(q,z,$,V);W=J(q,z,$,V);H=[(q+$)/2,(z+V)/2];X=[(H[0]-p.x)/f,(H[1]-p.y)/f];var h=200,g=h*h;if(W<g&&!a.touches[2]){var m=t.findNearestElement(o[0],o[1],!0,!0),x=t.findNearestElement(o[2],o[3],!0,!0);if(m&&m.isNode()){m.activate().emit(c("cxttapstart"));t.touchData.start=m}else if(x&&x.isNode()){x.activate().emit(c("cxttapstart"));t.touchData.start=x}else{n.emit(c("cxttapstart"))}t.touchData.start&&(t.touchData.start._private.grabbed=!1);t.touchData.cxt=!0;t.touchData.cxtDragged=!1;t.data.bgActivePosistion=e;t.redraw();return}}if(a.touches[2]){n.boxSelectionEnabled()&&a.preventDefault()}else if(a.touches[1]);else if(a.touches[0]){var _=t.findNearestElements(o[0],o[1],!0,!0),w=_[0];if(w!=null){w.activate();t.touchData.start=w;t.touchData.starts=_;if(t.nodeIsGrabbable(w)){var S=t.dragData.touchDragEles=n.collection(),P=null;t.redrawHint("eles",!0);t.redrawHint("drag",!0);if(w.selected()){P=n.$(function(e){return e.selected()&&t.nodeIsGrabbable(e)});y(P,{addToList:S})}else{y(w,{addToList:S})}u(w);w.emit(c("grabon"));if(P){P.forEach(function(e){e.emit(c("grab"))})}else{w.emit(c("grab"))}}}i(w,["touchstart","tapstart","vmousedown"],a,{x:o[0],y:o[1]});if(w==null){t.data.bgActivePosistion={x:l[0],y:l[1]};t.redrawHint("select",!0);t.redraw()}t.touchData.singleTouchMoved=!1;t.touchData.singleTouchStartTime=+new Date
clearTimeout(t.touchData.tapholdTimeout);t.touchData.tapholdTimeout=setTimeout(function(){t.touchData.singleTouchMoved===!1&&!t.pinching&&!t.touchData.selecting&&i(t.touchData.start,["taphold"],a,{x:o[0],y:o[1]})},t.tapholdDuration)}if(a.touches.length>=1){var C=t.touchData.startPosition=[null,null,null,null,null,null];for(var T=0;T<o.length;T++){C[T]=s[T]=o[T]}var I=a.touches[0];t.touchData.startGPosition=[I.clientX,I.clientY]}},!1);var te;t.registerBinding(r,"touchmove",te=function r(a){var n=t.touchData.capture;if(!n&&!E(a)){return}var o=t.selection;var l=t.cy;var c=t.touchData.now;var d=t.touchData.earlier;var p=l.zoom();if(a.touches[0]){var u=t.projectIntoViewport(a.touches[0].clientX,a.touches[0].clientY);c[0]=u[0];c[1]=u[1]}if(a.touches[1]){var u=t.projectIntoViewport(a.touches[1].clientX,a.touches[1].clientY);c[2]=u[0];c[3]=u[1]}if(a.touches[2]){var u=t.projectIntoViewport(a.touches[2].clientX,a.touches[2].clientY);c[4]=u[0];c[5]=u[1]}var f=function e(t){return{originalEvent:a,type:t,position:{x:c[0],y:c[1]}}};var h=t.touchData.startGPosition;var g;if(n&&a.touches[0]&&h){var m=[];for(var b=0;b<c.length;b++){m[b]=c[b]-d[b]}var x=a.touches[0].clientX-h[0],_=x*x,w=a.touches[0].clientY-h[1],S=w*w,P=_+S;g=P>=t.touchTapThreshold2}if(n&&t.touchData.cxt){a.preventDefault();var C=a.touches[0].clientX-Y,T=a.touches[0].clientY-G,I=a.touches[1].clientX-Y,k=a.touches[1].clientY-G,R=J(C,T,I,k),B=R/W,A=150,O=A*A,L=1.5,N=L*L;if(B>=N||R>=O){t.touchData.cxt=!1;t.data.bgActivePosistion=e;t.redrawHint("select",!0);var M=f("cxttapend");if(t.touchData.start){t.touchData.start.unactivate().emit(M);t.touchData.start=null}else{l.emit(M)}}}if(n&&t.touchData.cxt){var M=f("cxtdrag");t.data.bgActivePosistion=e;t.redrawHint("select",!0);if(t.touchData.start){t.touchData.start.emit(M)}else{l.emit(M)}t.touchData.start&&(t.touchData.start._private.grabbed=!1);t.touchData.cxtDragged=!0;var j=t.findNearestElement(c[0],c[1],!0,!0);if(!t.touchData.cxtOver||j!==t.touchData.cxtOver){t.touchData.cxtOver&&t.touchData.cxtOver.emit(f("cxtdragout"));t.touchData.cxtOver=j;j&&j.emit(f("cxtdragover"))}}else if(n&&a.touches[2]&&l.boxSelectionEnabled()){a.preventDefault();t.data.bgActivePosistion=e;this.lastThreeTouch=+new Date;t.touchData.selecting||l.emit(f("boxstart"));t.touchData.selecting=!0;t.touchData.didSelect=!0;o[4]=1;if(!o||o.length===0||o[0]===e){o[0]=(c[0]+c[2]+c[4])/3;o[1]=(c[1]+c[3]+c[5])/3;o[2]=(c[0]+c[2]+c[4])/3+1;o[3]=(c[1]+c[3]+c[5])/3+1}else{o[2]=(c[0]+c[2]+c[4])/3;o[3]=(c[1]+c[3]+c[5])/3}t.redrawHint("select",!0);t.redraw()}else if(n&&a.touches[1]&&!t.touchData.didSelect&&l.zoomingEnabled()&&l.panningEnabled()&&l.userZoomingEnabled()&&l.userPanningEnabled()){a.preventDefault();t.data.bgActivePosistion=e;t.redrawHint("select",!0);var H=t.dragData.touchDragEles;if(H){t.redrawHint("drag",!0);for(var K=0;K<H.length;K++){var U=H[K]._private;U.grabbed=!1;U.rscratch.inDragLayer=!1}}var ee=t.touchData.start,C=a.touches[0].clientX-Y,T=a.touches[0].clientY-G,I=a.touches[1].clientX-Y,k=a.touches[1].clientY-G,te=Z(C,T,I,k),re=te/F;if(Q){var ae=C-q,ne=T-z,ie=I-$,oe=k-V,se=(ae+ie)/2,le=(ne+oe)/2,ce=l.zoom(),de=ce*re,pe=l.pan(),ue=X[0]*ce+pe.x,fe=X[1]*ce+pe.y,he={x:-de/ce*(ue-pe.x-se)+ue,y:-de/ce*(fe-pe.y-le)+fe};if(ee&&ee.active()){var H=t.dragData.touchDragEles;v(H);t.redrawHint("drag",!0);t.redrawHint("eles",!0);ee.unactivate().emit(f("freeon"));H.emit(f("free"));if(t.dragData.didDrag){ee.emit(f("dragfreeon"));H.emit(f("dragfree"))}}l.viewport({zoom:de,pan:he,cancelOnFailedZoom:!0});l.emit(f("pinchzoom"));F=te;q=C;z=T;$=I;V=k;t.pinching=!0}if(a.touches[0]){var u=t.projectIntoViewport(a.touches[0].clientX,a.touches[0].clientY);c[0]=u[0];c[1]=u[1]}if(a.touches[1]){var u=t.projectIntoViewport(a.touches[1].clientX,a.touches[1].clientY);c[2]=u[0];c[3]=u[1]}if(a.touches[2]){var u=t.projectIntoViewport(a.touches[2].clientX,a.touches[2].clientY);c[4]=u[0];c[5]=u[1]}}else if(a.touches[0]&&!t.touchData.didSelect){var ge=t.touchData.start,ye=t.touchData.last,j;!t.hoverData.draggingEles&&!t.swipePanning&&(j=t.findNearestElement(c[0],c[1],!0,!0));n&&ge!=null&&a.preventDefault();if(n&&ge!=null&&t.nodeIsDraggable(ge)){if(g){var H=t.dragData.touchDragEles,ve=!t.dragData.didDrag;ve&&y(H,{inDragLayer:!0});t.dragData.didDrag=!0;var me={x:0,y:0};if(D(m[0])&&D(m[1])){me.x+=m[0];me.y+=m[1];if(ve){t.redrawHint("eles",!0);var be=t.touchData.dragDelta;if(be&&D(be[0])&&D(be[1])){me.x+=be[0];me.y+=be[1]}}}t.hoverData.draggingEles=!0;H.silentShift(me).emit(f("position")).emit(f("drag"));t.redrawHint("drag",!0);t.touchData.startPosition[0]==d[0]&&t.touchData.startPosition[1]==d[1]&&t.redrawHint("eles",!0);t.redraw()}else{var be=t.touchData.dragDelta=t.touchData.dragDelta||[];if(be.length===0){be.push(m[0]);be.push(m[1])}else{be[0]+=m[0];be[1]+=m[1]}}}i(ge||j,["touchmove","tapdrag","vmousemove"],a,{x:c[0],y:c[1]});if((!ge||!ge.grabbed())&&j!=ye){ye&&ye.emit(f("tapdragout"));j&&j.emit(f("tapdragover"))}t.touchData.last=j;if(n){for(var K=0;K<c.length;K++){c[K]&&t.touchData.startPosition[K]&&g&&(t.touchData.singleTouchMoved=!0)}}if(n&&(ge==null||ge.pannable())&&l.panningEnabled()&&l.userPanningEnabled()){var xe=s(ge,t.touchData.starts);if(xe){a.preventDefault();t.data.bgActivePosistion||(t.data.bgActivePosistion=Rr(t.touchData.startPosition));if(t.swipePanning){l.panBy({x:m[0]*p,y:m[1]*p});l.emit(f("dragpan"))}else if(g){t.swipePanning=!0;l.panBy({x:x*p,y:w*p});l.emit(f("dragpan"));if(ge){ge.unactivate();t.redrawHint("select",!0);t.touchData.start=null}}}var u=t.projectIntoViewport(a.touches[0].clientX,a.touches[0].clientY);c[0]=u[0];c[1]=u[1]}}for(var b=0;b<c.length;b++){d[b]=c[b]}if(n&&a.touches.length>0&&!t.hoverData.draggingEles&&!t.swipePanning&&t.data.bgActivePosistion!=null){t.data.bgActivePosistion=e;t.redrawHint("select",!0);t.redraw()}},!1);var re;t.registerBinding(r,"touchcancel",re=function e(r){var a=t.touchData.start;t.touchData.capture=!1;a&&a.unactivate()});var ae,ne,ie,oe;t.registerBinding(r,"touchend",ae=function r(n){var o=t.touchData.start;var s=t.touchData.capture;if(s){n.touches.length===0&&(t.touchData.capture=!1);n.preventDefault()}else{return}var l=t.selection;t.swipePanning=!1;t.hoverData.draggingEles=!1;var c=t.cy;var d=c.zoom();var p=t.touchData.now;var u=t.touchData.earlier;if(n.touches[0]){var f=t.projectIntoViewport(n.touches[0].clientX,n.touches[0].clientY);p[0]=f[0];p[1]=f[1]}if(n.touches[1]){var f=t.projectIntoViewport(n.touches[1].clientX,n.touches[1].clientY);p[2]=f[0];p[3]=f[1]}if(n.touches[2]){var f=t.projectIntoViewport(n.touches[2].clientX,n.touches[2].clientY);p[4]=f[0];p[5]=f[1]}var h=function e(t){return{originalEvent:n,type:t,position:{x:p[0],y:p[1]}}};o&&o.unactivate();var g;if(t.touchData.cxt){g=h("cxttapend");if(o){o.emit(g)}else{c.emit(g)}if(!t.touchData.cxtDragged){var y=h("cxttap");if(o){o.emit(y)}else{c.emit(y)}}t.touchData.start&&(t.touchData.start._private.grabbed=!1);t.touchData.cxt=!1;t.touchData.start=null;t.redraw();return}if(!n.touches[2]&&c.boxSelectionEnabled()&&t.touchData.selecting){t.touchData.selecting=!1;var m=c.collection(t.getAllInBox(l[0],l[1],l[2],l[3]));l[0]=e;l[1]=e;l[2]=e;l[3]=e;l[4]=0;t.redrawHint("select",!0);c.emit(h("boxend"));var b=function e(t){return t.selectable()&&!t.selected()};m.emit(h("box")).stdFilter(b).select().emit(h("boxselect"));m.nonempty()&&t.redrawHint("eles",!0);t.redraw()}o!=null&&o.unactivate();if(n.touches[2]){t.data.bgActivePosistion=e;t.redrawHint("select",!0)}else if(n.touches[1]);else if(n.touches[0]);else if(!n.touches[0]){t.data.bgActivePosistion=e;t.redrawHint("select",!0);var x=t.dragData.touchDragEles;if(o!=null){var _=o._private.grabbed;v(x);t.redrawHint("drag",!0);t.redrawHint("eles",!0);if(_){o.emit(h("freeon"));x.emit(h("free"));if(t.dragData.didDrag){o.emit(h("dragfreeon"));x.emit(h("dragfree"))}}i(o,["touchend","tapend","vmouseup","tapdragout"],n,{x:p[0],y:p[1]});o.unactivate();t.touchData.start=null}else{var w=t.findNearestElement(p[0],p[1],!0,!0);i(w,["touchend","tapend","vmouseup","tapdragout"],n,{x:p[0],y:p[1]})}var S=t.touchData.startPosition[0]-p[0],P=S*S,C=t.touchData.startPosition[1]-p[1],E=C*C,T=P+E,I=T*d*d;if(!t.touchData.singleTouchMoved){o||c.$(":selected").unselect(["tapunselect"]);i(o,["tap","vclick"],n,{x:p[0],y:p[1]});ne=!1;if(n.timeStamp-oe<=c.multiClickDebounceTime()){ie&&clearTimeout(ie);ne=!0;oe=null;i(o,["dbltap","vdblclick"],n,{x:p[0],y:p[1]})}else{ie=setTimeout(function(){if(ne)return;i(o,["onetap","voneclick"],n,{x:p[0],y:p[1]})},c.multiClickDebounceTime());oe=n.timeStamp}}if(o!=null&&!t.dragData.didDrag&&o._private.selectable&&I<t.touchTapThreshold2&&!t.pinching){if(c.selectionType()==="single"){c.$(a).unmerge(o).unselect(["tapunselect"]);o.select(["tapselect"])}else{if(o.selected()){o.unselect(["tapunselect"])}else{o.select(["tapselect"])}}t.redrawHint("eles",!0)}t.touchData.singleTouchMoved=!0}for(var k=0;k<p.length;k++){u[k]=p[k]}t.dragData.didDrag=!1;if(n.touches.length===0){t.touchData.dragDelta=[];t.touchData.startPosition=[null,null,null,null,null,null];t.touchData.startGPosition=null;t.touchData.didSelect=!1}if(n.touches.length<2){n.touches.length===1&&(t.touchData.startGPosition=[n.touches[0].clientX,n.touches[0].clientY]);t.pinching=!1;t.redrawHint("eles",!0);t.redraw()}},!1);if(typeof TouchEvent==="undefined"){var se=[],le=function e(t){return{clientX:t.clientX,clientY:t.clientY,force:1,identifier:t.pointerId,pageX:t.pageX,pageY:t.pageY,radiusX:t.width/2,radiusY:t.height/2,screenX:t.screenX,screenY:t.screenY,target:t.target}},ce=function e(t){return{event:t,touch:le(t)}},de=function e(t){se.push(ce(t))},pe=function e(t){for(var r=0;r<se.length;r++){var a=se[r];if(a.event.pointerId===t.pointerId){se.splice(r,1);return}}},ue=function e(t){var r=se.filter(function(e){return e.event.pointerId===t.pointerId})[0];r.event=t;r.touch=le(t)},fe=function e(t){t.touches=se.map(function(e){return e.touch})},he=function e(t){return t.pointerType==="mouse"||t.pointerType===4};t.registerBinding(t.container,"pointerdown",function(e){if(he(e)){return}e.preventDefault();de(e);fe(e);ee(e)});t.registerBinding(t.container,"pointerup",function(e){if(he(e)){return}pe(e);fe(e);ae(e)});t.registerBinding(t.container,"pointercancel",function(e){if(he(e)){return}pe(e);fe(e);re(e)});t.registerBinding(t.container,"pointermove",function(e){if(he(e)){return}e.preventDefault();ue(e);fe(e);te(e)})}};var sf={};sf.generatePolygon=function(e,t){return this.nodeShapes[e]={renderer:this,name:e,points:t,draw:function e(t,r,a,n,i,o){this.renderer.nodeShapeImpl("polygon",t,r,a,n,i,this.points)},intersectLine:function e(t,r,a,n,i,o,s,l){return Ca(i,o,this.points,t,r,a/2,n/2,s)},checkPoint:function e(t,r,a,n,i,o,s,l){return ga(t,r,this.points,o,s,n,i,[0,-1],a)},hasMiterBounds:e!=="rectangle",miterBounds:function e(t,r,a,n,i,o){return oa(this.points,t,r,a,n,i)}}};sf.generateEllipse=function(){return this.nodeShapes["ellipse"]={renderer:this,name:"ellipse",draw:function e(t,r,a,n,i,o){this.renderer.nodeShapeImpl(this.name,t,r,a,n,i)},intersectLine:function e(t,r,a,n,i,o,s,l){return ba(i,o,t,r,a/2+s,n/2+s)},checkPoint:function e(t,r,a,n,i,o,s,l){return xa(t,r,n,i,o,s,a)}}};sf.generateRoundPolygon=function(t,r){return this.nodeShapes[t]={renderer:this,name:t,points:r,getOrCreateCorners:function t(a,n,i,o,s,l,c){if(l[c]!==e&&l[c+"-cx"]===a&&l[c+"-cy"]===n){return l[c]}l[c]=new Array(r.length/2);l[c+"-cx"]=a;l[c+"-cy"]=n;var d=i/2;var p=o/2;s=s==="auto"?Ba(i,o):s;var u=new Array(r.length/2);for(var f=0;f<r.length/2;f++){u[f]={x:a+d*r[f*2],y:n+p*r[f*2+1]}}var h,g,y,v,m=u.length;g=u[m-1];for(h=0;h<m;h++){y=u[h%m];v=u[(h+1)%m];l[c][h]=zu(g,y,v,s);g=y;y=v}return l[c]},draw:function e(t,r,a,n,i,o,s){this.renderer.nodeShapeImpl("round-polygon",t,r,a,n,i,this.points,this.getOrCreateCorners(r,a,n,i,o,s,"drawCorners"))},intersectLine:function e(t,r,a,n,i,o,s,l,c){return Ea(i,o,this.points,t,r,a,n,s,this.getOrCreateCorners(t,r,a,n,l,c,"corners"))},checkPoint:function e(t,r,a,n,i,o,s,l,c){return ya(t,r,this.points,o,s,n,i,this.getOrCreateCorners(o,s,n,i,l,c,"corners"))}}};sf.generateRoundRectangle=function(){return this.nodeShapes["round-rectangle"]=this.nodeShapes["roundrectangle"]={renderer:this,name:"round-rectangle",points:Ia(4,0),draw:function e(t,r,a,n,i,o){this.renderer.nodeShapeImpl(this.name,t,r,a,n,i,this.points,o)},intersectLine:function e(t,r,a,n,i,o,s,l){return sa(i,o,t,r,a,n,s,l)},checkPoint:function e(t,r,a,n,i,o,s,l){var c=n/2;var d=i/2;l=l==="auto"?Da(n,i):l;l=Math.min(c,d,l);var p=l*2;if(ga(t,r,this.points,o,s,n,i-p,[0,-1],a)){return!0}if(ga(t,r,this.points,o,s,n-p,i,[0,-1],a)){return!0}if(xa(t,r,p,p,o-c+l,s-d+l,a)){return!0}if(xa(t,r,p,p,o+c-l,s-d+l,a)){return!0}if(xa(t,r,p,p,o+c-l,s+d-l,a)){return!0}if(xa(t,r,p,p,o-c+l,s+d-l,a)){return!0}return!1}}};sf.generateCutRectangle=function(){return this.nodeShapes["cut-rectangle"]=this.nodeShapes["cutrectangle"]={renderer:this,name:"cut-rectangle",cornerLength:Aa(),points:Ia(4,0),draw:function e(t,r,a,n,i,o){this.renderer.nodeShapeImpl(this.name,t,r,a,n,i,null,o)},generateCutTrianglePts:function e(t,r,a,n,i){var o=i==="auto"?this.cornerLength:i;var s=r/2;var l=t/2;var c=a-l;var d=a+l;var p=n-s;var u=n+s;return{topLeft:[c,p+o,c+o,p,c+o,p+o],topRight:[d-o,p,d,p+o,d-o,p+o],bottomRight:[d,u-o,d-o,u,d-o,u-o],bottomLeft:[c+o,u,c,u-o,c+o,u-o]}},intersectLine:function e(t,r,a,n,i,o,s,l){var c=this.generateCutTrianglePts(a+2*s,n+2*s,t,r,l);var d=[].concat.apply([],[c.topLeft.splice(0,4),c.topRight.splice(0,4),c.bottomRight.splice(0,4),c.bottomLeft.splice(0,4)]);return Ca(i,o,d,t,r)},checkPoint:function e(t,r,a,n,i,o,s,l){var c=l==="auto"?this.cornerLength:l;if(ga(t,r,this.points,o,s,n,i-2*c,[0,-1],a)){return!0}if(ga(t,r,this.points,o,s,n-2*c,i,[0,-1],a)){return!0}var d=this.generateCutTrianglePts(n,i,o,s);return ha(t,r,d.topLeft)||ha(t,r,d.topRight)||ha(t,r,d.bottomRight)||ha(t,r,d.bottomLeft)}}};sf.generateBarrel=function(){return this.nodeShapes["barrel"]={renderer:this,name:"barrel",points:Ia(4,0),draw:function e(t,r,a,n,i,o){this.renderer.nodeShapeImpl(this.name,t,r,a,n,i)},intersectLine:function e(t,r,a,n,i,o,s,l){var c=.15;var d=.5;var p=.85;var u=this.generateBarrelBezierPts(a+2*s,n+2*s,t,r);var f=function e(t){var r=Fr({x:t[0],y:t[1]},{x:t[2],y:t[3]},{x:t[4],y:t[5]},c);var a=Fr({x:t[0],y:t[1]},{x:t[2],y:t[3]},{x:t[4],y:t[5]},d);var n=Fr({x:t[0],y:t[1]},{x:t[2],y:t[3]},{x:t[4],y:t[5]},p);return[t[0],t[1],r.x,r.y,a.x,a.y,n.x,n.y,t[4],t[5]]};var h=[].concat(f(u.topLeft),f(u.topRight),f(u.bottomRight),f(u.bottomLeft));return Ca(i,o,h,t,r)},generateBarrelBezierPts:function e(t,r,a,n){var i=r/2;var o=t/2;var s=a-o;var l=a+o;var c=n-i;var d=n+i;var p=La(t,r);var u=p.heightOffset;var f=p.widthOffset;var h=p.ctrlPtOffsetPct*t;var g={topLeft:[s,c+u,s+h,c,s+f,c],topRight:[l-f,c,l-h,c,l,c+u],bottomRight:[l,d-u,l-h,d,l-f,d],bottomLeft:[s+f,d,s+h,d,s,d-u]};g.topLeft.isTop=!0;g.topRight.isTop=!0;g.bottomLeft.isBottom=!0;g.bottomRight.isBottom=!0;return g},checkPoint:function e(t,r,a,n,i,o,s,l){var c=La(n,i);var d=c.heightOffset;var p=c.widthOffset;if(ga(t,r,this.points,o,s,n,i-2*d,[0,-1],a)){return!0}if(ga(t,r,this.points,o,s,n-2*p,i,[0,-1],a)){return!0}var u=this.generateBarrelBezierPts(n,i,o,s);var f=function e(t,r,a){var n=a[4];var i=a[2];var o=a[0];var s=a[5];var l=a[1];var c=Math.min(n,o);var d=Math.max(n,o);var p=Math.min(s,l);var u=Math.max(s,l);if(c<=t&&t<=d&&p<=r&&r<=u){var f=Oa(n,i,o),h=da(f[0],f[1],f[2],t),g=h.filter(function(e){return 0<=e&&e<=1});if(g.length>0){return g[0]}}return null};var h=Object.keys(u);for(var g=0;g<h.length;g++){var y=h[g],v=u[y],m=f(t,r,v);if(m==null){continue}var b=v[5],x=v[3],_=v[1],w=Vr(b,x,_,m);if(v.isTop&&w<=r){return!0}if(v.isBottom&&r<=w){return!0}}return!1}}};sf.generateBottomRoundrectangle=function(){return this.nodeShapes["bottom-round-rectangle"]=this.nodeShapes["bottomroundrectangle"]={renderer:this,name:"bottom-round-rectangle",points:Ia(4,0),draw:function e(t,r,a,n,i,o){this.renderer.nodeShapeImpl(this.name,t,r,a,n,i,this.points,o)},intersectLine:function e(t,r,a,n,i,o,s,l){var c=t-(a/2+s);var d=r-(n/2+s);var p=t+(a/2+s);var u=Sa(i,o,t,r,c,d,p,d,!1);if(u.length>0){return u}return sa(i,o,t,r,a,n,s,l)},checkPoint:function e(t,r,a,n,i,o,s,l){l=l==="auto"?Da(n,i):l;var c=2*l;if(ga(t,r,this.points,o,s,n,i-c,[0,-1],a)){return!0}if(ga(t,r,this.points,o,s,n-c,i,[0,-1],a)){return!0}var d=n/2+2*a;var p=i/2+2*a;var u=[o-d,s-p,o-d,s,o+d,s,o+d,s-p];if(ha(t,r,u)){return!0}if(xa(t,r,c,c,o+n/2-l,s+i/2-l,a)){return!0}if(xa(t,r,c,c,o-n/2+l,s+i/2-l,a)){return!0}return!1}}};sf.registerNodeShapes=function(){var e=this.nodeShapes={};var t=this;this.generateEllipse();this.generatePolygon("triangle",Ia(3,0));this.generateRoundPolygon("round-triangle",Ia(3,0));this.generatePolygon("rectangle",Ia(4,0));e["square"]=e["rectangle"];this.generateRoundRectangle();this.generateCutRectangle();this.generateBarrel();this.generateBottomRoundrectangle();{var r=[0,1,1,0,0,-1,-1,0];this.generatePolygon("diamond",r);this.generateRoundPolygon("round-diamond",r)}this.generatePolygon("pentagon",Ia(5,0));this.generateRoundPolygon("round-pentagon",Ia(5,0));this.generatePolygon("hexagon",Ia(6,0));this.generateRoundPolygon("round-hexagon",Ia(6,0));this.generatePolygon("heptagon",Ia(7,0));this.generateRoundPolygon("round-heptagon",Ia(7,0));this.generatePolygon("octagon",Ia(8,0));this.generateRoundPolygon("round-octagon",Ia(8,0));var a=new Array(20);{var n=Ra(5,0),i=Ra(5,Math.PI/5),o=.5*(3-Math.sqrt(5));o*=1.57;for(var s=0;s<i.length/2;s++){i[s*2]*=o;i[s*2+1]*=o}for(var s=0;s<20/4;s++){a[s*4]=n[s*2];a[s*4+1]=n[s*2+1];a[s*4+2]=i[s*2];a[s*4+3]=i[s*2+1]}}a=ka(a);this.generatePolygon("star",a);this.generatePolygon("vee",[-1,-1,0,-.333,1,-1,0,1]);this.generatePolygon("rhomboid",[-1,-1,.333,-1,1,1,-.333,1]);this.generatePolygon("right-rhomboid",[-.333,-1,1,-1,.333,1,-1,1]);this.nodeShapes["concavehexagon"]=this.generatePolygon("concave-hexagon",[-1,-.95,-.75,0,-1,.95,1,.95,.75,0,1,-.95]);{var l=[-1,-1,.25,-1,1,0,.25,1,-1,1];this.generatePolygon("tag",l);this.generateRoundPolygon("round-tag",l)}e.makePolygon=function(e){var r=e.join("$");var a="polygon-"+r;var n;if(n=this[a]){return n}return t.generatePolygon(a,e)}};var lf={};lf.timeToRender=function(){return this.redrawTotalTime/this.redrawCount};lf.redraw=function(t){t=t||Ft();var r=this;r.averageRedrawTime===e&&(r.averageRedrawTime=0);r.lastRedrawTime===e&&(r.lastRedrawTime=0);r.lastDrawTime===e&&(r.lastDrawTime=0);r.requestedFrame=!0;r.renderOptions=t};lf.beforeRender=function(e,t){if(this.destroyed){return}t==null&&Lt("Priority is not optional for beforeRender");var r=this.beforeRenderCallbacks;r.push({fn:e,priority:t});r.sort(function(e,t){return t.priority-e.priority})};var cf=function e(t,r,a){var n=t.beforeRenderCallbacks;for(var i=0;i<n.length;i++){n[i].fn(r,a)}};lf.startRenderLoop=function(){var t=this;var r=t.cy;if(t.renderLoopStarted){return}else{t.renderLoopStarted=!0}var a=function n(i){if(t.destroyed){return}if(r.batching());else if(t.requestedFrame&&!t.skipFrame){cf(t,!0,i);var o=lt();t.render(t.renderOptions);var s=t.lastDrawTime=lt();t.averageRedrawTime===e&&(t.averageRedrawTime=s-o);t.redrawCount===e&&(t.redrawCount=0);t.redrawCount++;t.redrawTotalTime===e&&(t.redrawTotalTime=0);var l=s-o;t.redrawTotalTime+=l;t.lastRedrawTime=l;t.averageRedrawTime=t.averageRedrawTime/2+l/2;t.requestedFrame=!1}else{cf(t,!1,i)}t.skipFrame=!1;dt(a)};dt(a)};var df=function e(t){this.init(t)};var pf=df.prototype;pf.clientFunctions=["redrawHint","render","renderTo","matchCanvasSize","nodeShapeImpl","arrowShapeImpl"];pf.init=function(t){var r=this;r.options=t;r.cy=t.cy;var a=r.container=t.cy.container();var n=r.cy.window();if(n){var i=n.document,o=i.head,s="__________cytoscape_stylesheet",l="__________cytoscape_container",c=i.getElementById(s)!=null;a.className.indexOf(l)<0&&(a.className=(a.className||"")+" "+l);if(!c){var d=i.createElement("style");d.id=s;d.textContent="."+l+" { position: relative; }";o.insertBefore(d,o.children[0])}var p=n.getComputedStyle(a),u=p.getPropertyValue("position");u==="static"&&Mt("A Cytoscape container has style position:static and so can not use UI extensions properly")}r.selection=[e,e,e,e,0];r.bezierProjPcts=[.05,.225,.4,.5,.6,.775,.95];r.hoverData={down:null,last:null,downTime:null,triggerMode:null,dragging:!1,initialPan:[null,null],capture:!1};r.dragData={possibleDragElements:[]};r.touchData={start:null,capture:!1,startPosition:[null,null,null,null,null,null],singleTouchStartTime:null,singleTouchMoved:!0,now:[null,null,null,null,null,null],earlier:[null,null,null,null,null,null]};r.redraws=0;r.showFps=t.showFps;r.debug=t.debug;r.webgl=t.webgl;r.hideEdgesOnViewport=t.hideEdgesOnViewport;r.textureOnViewport=t.textureOnViewport;r.wheelSensitivity=t.wheelSensitivity;r.motionBlurEnabled=t.motionBlur;r.forcedPixelRatio=D(t.pixelRatio)?t.pixelRatio:null;r.motionBlur=t.motionBlur;r.motionBlurOpacity=t.motionBlurOpacity;r.motionBlurTransparency=1-r.motionBlurOpacity;r.motionBlurPxRatio=1;r.mbPxRBlurry=1;r.minMbLowQualFrames=4;r.fullQualityMb=!1;r.clearedForMotionBlur=[];r.desktopTapThreshold=t.desktopTapThreshold;r.desktopTapThreshold2=t.desktopTapThreshold*t.desktopTapThreshold;r.touchTapThreshold=t.touchTapThreshold;r.touchTapThreshold2=t.touchTapThreshold*t.touchTapThreshold;r.tapholdDuration=500;r.bindings=[];r.beforeRenderCallbacks=[];r.beforeRenderPriorities={animations:400,eleCalcs:300,eleTxrDeq:200,lyrTxrDeq:150,lyrTxrSkip:100};r.registerNodeShapes();r.registerArrowShapes();r.registerCalculationListeners()};pf.notify=function(e,t){var r=this;var a=r.cy;if(this.destroyed){return}if(e==="init"){r.load();return}if(e==="destroy"){r.destroy();return}(e==="add"||e==="remove"||e==="move"&&a.hasCompoundNodes()||e==="load"||e==="zorder"||e==="mount")&&r.invalidateCachedZSortedEles();e==="viewport"&&r.redrawHint("select",!0);e==="gc"&&r.redrawHint("gc",!0);if(e==="load"||e==="resize"||e==="mount"){r.invalidateContainerClientCoordsCache();r.matchCanvasSize(r.container)}r.redrawHint("eles",!0);r.redrawHint("drag",!0);this.startRenderLoop();this.redraw()};pf.destroy=function(){var e=this;e.destroyed=!0;e.cy.stopAnimationLoop();for(var t=0;t<e.bindings.length;t++){var r=e.bindings[t],a=r,n=a.target;(n.off||n.removeEventListener).apply(n,a.args)}e.bindings=[];e.beforeRenderCallbacks=[];e.onUpdateEleCalcsFns=[];e.removeObserver&&e.removeObserver.disconnect();e.styleObserver&&e.styleObserver.disconnect();e.resizeObserver&&e.resizeObserver.disconnect();if(e.labelCalcDiv){try{document.body.removeChild(e.labelCalcDiv)}catch(e){}}};pf.isHeadless=function(){return!1};[hu,af,nf,of,sf,lf].forEach(function(e){oe(pf,e)});var uf=1e3/60;var ff={setupDequeueing:function e(t){return function e(){var r=this;var a=this.renderer;if(r.dequeueingSetup){return}else{r.dequeueingSetup=!0}var n=ot(function(){a.redrawHint("eles",!0);a.redrawHint("drag",!0);a.redraw()},t.deqRedrawThreshold);var i=function e(i,o){var s=lt();var l=a.averageRedrawTime;var c=a.lastRedrawTime;var d=[];var p=a.cy.extent();var u=a.getPixelRatio();i||a.flushRenderedStyleQueue();while(!0){var f=lt(),h=f-s,g=f-o;if(c<uf){var y=uf-(i?l:0);if(g>=t.deqFastCost*y){break}}else{if(i){if(h>=t.deqCost*c||h>=t.deqAvgCost*l){break}}else if(g>=t.deqNoDrawCost*uf){break}}var v=t.deq(r,u,p);if(v.length>0){for(var m=0;m<v.length;m++){d.push(v[m])}}else{break}}if(d.length>0){t.onDeqd(r,d);!i&&t.shouldRedraw(r,d,u,p)&&n()}};var o=t.priority||Ot;a.beforeRender(i,o(r))}}};var hf=function(){function t(r){var a=arguments.length>1&&arguments[1]!==e?arguments[1]:Bt;n(this,t);this.idsByKey=new Qt;this.keyForId=new Qt;this.cachesByLvl=new Qt;this.lvls=[];this.getKey=r;this.doesEleInvalidateKey=a}return o(t,[{key:"getIdsFor",value:function e(t){t==null&&Lt("Can not get id list for null key");var r=this.idsByKey;var a=this.idsByKey.get(t);if(!a){a=new er;r.set(t,a)}return a}},{key:"addIdForKey",value:function e(t,r){t!=null&&this.getIdsFor(t).add(r)}},{key:"deleteIdForKey",value:function e(t,r){t!=null&&this.getIdsFor(t)["delete"](r)}},{key:"getNumberOfIdsForKey",value:function e(t){if(t==null){return 0}else{return this.getIdsFor(t).size}}},{key:"updateKeyMappingFor",value:function e(t){var r=t.id();var a=this.keyForId.get(r);var n=this.getKey(t);this.deleteIdForKey(a,r);this.addIdForKey(n,r);this.keyForId.set(r,n)}},{key:"deleteKeyMappingFor",value:function e(t){var r=t.id();var a=this.keyForId.get(r);this.deleteIdForKey(a,r);this.keyForId["delete"](r)}},{key:"keyHasChangedFor",value:function e(t){var r=t.id();var a=this.keyForId.get(r);var n=this.getKey(t);return a!==n}},{key:"isInvalid",value:function e(t){return this.keyHasChangedFor(t)||this.doesEleInvalidateKey(t)}},{key:"getCachesAt",value:function e(t){var r=this.cachesByLvl,a=this.lvls;var n=r.get(t);if(!n){n=new Qt;r.set(t,n);a.push(t)}return n}},{key:"getCache",value:function e(t,r){return this.getCachesAt(r).get(t)}},{key:"get",value:function e(t,r){var a=this.getKey(t);var n=this.getCache(a,r);n!=null&&this.updateKeyMappingFor(t);return n}},{key:"getForCachedKey",value:function e(t,r){var a=this.keyForId.get(t.id());var n=this.getCache(a,r);return n}},{key:"hasCache",value:function e(t,r){return this.getCachesAt(r).has(t)}},{key:"has",value:function e(t,r){var a=this.getKey(t);return this.hasCache(a,r)}},{key:"setCache",value:function e(t,r,a){a.key=t;this.getCachesAt(r).set(t,a)}},{key:"set",value:function e(t,r,a){var n=this.getKey(t);this.setCache(n,r,a);this.updateKeyMappingFor(t)}},{key:"deleteCache",value:function e(t,r){this.getCachesAt(r)["delete"](t)}},{key:"delete",value:function e(t,r){var a=this.getKey(t);this.deleteCache(a,r)}},{key:"invalidateKey",value:function e(t){var r=this;this.lvls.forEach(function(e){return r.deleteCache(t,e)})}},{key:"invalidate",value:function e(t){var r=t.id();var a=this.keyForId.get(r);this.deleteKeyMappingFor(t);var n=this.doesEleInvalidateKey(t);n&&this.invalidateKey(a);return n||this.getNumberOfIdsForKey(a)===0}}])}();var gf=25;var yf=50;var vf=-4;var mf=3;var bf=7.99;var xf=8;var _f=1024;var wf=1024;var Sf=1024;var Pf=.2;var Cf=.8;var Ef=10;var Tf=.15;var If=.1;var kf=.9;var Rf=.9;var Df=100;var Bf=1;var Af={dequeue:"dequeue",downscale:"downscale",highQuality:"highQuality"};var Of=Wt({getKey:null,doesEleInvalidateKey:Bt,drawElement:null,getBoundingBox:null,getRotationPoint:null,getRotationOffset:null,isVisible:Dt,allowEdgeTxrCaching:!0,allowParentTxrCaching:!0});var Lf=function e(t,r){var a=this;a.renderer=t;a.onDequeues=[];var n=Of(r);oe(a,n);a.lookup=new hf(n.getKey,n.doesEleInvalidateKey);a.setupDequeueing()};var Nf=Lf.prototype;Nf.reasons=Af;Nf.getTextureQueue=function(e){var t=this;t.eleImgCaches=t.eleImgCaches||{};return t.eleImgCaches[e]=t.eleImgCaches[e]||[]};Nf.getRetiredTextureQueue=function(e){var t=this;var r=t.eleImgCaches.retired=t.eleImgCaches.retired||{};var a=r[e]=r[e]||[];return a};Nf.getElementQueue=function(){var e=this;var t=e.eleCacheQueue=e.eleCacheQueue||new ur(function(e,t){return t.reqs-e.reqs});return t};Nf.getElementKeyToQueue=function(){var e=this;var t=e.eleKeyToCacheQueue=e.eleKeyToCacheQueue||{};return t};Nf.getElement=function(e,t,r,a,n){var i=this;var o=this.renderer;var s=o.cy.zoom();var l=this.lookup;if(!t||t.w===0||t.h===0||isNaN(t.w)||isNaN(t.h)||!e.visible()||e.removed()){return null}if(!i.allowEdgeTxrCaching&&e.isEdge()||!i.allowParentTxrCaching&&e.isParent()){return null}a==null&&(a=Math.ceil(Mr(s*r)));if(a<vf){a=vf}else if(s>=bf||a>mf){return null}var c=Math.pow(2,a);var d=t.h*c;var p=t.w*c;var u=o.eleTextBiggerThanMin(e,c);if(!this.isVisible(e,u)){return null}var f=l.get(e,a);if(f&&f.invalidated){f.invalidated=!1;f.texture.invalidatedWidth-=f.width}if(f){return f}var h;if(d<=gf){h=gf}else if(d<=yf){h=yf}else{h=Math.ceil(d/yf)*yf}if(d>Sf||p>wf){return null}var g=i.getTextureQueue(h);var y=g[g.length-2];var v=function e(){return i.recycleTexture(h,p)||i.addTexture(h,p)};y||(y=g[g.length-1]);y||(y=v());y.width-y.usedWidth<p&&(y=v());var m=function e(t){return t&&t.scaledLabelShown===u};var b=n&&n===Af.dequeue;var x=n&&n===Af.highQuality;var _=n&&n===Af.downscale;var w;for(var S=a+1;S<=mf;S++){var P=l.get(e,S);if(P){w=P;break}}var C=w&&w.level===a+1?w:null;var E=function e(){y.context.drawImage(C.texture.canvas,C.x,0,C.width,C.height,y.usedWidth,0,p,d)};y.context.setTransform(1,0,0,1,0,0);y.context.clearRect(y.usedWidth,0,p,h);if(m(C)){E()}else if(m(w)){if(x){for(var T=w.level;T>a;T--){C=i.getElement(e,t,r,T,Af.downscale)}E()}else{i.queueElement(e,w.level-1);return w}}else{var I;if(!b&&!x&&!_){for(var k=a-1;k>=vf;k--){var R=l.get(e,k);if(R){I=R;break}}}if(m(I)){i.queueElement(e,a);return I}y.context.translate(y.usedWidth,0);y.context.scale(c,c);this.drawElement(y.context,e,t,u,!1);y.context.scale(1/c,1/c);y.context.translate(-y.usedWidth,0)}f={x:y.usedWidth,texture:y,level:a,scale:c,width:p,height:d,scaledLabelShown:u};y.usedWidth+=Math.ceil(p+xf);y.eleCaches.push(f);l.set(e,a,f);i.checkTextureFullness(y);return f};Nf.invalidateElements=function(e){for(var t=0;t<e.length;t++){this.invalidateElement(e[t])}};Nf.invalidateElement=function(e){var t=this;var r=t.lookup;var a=[];var n=r.isInvalid(e);if(!n){return}for(var i=vf;i<=mf;i++){var o=r.getForCachedKey(e,i);o&&a.push(o)}var s=r.invalidate(e);if(s){for(var l=0;l<a.length;l++){var c=a[l],d=c.texture;d.invalidatedWidth+=c.width;c.invalidated=!0;t.checkTextureUtility(d)}}t.removeFromQueue(e)};Nf.checkTextureUtility=function(e){e.invalidatedWidth>=Pf*e.width&&this.retireTexture(e)};Nf.checkTextureFullness=function(e){var t=this;var r=t.getTextureQueue(e.height);if(e.usedWidth/e.width>Cf&&e.fullnessChecks>=Ef){Ht(r,e)}else{e.fullnessChecks++}};Nf.retireTexture=function(e){var t=this;var r=e.height;var a=t.getTextureQueue(r);var n=this.lookup;Ht(a,e);e.retired=!0;var i=e.eleCaches;for(var o=0;o<i.length;o++){var s=i[o];n.deleteCache(s.key,s.level)}Xt(i);var l=t.getRetiredTextureQueue(r);l.push(e)};Nf.addTexture=function(e,t){var r=this;var a=r.getTextureQueue(e);var n={};a.push(n);n.eleCaches=[];n.height=e;n.width=Math.max(_f,t);n.usedWidth=0;n.invalidatedWidth=0;n.fullnessChecks=0;n.canvas=r.renderer.makeOffscreenCanvas(n.width,n.height);n.context=n.canvas.getContext("2d");return n};Nf.recycleTexture=function(e,t){var r=this;var a=r.getTextureQueue(e);var n=r.getRetiredTextureQueue(e);for(var i=0;i<n.length;i++){var o=n[i];if(o.width>=t){o.retired=!1;o.usedWidth=0;o.invalidatedWidth=0;o.fullnessChecks=0;Xt(o.eleCaches);o.context.setTransform(1,0,0,1,0,0);o.context.clearRect(0,0,o.width,o.height);Ht(n,o);a.push(o);return o}}};Nf.queueElement=function(e,t){var r=this;var a=r.getElementQueue();var n=r.getElementKeyToQueue();var i=this.getKey(e);var o=n[i];if(o){o.level=Math.max(o.level,t);o.eles.merge(e);o.reqs++;a.updateItem(o)}else{var s={eles:e.spawn().merge(e),level:t,reqs:1,key:i};a.push(s);n[i]=s}};Nf.dequeue=function(e){var t=this;var r=t.getElementQueue();var a=t.getElementKeyToQueue();var n=[];var i=t.lookup;for(var o=0;o<Bf;o++){if(r.size()>0){var s=r.pop(),l=s.key,c=s.eles[0],d=i.hasCache(c,s.level);a[l]=null;if(d){continue}n.push(s);var p=t.getBoundingBox(c);t.getElement(c,p,e,s.level,Af.dequeue)}else{break}}return n};Nf.removeFromQueue=function(e){var t=this;var r=t.getElementQueue();var a=t.getElementKeyToQueue();var n=this.getKey(e);var i=a[n];if(i!=null){if(i.eles.length===1){i.reqs=Rt;r.updateItem(i);r.pop();a[n]=null}else{i.eles.unmerge(e)}}};Nf.onDequeue=function(e){this.onDequeues.push(e)};Nf.offDequeue=function(e){Ht(this.onDequeues,e)};Nf.setupDequeueing=ff.setupDequeueing({deqRedrawThreshold:Df,deqCost:Tf,deqAvgCost:If,deqNoDrawCost:kf,deqFastCost:Rf,deq:function e(t,r,a){return t.dequeue(r,a)},onDeqd:function e(t,r){for(var a=0;a<t.onDequeues.length;a++){var n=t.onDequeues[a];n(r)}},shouldRedraw:function e(t,r,a,n){for(var i=0;i<r.length;i++){var o=r[i].eles;for(var s=0;s<o.length;s++){var l=o[s].boundingBox();if(ea(l,n)){return!0}}}return!1},priority:function e(t){return t.renderer.beforeRenderPriorities.eleTxrDeq}});var Mf=1;var jf=-4;var qf=2;var zf=3.99;var $f=50;var Vf=50;var Ff=.15;var Wf=.1;var Hf=.9;var Xf=.9
var Yf=1;var Gf=250;var Kf=4e3*4e3;var Uf=32767;var Qf=!0;var Zf=function e(t){var r=this;var a=r.renderer=t;var n=a.cy;r.layersByLevel={};r.firstGet=!0;r.lastInvalidationTime=lt()-2*Gf;r.skipping=!1;r.eleTxrDeqs=n.collection();r.scheduleElementRefinement=ot(function(){r.refineElementTextures(r.eleTxrDeqs);r.eleTxrDeqs.unmerge(r.eleTxrDeqs)},Vf);a.beforeRender(function(e,t){if(t-r.lastInvalidationTime<=Gf){r.skipping=!0}else{r.skipping=!1}},a.beforeRenderPriorities.lyrTxrSkip);var i=function e(t,r){return r.reqs-t.reqs};r.layersQueue=new ur(i);r.setupDequeueing()};var Jf=Zf.prototype;var eh=0;var th=Math.pow(2,53)-1;Jf.makeLayer=function(e,t){var r=Math.pow(2,t);var a=Math.ceil(e.w*r);var n=Math.ceil(e.h*r);var i=this.renderer.makeOffscreenCanvas(a,n);var o={id:eh=++eh%th,bb:e,level:t,width:a,height:n,canvas:i,context:i.getContext("2d"),eles:[],elesQueue:[],reqs:0};var s=o.context;var l=-o.bb.x1;var c=-o.bb.y1;s.scale(r,r);s.translate(l,c);return o};Jf.getLayers=function(t,r,a){var n=this;var i=n.renderer;var o=i.cy;var s=o.zoom();var l=n.firstGet;n.firstGet=!1;if(a==null){a=Math.ceil(Mr(s*r));if(a<jf){a=jf}else if(s>=zf||a>qf){return null}}n.validateLayersElesOrdering(a,t);var c=n.layersByLevel;var d=Math.pow(2,a);var p=c[a]=c[a]||[];var u;var f=n.levelIsComplete(a,t);var h;var g=function e(){var r=function e(r){n.validateLayersElesOrdering(r,t);if(n.levelIsComplete(r,t)){h=c[r];return!0}};var i=function e(t){if(h){return}for(var n=a+t;jf<=n&&n<=qf;n+=t){if(r(n)){break}}};i(1);i(-1);for(var o=p.length-1;o>=0;o--){var s=p[o];s.invalid&&Ht(p,s)}};if(!f){g()}else{return p}var y=function e(){if(!u){u=Xr();for(var r=0;r<t.length;r++){Kr(u,t[r].boundingBox())}}return u};var v=function t(r){r=r||{};var i=r.after;y();var o=Math.ceil(u.w*d);var s=Math.ceil(u.h*d);if(o>Uf||s>Uf){return null}var l=o*s;if(l>Kf){return null}var c=n.makeLayer(u,a);if(i!=null){var f=p.indexOf(i)+1;p.splice(f,0,c)}else(r.insert===e||r.insert)&&p.unshift(c);return c};if(n.skipping&&!l){return null}var m=null;var b=t.length/Mf;var x=!l;for(var _=0;_<t.length;_++){var w=t[_],S=w._private.rscratch,P=S.imgLayerCaches=S.imgLayerCaches||{},C=P[a];if(C){m=C;continue}if(!m||m.eles.length>=b||!aa(m.bb,w.boundingBox())){m=v({insert:!0,after:m});if(!m){return null}}if(h||x){n.queueLayer(m,w)}else{n.drawEleInLayer(m,w,a,r)}m.eles.push(w);P[a]=m}if(h){return h}if(x){return null}return p};Jf.getEleLevelForLayerLevel=function(e,t){return e};Jf.drawEleInLayer=function(e,t,r,a){var n=this;var i=this.renderer;var o=e.context;var s=t.boundingBox();if(s.w===0||s.h===0||!t.visible()){return}r=n.getEleLevelForLayerLevel(r,a);{i.setImgSmoothing(o,!1)}{i.drawCachedElement(o,t,null,null,r,Qf)}{i.setImgSmoothing(o,!0)}};Jf.levelIsComplete=function(e,t){var r=this;var a=r.layersByLevel[e];if(!a||a.length===0){return!1}var n=0;for(var i=0;i<a.length;i++){var o=a[i];if(o.reqs>0){return!1}if(o.invalid){return!1}n+=o.eles.length}if(n!==t.length){return!1}return!0};Jf.validateLayersElesOrdering=function(e,t){var r=this.layersByLevel[e];if(!r){return}for(var a=0;a<r.length;a++){var n=r[a],i=-1;for(var o=0;o<t.length;o++){if(n.eles[0]===t[o]){i=o;break}}if(i<0){this.invalidateLayer(n);continue}var s=i;for(var o=0;o<n.eles.length;o++){if(n.eles[o]!==t[s+o]){this.invalidateLayer(n);break}}}};Jf.updateElementsInLayers=function(e,t){var r=this;var a=L(e[0]);for(var n=0;n<e.length;n++){var i=a?null:e[n],o=a?e[n]:e[n].ele,s=o._private.rscratch,l=s.imgLayerCaches=s.imgLayerCaches||{};for(var c=jf;c<=qf;c++){var d=l[c];if(!d){continue}if(i&&r.getEleLevelForLayerLevel(d.level)!==i.level){continue}t(d,o,i)}}};Jf.haveLayers=function(){var e=this;var t=!1;for(var r=jf;r<=qf;r++){var a=e.layersByLevel[r];if(a&&a.length>0){t=!0;break}}return t};Jf.invalidateElements=function(e){var t=this;if(e.length===0){return}t.lastInvalidationTime=lt();if(e.length===0||!t.haveLayers()){return}t.updateElementsInLayers(e,function e(r,a,n){t.invalidateLayer(r)})};Jf.invalidateLayer=function(e){this.lastInvalidationTime=lt();if(e.invalid){return}var t=e.level;var r=e.eles;var a=this.layersByLevel[t];Ht(a,e);e.elesQueue=[];e.invalid=!0;e.replacement&&(e.replacement.invalid=!0);for(var n=0;n<r.length;n++){var i=r[n]._private.rscratch.imgLayerCaches;i&&(i[t]=null)}};Jf.refineElementTextures=function(e){var t=this;t.updateElementsInLayers(e,function e(r,a,n){var i=r.replacement;if(!i){i=r.replacement=t.makeLayer(r.bb,r.level);i.replaces=r;i.eles=r.eles}if(!i.reqs){for(var o=0;o<i.eles.length;o++){t.queueLayer(i,i.eles[o])}}})};Jf.enqueueElementRefinement=function(e){this.eleTxrDeqs.merge(e);this.scheduleElementRefinement()};Jf.queueLayer=function(e,t){var r=this;var a=r.layersQueue;var n=e.elesQueue;var i=n.hasId=n.hasId||{};if(e.replacement){return}if(t){if(i[t.id()]){return}n.push(t);i[t.id()]=!0}if(e.reqs){e.reqs++;a.updateItem(e)}else{e.reqs=1;a.push(e)}};Jf.dequeue=function(e){var t=this;var r=t.layersQueue;var a=[];var n=0;while(n<Yf){if(r.size()===0){break}var i=r.peek();if(i.replacement){r.pop();continue}if(i.replaces&&i!==i.replaces.replacement){r.pop();continue}if(i.invalid){r.pop();continue}var o=i.elesQueue.shift();if(o){t.drawEleInLayer(i,o,i.level,e);n++}a.length===0&&a.push(!0);if(i.elesQueue.length===0){r.pop();i.reqs=0;i.replaces&&t.applyLayerReplacement(i);t.requestRedraw()}}return a};Jf.applyLayerReplacement=function(e){var t=this;var r=t.layersByLevel[e.level];var a=e.replaces;var n=r.indexOf(a);if(n<0||a.invalid){return}r[n]=e;for(var i=0;i<e.eles.length;i++){var o=e.eles[i]._private,s=o.imgLayerCaches=o.imgLayerCaches||{};s&&(s[e.level]=e)}t.requestRedraw()};Jf.requestRedraw=ot(function(){var e=this.renderer;e.redrawHint("eles",!0);e.redrawHint("drag",!0);e.redraw()},100);Jf.setupDequeueing=ff.setupDequeueing({deqRedrawThreshold:$f,deqCost:Ff,deqAvgCost:Wf,deqNoDrawCost:Hf,deqFastCost:Xf,deq:function e(t,r){return t.dequeue(r)},onDeqd:Ot,shouldRedraw:Dt,priority:function e(t){return t.renderer.beforeRenderPriorities.lyrTxrDeq}});var rh={};var ah;function nh(e,t){for(var r=0;r<t.length;r++){var a=t[r];e.lineTo(a.x,a.y)}}function ih(e,t,r){var a;for(var n=0;n<t.length;n++){var i=t[n];n===0&&(a=i);e.lineTo(i.x,i.y)}e.quadraticCurveTo(r.x,r.y,a.x,a.y)}function oh(e,t,r){e.beginPath&&e.beginPath();for(var a=0;a<t.length;a++){var n=t[a];e.lineTo(n.x,n.y)}var i=r[0];e.moveTo(i.x,i.y);for(var a=1;a<r.length;a++){var n=r[a];e.lineTo(n.x,n.y)}e.closePath&&e.closePath()}function sh(e,t,r,a,n){e.beginPath&&e.beginPath();e.arc(r,a,n,0,Math.PI*2,!1);var i=t[0];e.moveTo(i.x,i.y);for(var o=0;o<t.length;o++){var s=t[o];e.lineTo(s.x,s.y)}e.closePath&&e.closePath()}function lh(e,t,r,a){e.arc(t,r,a,0,Math.PI*2,!1)}rh.arrowShapeImpl=function(e){return(ah||(ah={polygon:nh,"triangle-backcurve":ih,"triangle-tee":oh,"circle-triangle":sh,"triangle-cross":oh,circle:lh}))[e]};var ch={};ch.drawElement=function(e,t,r,a,n,i){var o=this;if(t.isNode()){o.drawNode(e,t,r,a,n,i)}else{o.drawEdge(e,t,r,a,n,i)}};ch.drawElementOverlay=function(e,t){var r=this;if(t.isNode()){r.drawNodeOverlay(e,t)}else{r.drawEdgeOverlay(e,t)}};ch.drawElementUnderlay=function(e,t){var r=this;if(t.isNode()){r.drawNodeUnderlay(e,t)}else{r.drawEdgeUnderlay(e,t)}};ch.drawCachedElementPortion=function(e,t,r,a,n,i,o,s){var l=this;var c=r.getBoundingBox(t);if(c.w===0||c.h===0){return}var d=r.getElement(t,c,a,n,i);if(d!=null){var p=s(l,t);if(p===0){return}var u=o(l,t),f=c.x1,h=c.y1,g=c.w,y=c.h,v,m,b,x,_;if(u!==0){var w=r.getRotationPoint(t);b=w.x;x=w.y;e.translate(b,x);e.rotate(u);_=l.getImgSmoothing(e);_||l.setImgSmoothing(e,!0);var S=r.getRotationOffset(t);v=S.x;m=S.y}else{v=f;m=h}var P;if(p!==1){P=e.globalAlpha;e.globalAlpha=P*p}e.drawImage(d.texture.canvas,d.x,0,d.width,d.height,v,m,g,y);p!==1&&(e.globalAlpha=P);if(u!==0){e.rotate(-u);e.translate(-b,-x);_||l.setImgSmoothing(e,!1)}}else{r.drawElement(e,t)}};var dh=function e(){return 0};var ph=function e(t,r){return t.getTextAngle(r,null)};var uh=function e(t,r){return t.getTextAngle(r,"source")};var fh=function e(t,r){return t.getTextAngle(r,"target")};var hh=function e(t,r){return r.effectiveOpacity()};var gh=function e(t,r){return r.pstyle("text-opacity").pfValue*r.effectiveOpacity()};ch.drawCachedElement=function(e,t,r,a,n,i){var o=this;var s=o.data,l=s.eleTxrCache,c=s.lblTxrCache,d=s.slbTxrCache,p=s.tlbTxrCache;var u=t.boundingBox();var f=i===!0?l.reasons.highQuality:null;if(u.w===0||u.h===0||!t.visible()){return}if(!a||ea(u,a)){var h=t.isEdge(),g=t.element()._private.rscratch.badLine;o.drawElementUnderlay(e,t);o.drawCachedElementPortion(e,t,l,r,n,f,dh,hh);(!h||!g)&&o.drawCachedElementPortion(e,t,c,r,n,f,ph,gh);if(h&&!g){o.drawCachedElementPortion(e,t,d,r,n,f,uh,gh);o.drawCachedElementPortion(e,t,p,r,n,f,fh,gh)}o.drawElementOverlay(e,t)}};ch.drawElements=function(e,t){var r=this;for(var a=0;a<t.length;a++){var n=t[a];r.drawElement(e,n)}};ch.drawCachedElements=function(e,t,r,a){var n=this;for(var i=0;i<t.length;i++){var o=t[i];n.drawCachedElement(e,o,r,a)}};ch.drawCachedNodes=function(e,t,r,a){var n=this;for(var i=0;i<t.length;i++){var o=t[i];if(!o.isNode()){continue}n.drawCachedElement(e,o,r,a)}};ch.drawLayeredElements=function(e,t,r,a){var n=this;var i=n.data.lyrTxrCache.getLayers(t,r);if(i){for(var o=0;o<i.length;o++){var s=i[o],l=s.bb;if(l.w===0||l.h===0){continue}e.drawImage(s.canvas,l.x1,l.y1,l.w,l.h)}}else{n.drawCachedElements(e,t,r,a)}};var yh={};yh.drawEdge=function(t,r,a){var n=arguments.length>3&&arguments[3]!==e?arguments[3]:!0;var i=arguments.length>4&&arguments[4]!==e?arguments[4]:!0;var o=arguments.length>5&&arguments[5]!==e?arguments[5]:!0;var s=this;var l=r._private.rscratch;if(o&&!r.visible()){return}if(l.badLine||l.allpts==null||isNaN(l.allpts[0])){return}var c;if(a){c=a;t.translate(-c.x1,-c.y1)}var d=o?r.pstyle("opacity").value:1;var p=o?r.pstyle("line-opacity").value:1;var u=r.pstyle("curve-style").value;var f=r.pstyle("line-style").value;var h=r.pstyle("width").pfValue;var g=r.pstyle("line-cap").value;var y=r.pstyle("line-outline-width").value;var v=r.pstyle("line-outline-color").value;var m=d*p;var b=d*p;var x=function a(){var n=arguments.length>0&&arguments[0]!==e?arguments[0]:m;if(u==="straight-triangle"){s.eleStrokeStyle(t,r,n);s.drawEdgeTrianglePath(r,t,l.allpts)}else{t.lineWidth=h;t.lineCap=g;s.eleStrokeStyle(t,r,n);s.drawEdgePath(r,t,l.allpts,f);t.lineCap="butt"}};var _=function a(){var n=arguments.length>0&&arguments[0]!==e?arguments[0]:m;t.lineWidth=h+y;t.lineCap=g;if(y>0){s.colorStrokeStyle(t,v[0],v[1],v[2],n)}else{t.lineCap="butt";return}if(u==="straight-triangle"){s.drawEdgeTrianglePath(r,t,l.allpts)}else{s.drawEdgePath(r,t,l.allpts,f);t.lineCap="butt"}};var w=function e(){if(!i){return}s.drawEdgeOverlay(t,r)};var S=function e(){if(!i){return}s.drawEdgeUnderlay(t,r)};var P=function a(){var n=arguments.length>0&&arguments[0]!==e?arguments[0]:b;s.drawArrowheads(t,r,n)};var C=function e(){s.drawElementText(t,r,null,n)};t.lineJoin="round";var E=r.pstyle("ghost").value==="yes";if(E){var T=r.pstyle("ghost-offset-x").pfValue,I=r.pstyle("ghost-offset-y").pfValue,k=r.pstyle("ghost-opacity").value,R=m*k;t.translate(T,I);x(R);P(R);t.translate(-T,-I)}else{_()}S();x();P();w();C();a&&t.translate(c.x1,c.y1)};var vh=function e(t){if(!["overlay","underlay"].includes(t)){throw new Error("Invalid state")}return function(e,r){if(!r.visible()){return}var a=r.pstyle("".concat(t,"-opacity")).value;if(a===0){return}var n=this;var i=n.usePaths();var o=r._private.rscratch;var s=r.pstyle("".concat(t,"-padding")).pfValue;var l=2*s;var c=r.pstyle("".concat(t,"-color")).value;e.lineWidth=l;if(o.edgeType==="self"&&!i){e.lineCap="butt"}else{e.lineCap="round"}n.colorStrokeStyle(e,c[0],c[1],c[2],a);n.drawEdgePath(r,e,o.allpts,"solid")}};yh.drawEdgeOverlay=vh("overlay");yh.drawEdgeUnderlay=vh("underlay");yh.drawEdgePath=function(e,t,r,a){var n=e._private.rscratch;var i=t;var o;var l=!1;var c=this.usePaths();var d=e.pstyle("line-dash-pattern").pfValue;var p=e.pstyle("line-dash-offset").pfValue;if(c){var u=r.join("$"),f=n.pathCacheKey&&n.pathCacheKey===u;if(f){o=t=n.pathCache;l=!0}else{o=t=new Path2D;n.pathCacheKey=u;n.pathCache=o}}if(i.setLineDash){switch(a){case"dotted":i.setLineDash([1,1]);break;case"dashed":i.setLineDash(d);i.lineDashOffset=p;break;case"solid":i.setLineDash([]);break}}if(!l&&!n.badLine){t.beginPath&&t.beginPath();t.moveTo(r[0],r[1]);switch(n.edgeType){case"bezier":case"self":case"compound":case"multibezier":for(var h=2;h+3<r.length;h+=4){t.quadraticCurveTo(r[h],r[h+1],r[h+2],r[h+3])}break;case"straight":case"haystack":for(var g=2;g+1<r.length;g+=2){t.lineTo(r[g],r[g+1])}break;case"segments":if(n.isRound){var y=s(n.roundCorners),v;try{for(y.s();!(v=y.n()).done;){var m=v.value;qu(t,m)}}catch(e){y.e(e)}finally{y.f()}t.lineTo(r[r.length-2],r[r.length-1])}else{for(var b=2;b+1<r.length;b+=2){t.lineTo(r[b],r[b+1])}}break}}t=i;if(c){t.stroke(o)}else{t.stroke()}t.setLineDash&&t.setLineDash([])};yh.drawEdgeTrianglePath=function(e,t,r){t.fillStyle=t.strokeStyle;var a=e.pstyle("width").pfValue;for(var n=0;n+1<r.length;n+=2){var i=[r[n+2]-r[n],r[n+3]-r[n+1]],o=Math.sqrt(i[0]*i[0]+i[1]*i[1]),s=[i[1]/o,-i[0]/o],l=[s[0]*a/2,s[1]*a/2];t.beginPath();t.moveTo(r[n]-l[0],r[n+1]-l[1]);t.lineTo(r[n]+l[0],r[n+1]+l[1]);t.lineTo(r[n+2],r[n+3]);t.closePath();t.fill()}};yh.drawArrowheads=function(e,t,r){var a=t._private.rscratch;var n=a.edgeType==="haystack";n||this.drawArrowhead(e,t,"source",a.arrowStartX,a.arrowStartY,a.srcArrowAngle,r);this.drawArrowhead(e,t,"mid-target",a.midX,a.midY,a.midtgtArrowAngle,r);this.drawArrowhead(e,t,"mid-source",a.midX,a.midY,a.midsrcArrowAngle,r);n||this.drawArrowhead(e,t,"target",a.arrowEndX,a.arrowEndY,a.tgtArrowAngle,r)};yh.drawArrowhead=function(t,r,a,n,i,o,s){if(isNaN(n)||n==null||isNaN(i)||i==null||isNaN(o)||o==null){return}var l=this;var c=r.pstyle(a+"-arrow-shape").value;if(c==="none"){return}var d=r.pstyle(a+"-arrow-fill").value==="hollow"?"both":"filled";var p=r.pstyle(a+"-arrow-fill").value;var u=r.pstyle("width").pfValue;var f=r.pstyle(a+"-arrow-width");var h=f.value==="match-line"?u:f.pfValue;f.units==="%"&&(h*=u);var g=r.pstyle("opacity").value;s===e&&(s=g);var y=t.globalCompositeOperation;if(s!==1||p==="hollow"){t.globalCompositeOperation="destination-out";l.colorFillStyle(t,255,255,255,1);l.colorStrokeStyle(t,255,255,255,1);l.drawArrowShape(r,t,d,u,c,h,n,i,o);t.globalCompositeOperation=y}var v=r.pstyle(a+"-arrow-color").value;l.colorFillStyle(t,v[0],v[1],v[2],s);l.colorStrokeStyle(t,v[0],v[1],v[2],s);l.drawArrowShape(r,t,p,u,c,h,n,i,o)};yh.drawArrowShape=function(e,t,r,a,n,i,o,s,l){var c=this;var d=this.usePaths()&&n!=="triangle-cross";var p=!1;var u;var f=t;var h={x:o,y:s};var g=e.pstyle("arrow-scale").value;var y=this.getArrowWidth(a,g);var v=c.arrowShapes[n];if(d){var m=c.arrowPathCache=c.arrowPathCache||[],b=_t(n),x=m[b];if(x!=null){u=t=x;p=!0}else{u=t=new Path2D;m[b]=u}}if(!p){t.beginPath&&t.beginPath();if(d){v.draw(t,1,0,{x:0,y:0},1)}else{v.draw(t,y,l,h,a)}t.closePath&&t.closePath()}t=f;if(d){t.translate(o,s);t.rotate(l);t.scale(y,y)}if(r==="filled"||r==="both"){if(d){t.fill(u)}else{t.fill()}}if(r==="hollow"||r==="both"){t.lineWidth=i/(d?y:1);t.lineJoin="miter";if(d){t.stroke(u)}else{t.stroke()}}if(d){t.scale(1/y,1/y);t.rotate(-l);t.translate(-o,-s)}};var mh={};mh.safeDrawImage=function(e,t,r,a,n,i,o,s,l,c){if(n<=0||i<=0||l<=0||c<=0){return}try{e.drawImage(t,r,a,n,i,o,s,l,c)}catch(e){Mt(e)}};mh.drawInscribedImage=function(e,t,r,a,n){var i=this;var o=r.position();var s=o.x;var l=o.y;var c=r.cy().style();var d=c.getIndexedStyle.bind(c);var p=d(r,"background-fit","value",a);var u=d(r,"background-repeat","value",a);var f=r.width();var h=r.height();var g=r.padding()*2;var y=f+(d(r,"background-width-relative-to","value",a)==="inner"?0:g);var v=h+(d(r,"background-height-relative-to","value",a)==="inner"?0:g);var m=r._private.rscratch;var b=d(r,"background-clip","value",a);var x=b==="node";var _=d(r,"background-image-opacity","value",a)*n;var w=d(r,"background-image-smoothing","value",a);var S=r.pstyle("corner-radius").value;S!=="auto"&&(S=r.pstyle("corner-radius").pfValue);var P=t.width||t.cachedW;var C=t.height||t.cachedH;if(null==P||null==C){document.body.appendChild(t);P=t.cachedW=t.width||t.offsetWidth;C=t.cachedH=t.height||t.offsetHeight;document.body.removeChild(t)}var E=P;var T=C;if(d(r,"background-width","value",a)!=="auto"){if(d(r,"background-width","units",a)==="%"){E=d(r,"background-width","pfValue",a)*y}else{E=d(r,"background-width","pfValue",a)}}if(d(r,"background-height","value",a)!=="auto"){if(d(r,"background-height","units",a)==="%"){T=d(r,"background-height","pfValue",a)*v}else{T=d(r,"background-height","pfValue",a)}}if(E===0||T===0){return}if(p==="contain"){var I=Math.min(y/E,v/T);E*=I;T*=I}else if(p==="cover"){var I=Math.max(y/E,v/T);E*=I;T*=I}var k=s-y/2;var R=d(r,"background-position-x","units",a);var D=d(r,"background-position-x","pfValue",a);if(R==="%"){k+=(y-E)*D}else{k+=D}var B=d(r,"background-offset-x","units",a);var A=d(r,"background-offset-x","pfValue",a);if(B==="%"){k+=(y-E)*A}else{k+=A}var O=l-v/2;var L=d(r,"background-position-y","units",a);var N=d(r,"background-position-y","pfValue",a);if(L==="%"){O+=(v-T)*N}else{O+=N}var M=d(r,"background-offset-y","units",a);var j=d(r,"background-offset-y","pfValue",a);if(M==="%"){O+=(v-T)*j}else{O+=j}if(m.pathCache){k-=s;O-=l;s=0;l=0}var q=e.globalAlpha;e.globalAlpha=_;var z=i.getImgSmoothing(e);var $=!1;if(w==="no"&&z){i.setImgSmoothing(e,!1);$=!0}else if(w==="yes"&&!z){i.setImgSmoothing(e,!0);$=!0}if(u==="no-repeat"){if(x){e.save();if(m.pathCache){e.clip(m.pathCache)}else{i.nodeShapes[i.getNodeShape(r)].draw(e,s,l,y,v,S,m);e.clip()}}i.safeDrawImage(e,t,0,0,P,C,k,O,E,T);x&&e.restore()}else{var V=e.createPattern(t,u);e.fillStyle=V;i.nodeShapes[i.getNodeShape(r)].draw(e,s,l,y,v,S,m);e.translate(k,O);e.fill();e.translate(-k,-O)}e.globalAlpha=q;$&&i.setImgSmoothing(e,z)};var bh={};bh.eleTextBiggerThanMin=function(e,t){if(!t){var r=e.cy().zoom(),a=this.getPixelRatio(),n=Math.ceil(Mr(r*a));t=Math.pow(2,n)}var i=e.pstyle("font-size").pfValue*t;var o=e.pstyle("min-zoomed-font-size").pfValue;if(i<o){return!1}return!0};bh.drawElementText=function(t,r,a,n,i){var o=arguments.length>5&&arguments[5]!==e?arguments[5]:!0;var s=this;if(n==null){if(o&&!s.eleTextBiggerThanMin(r)){return}}else if(n===!1){return}if(r.isNode()){var l=r.pstyle("label");if(!l||!l.value){return}var c=s.getLabelJustification(r);t.textAlign=c;t.textBaseline="bottom"}else{var d=r.element()._private.rscratch.badLine,p=r.pstyle("label"),u=r.pstyle("source-label"),f=r.pstyle("target-label");if(d||(!p||!p.value)&&(!u||!u.value)&&(!f||!f.value)){return}t.textAlign="center";t.textBaseline="bottom"}var h=!a;var g;if(a){g=a;t.translate(-g.x1,-g.y1)}if(i==null){s.drawText(t,r,null,h,o);if(r.isEdge()){s.drawText(t,r,"source",h,o);s.drawText(t,r,"target",h,o)}}else{s.drawText(t,r,i,h,o)}a&&t.translate(g.x1,g.y1)};bh.getFontCache=function(e){var t;this.fontCaches=this.fontCaches||[];for(var r=0;r<this.fontCaches.length;r++){t=this.fontCaches[r];if(t.context===e){return t}}t={context:e};this.fontCaches.push(t);return t};bh.setupTextStyle=function(t,r){var a=arguments.length>2&&arguments[2]!==e?arguments[2]:!0;var n=r.pstyle("font-style").strValue;var i=r.pstyle("font-size").pfValue+"px";var o=r.pstyle("font-family").strValue;var s=r.pstyle("font-weight").strValue;var l=a?r.effectiveOpacity()*r.pstyle("text-opacity").value:1;var c=r.pstyle("text-outline-opacity").value*l;var d=r.pstyle("color").value;var p=r.pstyle("text-outline-color").value;t.font=n+" "+s+" "+i+" "+o;t.lineJoin="round";this.colorFillStyle(t,d[0],d[1],d[2],l);this.colorStrokeStyle(t,p[0],p[1],p[2],c)};function xh(e,t,r,a,n){var i=Math.min(a,n);var o=i/2;var s=t+a/2;var l=r+n/2;e.beginPath();e.arc(s,l,o,0,Math.PI*2);e.closePath()}function _h(t,r,a,n,i){var o=arguments.length>5&&arguments[5]!==e?arguments[5]:5;var s=Math.min(o,n/2,i/2);t.beginPath();t.moveTo(r+s,a);t.lineTo(r+n-s,a);t.quadraticCurveTo(r+n,a,r+n,a+s);t.lineTo(r+n,a+i-s);t.quadraticCurveTo(r+n,a+i,r+n-s,a+i);t.lineTo(r+s,a+i);t.quadraticCurveTo(r,a+i,r,a+i-s);t.lineTo(r,a+s);t.quadraticCurveTo(r,a,r+s,a);t.closePath()}bh.getTextAngle=function(e,t){var r;var a=e._private;var n=a.rscratch;var i=t?t+"-":"";var o=e.pstyle(i+"text-rotation");if(o.strValue==="autorotate"){var s=Gt(n,"labelAngle",t);r=e.isEdge()?s:0}else if(o.strValue==="none"){r=0}else{r=o.pfValue}return r};bh.drawText=function(t,r,a){var n=arguments.length>3&&arguments[3]!==e?arguments[3]:!0;var i=arguments.length>4&&arguments[4]!==e?arguments[4]:!0;var o=r._private;var s=o.rscratch;var l=i?r.effectiveOpacity():1;if(i&&(l===0||r.pstyle("text-opacity").value===0)){return}a==="main"&&(a=null);var c=Gt(s,"labelX",a);var d=Gt(s,"labelY",a);var p,u;var f=this.getLabelText(r,a);if(f!=null&&f!==""&&!isNaN(c)&&!isNaN(d)){this.setupTextStyle(t,r,i);var h=a?a+"-":"",g=Gt(s,"labelWidth",a),y=Gt(s,"labelHeight",a),v=r.pstyle(h+"text-margin-x").pfValue,m=r.pstyle(h+"text-margin-y").pfValue,b=r.isEdge(),x=r.pstyle("text-halign").value,_=r.pstyle("text-valign").value;if(b){x="center";_="center"}c+=v;d+=m;var w;if(!n){w=0}else{w=this.getTextAngle(r,a)}if(w!==0){p=c;u=d;t.translate(p,u);t.rotate(w);c=0;d=0}switch(_){case"top":break;case"center":d+=y/2;break;case"bottom":d+=y;break}var S=r.pstyle("text-background-opacity").value,P=r.pstyle("text-border-opacity").value,C=r.pstyle("text-border-width").pfValue,E=r.pstyle("text-background-padding").pfValue,T=r.pstyle("text-background-shape").strValue,I=T==="round-rectangle"||T==="roundrectangle",k=T==="circle",R=2;if(S>0||C>0&&P>0){var D=t.fillStyle,B=t.strokeStyle,A=t.lineWidth,O=r.pstyle("text-background-color").value,L=r.pstyle("text-border-color").value,N=r.pstyle("text-border-style").value,M=S>0,j=C>0&&P>0,q=c-E;switch(x){case"left":q-=g;break;case"center":q-=g/2;break}var z=d-y-E,$=g+2*E,V=y+2*E;M&&(t.fillStyle="rgba(".concat(O[0],",").concat(O[1],",").concat(O[2],",").concat(S*l,")"));if(j){t.strokeStyle="rgba(".concat(L[0],",").concat(L[1],",").concat(L[2],",").concat(P*l,")");t.lineWidth=C;if(t.setLineDash){switch(N){case"dotted":t.setLineDash([1,1]);break;case"dashed":t.setLineDash([4,2]);break;case"double":t.lineWidth=C/4;t.setLineDash([]);break;case"solid":default:t.setLineDash([]);break}}}if(I){t.beginPath();_h(t,q,z,$,V,R)}else if(k){t.beginPath();xh(t,q,z,$,V)}else{t.beginPath();t.rect(q,z,$,V)}M&&t.fill();j&&t.stroke();if(j&&N==="double"){var F=C/2;t.beginPath();if(I){_h(t,q+F,z+F,$-2*F,V-2*F,R)}else{t.rect(q+F,z+F,$-2*F,V-2*F)}t.stroke()}t.fillStyle=D;t.strokeStyle=B;t.lineWidth=A;t.setLineDash&&t.setLineDash([])}var W=2*r.pstyle("text-outline-width").pfValue;W>0&&(t.lineWidth=W);if(r.pstyle("text-wrap").value==="wrap"){var H=Gt(s,"labelWrapCachedLines",a),X=Gt(s,"labelLineHeight",a),Y=g/2,G=this.getLabelJustification(r);if(G==="auto");else if(x==="left"){if(G==="left"){c+=-g}else G==="center"&&(c+=-Y)}else if(x==="center"){if(G==="left"){c+=-Y}else G==="right"&&(c+=Y)}else if(x==="right"){if(G==="center"){c+=Y}else G==="right"&&(c+=g)}switch(_){case"top":d-=(H.length-1)*X;break;case"center":case"bottom":d-=(H.length-1)*X;break}for(var K=0;K<H.length;K++){W>0&&t.strokeText(H[K],c,d);t.fillText(H[K],c,d);d+=X}}else{W>0&&t.strokeText(f,c,d);t.fillText(f,c,d)}if(w!==0){t.rotate(-w);t.translate(-p,-u)}}};var wh={};wh.drawNode=function(t,r,a){var n=arguments.length>3&&arguments[3]!==e?arguments[3]:!0;var i=arguments.length>4&&arguments[4]!==e?arguments[4]:!0;var o=arguments.length>5&&arguments[5]!==e?arguments[5]:!0;var s=this;var l,c;var d=r._private;var p=d.rscratch;var u=r.position();if(!D(u.x)||!D(u.y)){return}if(o&&!r.visible()){return}var f=o?r.effectiveOpacity():1;var h=s.usePaths();var g;var y=!1;var v=r.padding();l=r.width()+2*v;c=r.height()+2*v;var m;if(a){m=a;t.translate(-m.x1,-m.y1)}var b=r.pstyle("background-image");var x=b.value;var _=new Array(x.length);var w=new Array(x.length);var S=0;for(var P=0;P<x.length;P++){var C=x[P],E=_[P]=C!=null&&C!=="none";if(E){var T=r.cy().style().getIndexedStyle(r,"background-image-crossorigin","value",P);S++;w[P]=s.getCachedImage(C,T,function(){d.backgroundTimestamp=Date.now();r.emitAndNotify("background")})}}var I=r.pstyle("background-blacken").value;var k=r.pstyle("border-width").pfValue;var R=r.pstyle("background-opacity").value*f;var B=r.pstyle("border-color").value;var A=r.pstyle("border-style").value;var O=r.pstyle("border-join").value;var L=r.pstyle("border-cap").value;var N=r.pstyle("border-position").value;var M=r.pstyle("border-dash-pattern").pfValue;var j=r.pstyle("border-dash-offset").pfValue;var q=r.pstyle("border-opacity").value*f;var z=r.pstyle("outline-width").pfValue;var $=r.pstyle("outline-color").value;var V=r.pstyle("outline-style").value;var F=r.pstyle("outline-opacity").value*f;var W=r.pstyle("outline-offset").value;var H=r.pstyle("corner-radius").value;H!=="auto"&&(H=r.pstyle("corner-radius").pfValue);var X=function a(){var n=arguments.length>0&&arguments[0]!==e?arguments[0]:R;s.eleFillStyle(t,r,n)};var Y=function r(){var a=arguments.length>0&&arguments[0]!==e?arguments[0]:q;s.colorStrokeStyle(t,B[0],B[1],B[2],a)};var G=function r(){var a=arguments.length>0&&arguments[0]!==e?arguments[0]:F;s.colorStrokeStyle(t,$[0],$[1],$[2],a)};var K=function e(t,r,a,n){var i=s.nodePathCache=s.nodePathCache||[];var o=wt(a==="polygon"?a+","+n.join(","):a,""+r,""+t,""+H);var l=i[o];var c;var d=!1;if(l!=null){c=l;d=!0;p.pathCache=c}else{c=new Path2D;i[o]=p.pathCache=c}return{path:c,cacheHit:d}};var U=r.pstyle("shape").strValue;var Q=r.pstyle("shape-polygon-points").pfValue;if(h){t.translate(u.x,u.y);var Z=K(l,c,U,Q);g=Z.path;y=Z.cacheHit}var J=function e(){if(!y){var a=u;h&&(a={x:0,y:0});s.nodeShapes[s.getNodeShape(r)].draw(g||t,a.x,a.y,l,c,H,p)}if(h){t.fill(g)}else{t.fill()}};var ee=function a(){var n=arguments.length>0&&arguments[0]!==e?arguments[0]:f;var i=arguments.length>1&&arguments[1]!==e?arguments[1]:!0;var o=d.backgrounding;var l=0;for(var c=0;c<w.length;c++){var p=r.cy().style().getIndexedStyle(r,"background-image-containment","value",c);if(i&&p==="over"||!i&&p==="inside"){l++;continue}if(_[c]&&w[c].complete&&!w[c].error){l++;s.drawInscribedImage(t,w[c],r,c,n)}}d.backgrounding=!(l===S);o!==d.backgrounding&&r.updateStyle(!1)};var te=function a(){var n=arguments.length>0&&arguments[0]!==e?arguments[0]:!1;var i=arguments.length>1&&arguments[1]!==e?arguments[1]:f;if(s.hasPie(r)){s.drawPie(t,r,i);n&&(h||s.nodeShapes[s.getNodeShape(r)].draw(t,u.x,u.y,l,c,H,p))}};var re=function a(){var n=arguments.length>0&&arguments[0]!==e?arguments[0]:!1;var i=arguments.length>1&&arguments[1]!==e?arguments[1]:f;if(s.hasStripe(r)){t.save();if(h){t.clip(p.pathCache)}else{s.nodeShapes[s.getNodeShape(r)].draw(t,u.x,u.y,l,c,H,p);t.clip()}s.drawStripe(t,r,i);t.restore();n&&(h||s.nodeShapes[s.getNodeShape(r)].draw(t,u.x,u.y,l,c,H,p))}};var ae=function r(){var a=arguments.length>0&&arguments[0]!==e?arguments[0]:f;var n=(I>0?I:-I)*a;var i=I>0?0:255;if(I!==0){s.colorFillStyle(t,i,i,i,n);if(h){t.fill(g)}else{t.fill()}}};var ne=function e(){if(k>0){t.lineWidth=k;t.lineCap=L;t.lineJoin=O;if(t.setLineDash){switch(A){case"dotted":t.setLineDash([1,1]);break;case"dashed":t.setLineDash(M);t.lineDashOffset=j;break;case"solid":case"double":t.setLineDash([]);break}}if(N!=="center"){t.save();t.lineWidth*=2;if(N==="inside"){h?t.clip(g):t.clip()}else{var r=new Path2D;r.rect(-l/2-k,-c/2-k,l+2*k,c+2*k);r.addPath(g);t.clip(r,"evenodd")}h?t.stroke(g):t.stroke();t.restore()}else{h?t.stroke(g):t.stroke()}if(A==="double"){t.lineWidth=k/3;var a=t.globalCompositeOperation;t.globalCompositeOperation="destination-out";if(h){t.stroke(g)}else{t.stroke()}t.globalCompositeOperation=a}t.setLineDash&&t.setLineDash([])}};var ie=function e(){if(z>0){t.lineWidth=z;t.lineCap="butt";if(t.setLineDash){switch(V){case"dotted":t.setLineDash([1,1]);break;case"dashed":t.setLineDash([4,2]);break;case"solid":case"double":t.setLineDash([]);break}}var a=u;h&&(a={x:0,y:0});var n=s.getNodeShape(r),i=k;N==="inside"&&(i=0);N==="outside"&&(i*=2);var o=(l+i+(z+W))/l,d=(c+i+(z+W))/c,p=l*o,f=c*d,g=s.nodeShapes[n].points,y;if(h){var v=K(p,f,n,g);y=v.path}if(n==="ellipse"){s.drawEllipsePath(y||t,a.x,a.y,p,f)}else if(["round-diamond","round-heptagon","round-hexagon","round-octagon","round-pentagon","round-polygon","round-triangle","round-tag"].includes(n)){var m=0,b=0,x=0;if(n==="round-diamond"){m=(i+W+z)*1.4}else if(n==="round-heptagon"){m=(i+W+z)*1.075;x=-(i/2+W+z)/35}else if(n==="round-hexagon"){m=(i+W+z)*1.12}else if(n==="round-pentagon"){m=(i+W+z)*1.13;x=-(i/2+W+z)/15}else if(n==="round-tag"){m=(i+W+z)*1.12;b=(i/2+z+W)*.07}else if(n==="round-triangle"){m=(i+W+z)*(Math.PI/2);x=-(i+W/2+z)/Math.PI}if(m!==0){o=(l+m)/l;p=l*o;if(!["round-hexagon","round-tag"].includes(n)){d=(c+m)/c;f=c*d}}H=H==="auto"?Ba(p,f):H;var _=p/2,w=f/2,S=H+(i+z+W)/2,P=new Array(g.length/2),C=new Array(g.length/2);for(var E=0;E<g.length/2;E++){P[E]={x:a.x+b+_*g[E*2],y:a.y+x+w*g[E*2+1]}}var T,I,R,D,B=P.length;I=P[B-1];for(T=0;T<B;T++){R=P[T%B];D=P[(T+1)%B];C[T]=zu(I,R,D,S);I=R;R=D}s.drawRoundPolygonPath(y||t,a.x+b,a.y+x,l*o,c*d,g,C)}else if(["roundrectangle","round-rectangle"].includes(n)){H=H==="auto"?Da(p,f):H;s.drawRoundRectanglePath(y||t,a.x,a.y,p,f,H+(i+z+W)/2)}else if(["cutrectangle","cut-rectangle"].includes(n)){H=H==="auto"?Aa():H;s.drawCutRectanglePath(y||t,a.x,a.y,p,f,null,H+(i+z+W)/4)}else if(["bottomroundrectangle","bottom-round-rectangle"].includes(n)){H=H==="auto"?Da(p,f):H;s.drawBottomRoundRectanglePath(y||t,a.x,a.y,p,f,H+(i+z+W)/2)}else if(n==="barrel"){s.drawBarrelPath(y||t,a.x,a.y,p,f)}else if(n.startsWith("polygon")||["rhomboid","right-rhomboid","round-tag","tag","vee"].includes(n)){var A=(i+z+W)/l;g=va(ma(g,A));s.drawPolygonPath(y||t,a.x,a.y,l,c,g)}else{var O=(i+z+W)/l;g=va(ma(g,-O));s.drawPolygonPath(y||t,a.x,a.y,l,c,g)}if(h){t.stroke(y)}else{t.stroke()}if(V==="double"){t.lineWidth=i/3;var L=t.globalCompositeOperation;t.globalCompositeOperation="destination-out";if(h){t.stroke(y)}else{t.stroke()}t.globalCompositeOperation=L}t.setLineDash&&t.setLineDash([])}};var oe=function e(){i&&s.drawNodeOverlay(t,r,u,l,c)};var se=function e(){i&&s.drawNodeUnderlay(t,r,u,l,c)};var le=function e(){s.drawElementText(t,r,null,n)};var ce=r.pstyle("ghost").value==="yes";if(ce){var de=r.pstyle("ghost-offset-x").pfValue,pe=r.pstyle("ghost-offset-y").pfValue,ue=r.pstyle("ghost-opacity").value,fe=ue*f;t.translate(de,pe);G();ie();X(ue*R);J();ee(fe,!0);Y(ue*q);ne();te(I!==0||k!==0);re(I!==0||k!==0);ee(fe,!1);ae(fe);t.translate(-de,-pe)}h&&t.translate(-u.x,-u.y);se();h&&t.translate(u.x,u.y);G();ie();X();J();ee(f,!0);Y();ne();te(I!==0||k!==0);re(I!==0||k!==0);ee(f,!1);ae();h&&t.translate(-u.x,-u.y);le();oe();a&&t.translate(m.x1,m.y1)};var Sh=function e(t){if(!["overlay","underlay"].includes(t)){throw new Error("Invalid state")}return function(e,r,a,n,i){var o=this;if(!r.visible()){return}var s=r.pstyle("".concat(t,"-padding")).pfValue;var l=r.pstyle("".concat(t,"-opacity")).value;var c=r.pstyle("".concat(t,"-color")).value;var d=r.pstyle("".concat(t,"-shape")).value;var p=r.pstyle("".concat(t,"-corner-radius")).value;if(l>0){a=a||r.position();if(n==null||i==null){var u=r.padding();n=r.width()+2*u;i=r.height()+2*u}o.colorFillStyle(e,c[0],c[1],c[2],l);o.nodeShapes[d].draw(e,a.x,a.y,n+s*2,i+s*2,p);e.fill()}}};wh.drawNodeOverlay=Sh("overlay");wh.drawNodeUnderlay=Sh("underlay");wh.hasPie=function(e){e=e[0];return e._private.hasPie};wh.hasStripe=function(e){e=e[0];return e._private.hasStripe};wh.drawPie=function(t,r,a,n){r=r[0];n=n||r.position();var i=r.cy().style();var o=r.pstyle("pie-size");var s=r.pstyle("pie-hole");var l=r.pstyle("pie-start-angle").pfValue;var c=n.x;var d=n.y;var p=r.width();var u=r.height();var f=Math.min(p,u)/2;var h;var g=0;var y=this.usePaths();if(y){c=0;d=0}if(o.units==="%"){f=f*o.pfValue}else o.pfValue!==e&&(f=o.pfValue/2);if(s.units==="%"){h=f*s.pfValue}else s.pfValue!==e&&(h=s.pfValue/2);if(h>=f){return}for(var v=1;v<=i.pieBackgroundN;v++){var m=r.pstyle("pie-"+v+"-background-size").value,b=r.pstyle("pie-"+v+"-background-color").value,x=r.pstyle("pie-"+v+"-background-opacity").value*a,_=m/100
_+g>1&&(_=1-g);var w=1.5*Math.PI+2*Math.PI*g;w+=l;var S=2*Math.PI*_,P=w+S;if(m===0||g>=1||g+_>1){continue}if(h===0){t.beginPath();t.moveTo(c,d);t.arc(c,d,f,w,P);t.closePath()}else{t.beginPath();t.arc(c,d,f,w,P);t.arc(c,d,h,P,w,!0);t.closePath()}this.colorFillStyle(t,b[0],b[1],b[2],x);t.fill();g+=_}};wh.drawStripe=function(t,r,a,n){r=r[0];n=n||r.position();var i=r.cy().style();var o=n.x;var s=n.y;var l=r.width();var c=r.height();var d=0;var p=this.usePaths();t.save();var u=r.pstyle("stripe-direction").value;var f=r.pstyle("stripe-size");switch(u){case"vertical":break;case"righward":t.rotate(-Math.PI/2);break}var h=l;var g=c;if(f.units==="%"){h=h*f.pfValue;g=g*f.pfValue}else if(f.pfValue!==e){h=f.pfValue;g=f.pfValue}if(p){o=0;s=0}s-=h/2;o-=g/2;for(var y=1;y<=i.stripeBackgroundN;y++){var v=r.pstyle("stripe-"+y+"-background-size").value,m=r.pstyle("stripe-"+y+"-background-color").value,b=r.pstyle("stripe-"+y+"-background-opacity").value*a,x=v/100;x+d>1&&(x=1-d);if(v===0||d>=1||d+x>1){continue}t.beginPath();t.rect(o,s+g*d,h,g*x);t.closePath();this.colorFillStyle(t,m[0],m[1],m[2],b);t.fill();d+=x}t.restore()};var Ph={};var Ch=100;Ph.getPixelRatio=function(){var e=this.data.contexts[0];if(this.forcedPixelRatio!=null){return this.forcedPixelRatio}var t=this.cy.window();var r=e.backingStorePixelRatio||e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return(t.devicePixelRatio||1)/r};Ph.paintCache=function(e){var t=this.paintCaches=this.paintCaches||[];var r=!0;var a;for(var n=0;n<t.length;n++){a=t[n];if(a.context===e){r=!1;break}}if(r){a={context:e};t.push(a)}return a};Ph.createGradientStyleFor=function(e,t,r,a,n){var i;var o=this.usePaths();var s=r.pstyle(t+"-gradient-stop-colors").value,l=r.pstyle(t+"-gradient-stop-positions").pfValue;if(a==="radial-gradient"){if(r.isEdge()){var c=r.sourceEndpoint(),d=r.targetEndpoint(),p=r.midpoint(),u=qr(c,p),f=qr(d,p);i=e.createRadialGradient(p.x,p.y,0,p.x,p.y,Math.max(u,f))}else{var h=o?{x:0,y:0}:r.position(),g=r.paddedWidth(),y=r.paddedHeight();i=e.createRadialGradient(h.x,h.y,0,h.x,h.y,Math.max(g,y))}}else{if(r.isEdge()){var v=r.sourceEndpoint(),m=r.targetEndpoint();i=e.createLinearGradient(v.x,v.y,m.x,m.y)}else{var b=o?{x:0,y:0}:r.position(),x=r.paddedWidth(),_=r.paddedHeight(),w=x/2,S=_/2,P=r.pstyle("background-gradient-direction").value;switch(P){case"to-bottom":i=e.createLinearGradient(b.x,b.y-S,b.x,b.y+S);break;case"to-top":i=e.createLinearGradient(b.x,b.y+S,b.x,b.y-S);break;case"to-left":i=e.createLinearGradient(b.x+w,b.y,b.x-w,b.y);break;case"to-right":i=e.createLinearGradient(b.x-w,b.y,b.x+w,b.y);break;case"to-bottom-right":case"to-right-bottom":i=e.createLinearGradient(b.x-w,b.y-S,b.x+w,b.y+S);break;case"to-top-right":case"to-right-top":i=e.createLinearGradient(b.x-w,b.y+S,b.x+w,b.y-S);break;case"to-bottom-left":case"to-left-bottom":i=e.createLinearGradient(b.x+w,b.y-S,b.x-w,b.y+S);break;case"to-top-left":case"to-left-top":i=e.createLinearGradient(b.x+w,b.y+S,b.x-w,b.y-S);break}}}if(!i)return null;var C=l.length===s.length;var E=s.length;for(var T=0;T<E;T++){i.addColorStop(C?l[T]:T/(E-1),"rgba("+s[T][0]+","+s[T][1]+","+s[T][2]+","+n+")")}return i};Ph.gradientFillStyle=function(e,t,r,a){var n=this.createGradientStyleFor(e,"background",t,r,a);if(!n)return null;e.fillStyle=n};Ph.colorFillStyle=function(e,t,r,a,n){e.fillStyle="rgba("+t+","+r+","+a+","+n+")"};Ph.eleFillStyle=function(e,t,r){var a=t.pstyle("background-fill").value;if(a==="linear-gradient"||a==="radial-gradient"){this.gradientFillStyle(e,t,a,r)}else{var n=t.pstyle("background-color").value;this.colorFillStyle(e,n[0],n[1],n[2],r)}};Ph.gradientStrokeStyle=function(e,t,r,a){var n=this.createGradientStyleFor(e,"line",t,r,a);if(!n)return null;e.strokeStyle=n};Ph.colorStrokeStyle=function(e,t,r,a,n){e.strokeStyle="rgba("+t+","+r+","+a+","+n+")"};Ph.eleStrokeStyle=function(e,t,r){var a=t.pstyle("line-fill").value;if(a==="linear-gradient"||a==="radial-gradient"){this.gradientStrokeStyle(e,t,a,r)}else{var n=t.pstyle("line-color").value;this.colorStrokeStyle(e,n[0],n[1],n[2],r)}};Ph.matchCanvasSize=function(e){var t=this;var r=t.data;var a=t.findContainerClientCoords();var n=a[2];var i=a[3];var o=t.getPixelRatio();var s=t.motionBlurPxRatio;(e===t.data.bufferCanvases[t.MOTIONBLUR_BUFFER_NODE]||e===t.data.bufferCanvases[t.MOTIONBLUR_BUFFER_DRAG])&&(o=s);var l=n*o;var c=i*o;var d;if(l===t.canvasWidth&&c===t.canvasHeight){return}t.fontCaches=null;var p=r.canvasContainer;p.style.width=n+"px";p.style.height=i+"px";for(var u=0;u<t.CANVAS_LAYERS;u++){d=r.canvases[u];d.width=l;d.height=c;d.style.width=n+"px";d.style.height=i+"px"}for(var u=0;u<t.BUFFER_COUNT;u++){d=r.bufferCanvases[u];d.width=l;d.height=c;d.style.width=n+"px";d.style.height=i+"px"}t.textureMult=1;if(o<=1){d=r.bufferCanvases[t.TEXTURE_BUFFER];t.textureMult=2;d.width=l*t.textureMult;d.height=c*t.textureMult}t.canvasWidth=l;t.canvasHeight=c;t.pixelRatio=o};Ph.renderTo=function(e,t,r,a){this.render({forcedContext:e,forcedZoom:t,forcedPan:r,drawAllLayers:!0,forcedPxRatio:a})};Ph.clearCanvas=function(){var e=this;var t=e.data;function r(t){t.clearRect(0,0,e.canvasWidth,e.canvasHeight)}r(t.contexts[e.NODE]);r(t.contexts[e.DRAG])};Ph.render=function(t){var r=this;t=t||Ft();var a=r.cy;var n=t.forcedContext;var i=t.drawAllLayers;var o=t.drawOnlyNodeLayer;var s=t.forcedZoom;var l=t.forcedPan;var c=t.forcedPxRatio===e?this.getPixelRatio():t.forcedPxRatio;var d=r.data;var p=d.canvasNeedsRedraw;var u=r.textureOnViewport&&!n&&(r.pinching||r.hoverData.dragging||r.swipePanning||r.data.wheelZooming);var f=t.motionBlur!==e?t.motionBlur:r.motionBlur;var h=r.motionBlurPxRatio;var g=a.hasCompoundNodes();var y=r.hoverData.draggingEles;var v=r.hoverData.selecting||r.touchData.selecting?!0:!1;f=f&&!n&&r.motionBlurEnabled&&!v;var m=f;if(!n){if(r.prevPxRatio!==c){r.invalidateContainerClientCoordsCache();r.matchCanvasSize(r.container);r.redrawHint("eles",!0);r.redrawHint("drag",!0)}r.prevPxRatio=c}!n&&r.motionBlurTimeout&&clearTimeout(r.motionBlurTimeout);if(f){r.mbFrames==null&&(r.mbFrames=0);r.mbFrames++;r.mbFrames<3&&(m=!1);r.mbFrames>r.minMbLowQualFrames&&(r.motionBlurPxRatio=r.mbPxRBlurry)}r.clearingMotionBlur&&(r.motionBlurPxRatio=1);if(r.textureDrawLastFrame&&!u){p[r.NODE]=!0;p[r.SELECT_BOX]=!0}var b=a.style();var x=a.zoom();var _=s!==e?s:x;var w=a.pan();var S={x:w.x,y:w.y};var P={zoom:x,pan:{x:w.x,y:w.y}};var C=r.prevViewport;var E=C===e||P.zoom!==C.zoom||P.pan.x!==C.pan.x||P.pan.y!==C.pan.y;!E&&!(y&&!g)&&(r.motionBlurPxRatio=1);l&&(S=l);_*=c;S.x*=c;S.y*=c;var T=r.getCachedZSortedEles();function I(e,t,a,n,i){var o=e.globalCompositeOperation;e.globalCompositeOperation="destination-out";r.colorFillStyle(e,255,255,255,r.motionBlurTransparency);e.fillRect(t,a,n,i);e.globalCompositeOperation=o}function k(t,a){var o,c,p,u;if(!r.clearingMotionBlur&&(t===d.bufferContexts[r.MOTIONBLUR_BUFFER_NODE]||t===d.bufferContexts[r.MOTIONBLUR_BUFFER_DRAG])){o={x:w.x*h,y:w.y*h};c=x*h;p=r.canvasWidth*h;u=r.canvasHeight*h}else{o=S;c=_;p=r.canvasWidth;u=r.canvasHeight}t.setTransform(1,0,0,1,0,0);if(a==="motionBlur"){I(t,0,0,p,u)}else!n&&(a===e||a)&&t.clearRect(0,0,p,u);if(!i){t.translate(o.x,o.y);t.scale(c,c)}l&&t.translate(l.x,l.y);s&&t.scale(s,s)}u||(r.textureDrawLastFrame=!1);if(u){r.textureDrawLastFrame=!0;if(!r.textureCache){r.textureCache={};r.textureCache.bb=a.mutableElements().boundingBox();r.textureCache.texture=r.data.bufferCanvases[r.TEXTURE_BUFFER];var R=r.data.bufferContexts[r.TEXTURE_BUFFER];R.setTransform(1,0,0,1,0,0);R.clearRect(0,0,r.canvasWidth*r.textureMult,r.canvasHeight*r.textureMult);r.render({forcedContext:R,drawOnlyNodeLayer:!0,forcedPxRatio:c*r.textureMult});var P=r.textureCache.viewport={zoom:a.zoom(),pan:a.pan(),width:r.canvasWidth,height:r.canvasHeight};P.mpan={x:(0-P.pan.x)/P.zoom,y:(0-P.pan.y)/P.zoom}}p[r.DRAG]=!1;p[r.NODE]=!1;var D=d.contexts[r.NODE],B=r.textureCache.texture,P=r.textureCache.viewport;D.setTransform(1,0,0,1,0,0);if(f){I(D,0,0,P.width,P.height)}else{D.clearRect(0,0,P.width,P.height)}var A=b.core("outside-texture-bg-color").value,O=b.core("outside-texture-bg-opacity").value;r.colorFillStyle(D,A[0],A[1],A[2],O);D.fillRect(0,0,P.width,P.height);var x=a.zoom();k(D,!1);D.clearRect(P.mpan.x,P.mpan.y,P.width/P.zoom/c,P.height/P.zoom/c);D.drawImage(B,P.mpan.x,P.mpan.y,P.width/P.zoom/c,P.height/P.zoom/c)}else r.textureOnViewport&&!n&&(r.textureCache=null);var L=a.extent();var N=r.pinching||r.hoverData.dragging||r.swipePanning||r.data.wheelZooming||r.hoverData.draggingEles||r.cy.animated();var M=r.hideEdgesOnViewport&&N;var j=[];j[r.NODE]=!p[r.NODE]&&f&&!r.clearedForMotionBlur[r.NODE]||r.clearingMotionBlur;j[r.NODE]&&(r.clearedForMotionBlur[r.NODE]=!0);j[r.DRAG]=!p[r.DRAG]&&f&&!r.clearedForMotionBlur[r.DRAG]||r.clearingMotionBlur;j[r.DRAG]&&(r.clearedForMotionBlur[r.DRAG]=!0);if(p[r.NODE]||i||o||j[r.NODE]){var q=f&&!j[r.NODE]&&h!==1,D=n||(q?r.data.bufferContexts[r.MOTIONBLUR_BUFFER_NODE]:d.contexts[r.NODE]),z=f&&!q?"motionBlur":e;k(D,z);if(M){r.drawCachedNodes(D,T.nondrag,c,L)}else{r.drawLayeredElements(D,T.nondrag,c,L)}r.debug&&r.drawDebugPoints(D,T.nondrag);!i&&!f&&(p[r.NODE]=!1)}if(!o&&(p[r.DRAG]||i||j[r.DRAG])){var q=f&&!j[r.DRAG]&&h!==1,D=n||(q?r.data.bufferContexts[r.MOTIONBLUR_BUFFER_DRAG]:d.contexts[r.DRAG]);k(D,f&&!q?"motionBlur":e);if(M){r.drawCachedNodes(D,T.drag,c,L)}else{r.drawCachedElements(D,T.drag,c,L)}r.debug&&r.drawDebugPoints(D,T.drag);!i&&!f&&(p[r.DRAG]=!1)}this.drawSelectionRectangle(t,k);if(f&&h!==1){var $=d.contexts[r.NODE],V=r.data.bufferCanvases[r.MOTIONBLUR_BUFFER_NODE],F=d.contexts[r.DRAG],W=r.data.bufferCanvases[r.MOTIONBLUR_BUFFER_DRAG],H=function e(t,a,n){t.setTransform(1,0,0,1,0,0);if(n||!m){t.clearRect(0,0,r.canvasWidth,r.canvasHeight)}else{I(t,0,0,r.canvasWidth,r.canvasHeight)}t.drawImage(a,0,0,r.canvasWidth*h,r.canvasHeight*h,0,0,r.canvasWidth,r.canvasHeight)};if(p[r.NODE]||j[r.NODE]){H($,V,j[r.NODE]);p[r.NODE]=!1}if(p[r.DRAG]||j[r.DRAG]){H(F,W,j[r.DRAG]);p[r.DRAG]=!1}}r.prevViewport=P;if(r.clearingMotionBlur){r.clearingMotionBlur=!1;r.motionBlurCleared=!0;r.motionBlur=!0}f&&(r.motionBlurTimeout=setTimeout(function(){r.motionBlurTimeout=null;r.clearedForMotionBlur[r.NODE]=!1;r.clearedForMotionBlur[r.DRAG]=!1;r.motionBlur=!1;r.clearingMotionBlur=!u;r.mbFrames=0;p[r.NODE]=!0;p[r.DRAG]=!0;r.redraw()},Ch));n||a.emit("render")};var Eh;Ph.drawSelectionRectangle=function(e,t){var r=this;var a=r.cy;var n=r.data;var i=a.style();var o=e.drawOnlyNodeLayer;var s=e.drawAllLayers;var l=n.canvasNeedsRedraw;var c=e.forcedContext;if(r.showFps||!o&&l[r.SELECT_BOX]&&!s){var d=c||n.contexts[r.SELECT_BOX];t(d);if(r.selection[4]==1&&(r.hoverData.selecting||r.touchData.selecting)){var p=r.cy.zoom(),u=i.core("selection-box-border-width").value/p;d.lineWidth=u;d.fillStyle="rgba("+i.core("selection-box-color").value[0]+","+i.core("selection-box-color").value[1]+","+i.core("selection-box-color").value[2]+","+i.core("selection-box-opacity").value+")";d.fillRect(r.selection[0],r.selection[1],r.selection[2]-r.selection[0],r.selection[3]-r.selection[1]);if(u>0){d.strokeStyle="rgba("+i.core("selection-box-border-color").value[0]+","+i.core("selection-box-border-color").value[1]+","+i.core("selection-box-border-color").value[2]+","+i.core("selection-box-opacity").value+")";d.strokeRect(r.selection[0],r.selection[1],r.selection[2]-r.selection[0],r.selection[3]-r.selection[1])}}if(n.bgActivePosistion&&!r.hoverData.selecting){var p=r.cy.zoom(),f=n.bgActivePosistion;d.fillStyle="rgba("+i.core("active-bg-color").value[0]+","+i.core("active-bg-color").value[1]+","+i.core("active-bg-color").value[2]+","+i.core("active-bg-opacity").value+")";d.beginPath();d.arc(f.x,f.y,i.core("active-bg-size").pfValue/p,0,2*Math.PI);d.fill()}var h=r.lastRedrawTime;if(r.showFps&&h){h=Math.round(h);var g=Math.round(1e3/h),y="1 frame = "+h+" ms = "+g+" fps";d.setTransform(1,0,0,1,0,0);d.fillStyle="rgba(255, 0, 0, 0.75)";d.strokeStyle="rgba(255, 0, 0, 0.75)";d.font="30px Arial";if(!Eh){var v=d.measureText(y);Eh=v.actualBoundingBoxAscent}d.fillText(y,0,Eh);var m=60;d.strokeRect(0,Eh+10,250,20);d.fillRect(0,Eh+10,250*Math.min(g/m,1),20)}s||(l[r.SELECT_BOX]=!1)}};function Th(e,t,r){var a=e.createShader(t);e.shaderSource(a,r);e.compileShader(a);if(!e.getShaderParameter(a,e.COMPILE_STATUS)){throw new Error(e.getShaderInfoLog(a))}return a}function Ih(e,t,r){var a=Th(e,e.VERTEX_SHADER,t);var n=Th(e,e.FRAGMENT_SHADER,r);var i=e.createProgram();e.attachShader(i,a);e.attachShader(i,n);e.linkProgram(i);if(!e.getProgramParameter(i,e.LINK_STATUS)){throw new Error("Could not initialize shaders")}return i}function kh(t,r,a){a===e&&(a=r);var n=t.makeOffscreenCanvas(r,a);var i=n.context=n.getContext("2d");n.clear=function(){return i.clearRect(0,0,n.width,n.height)};n.clear();return n}function Rh(e){var t=e.pixelRatio;var r=e.cy.zoom();var a=e.cy.pan();return{zoom:r*t,pan:{x:a.x*t,y:a.y*t}}}function Dh(e){var t=e.pixelRatio;var r=e.cy.zoom();return r*t}function Bh(e,t,r,a,n){var i=a*r+t.x;var o=n*r+t.y;o=Math.round(e.canvasHeight-o);return[i,o]}function Ah(e){if(e.pstyle("background-fill").value!=="solid")return!1;if(e.pstyle("background-image").strValue!=="none")return!1;if(e.pstyle("border-width").value===0)return!0;if(e.pstyle("border-opacity").value===0)return!0;if(e.pstyle("border-style").value!=="solid")return!1;return!0}function Oh(e,t){if(e.length!==t.length){return!1}for(var r=0;r<e.length;r++){if(e[r]!==t[r]){return!1}}return!0}function Lh(e,t,r){var a=e[0]/255;var n=e[1]/255;var i=e[2]/255;var o=r||new Array(4);o[0]=a*t;o[1]=n*t;o[2]=i*t;o[3]=t;return o}function Nh(e,t){var r=t||new Array(4);r[0]=(e>>0&255)/255;r[1]=(e>>8&255)/255;r[2]=(e>>16&255)/255;r[3]=(e>>24&255)/255;return r}function Mh(e){return e[0]+(e[1]<<8)+(e[2]<<16)+(e[3]<<24)}function jh(e,t){var r=e.createTexture();r.buffer=function(t){e.bindTexture(e.TEXTURE_2D,r);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_NEAREST);e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0);e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t);e.generateMipmap(e.TEXTURE_2D);e.bindTexture(e.TEXTURE_2D,null)};r.deleteTexture=function(){e.deleteTexture(r)};return r}function qh(e,t){switch(t){case"float":return[1,e.FLOAT,4];case"vec2":return[2,e.FLOAT,4];case"vec3":return[3,e.FLOAT,4];case"vec4":return[4,e.FLOAT,4];case"int":return[1,e.INT,4];case"ivec2":return[2,e.INT,4]}}function zh(e,t,r){switch(t){case e.FLOAT:return new Float32Array(r);case e.INT:return new Int32Array(r)}}function $h(e,t,r,a,n,i){switch(t){case e.FLOAT:return new Float32Array(r.buffer,i*a,n);case e.INT:return new Int32Array(r.buffer,i*a,n)}}function Vh(e,t,r,a){var n=qh(e,t),i=f(n,2),o=i[0],s=i[1];var l=zh(e,s,a);var c=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,c);e.bufferData(e.ARRAY_BUFFER,l,e.STATIC_DRAW);if(s===e.FLOAT){e.vertexAttribPointer(r,o,s,!1,0,0)}else s===e.INT&&e.vertexAttribIPointer(r,o,s,0,0);e.enableVertexAttribArray(r);e.bindBuffer(e.ARRAY_BUFFER,null);return c}function Fh(e,t,r,a){var n=qh(e,r),i=f(n,3),o=i[0],s=i[1],l=i[2];var c=zh(e,s,t*o);var d=o*l;var p=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,p);e.bufferData(e.ARRAY_BUFFER,t*d,e.DYNAMIC_DRAW);e.enableVertexAttribArray(a);if(s===e.FLOAT){e.vertexAttribPointer(a,o,s,!1,d,0)}else s===e.INT&&e.vertexAttribIPointer(a,o,s,d,0);e.vertexAttribDivisor(a,1);e.bindBuffer(e.ARRAY_BUFFER,null);var u=new Array(t);for(var h=0;h<t;h++){u[h]=$h(e,s,c,d,o,h)}p.dataArray=c;p.stride=d;p.size=o;p.getView=function(e){return u[e]};p.setPoint=function(e,t,r){var a=u[e];a[0]=t;a[1]=r};p.bufferSubData=function(t){e.bindBuffer(e.ARRAY_BUFFER,p);if(t){e.bufferSubData(e.ARRAY_BUFFER,0,c,0,t*o)}else{e.bufferSubData(e.ARRAY_BUFFER,0,c)}};return p}function Wh(e,t,r){var a=9;var n=new Float32Array(t*a);var i=new Array(t);for(var o=0;o<t;o++){var s=o*a*4;i[o]=new Float32Array(n.buffer,s,a)}var l=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,l);e.bufferData(e.ARRAY_BUFFER,n.byteLength,e.DYNAMIC_DRAW);for(var c=0;c<3;c++){var d=r+c;e.enableVertexAttribArray(d);e.vertexAttribPointer(d,3,e.FLOAT,!1,3*12,c*12);e.vertexAttribDivisor(d,1)}e.bindBuffer(e.ARRAY_BUFFER,null);l.getMatrixView=function(e){return i[e]};l.setData=function(e,t){i[t].set(e,0)};l.bufferSubData=function(){e.bindBuffer(e.ARRAY_BUFFER,l);e.bufferSubData(e.ARRAY_BUFFER,0,n)};return l}function Hh(e){var t=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,t);var r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE);e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);e.bindFramebuffer(e.FRAMEBUFFER,null);t.setFramebufferAttachmentSizes=function(t,a){e.bindTexture(e.TEXTURE_2D,r);e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t,a,0,e.RGBA,e.UNSIGNED_BYTE,null)};return t}var Xh=typeof Float32Array!=="undefined"?Float32Array:Array;Math.hypot||(Math.hypot=function(){var e=0,t=arguments.length;while(t--){e+=arguments[t]*arguments[t]}return Math.sqrt(e)});function Yh(){var e=new Xh(9);if(Xh!=Float32Array){e[1]=0;e[2]=0;e[3]=0;e[5]=0;e[6]=0;e[7]=0}e[0]=1;e[4]=1;e[8]=1;return e}function Gh(e){e[0]=1;e[1]=0;e[2]=0;e[3]=0;e[4]=1;e[5]=0;e[6]=0;e[7]=0;e[8]=1;return e}function Kh(e,t,r){var a=t[0],n=t[1],i=t[2];var o=t[3],s=t[4],l=t[5];var c=t[6],d=t[7],p=t[8];var u=r[0],f=r[1],h=r[2];var g=r[3],y=r[4],v=r[5];var m=r[6],b=r[7],x=r[8];e[0]=u*a+f*o+h*c;e[1]=u*n+f*s+h*d;e[2]=u*i+f*l+h*p;e[3]=g*a+y*o+v*c;e[4]=g*n+y*s+v*d;e[5]=g*i+y*l+v*p;e[6]=m*a+b*o+x*c;e[7]=m*n+b*s+x*d;e[8]=m*i+b*l+x*p;return e}function Uh(e,t,r){var a=t[0],n=t[1],i=t[2],o=t[3],s=t[4],l=t[5],c=t[6],d=t[7],p=t[8],u=r[0],f=r[1];e[0]=a;e[1]=n;e[2]=i;e[3]=o;e[4]=s;e[5]=l;e[6]=u*a+f*o+c;e[7]=u*n+f*s+d;e[8]=u*i+f*l+p;return e}function Qh(e,t,r){var a=t[0],n=t[1],i=t[2],o=t[3],s=t[4],l=t[5],c=t[6],d=t[7],p=t[8],u=Math.sin(r),f=Math.cos(r);e[0]=f*a+u*o;e[1]=f*n+u*s;e[2]=f*i+u*l;e[3]=f*o-u*a;e[4]=f*s-u*n;e[5]=f*l-u*i;e[6]=c;e[7]=d;e[8]=p;return e}function Zh(e,t,r){var a=r[0],n=r[1];e[0]=a*t[0];e[1]=a*t[1];e[2]=a*t[2];e[3]=n*t[3];e[4]=n*t[4];e[5]=n*t[5];e[6]=t[6];e[7]=t[7];e[8]=t[8];return e}function Jh(e,t,r){e[0]=2/t;e[1]=0;e[2]=0;e[3]=0;e[4]=-2/r;e[5]=0;e[6]=-1;e[7]=1;e[8]=1;return e}var eg=function(){function e(t,r,a,i){n(this,e);this.debugID=Math.floor(Math.random()*1e4);this.r=t;this.texSize=r;this.texRows=a;this.texHeight=Math.floor(r/a);this.enableWrapping=!0;this.locked=!1;this.texture=null;this.needsBuffer=!0;this.freePointer={x:0,row:0};this.keyToLocation=new Map;this.canvas=i(t,r,r);this.scratch=i(t,r,this.texHeight,"scratch")}return o(e,[{key:"lock",value:function e(){this.locked=!0}},{key:"getKeys",value:function e(){return new Set(this.keyToLocation.keys())}},{key:"getScale",value:function e(t){var r=t.w,a=t.h;var n=this.texHeight,i=this.texSize;var o=n/a;var s=r*o;var l=a*o;if(s>i){o=i/r;s=r*o;l=a*o}return{scale:o,texW:s,texH:l}}},{key:"draw",value:function e(t,r,a){var n=this;if(this.locked)throw new Error("can't draw, atlas is locked");var i=this.texSize,o=this.texRows,s=this.texHeight;var l=this.getScale(r),c=l.scale,d=l.texW,p=l.texH;var u=function e(t,n){if(a&&n){var i=n.context,o=t.x,l=t.row,d=o,p=s*l;i.save();i.translate(d,p);i.scale(c,c);a(i,r);i.restore()}};var f=[null,null];var h=function e(){u(n.freePointer,n.canvas);f[0]={x:n.freePointer.x,y:n.freePointer.row*s,w:d,h:p};f[1]={x:n.freePointer.x+d,y:n.freePointer.row*s,w:0,h:p};n.freePointer.x+=d;if(n.freePointer.x==i){n.freePointer.x=0;n.freePointer.row++}};var g=function e(){var t=n.scratch,r=n.canvas;t.clear();u({x:0,row:0},t);var a=i-n.freePointer.x;var o=d-a;{var l=n.freePointer.x,c=n.freePointer.row*s,h=a;r.context.drawImage(t,0,0,h,s,l,c,h,s);f[0]={x:l,y:c,w:h,h:p}}{var g=a,y=(n.freePointer.row+1)*s,v=o;r&&r.context.drawImage(t,g,0,v,s,0,y,v,s);f[1]={x:0,y:y,w:v,h:p}}n.freePointer.x=o;n.freePointer.row++};var y=function e(){n.freePointer.x=0;n.freePointer.row++};if(this.freePointer.x+d<=i){h()}else if(this.freePointer.row>=o-1){return!1}else if(this.freePointer.x===i){y();h()}else if(this.enableWrapping){g()}else{y();h()}this.keyToLocation.set(t,f);this.needsBuffer=!0;return f}},{key:"getOffsets",value:function e(t){return this.keyToLocation.get(t)}},{key:"isEmpty",value:function e(){return this.freePointer.x===0&&this.freePointer.row===0}},{key:"canFit",value:function e(t){if(this.locked)return!1;var r=this.texSize,a=this.texRows;var n=this.getScale(t),i=n.texW;if(this.freePointer.x+i>r){return this.freePointer.row<a-1}return!0}},{key:"bufferIfNeeded",value:function e(t){this.texture||(this.texture=jh(t,this.debugID));if(this.needsBuffer){this.texture.buffer(this.canvas);this.needsBuffer=!1;if(this.locked){this.canvas=null;this.scratch=null}}}},{key:"dispose",value:function e(){if(this.texture){this.texture.deleteTexture();this.texture=null}this.canvas=null;this.scratch=null;this.locked=!0}}])}();var tg=function(){function e(t,r,a,i){n(this,e);this.r=t;this.texSize=r;this.texRows=a;this.createTextureCanvas=i;this.atlases=[];this.styleKeyToAtlas=new Map;this.markedKeys=new Set}return o(e,[{key:"getKeys",value:function e(){return new Set(this.styleKeyToAtlas.keys())}},{key:"_createAtlas",value:function e(){var t=this.r,r=this.texSize,a=this.texRows,n=this.createTextureCanvas;return new eg(t,r,a,n)}},{key:"_getScratchCanvas",value:function e(){if(!this.scratch){var t=this.r,r=this.texSize,a=this.texRows,n=this.createTextureCanvas,i=Math.floor(r/a);this.scratch=n(t,r,i,"scratch")}return this.scratch}},{key:"draw",value:function e(t,r,a){var n=this.styleKeyToAtlas.get(t);if(!n){n=this.atlases[this.atlases.length-1];if(!n||!n.canFit(r)){n&&n.lock();n=this._createAtlas();this.atlases.push(n)}n.draw(t,r,a);this.styleKeyToAtlas.set(t,n)}return n}},{key:"getAtlas",value:function e(t){return this.styleKeyToAtlas.get(t)}},{key:"hasAtlas",value:function e(t){return this.styleKeyToAtlas.has(t)}},{key:"markKeyForGC",value:function e(t){this.markedKeys.add(t)}},{key:"gc",value:function e(){var t=this;var r=this.markedKeys;if(r.size===0){console.log("nothing to garbage collect");return}var a=[];var n=new Map;var i=null;var o=s(this.atlases),l;try{var c=function e(){var o=l.value;var c=o.getKeys();var d=rg(r,c);if(d.size===0){a.push(o);c.forEach(function(e){return n.set(e,o)});return 1}if(!i){i=t._createAtlas();a.push(i)}var p=s(c),u;try{for(p.s();!(u=p.n()).done;){var h=u.value;if(!d.has(h)){var g=o.getOffsets(h),y=f(g,2),v=y[0],m=y[1];if(!i.canFit({w:v.w+m.w,h:v.h})){i.lock();i=t._createAtlas();a.push(i)}if(o.canvas){t._copyTextureToNewAtlas(h,o,i);n.set(h,i)}}}}catch(e){p.e(e)}finally{p.f()}o.dispose()};for(o.s();!(l=o.n()).done;){if(c())continue}}catch(e){o.e(e)}finally{o.f()}this.atlases=a;this.styleKeyToAtlas=n;this.markedKeys=new Set}},{key:"_copyTextureToNewAtlas",value:function e(t,r,a){var n=r.getOffsets(t),i=f(n,2),o=i[0],s=i[1];if(s.w===0){a.draw(t,o,function(e){e.drawImage(r.canvas,o.x,o.y,o.w,o.h,0,0,o.w,o.h)})}else{var l=this._getScratchCanvas();l.clear();l.context.drawImage(r.canvas,o.x,o.y,o.w,o.h,0,0,o.w,o.h);l.context.drawImage(r.canvas,s.x,s.y,s.w,s.h,o.w,0,s.w,s.h);var c=o.w+s.w,d=o.h;a.draw(t,{w:c,h:d},function(e){e.drawImage(l,0,0,c,d,0,0,c,d)})}}},{key:"getCounts",value:function e(){return{keyCount:this.styleKeyToAtlas.size,atlasCount:new Set(this.styleKeyToAtlas.values()).size}}}])}();function rg(e,t){if(e.intersection)return e.intersection(t);else return new Set(h(e).filter(function(e){return t.has(e)}))}var ag=function(){function t(e,r){n(this,t);this.r=e;this.globalOptions=r;this.atlasSize=r.webglTexSize;this.maxAtlasesPerBatch=r.webglTexPerBatch;this.renderTypes=new Map;this.collections=new Map;this.typeAndIdToKey=new Map}return o(t,[{key:"getAtlasSize",value:function e(){return this.atlasSize}},{key:"addAtlasCollection",value:function e(t,r){var a=this.globalOptions,n=a.webglTexSize,i=a.createTextureCanvas;var o=r.texRows;var s=this._cacheScratchCanvas(i);var l=new tg(this.r,n,o,s);this.collections.set(t,l)}},{key:"addRenderType",value:function e(t,r){var a=r.collection;if(!this.collections.has(a))throw new Error("invalid atlas collection name '".concat(a,"'"));var n=this.collections.get(a);var i=oe({type:t,atlasCollection:n},r);this.renderTypes.set(t,i)}},{key:"getRenderTypeOpts",value:function e(t){return this.renderTypes.get(t)}},{key:"getAtlasCollection",value:function e(t){return this.collections.get(t)}},{key:"_cacheScratchCanvas",value:function e(t){var r=-1;var a=-1;var n=null;return function(e,i,o,s){if(s){if(!n||i!=r||o!=a){r=i;a=o;n=t(e,i,o)}return n}else{return t(e,i,o)}}}},{key:"_key",value:function e(t,r){return"".concat(t,"-").concat(r)}},{key:"invalidate",value:function t(r){var a=this;var n=arguments.length>1&&arguments[1]!==e?arguments[1]:{},i=n.forceRedraw,o=i===e?!1:i,l=n.filterEle,c=l===e?function(){return!0}:l,d=n.filterType,p=d===e?function(){return!0}:d;var u=!1;var f=!1;var h=s(r),g;try{for(h.s();!(g=h.n()).done;){var y=g.value;if(c(y)){var v=s(this.renderTypes.values()),m;try{var b=function t(){var r=m.value;var n=r.type;if(p(n)){var i=a.collections.get(r.collection),s=r.getKey(y),l=Array.isArray(s)?s:[s];if(o){l.forEach(function(e){return i.markKeyForGC(e)});f=!0}else{var c=r.getID?r.getID(y):y.id(),d=a._key(n,c),h=a.typeAndIdToKey.get(d);if(h!==e&&!Oh(l,h)){u=!0;a.typeAndIdToKey["delete"](d);h.forEach(function(e){return i.markKeyForGC(e)})}}}};for(v.s();!(m=v.n()).done;){b()}}catch(e){v.e(e)}finally{v.f()}}}}catch(e){h.e(e)}finally{h.f()}if(f){this.gc();u=!1}return u}},{key:"gc",value:function e(){var t=s(this.collections.values()),r;try{for(t.s();!(r=t.n()).done;){var a=r.value;a.gc()}}catch(e){t.e(e)}finally{t.f()}}},{key:"getOrCreateAtlas",value:function e(t,r,a,n){var i=this.renderTypes.get(r);var o=this.collections.get(i.collection);var s=!1;var l=o.draw(n,a,function(e){if(i.drawClipped){e.save();e.beginPath();e.rect(0,0,a.w,a.h);e.clip();i.drawElement(e,t,a,!0,!0);e.restore()}else{i.drawElement(e,t,a,!0,!0)}s=!0});if(s){var c=i.getID?i.getID(t):t.id(),d=this._key(r,c);if(this.typeAndIdToKey.has(d)){this.typeAndIdToKey.get(d).push(n)}else{this.typeAndIdToKey.set(d,[n])}}return l}},{key:"getAtlasInfo",value:function e(t,r){var a=this;var n=this.renderTypes.get(r);var i=n.getKey(t);var o=Array.isArray(i)?i:[i];return o.map(function(e){var i=n.getBoundingBox(t,e);var o=a.getOrCreateAtlas(t,r,i,e);var s=o.getOffsets(e),l=f(s,2),c=l[0],d=l[1];return{atlas:o,tex:c,tex1:c,tex2:d,bb:i}})}},{key:"getDebugInfo",value:function e(){var t=[];var r=s(this.collections),a;try{for(r.s();!(a=r.n()).done;){var n=f(a.value,2),i=n[0],o=n[1],l=o.getCounts(),c=l.keyCount,d=l.atlasCount;t.push({type:i,keyCount:c,atlasCount:d})}}catch(e){r.e(e)}finally{r.f()}return t}}])}();var ng=function(){function e(t){n(this,e);this.globalOptions=t;this.atlasSize=t.webglTexSize;this.maxAtlasesPerBatch=t.webglTexPerBatch;this.batchAtlases=[]}return o(e,[{key:"getMaxAtlasesPerBatch",value:function e(){return this.maxAtlasesPerBatch}},{key:"getAtlasSize",value:function e(){return this.atlasSize}},{key:"getIndexArray",value:function e(){return Array.from({length:this.maxAtlasesPerBatch},function(e,t){return t})}},{key:"startBatch",value:function e(){this.batchAtlases=[]}},{key:"getAtlasCount",value:function e(){return this.batchAtlases.length}},{key:"getAtlases",value:function e(){return this.batchAtlases}},{key:"canAddToCurrentBatch",value:function e(t){if(this.batchAtlases.length===this.maxAtlasesPerBatch){return this.batchAtlases.includes(t)}return!0}},{key:"getAtlasIndexForBatch",value:function e(t){var r=this.batchAtlases.indexOf(t);if(r<0){if(this.batchAtlases.length===this.maxAtlasesPerBatch){throw new Error("cannot add more atlases to batch")}this.batchAtlases.push(t);r=this.batchAtlases.length-1}return r}}])}();var ig="\n  float circleSD(vec2 p, float r) {\n    return distance(vec2(0), p) - r; // signed distance\n  }\n";var og="\n  float rectangleSD(vec2 p, vec2 b) {\n    vec2 d = abs(p)-b;\n    return distance(vec2(0),max(d,0.0)) + min(max(d.x,d.y),0.0);\n  }\n";var sg="\n  float roundRectangleSD(vec2 p, vec2 b, vec4 cr) {\n    cr.xy = (p.x > 0.0) ? cr.xy : cr.zw;\n    cr.x  = (p.y > 0.0) ? cr.x  : cr.y;\n    vec2 q = abs(p) - b + cr.x;\n    return min(max(q.x, q.y), 0.0) + distance(vec2(0), max(q, 0.0)) - cr.x;\n  }\n";var lg="\n  float ellipseSD(vec2 p, vec2 ab) {\n    p = abs( p ); // symmetry\n\n    // find root with Newton solver\n    vec2 q = ab*(p-ab);\n    float w = (q.x<q.y)? 1.570796327 : 0.0;\n    for( int i=0; i<5; i++ ) {\n      vec2 cs = vec2(cos(w),sin(w));\n      vec2 u = ab*vec2( cs.x,cs.y);\n      vec2 v = ab*vec2(-cs.y,cs.x);\n      w = w + dot(p-u,v)/(dot(p-u,u)+dot(v,v));\n    }\n    \n    // compute final point and distance\n    float d = length(p-ab*vec2(cos(w),sin(w)));\n    \n    // return signed distance\n    return (dot(p/ab,p/ab)>1.0) ? d : -d;\n  }\n";var cg={SCREEN:{name:"screen",screen:!0},PICKING:{name:"picking",picking:!0}};var dg={IGNORE:1,USE_BB:2};var pg=0;var ug=1;var fg=2;var hg=3;var gg=4;var yg=5;var vg=6;var mg=7;var bg=function(){function t(e,r,a){n(this,t);this.r=e;this.gl=r;this.maxInstances=a.webglBatchSize;this.atlasSize=a.webglTexSize;this.bgColor=a.bgColor;this.debug=a.webglDebug;this.batchDebugInfo=[];a.enableWrapping=!0;a.createTextureCanvas=kh;this.atlasManager=new ag(e,a);this.batchManager=new ng(a);this.simpleShapeOptions=new Map;this.program=this._createShaderProgram(cg.SCREEN);this.pickingProgram=this._createShaderProgram(cg.PICKING);this.vao=this._createVAO()}return o(t,[{key:"addAtlasCollection",value:function e(t,r){this.atlasManager.addAtlasCollection(t,r)}},{key:"addTextureAtlasRenderType",value:function e(t,r){this.atlasManager.addRenderType(t,r)}},{key:"addSimpleShapeRenderType",value:function e(t,r){this.simpleShapeOptions.set(t,r)}},{key:"invalidate",value:function t(r){var a=arguments.length>1&&arguments[1]!==e?arguments[1]:{},n=a.type;var i=this.atlasManager;if(n){return i.invalidate(r,{filterType:function e(t){return t===n},forceRedraw:!0})}else{return i.invalidate(r)}}},{key:"gc",value:function e(){this.atlasManager.gc()}},{key:"_createShaderProgram",value:function e(t){var r=this.gl;var a="#version 300 es\n      precision highp float;\n\n      uniform mat3 uPanZoomMatrix;\n      uniform int  uAtlasSize;\n      \n      // instanced\n      in vec2 aPosition; // a vertex from the unit square\n      \n      in mat3 aTransform; // used to transform verticies, eg into a bounding box\n      in int aVertType; // the type of thing we are rendering\n\n      // the z-index that is output when using picking mode\n      in vec4 aIndex;\n      \n      // For textures\n      in int aAtlasId; // which shader unit/atlas to use\n      in vec4 aTex; // x/y/w/h of texture in atlas\n\n      // for edges\n      in vec4 aPointAPointB;\n      in vec4 aPointCPointD;\n      in vec2 aLineWidth; // also used for node border width\n\n      // simple shapes\n      in vec4 aCornerRadius; // for round-rectangle [top-right, bottom-right, top-left, bottom-left]\n      in vec4 aColor; // also used for edges\n      in vec4 aBorderColor; // aLineWidth is used for border width\n\n      // output values passed to the fragment shader\n      out vec2 vTexCoord;\n      out vec4 vColor;\n      out vec2 vPosition;\n      // flat values are not interpolated\n      flat out int vAtlasId; \n      flat out int vVertType;\n      flat out vec2 vTopRight;\n      flat out vec2 vBotLeft;\n      flat out vec4 vCornerRadius;\n      flat out vec4 vBorderColor;\n      flat out vec2 vBorderWidth;\n      flat out vec4 vIndex;\n      \n      void main(void) {\n        int vid = gl_VertexID;\n        vec2 position = aPosition; // TODO make this a vec3, simplifies some code below\n\n        if(aVertType == ".concat(pg,") {\n          float texX = aTex.x; // texture coordinates\n          float texY = aTex.y;\n          float texW = aTex.z;\n          float texH = aTex.w;\n\n          if(vid == 1 || vid == 2 || vid == 4) {\n            texX += texW;\n          }\n          if(vid == 2 || vid == 4 || vid == 5) {\n            texY += texH;\n          }\n\n          float d = float(uAtlasSize);\n          vTexCoord = vec2(texX / d, texY / d); // tex coords must be between 0 and 1\n\n          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);\n        }\n        else if(aVertType == ").concat(gg," || aVertType == ").concat(mg," \n             || aVertType == ").concat(yg," || aVertType == ").concat(vg,") { // simple shapes\n\n          // the bounding box is needed by the fragment shader\n          vBotLeft  = (aTransform * vec3(0, 0, 1)).xy; // flat\n          vTopRight = (aTransform * vec3(1, 1, 1)).xy; // flat\n          vPosition = (aTransform * vec3(position, 1)).xy; // will be interpolated\n\n          // calculations are done in the fragment shader, just pass these along\n          vColor = aColor;\n          vCornerRadius = aCornerRadius;\n          vBorderColor = aBorderColor;\n          vBorderWidth = aLineWidth;\n\n          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);\n        }\n        else if(aVertType == ").concat(ug,") {\n          vec2 source = aPointAPointB.xy;\n          vec2 target = aPointAPointB.zw;\n\n          // adjust the geometry so that the line is centered on the edge\n          position.y = position.y - 0.5;\n\n          // stretch the unit square into a long skinny rectangle\n          vec2 xBasis = target - source;\n          vec2 yBasis = normalize(vec2(-xBasis.y, xBasis.x));\n          vec2 point = source + xBasis * position.x + yBasis * aLineWidth[0] * position.y;\n\n          gl_Position = vec4(uPanZoomMatrix * vec3(point, 1.0), 1.0);\n          vColor = aColor;\n        } \n        else if(aVertType == ").concat(fg,") {\n          vec2 pointA = aPointAPointB.xy;\n          vec2 pointB = aPointAPointB.zw;\n          vec2 pointC = aPointCPointD.xy;\n          vec2 pointD = aPointCPointD.zw;\n\n          // adjust the geometry so that the line is centered on the edge\n          position.y = position.y - 0.5;\n\n          vec2 p0, p1, p2, pos;\n          if(position.x == 0.0) { // The left side of the unit square\n            p0 = pointA;\n            p1 = pointB;\n            p2 = pointC;\n            pos = position;\n          } else { // The right side of the unit square, use same approach but flip the geometry upside down\n            p0 = pointD;\n            p1 = pointC;\n            p2 = pointB;\n            pos = vec2(0.0, -position.y);\n          }\n\n          vec2 p01 = p1 - p0;\n          vec2 p12 = p2 - p1;\n          vec2 p21 = p1 - p2;\n\n          // Find the normal vector.\n          vec2 tangent = normalize(normalize(p12) + normalize(p01));\n          vec2 normal = vec2(-tangent.y, tangent.x);\n\n          // Find the vector perpendicular to p0 -> p1.\n          vec2 p01Norm = normalize(vec2(-p01.y, p01.x));\n\n          // Determine the bend direction.\n          float sigma = sign(dot(p01 + p21, normal));\n          float width = aLineWidth[0];\n\n          if(sign(pos.y) == -sigma) {\n            // This is an intersecting vertex. Adjust the position so that there's no overlap.\n            vec2 point = 0.5 * width * normal * -sigma / dot(normal, p01Norm);\n            gl_Position = vec4(uPanZoomMatrix * vec3(p1 + point, 1.0), 1.0);\n          } else {\n            // This is a non-intersecting vertex. Treat it like a mitre join.\n            vec2 point = 0.5 * width * normal * sigma * dot(normal, p01Norm);\n            gl_Position = vec4(uPanZoomMatrix * vec3(p1 + point, 1.0), 1.0);\n          }\n\n          vColor = aColor;\n        } \n        else if(aVertType == ").concat(hg," && vid < 3) {\n          // massage the first triangle into an edge arrow\n          if(vid == 0)\n            position = vec2(-0.15, -0.3);\n          if(vid == 1)\n            position = vec2(  0.0,  0.0);\n          if(vid == 2)\n            position = vec2( 0.15, -0.3);\n\n          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);\n          vColor = aColor;\n        }\n        else {\n          gl_Position = vec4(2.0, 0.0, 0.0, 1.0); // discard vertex by putting it outside webgl clip space\n        }\n\n        vAtlasId = aAtlasId;\n        vVertType = aVertType;\n        vIndex = aIndex;\n      }\n    ")
var n=this.batchManager.getIndexArray();var i="#version 300 es\n      precision highp float;\n\n      // declare texture unit for each texture atlas in the batch\n      ".concat(n.map(function(e){return"uniform sampler2D uTexture".concat(e,";")}).join("\n\t"),"\n\n      uniform vec4 uBGColor;\n      uniform float uZoom;\n\n      in vec2 vTexCoord;\n      in vec4 vColor;\n      in vec2 vPosition; // model coordinates\n\n      flat in int vAtlasId;\n      flat in vec4 vIndex;\n      flat in int vVertType;\n      flat in vec2 vTopRight;\n      flat in vec2 vBotLeft;\n      flat in vec4 vCornerRadius;\n      flat in vec4 vBorderColor;\n      flat in vec2 vBorderWidth;\n\n      out vec4 outColor;\n\n      ").concat(ig,"\n      ").concat(og,"\n      ").concat(sg,"\n      ").concat(lg,"\n\n      vec4 blend(vec4 top, vec4 bot) { // blend colors with premultiplied alpha\n        return vec4( \n          top.rgb + (bot.rgb * (1.0 - top.a)),\n          top.a   + (bot.a   * (1.0 - top.a)) \n        );\n      }\n\n      vec4 distInterp(vec4 cA, vec4 cB, float d) { // interpolate color using Signed Distance\n        // scale to the zoom level so that borders don't look blurry when zoomed in\n        // note 1.5 is an aribitrary value chosen because it looks good\n        return mix(cA, cB, 1.0 - smoothstep(0.0, 1.5 / uZoom, abs(d))); \n      }\n\n      void main(void) {\n        if(vVertType == ").concat(pg,") {\n          // look up the texel from the texture unit\n          ").concat(n.map(function(e){return"if(vAtlasId == ".concat(e,") outColor = texture(uTexture").concat(e,", vTexCoord);")}).join("\n\telse "),"\n        } \n        else if(vVertType == ").concat(hg,") {\n          // mimics how canvas renderer uses context.globalCompositeOperation = 'destination-out';\n          outColor = blend(vColor, uBGColor);\n          outColor.a = 1.0; // make opaque, masks out line under arrow\n        }\n        else if(vVertType == ").concat(gg," && vBorderWidth == vec2(0.0)) { // simple rectangle with no border\n          outColor = vColor; // unit square is already transformed to the rectangle, nothing else needs to be done\n        }\n        else if(vVertType == ").concat(gg," || vVertType == ").concat(mg," \n          || vVertType == ").concat(yg," || vVertType == ").concat(vg,") { // use SDF\n\n          float outerBorder = vBorderWidth[0];\n          float innerBorder = vBorderWidth[1];\n          float borderPadding = outerBorder * 2.0;\n          float w = vTopRight.x - vBotLeft.x - borderPadding;\n          float h = vTopRight.y - vBotLeft.y - borderPadding;\n          vec2 b = vec2(w/2.0, h/2.0); // half width, half height\n          vec2 p = vPosition - vec2(vTopRight.x - b[0] - outerBorder, vTopRight.y - b[1] - outerBorder); // translate to center\n\n          float d; // signed distance\n          if(vVertType == ").concat(gg,") {\n            d = rectangleSD(p, b);\n          } else if(vVertType == ").concat(mg," && w == h) {\n            d = circleSD(p, b.x); // faster than ellipse\n          } else if(vVertType == ").concat(mg,") {\n            d = ellipseSD(p, b);\n          } else {\n            d = roundRectangleSD(p, b, vCornerRadius.wzyx);\n          }\n\n          // use the distance to interpolate a color to smooth the edges of the shape, doesn't need multisampling\n          // we must smooth colors inwards, because we can't change pixels outside the shape's bounding box\n          if(d > 0.0) {\n            if(d > outerBorder) {\n              discard;\n            } else {\n              outColor = distInterp(vBorderColor, vec4(0), d - outerBorder);\n            }\n          } else {\n            if(d > innerBorder) {\n              vec4 outerColor = outerBorder == 0.0 ? vec4(0) : vBorderColor;\n              vec4 innerBorderColor = blend(vBorderColor, vColor);\n              outColor = distInterp(innerBorderColor, outerColor, d);\n            } \n            else {\n              vec4 outerColor;\n              if(innerBorder == 0.0 && outerBorder == 0.0) {\n                outerColor = vec4(0);\n              } else if(innerBorder == 0.0) {\n                outerColor = vBorderColor;\n              } else {\n                outerColor = blend(vBorderColor, vColor);\n              }\n              outColor = distInterp(vColor, outerColor, d - innerBorder);\n            }\n          }\n        }\n        else {\n          outColor = vColor;\n        }\n\n        ").concat(t.picking?"if(outColor.a == 0.0) discard;\n             else outColor = vIndex;":"","\n      }\n    ");var o=Ih(r,a,i);o.aPosition=r.getAttribLocation(o,"aPosition");o.aIndex=r.getAttribLocation(o,"aIndex");o.aVertType=r.getAttribLocation(o,"aVertType");o.aTransform=r.getAttribLocation(o,"aTransform");o.aAtlasId=r.getAttribLocation(o,"aAtlasId");o.aTex=r.getAttribLocation(o,"aTex");o.aPointAPointB=r.getAttribLocation(o,"aPointAPointB");o.aPointCPointD=r.getAttribLocation(o,"aPointCPointD");o.aLineWidth=r.getAttribLocation(o,"aLineWidth");o.aColor=r.getAttribLocation(o,"aColor");o.aCornerRadius=r.getAttribLocation(o,"aCornerRadius");o.aBorderColor=r.getAttribLocation(o,"aBorderColor");o.uPanZoomMatrix=r.getUniformLocation(o,"uPanZoomMatrix");o.uAtlasSize=r.getUniformLocation(o,"uAtlasSize");o.uBGColor=r.getUniformLocation(o,"uBGColor");o.uZoom=r.getUniformLocation(o,"uZoom");o.uTextures=[];for(var s=0;s<this.batchManager.getMaxAtlasesPerBatch();s++){o.uTextures.push(r.getUniformLocation(o,"uTexture".concat(s)))}return o}},{key:"_createVAO",value:function e(){var t=[0,0,1,0,1,1,0,0,1,1,0,1];this.vertexCount=t.length/2;var r=this.maxInstances;var a=this.gl,n=this.program;var i=a.createVertexArray();a.bindVertexArray(i);Vh(a,"vec2",n.aPosition,t);this.transformBuffer=Wh(a,r,n.aTransform);this.indexBuffer=Fh(a,r,"vec4",n.aIndex);this.vertTypeBuffer=Fh(a,r,"int",n.aVertType);this.atlasIdBuffer=Fh(a,r,"int",n.aAtlasId);this.texBuffer=Fh(a,r,"vec4",n.aTex);this.pointAPointBBuffer=Fh(a,r,"vec4",n.aPointAPointB);this.pointCPointDBuffer=Fh(a,r,"vec4",n.aPointCPointD);this.lineWidthBuffer=Fh(a,r,"vec2",n.aLineWidth);this.colorBuffer=Fh(a,r,"vec4",n.aColor);this.cornerRadiusBuffer=Fh(a,r,"vec4",n.aCornerRadius);this.borderColorBuffer=Fh(a,r,"vec4",n.aBorderColor);a.bindVertexArray(null);return i}},{key:"buffers",get:function e(){var t=this;this._buffers||(this._buffers=Object.keys(this).filter(function(e){return U(e,"Buffer")}).map(function(e){return t[e]}));return this._buffers}},{key:"startFrame",value:function t(r){var a=arguments.length>1&&arguments[1]!==e?arguments[1]:cg.SCREEN;this.panZoomMatrix=r;this.renderTarget=a;this.batchDebugInfo=[];this.wrappedCount=0;this.simpleCount=0;this.startBatch()}},{key:"startBatch",value:function e(){this.instanceCount=0;this.batchManager.startBatch()}},{key:"endFrame",value:function e(){this.endBatch()}},{key:"_isVisible",value:function e(t,r){if(t.visible()){if(r&&r.isVisible){return r.isVisible(t)}return!0}return!1}},{key:"drawTexture",value:function e(t,r,a){var n=this.atlasManager,i=this.batchManager;var o=n.getRenderTypeOpts(a);if(!this._isVisible(t,o)){return}if(t.isEdge()&&!this._isValidEdge(t)){return}if(this.renderTarget.picking&&o.getTexPickingMode){var l=o.getTexPickingMode(t);if(l===dg.IGNORE){return}else if(l==dg.USE_BB){this.drawPickingRectangle(t,r,a);return}}var c=n.getAtlasInfo(t,a);var d=s(c),p;try{for(d.s();!(p=d.n()).done;){var u=p.value,h=u.atlas,g=u.tex1,y=u.tex2;i.canAddToCurrentBatch(h)||this.endBatch();var v=i.getAtlasIndexForBatch(h);for(var m=0,b=[[g,!0],[y,!1]];m<b.length;m++){var x=f(b[m],2),_=x[0],w=x[1];if(_.w!=0){var S=this.instanceCount;this.vertTypeBuffer.getView(S)[0]=pg;var P=this.indexBuffer.getView(S);Nh(r,P);var C=this.atlasIdBuffer.getView(S);C[0]=v;var E=this.texBuffer.getView(S);E[0]=_.x;E[1]=_.y;E[2]=_.w;E[3]=_.h;var T=this.transformBuffer.getMatrixView(S);this.setTransformMatrix(t,T,o,u,w);this.instanceCount++;w||this.wrappedCount++;this.instanceCount>=this.maxInstances&&this.endBatch()}}}}catch(e){d.e(e)}finally{d.f()}}},{key:"setTransformMatrix",value:function t(r,a,n,i){var o=arguments.length>4&&arguments[4]!==e?arguments[4]:!0;var s=0;n.shapeProps&&n.shapeProps.padding&&(s=r.pstyle(n.shapeProps.padding).pfValue);if(i){var l=i.bb,c=i.tex1,d=i.tex2,p=c.w/(c.w+d.w);o||(p=1-p);var u=this._getAdjustedBB(l,s,o,p);this._applyTransformMatrix(a,u,n,r)}else{var f=n.getBoundingBox(r),h=this._getAdjustedBB(f,s,!0,1);this._applyTransformMatrix(a,h,n,r)}}},{key:"_applyTransformMatrix",value:function e(t,r,a,n){var i,o;Gh(t);var s=a.getRotation?a.getRotation(n):0;if(s!==0){var l=a.getRotationPoint(n),c=l.x,d=l.y;Uh(t,t,[c,d]);Qh(t,t,s);var p=a.getRotationOffset(n);i=p.x+(r.xOffset||0);o=p.y+(r.yOffset||0)}else{i=r.x1;o=r.y1}Uh(t,t,[i,o]);Zh(t,t,[r.w,r.h])}},{key:"_getAdjustedBB",value:function e(t,r,a,n){var i=t.x1,o=t.y1,s=t.w,l=t.h,c=t.yOffset;if(r){i-=r;o-=r;s+=2*r;l+=2*r}var d=0;var p=s*n;if(a&&n<1){s=p}else if(!a&&n<1){d=s-p;i+=d;s=p}return{x1:i,y1:o,w:s,h:l,xOffset:d,yOffset:c}}},{key:"drawPickingRectangle",value:function e(t,r,a){var n=this.atlasManager.getRenderTypeOpts(a);var i=this.instanceCount;this.vertTypeBuffer.getView(i)[0]=gg;var o=this.indexBuffer.getView(i);Nh(r,o);var s=this.colorBuffer.getView(i);Lh([0,0,0],1,s);var l=this.transformBuffer.getMatrixView(i);this.setTransformMatrix(t,l,n);this.simpleCount++;this.instanceCount++;this.instanceCount>=this.maxInstances&&this.endBatch()}},{key:"drawNode",value:function t(r,a,n){var i=this.simpleShapeOptions.get(n);if(!this._isVisible(r,i)){return}var o=i.shapeProps;var s=this._getVertTypeForShape(r,o.shape);if(s===e||i.isSimple&&!i.isSimple(r)){this.drawTexture(r,a,n);return}var l=this.instanceCount;this.vertTypeBuffer.getView(l)[0]=s;if(s===yg||s===vg){var c=i.getBoundingBox(r),d=this._getCornerRadius(r,o.radius,c),p=this.cornerRadiusBuffer.getView(l);p[0]=d;p[1]=d;p[2]=d;p[3]=d;if(s===vg){p[0]=0;p[2]=0}}var u=this.indexBuffer.getView(l);Nh(a,u);var f=r.pstyle(o.color).value;var h=r.pstyle(o.opacity).value;var g=this.colorBuffer.getView(l);Lh(f,h,g);var y=this.lineWidthBuffer.getView(l);y[0]=0;y[1]=0;if(o.border){var v=r.pstyle("border-width").value;if(v>0){var m=r.pstyle("border-color").value,b=r.pstyle("border-opacity").value,x=this.borderColorBuffer.getView(l);Lh(m,b,x);var _=r.pstyle("border-position").value;if(_==="inside"){y[0]=0;y[1]=-v}else if(_==="outside"){y[0]=v;y[1]=0}else{var w=v/2;y[0]=w;y[1]=-w}}}var S=this.transformBuffer.getMatrixView(l);this.setTransformMatrix(r,S,i);this.simpleCount++;this.instanceCount++;this.instanceCount>=this.maxInstances&&this.endBatch()}},{key:"_getVertTypeForShape",value:function t(r,a){var n=r.pstyle(a).value;switch(n){case"rectangle":return gg;case"ellipse":return mg;case"roundrectangle":case"round-rectangle":return yg;case"bottom-round-rectangle":return vg;default:return e}}},{key:"_getCornerRadius",value:function e(t,r,a){var n=a.w,i=a.h;if(t.pstyle(r).value==="auto"){return Da(n,i)}else{var o=t.pstyle(r).pfValue,s=n/2,l=i/2;return Math.min(o,l,s)}}},{key:"drawEdgeArrow",value:function e(t,r,a){if(!t.visible()){return}var n=t._private.rscratch;var i,o,s;if(a==="source"){i=n.arrowStartX;o=n.arrowStartY;s=n.srcArrowAngle}else{i=n.arrowEndX;o=n.arrowEndY;s=n.tgtArrowAngle}if(isNaN(i)||i==null||isNaN(o)||o==null||isNaN(s)||s==null){return}var l=t.pstyle(a+"-arrow-shape").value;if(l==="none"){return}var c=t.pstyle(a+"-arrow-color").value;var d=t.pstyle("opacity").value;var p=t.pstyle("line-opacity").value;var u=d*p;var f=t.pstyle("width").pfValue;var h=t.pstyle("arrow-scale").value;var g=this.r.getArrowWidth(f,h);var y=this.instanceCount;var v=this.transformBuffer.getMatrixView(y);Gh(v);Uh(v,v,[i,o]);Zh(v,v,[g,g]);Qh(v,v,s);this.vertTypeBuffer.getView(y)[0]=hg;var m=this.indexBuffer.getView(y);Nh(r,m);var b=this.colorBuffer.getView(y);Lh(c,u,b);this.instanceCount++;this.instanceCount>=this.maxInstances&&this.endBatch()}},{key:"drawEdgeLine",value:function e(t,r){if(!t.visible()){return}var a=this._getEdgePoints(t);if(!a){return}var n=t.pstyle("opacity").value;var i=t.pstyle("line-opacity").value;var o=t.pstyle("width").pfValue;var s=t.pstyle("line-color").value;var l=n*i;a.length/2+this.instanceCount>this.maxInstances&&this.endBatch();if(a.length==4){var c=this.instanceCount;this.vertTypeBuffer.getView(c)[0]=ug;var d=this.indexBuffer.getView(c);Nh(r,d);var p=this.colorBuffer.getView(c);Lh(s,l,p);var u=this.lineWidthBuffer.getView(c);u[0]=o;var f=this.pointAPointBBuffer.getView(c);f[0]=a[0];f[1]=a[1];f[2]=a[2];f[3]=a[3];this.instanceCount++;this.instanceCount>=this.maxInstances&&this.endBatch()}else{for(var h=0;h<a.length-2;h+=2){var g=this.instanceCount;this.vertTypeBuffer.getView(g)[0]=fg;var y=this.indexBuffer.getView(g);Nh(r,y);var v=this.colorBuffer.getView(g);Lh(s,l,v);var m=this.lineWidthBuffer.getView(g);m[0]=o;var b=a[h-2],x=a[h-1],_=a[h],w=a[h+1],S=a[h+2],P=a[h+3],C=a[h+4],E=a[h+5];if(h==0){b=2*_-S+.001;x=2*w-P+.001}if(h==a.length-4){C=2*S-_+.001;E=2*P-w+.001}var T=this.pointAPointBBuffer.getView(g);T[0]=b;T[1]=x;T[2]=_;T[3]=w;var I=this.pointCPointDBuffer.getView(g);I[0]=S;I[1]=P;I[2]=C;I[3]=E;this.instanceCount++;this.instanceCount>=this.maxInstances&&this.endBatch()}}}},{key:"_isValidEdge",value:function e(t){var r=t._private.rscratch;if(r.badLine||r.allpts==null||isNaN(r.allpts[0])){return!1}return!0}},{key:"_getEdgePoints",value:function e(t){var r=t._private.rscratch;if(!this._isValidEdge(t)){return}var a=r.allpts;if(a.length==4){return a}var n=this._getNumSegments(t);return this._getCurveSegmentPoints(a,n)}},{key:"_getNumSegments",value:function e(t){var r=15;return Math.min(Math.max(r,5),this.maxInstances)}},{key:"_getCurveSegmentPoints",value:function e(t,r){if(t.length==4){return t}var a=Array((r+1)*2);for(var n=0;n<=r;n++){if(n==0){a[0]=t[0];a[1]=t[1]}else if(n==r){a[n*2]=t[t.length-2];a[n*2+1]=t[t.length-1]}else{var i=n/r;this._setCurvePoint(t,i,a,n*2)}}return a}},{key:"_setCurvePoint",value:function e(t,r,a,n){if(t.length<=2){a[n]=t[0];a[n+1]=t[1]}else{var i=Array(t.length-2);for(var o=0;o<i.length;o+=2){var s=(1-r)*t[o]+r*t[o+2],l=(1-r)*t[o+1]+r*t[o+3];i[o]=s;i[o+1]=l}return this._setCurvePoint(i,r,a,n)}}},{key:"endBatch",value:function e(){var t=this.gl,r=this.vao,a=this.vertexCount,n=this.instanceCount;if(n===0)return;var i=this.renderTarget.picking?this.pickingProgram:this.program;t.useProgram(i);t.bindVertexArray(r);var o=s(this.buffers),l;try{for(o.s();!(l=o.n()).done;){var c=l.value;c.bufferSubData(n)}}catch(e){o.e(e)}finally{o.f()}var d=this.batchManager.getAtlases();for(var p=0;p<d.length;p++){d[p].bufferIfNeeded(t)}for(var u=0;u<d.length;u++){t.activeTexture(t.TEXTURE0+u);t.bindTexture(t.TEXTURE_2D,d[u].texture);t.uniform1i(i.uTextures[u],u)}t.uniform1f(i.uZoom,Dh(this.r));t.uniformMatrix3fv(i.uPanZoomMatrix,!1,this.panZoomMatrix);t.uniform1i(i.uAtlasSize,this.batchManager.getAtlasSize());var f=Lh(this.bgColor,1);t.uniform4fv(i.uBGColor,f);t.drawArraysInstanced(t.TRIANGLES,0,a,n);t.bindVertexArray(null);t.bindTexture(t.TEXTURE_2D,null);this.debug&&this.batchDebugInfo.push({count:n,atlasCount:d.length});this.startBatch()}},{key:"getDebugInfo",value:function e(){var t=this.atlasManager.getDebugInfo();var r=t.reduce(function(e,t){return e+t.atlasCount},0);var a=this.batchDebugInfo;var n=a.reduce(function(e,t){return e+t.count},0);return{atlasInfo:t,totalAtlases:r,wrappedCount:this.wrappedCount,simpleCount:this.simpleCount,batchCount:a.length,batchInfo:a,totalInstances:n}}}])}();var xg={};xg.initWebgl=function(e,t){var r=this;var a=r.data.contexts[r.WEBGL];e.bgColor=_g(r);e.webglTexSize=Math.min(e.webglTexSize,a.getParameter(a.MAX_TEXTURE_SIZE));e.webglTexRows=Math.min(e.webglTexRows,54);e.webglTexRowsNodes=Math.min(e.webglTexRowsNodes,54);e.webglBatchSize=Math.min(e.webglBatchSize,16384);e.webglTexPerBatch=Math.min(e.webglTexPerBatch,a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS));r.webglDebug=e.webglDebug;r.webglDebugShowAtlases=e.webglDebugShowAtlases;r.pickingFrameBuffer=Hh(a);r.pickingFrameBuffer.needsDraw=!0;r.drawing=new bg(r,a,e);var n=function e(t){return function(e){return r.getTextAngle(e,t)}};var i=function e(t){return function(e){var r=e.pstyle(t);return r&&r.value}};var o=function e(t){return function(e){return e.pstyle("".concat(t,"-opacity")).value>0}};var s=function e(t){var r=t.pstyle("text-events").strValue==="yes";return r?dg.USE_BB:dg.IGNORE};var l=function e(t){var r=t.position(),a=r.x,n=r.y;var i=t.outerWidth();var o=t.outerHeight();return{w:i,h:o,x1:a-i/2,y1:n-o/2}};r.drawing.addAtlasCollection("node",{texRows:e.webglTexRowsNodes});r.drawing.addAtlasCollection("label",{texRows:e.webglTexRows});r.drawing.addTextureAtlasRenderType("node-body",{collection:"node",getKey:t.getStyleKey,getBoundingBox:t.getElementBox,drawElement:t.drawElement});r.drawing.addSimpleShapeRenderType("node-body",{getBoundingBox:l,isSimple:Ah,shapeProps:{shape:"shape",color:"background-color",opacity:"background-opacity",radius:"corner-radius",border:!0}});r.drawing.addSimpleShapeRenderType("node-overlay",{getBoundingBox:l,isVisible:o("overlay"),shapeProps:{shape:"overlay-shape",color:"overlay-color",opacity:"overlay-opacity",padding:"overlay-padding",radius:"overlay-corner-radius"}});r.drawing.addSimpleShapeRenderType("node-underlay",{getBoundingBox:l,isVisible:o("underlay"),shapeProps:{shape:"underlay-shape",color:"underlay-color",opacity:"underlay-opacity",padding:"underlay-padding",radius:"underlay-corner-radius"}});r.drawing.addTextureAtlasRenderType("label",{collection:"label",getTexPickingMode:s,getKey:Sg(t.getLabelKey,null),getBoundingBox:Pg(t.getLabelBox,null),drawClipped:!0,drawElement:t.drawLabel,getRotation:n(null),getRotationPoint:t.getLabelRotationPoint,getRotationOffset:t.getLabelRotationOffset,isVisible:i("label")});r.drawing.addTextureAtlasRenderType("edge-source-label",{collection:"label",getTexPickingMode:s,getKey:Sg(t.getSourceLabelKey,"source"),getBoundingBox:Pg(t.getSourceLabelBox,"source"),drawClipped:!0,drawElement:t.drawSourceLabel,getRotation:n("source"),getRotationPoint:t.getSourceLabelRotationPoint,getRotationOffset:t.getSourceLabelRotationOffset,isVisible:i("source-label")});r.drawing.addTextureAtlasRenderType("edge-target-label",{collection:"label",getTexPickingMode:s,getKey:Sg(t.getTargetLabelKey,"target"),getBoundingBox:Pg(t.getTargetLabelBox,"target"),drawClipped:!0,drawElement:t.drawTargetLabel,getRotation:n("target"),getRotationPoint:t.getTargetLabelRotationPoint,getRotationOffset:t.getTargetLabelRotationOffset,isVisible:i("target-label")});var c=ot(function(){console.log("garbage collect flag set");r.data.gc=!0},1e4);r.onUpdateEleCalcs(function(e,t){var a=!1;t&&t.length>0&&(a|=r.drawing.invalidate(t));a&&c()});Cg(r)};function _g(e){var t=e.cy.container();var r=t&&t.style&&t.style.backgroundColor||"white";return pe(r)}function wg(e,t){var r=e._private.rscratch;return Gt(r,"labelWrapCachedLines",t)||[]}var Sg=function e(t,r){return function(e){var a=t(e);var n=wg(e,r);if(n.length>1){return n.map(function(e,t){return"".concat(a,"_").concat(t)})}return a}};var Pg=function e(t,r){return function(e,a){var n=t(e);if(typeof a==="string"){var i=a.indexOf("_");if(i>0){var o=Number(a.substring(i+1)),s=wg(e,r),l=n.h/s.length,c=l*o,d=n.y1+c;return{x1:n.x1,w:n.w,y1:d,h:l,yOffset:c}}}return n}};function Cg(e){{var t=e.render;e.render=function(r){r=r||{};var a=e.cy;if(e.webgl){if(a.zoom()>bf){Eg(e);t.call(e,r)}else{Tg(e);Ng(e,r,cg.SCREEN)}}}}{var r=e.matchCanvasSize;e.matchCanvasSize=function(t){r.call(e,t);e.pickingFrameBuffer.setFramebufferAttachmentSizes(e.canvasWidth,e.canvasHeight);e.pickingFrameBuffer.needsDraw=!0}}{e.findNearestElements=function(t,r,a,n){return Og(e,t,r)}}{var a=e.invalidateCachedZSortedEles;e.invalidateCachedZSortedEles=function(){a.call(e);e.pickingFrameBuffer.needsDraw=!0}}{var n=e.notify;e.notify=function(t,r){n.call(e,t,r);if(t==="viewport"||t==="bounds"){e.pickingFrameBuffer.needsDraw=!0}else t==="background"&&e.drawing.invalidate(r,{type:"node-body"})}}}function Eg(e){var t=e.data.contexts[e.WEBGL];t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT)}function Tg(e){var t=function t(r){r.save();r.setTransform(1,0,0,1,0,0);r.clearRect(0,0,e.canvasWidth,e.canvasHeight);r.restore()};t(e.data.contexts[e.NODE]);t(e.data.contexts[e.DRAG])}function Ig(e){var t=e.canvasWidth;var r=e.canvasHeight;var a=Rh(e),n=a.pan,i=a.zoom;var o=Yh();Uh(o,o,[n.x,n.y]);Zh(o,o,[i,i]);var s=Yh();Jh(s,t,r);var l=Yh();Kh(l,s,o);return l}function kg(e,t){var r=e.canvasWidth;var a=e.canvasHeight;var n=Rh(e),i=n.pan,o=n.zoom;t.setTransform(1,0,0,1,0,0);t.clearRect(0,0,r,a);t.translate(i.x,i.y);t.scale(o,o)}function Rg(e,t){e.drawSelectionRectangle(t,function(t){return kg(e,t)})}function Dg(e){var t=e.data.contexts[e.NODE];t.save();kg(e,t);t.strokeStyle="rgba(0, 0, 0, 0.3)";t.beginPath();t.moveTo(-1e3,0);t.lineTo(1e3,0);t.stroke();t.beginPath();t.moveTo(0,-1e3);t.lineTo(0,1e3);t.stroke();t.restore()}function Bg(e){var t=function t(r,a,n){var i=r.atlasManager.getAtlasCollection(a);var o=e.data.contexts[e.NODE];var s=i.atlases;for(var l=0;l<s.length;l++){var c=s[l],d=c.canvas;if(d){var p=d.width,u=d.height,f=p*l,h=d.height*n,g=.4;o.save();o.scale(g,g);o.drawImage(d,f,h);o.strokeStyle="black";o.rect(f,h,p,u);o.stroke();o.restore()}}};var r=0;t(e.drawing,"node",r++);t(e.drawing,"label",r++)}function Ag(e,t,r,a,n){var i,o,s,l;var c=Rh(e),d=c.pan,p=c.zoom;{var u=Bh(e,d,p,t,r),h=f(u,2),g=h[0],y=h[1],v=6;i=g-v/2;o=y-v/2;s=v;l=v}if(s===0||l===0){return[]}var m=e.data.contexts[e.WEBGL];m.bindFramebuffer(m.FRAMEBUFFER,e.pickingFrameBuffer);if(e.pickingFrameBuffer.needsDraw){m.viewport(0,0,m.canvas.width,m.canvas.height);Ng(e,null,cg.PICKING);e.pickingFrameBuffer.needsDraw=!1}var b=s*l;var x=new Uint8Array(b*4);m.readPixels(i,o,s,l,m.RGBA,m.UNSIGNED_BYTE,x);m.bindFramebuffer(m.FRAMEBUFFER,null);var _=new Set;for(var w=0;w<b;w++){var S=x.slice(w*4,w*4+4),P=Mh(S)-1;P>=0&&_.add(P)}return _}function Og(e,t,r){var a=Ag(e,t,r);var n=e.getCachedZSortedEles();var i,o;var l=s(a),c;try{for(l.s();!(c=l.n()).done;){var d=c.value,p=n[d];!i&&p.isNode()&&(i=p);!o&&p.isEdge()&&(o=p);if(i&&o){break}}}catch(e){l.e(e)}finally{l.f()}return[i,o].filter(Boolean)}function Lg(e,t,r){var a=e.drawing;t+=1;if(r.isNode()){a.drawNode(r,t,"node-underlay");a.drawNode(r,t,"node-body");a.drawTexture(r,t,"label");a.drawNode(r,t,"node-overlay")}else{a.drawEdgeLine(r,t);a.drawEdgeArrow(r,t,"source");a.drawEdgeArrow(r,t,"target");a.drawTexture(r,t,"label");a.drawTexture(r,t,"edge-source-label");a.drawTexture(r,t,"edge-target-label")}}function Ng(e,t,r){var a;e.webglDebug&&(a=performance.now());var n=e.drawing;var i=0;r.screen&&(e.data.canvasNeedsRedraw[e.SELECT_BOX]&&Rg(e,t));if(e.data.canvasNeedsRedraw[e.NODE]||r.picking){var o=e.data.contexts[e.WEBGL];if(r.screen){o.clearColor(0,0,0,0);o.enable(o.BLEND);o.blendFunc(o.ONE,o.ONE_MINUS_SRC_ALPHA)}else{o.disable(o.BLEND)}o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT);o.viewport(0,0,o.canvas.width,o.canvas.height);var l=Ig(e),c=e.getCachedZSortedEles();i=c.length;n.startFrame(l,r);if(r.screen){for(var d=0;d<c.nondrag.length;d++){Lg(e,d,c.nondrag[d])}for(var p=0;p<c.drag.length;p++){Lg(e,p,c.drag[p])}}else if(r.picking){for(var u=0;u<c.length;u++){Lg(e,u,c[u])}}n.endFrame();if(r.screen&&e.webglDebugShowAtlases){Dg(e);Bg(e)}e.data.canvasNeedsRedraw[e.NODE]=!1;e.data.canvasNeedsRedraw[e.DRAG]=!1}if(e.webglDebug){var f=performance.now(),h=!1,g=Math.ceil(f-a),y=n.getDebugInfo(),v=["".concat(i," elements"),"".concat(y.totalInstances," instances"),"".concat(y.batchCount," batches"),"".concat(y.totalAtlases," atlases"),"".concat(y.wrappedCount," wrapped textures"),"".concat(y.simpleCount," simple shapes")].join(", ");if(h){console.log("WebGL (".concat(r.name,") - time ").concat(g,"ms, ").concat(v))}else{console.log("WebGL (".concat(r.name,") - frame time ").concat(g,"ms"));console.log("Totals:");console.log("  ".concat(v));console.log("Texture Atlases Used:");var m=y.atlasInfo,b=s(m),x;try{for(b.s();!(x=b.n()).done;){var _=x.value;console.log("  ".concat(_.type,": ").concat(_.keyCount," keys, ").concat(_.atlasCount," atlases"))}}catch(e){b.e(e)}finally{b.f()}console.log("")}}if(e.data.gc){console.log("Garbage Collect!");e.data.gc=!1;n.gc()}}var Mg={};Mg.drawPolygonPath=function(e,t,r,a,n,i){var o=a/2;var s=n/2;e.beginPath&&e.beginPath();e.moveTo(t+o*i[0],r+s*i[1]);for(var l=1;l<i.length/2;l++){e.lineTo(t+o*i[l*2],r+s*i[l*2+1])}e.closePath()};Mg.drawRoundPolygonPath=function(e,t,r,a,n,i,o){o.forEach(function(t){return qu(e,t)});e.closePath()};Mg.drawRoundRectanglePath=function(e,t,r,a,n,i){var o=a/2;var s=n/2;var l=i==="auto"?Da(a,n):Math.min(i,s,o);e.beginPath&&e.beginPath();e.moveTo(t,r-s);e.arcTo(t+o,r-s,t+o,r,l);e.arcTo(t+o,r+s,t,r+s,l);e.arcTo(t-o,r+s,t-o,r,l);e.arcTo(t-o,r-s,t,r-s,l);e.lineTo(t,r-s);e.closePath()};Mg.drawBottomRoundRectanglePath=function(e,t,r,a,n,i){var o=a/2;var s=n/2;var l=i==="auto"?Da(a,n):i;e.beginPath&&e.beginPath();e.moveTo(t,r-s);e.lineTo(t+o,r-s);e.lineTo(t+o,r);e.arcTo(t+o,r+s,t,r+s,l);e.arcTo(t-o,r+s,t-o,r,l);e.lineTo(t-o,r-s);e.lineTo(t,r-s);e.closePath()};Mg.drawCutRectanglePath=function(e,t,r,a,n,i,o){var s=a/2;var l=n/2;var c=o==="auto"?Aa():o;e.beginPath&&e.beginPath();e.moveTo(t-s+c,r-l);e.lineTo(t+s-c,r-l);e.lineTo(t+s,r-l+c);e.lineTo(t+s,r+l-c);e.lineTo(t+s-c,r+l);e.lineTo(t-s+c,r+l);e.lineTo(t-s,r+l-c);e.lineTo(t-s,r-l+c);e.closePath()};Mg.drawBarrelPath=function(e,t,r,a,n){var i=a/2;var o=n/2;var s=t-i;var l=t+i;var c=r-o;var d=r+o;var p=La(a,n);var u=p.widthOffset;var f=p.heightOffset;var h=p.ctrlPtOffsetPct*u;e.beginPath&&e.beginPath();e.moveTo(s,c+f);e.lineTo(s,d-f);e.quadraticCurveTo(s+h,d,s+u,d);e.lineTo(l-u,d);e.quadraticCurveTo(l-h,d,l,d-f);e.lineTo(l,c+f);e.quadraticCurveTo(l-h,c,l-u,c);e.lineTo(s+u,c);e.quadraticCurveTo(s+h,c,s,c+f);e.closePath()};var jg=Math.sin(0);var qg=Math.cos(0);var zg={};var $g={};var Vg=Math.PI/40;for(var Fg=0*Math.PI;Fg<2*Math.PI;Fg+=Vg){zg[Fg]=Math.sin(Fg);$g[Fg]=Math.cos(Fg)}Mg.drawEllipsePath=function(e,t,r,a,n){e.beginPath&&e.beginPath();if(e.ellipse){e.ellipse(t,r,a/2,n/2,0,0,2*Math.PI)}else{var i,o,s=a/2,l=n/2;for(var c=0*Math.PI;c<2*Math.PI;c+=Vg){i=t-s*zg[c]*jg+s*$g[c]*qg;o=r+l*$g[c]*jg+l*zg[c]*qg;if(c===0){e.moveTo(i,o)}else{e.lineTo(i,o)}}}e.closePath()};var Wg={};Wg.createBuffer=function(e,t){var r=document.createElement("canvas");r.width=e;r.height=t;return[r,r.getContext("2d")]};Wg.bufferCanvasImage=function(t){var r=this.cy;var a=r.mutableElements();var n=a.boundingBox();var i=this.findContainerClientCoords();var o=t.full?Math.ceil(n.w):i[2];var s=t.full?Math.ceil(n.h):i[3];var l=D(t.maxWidth)||D(t.maxHeight);var c=this.getPixelRatio();var d=1;if(t.scale!==e){o*=t.scale;s*=t.scale;d=t.scale}else if(l){var p=Infinity,u=Infinity;D(t.maxWidth)&&(p=d*t.maxWidth/o);D(t.maxHeight)&&(u=d*t.maxHeight/s);d=Math.min(p,u);o*=d;s*=d}if(!l){o*=c;s*=c;d*=c}var f=document.createElement("canvas");f.width=o;f.height=s;f.style.width=o+"px";f.style.height=s+"px";var h=f.getContext("2d");if(o>0&&s>0){h.clearRect(0,0,o,s);h.globalCompositeOperation="source-over";var g=this.getCachedZSortedEles();if(t.full){h.translate(-n.x1*d,-n.y1*d);h.scale(d,d);this.drawElements(h,g);h.scale(1/d,1/d);h.translate(n.x1*d,n.y1*d)}else{var y=r.pan(),v={x:y.x*d,y:y.y*d};d*=r.zoom();h.translate(v.x,v.y);h.scale(d,d);this.drawElements(h,g);h.scale(1/d,1/d);h.translate(-v.x,-v.y)}if(t.bg){h.globalCompositeOperation="destination-over";h.fillStyle=t.bg;h.rect(0,0,o,s);h.fill()}}return f};function Hg(e,t){var r=atob(e);var a=new ArrayBuffer(r.length);var n=new Uint8Array(a);for(var i=0;i<r.length;i++){n[i]=r.charCodeAt(i)}return new Blob([a],{type:t})}function Xg(e){var t=e.indexOf(",");return e.substr(t+1)}function Yg(e,t,r){var a=function a(){return t.toDataURL(r,e.quality)};switch(e.output){case"blob-promise":return new fi(function(a,n){try{t.toBlob(function(e){if(e!=null){a(e)}else{n(new Error("`canvas.toBlob()` sent a null value in its callback"))}},r,e.quality)}catch(e){n(e)}});case"blob":return Hg(Xg(a()),r);case"base64":return Xg(a());case"base64uri":default:return a()}}Wg.png=function(e){return Yg(e,this.bufferCanvasImage(e),"image/png")};Wg.jpg=function(e){return Yg(e,this.bufferCanvasImage(e),"image/jpeg")};var Gg={};Gg.nodeShapeImpl=function(e,t,r,a,n,i,o,s){switch(e){case"ellipse":return this.drawEllipsePath(t,r,a,n,i);case"polygon":return this.drawPolygonPath(t,r,a,n,i,o);case"round-polygon":return this.drawRoundPolygonPath(t,r,a,n,i,o,s);case"roundrectangle":case"round-rectangle":return this.drawRoundRectanglePath(t,r,a,n,i,s);case"cutrectangle":case"cut-rectangle":return this.drawCutRectanglePath(t,r,a,n,i,o,s);case"bottomroundrectangle":case"bottom-round-rectangle":return this.drawBottomRoundRectanglePath(t,r,a,n,i,s);case"barrel":return this.drawBarrelPath(t,r,a,n,i)}};var Kg=Ug.prototype;Kg.CANVAS_LAYERS=3;Kg.SELECT_BOX=0;Kg.DRAG=1;Kg.NODE=2;Kg.WEBGL=3;Kg.CANVAS_TYPES=["2d","2d","2d","webgl2"];Kg.BUFFER_COUNT=3;Kg.TEXTURE_BUFFER=0;Kg.MOTIONBLUR_BUFFER_NODE=1;Kg.MOTIONBLUR_BUFFER_DRAG=2;function Ug(e){var t=this;var r=t.cy.window();var a=r.document;if(e.webgl){Kg.CANVAS_LAYERS=t.CANVAS_LAYERS=4;console.log("webgl rendering enabled")}t.data={canvases:new Array(Kg.CANVAS_LAYERS),contexts:new Array(Kg.CANVAS_LAYERS),canvasNeedsRedraw:new Array(Kg.CANVAS_LAYERS),bufferCanvases:new Array(Kg.BUFFER_COUNT),bufferContexts:new Array(Kg.CANVAS_LAYERS)};var n="-webkit-tap-highlight-color";var i="rgba(0,0,0,0)";t.data.canvasContainer=a.createElement("div");var o=t.data.canvasContainer.style;t.data.canvasContainer.style[n]=i;o.position="relative";o.zIndex="0";o.overflow="hidden";var s=e.cy.container();s.appendChild(t.data.canvasContainer);s.style[n]=i;var l={"-webkit-user-select":"none","-moz-user-select":"-moz-none","user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)","outline-style":"none"};if(W()){l["-ms-touch-action"]="none";l["touch-action"]="none"}for(var c=0;c<Kg.CANVAS_LAYERS;c++){var d=t.data.canvases[c]=a.createElement("canvas"),p=Kg.CANVAS_TYPES[c];t.data.contexts[c]=d.getContext(p);t.data.contexts[c]||Lt("Could not create canvas of type "+p);Object.keys(l).forEach(function(e){d.style[e]=l[e]});d.style.position="absolute";d.setAttribute("data-id","layer"+c);d.style.zIndex=String(Kg.CANVAS_LAYERS-c);t.data.canvasContainer.appendChild(d);t.data.canvasNeedsRedraw[c]=!1}t.data.topCanvas=t.data.canvases[0];t.data.canvases[Kg.NODE].setAttribute("data-id","layer"+Kg.NODE+"-node");t.data.canvases[Kg.SELECT_BOX].setAttribute("data-id","layer"+Kg.SELECT_BOX+"-selectbox");t.data.canvases[Kg.DRAG].setAttribute("data-id","layer"+Kg.DRAG+"-drag");t.data.canvases[Kg.WEBGL]&&t.data.canvases[Kg.WEBGL].setAttribute("data-id","layer"+Kg.WEBGL+"-webgl");for(var c=0;c<Kg.BUFFER_COUNT;c++){t.data.bufferCanvases[c]=a.createElement("canvas");t.data.bufferContexts[c]=t.data.bufferCanvases[c].getContext("2d");t.data.bufferCanvases[c].style.position="absolute";t.data.bufferCanvases[c].setAttribute("data-id","buffer"+c);t.data.bufferCanvases[c].style.zIndex=String(-c-1);t.data.bufferCanvases[c].style.visibility="hidden"}t.pathsEnabled=!0;var u=Xr();var f=function e(t){return{x:(t.x1+t.x2)/2,y:(t.y1+t.y2)/2}};var h=function e(t){return{x:-t.w/2,y:-t.h/2}};var g=function e(t){var r=t[0]._private;var a=r.oldBackgroundTimestamp===r.backgroundTimestamp;return!a};var y=function e(t){return t[0]._private.nodeKey};var v=function e(t){return t[0]._private.labelStyleKey};var m=function e(t){return t[0]._private.sourceLabelStyleKey};var b=function e(t){return t[0]._private.targetLabelStyleKey};var x=function e(r,a,n,i,o){return t.drawElement(r,a,n,!1,!1,o)};var _=function e(r,a,n,i,o){return t.drawElementText(r,a,n,i,"main",o)};var w=function e(r,a,n,i,o){return t.drawElementText(r,a,n,i,"source",o)};var S=function e(r,a,n,i,o){return t.drawElementText(r,a,n,i,"target",o)};var P=function e(t){t.boundingBox();return t[0]._private.bodyBounds};var C=function e(t){t.boundingBox();return t[0]._private.labelBounds.main||u};var E=function e(t){t.boundingBox();return t[0]._private.labelBounds.source||u}
var T=function e(t){t.boundingBox();return t[0]._private.labelBounds.target||u};var I=function e(t,r){return r};var k=function e(t){return f(P(t))};var R=function e(t,r,a){var n=t?t+"-":"";return{x:r.x+a.pstyle(n+"text-margin-x").pfValue,y:r.y+a.pstyle(n+"text-margin-y").pfValue}};var D=function e(t,r,a){var n=t[0]._private.rscratch;return{x:n[r],y:n[a]}};var B=function e(t){return R("",D(t,"labelX","labelY"),t)};var A=function e(t){return R("source",D(t,"sourceLabelX","sourceLabelY"),t)};var O=function e(t){return R("target",D(t,"targetLabelX","targetLabelY"),t)};var L=function e(t){return h(P(t))};var N=function e(t){return h(E(t))};var M=function e(t){return h(T(t))};var j=function e(t){var r=C(t);var a=h(C(t));if(t.isNode()){switch(t.pstyle("text-halign").value){case"left":a.x=-r.w-(r.leftPad||0);break;case"right":a.x=-(r.rightPad||0);break}switch(t.pstyle("text-valign").value){case"top":a.y=-r.h-(r.topPad||0);break;case"bottom":a.y=-(r.botPad||0);break}}return a};var q=t.data.eleTxrCache=new Lf(t,{getKey:y,doesEleInvalidateKey:g,drawElement:x,getBoundingBox:P,getRotationPoint:k,getRotationOffset:L,allowEdgeTxrCaching:!1,allowParentTxrCaching:!1});var z=t.data.lblTxrCache=new Lf(t,{getKey:v,drawElement:_,getBoundingBox:C,getRotationPoint:B,getRotationOffset:j,isVisible:I});var $=t.data.slbTxrCache=new Lf(t,{getKey:m,drawElement:w,getBoundingBox:E,getRotationPoint:A,getRotationOffset:N,isVisible:I});var V=t.data.tlbTxrCache=new Lf(t,{getKey:b,drawElement:S,getBoundingBox:T,getRotationPoint:O,getRotationOffset:M,isVisible:I});var F=t.data.lyrTxrCache=new Zf(t);t.onUpdateEleCalcs(function e(t,r){q.invalidateElements(r);z.invalidateElements(r);$.invalidateElements(r);V.invalidateElements(r);F.invalidateElements(r);for(var a=0;a<r.length;a++){var n=r[a]._private;n.oldBackgroundTimestamp=n.backgroundTimestamp}});var H=function e(t){for(var r=0;r<t.length;r++){F.enqueueElementRefinement(t[r].ele)}};q.onDequeue(H);z.onDequeue(H);$.onDequeue(H);V.onDequeue(H);e.webgl&&t.initWebgl(e,{getStyleKey:y,getLabelKey:v,getSourceLabelKey:m,getTargetLabelKey:b,drawElement:x,drawLabel:_,drawSourceLabel:w,drawTargetLabel:S,getElementBox:P,getLabelBox:C,getSourceLabelBox:E,getTargetLabelBox:T,getElementRotationPoint:k,getElementRotationOffset:L,getLabelRotationPoint:B,getSourceLabelRotationPoint:A,getTargetLabelRotationPoint:O,getLabelRotationOffset:j,getSourceLabelRotationOffset:N,getTargetLabelRotationOffset:M})}Kg.redrawHint=function(e,t){var r=this;switch(e){case"eles":r.data.canvasNeedsRedraw[Kg.NODE]=t;break;case"drag":r.data.canvasNeedsRedraw[Kg.DRAG]=t;break;case"select":r.data.canvasNeedsRedraw[Kg.SELECT_BOX]=t;break;case"gc":r.data.gc=!0;break}};var Qg=typeof Path2D!=="undefined";Kg.path2dEnabled=function(t){if(t===e){return this.pathsEnabled}this.pathsEnabled=t?!0:!1};Kg.usePaths=function(){return Qg&&this.pathsEnabled};Kg.setImgSmoothing=function(e,t){if(e.imageSmoothingEnabled!=null){e.imageSmoothingEnabled=t}else{e.webkitImageSmoothingEnabled=t;e.mozImageSmoothingEnabled=t;e.msImageSmoothingEnabled=t}};Kg.getImgSmoothing=function(e){if(e.imageSmoothingEnabled!=null){return e.imageSmoothingEnabled}else{return e.webkitImageSmoothingEnabled||e.mozImageSmoothingEnabled||e.msImageSmoothingEnabled}};Kg.makeOffscreenCanvas=function(e,t){var r;if((typeof OffscreenCanvas==="undefined"?"undefined":v(OffscreenCanvas))!=="undefined"){r=new OffscreenCanvas(e,t)}else{var a=this.cy.window(),n=a.document;r=n.createElement("canvas");r.width=e;r.height=t}return r};[rh,ch,yh,mh,bh,wh,Ph,xg,Mg,Wg,Gg].forEach(function(e){oe(Kg,e)});var Zg=[{name:"null",impl:pu},{name:"base",impl:df},{name:"canvas",impl:Ug}];var Jg=[{type:"layout",extensions:du},{type:"renderer",extensions:Zg}];var ey={};var ty={};function ry(e,t,r){var a=r;var n=function r(a){Mt("Can not register `"+t+"` for `"+e+"` since `"+a+"` already exists in the prototype and can not be overridden")};if(e==="core"){if(wp.prototype[t]){return n(t)}else{wp.prototype[t]=r}}else if(e==="collection"){if(Nd.prototype[t]){return n(t)}else{Nd.prototype[t]=r}}else if(e==="layout"){var i=function e(t){this.options=t;r.call(this,t);k(this._private)||(this._private={});this._private.cy=t.cy;this._private.listeners=[];this.createEmitter()},o=i.prototype=Object.create(r.prototype),s=[];for(var l=0;l<s.length;l++){var c=s[l];o[c]=o[c]||function(){return this}}if(o.start&&!o.run){o.run=function(){this.start();return this}}else!o.start&&o.run&&(o.start=function(){this.run();return this});var d=r.prototype.stop;o.stop=function(){var e=this.options;if(e&&e.animate){var t=this.animations;if(t){for(var r=0;r<t.length;r++){t[r].stop()}}}if(d){d.call(this)}else{this.emit("layoutstop")}return this};o.destroy||(o.destroy=function(){return this});o.cy=function(){return this._private.cy};var p=function e(t){return t._private.cy},u={addEventFields:function e(t,r){r.layout=t;r.cy=p(t);r.target=t},bubble:function e(){return!0},parent:function e(t){return p(t)}};oe(o,{createEmitter:function e(){this._private.emitter=new ed(u,this);return this},emitter:function e(){return this._private.emitter},on:function e(t,r){this.emitter().on(t,r);return this},one:function e(t,r){this.emitter().one(t,r);return this},once:function e(t,r){this.emitter().one(t,r);return this},removeListener:function e(t,r){this.emitter().removeListener(t,r);return this},removeAllListeners:function e(){this.emitter().removeAllListeners();return this},emit:function e(t,r){this.emitter().emit(t,r);return this}});vl.eventAliasesOn(o);a=i}else if(e==="renderer"&&t!=="null"&&t!=="base"){var f=ay("renderer","base"),h=f.prototype,g=r,y=r.prototype,v=function e(){f.apply(this,arguments);g.apply(this,arguments)},m=v.prototype;for(var b in h){var x=h[b],_=y[b]!=null;if(_){return n(b)}m[b]=x}for(var w in y){m[w]=y[w]}h.clientFunctions.forEach(function(e){m[e]=m[e]||function(){Lt("Renderer does not implement `renderer."+e+"()` on its prototype")}});a=v}else if(e==="__proto__"||e==="constructor"||e==="prototype"){return Lt(e+" is an illegal type to be registered, possibly lead to prototype pollutions")}return fe({map:ey,keys:[e,t],value:a})}function ay(e,t){return he({map:ey,keys:[e,t]})}function ny(e,t,r,a,n){return fe({map:ty,keys:[e,t,r,a],value:n})}function iy(e,t,r,a){return he({map:ty,keys:[e,t,r,a]})}var oy=function e(){if(arguments.length===2){return ay.apply(null,arguments)}else if(arguments.length===3){return ry.apply(null,arguments)}else if(arguments.length===4){return iy.apply(null,arguments)}else if(arguments.length===5){return ny.apply(null,arguments)}else{Lt("Invalid extension access syntax")}};wp.prototype.extension=oy;Jg.forEach(function(e){e.extensions.forEach(function(t){ry(e.type,t.name,t.impl)})});var sy=function e(){if(!(this instanceof sy)){return new sy}this.length=0};var ly=sy.prototype;ly.instanceString=function(){return"stylesheet"};ly.selector=function(e){var t=this.length++;this[t]={selector:e,properties:[]};return this};ly.css=function(e,t){var r=this.length-1;if(E(e)){this[r].properties.push({name:e,value:t})}else if(k(e)){var a=e,n=Object.keys(a);for(var i=0;i<n.length;i++){var o=n[i],s=a[o];if(s==null){continue}var l=yp.properties[o]||yp.properties[Y(o)];if(l==null){continue}var c=l.name,d=s;this[r].properties.push({name:c,value:d})}}return this};ly.style=ly.css;ly.generateStyle=function(e){var t=new yp(e);return this.appendToStyle(t)};ly.appendToStyle=function(e){for(var t=0;t<this.length;t++){var r=this[t],a=r.selector,n=r.properties;e.selector(a);for(var i=0;i<n.length;i++){var o=n[i];e.css(o.name,o.value)}}return e};var cy="3.33.1";var dy=function t(r){r===e&&(r={});if(k(r)){return new wp(r)}else if(E(r)){return oy.apply(oy,arguments)}};dy.use=function(e){var t=Array.prototype.slice.call(arguments,1);t.unshift(dy);e.apply(null,t);return this};dy.warnings=function(e){return Nt(e)};dy.version=cy;dy.stylesheet=dy.Stylesheet=sy;__bbb.cc=dy;__bbb.f=undefined}).call(this)